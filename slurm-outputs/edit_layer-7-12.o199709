[2025-04-24 22:20:17,511][__main__][INFO] - 

alg: mend
lr: 1.0e-06
edit_lr: 0.0001
seed: 0
debug: false
model_save_pt: 5000
edit_bs: 1
silent: false
max_iters: 1000000
log_interval: 10
val_interval: 100
lr_lr: 0.0001
batch_size: 2
val_batch_size: 5
accumulate_bs: 10
cedit: 0.1
cloc: 1.0
cbase: 1.0
val_steps: 100
device: cuda:0
base_loss: distill
oracle: false
train: true
train_base: false
opt: Adam
single_batch: false
archive: null
grad_clip: 100.0
ref: null
early_stop_patience: 2000
early_stop_key: loss/total_edit_val
dropout: 0.0
tokenizer: null
results_dir: null
no_grad_layers: null
eval_only: false
half: false
save: false
l_e_data: rephrase
edit_loss: p(y|x)
edit_input: question
model:
  pt: null
  name: ${oc.env:PWD}/models/Llama-3.2-1B-eos-sft
  class_name: LlamaForCausalLM
  tokenizer_class: LlamaTokenizer
  tokenizer_name: ${oc.env:SHARE_RES_DIR}/models/llama3/hf/Llama-3.2-1B
  inner_params:
  - model.layers.7.mlp.gate_proj.weight
  - model.layers.7.mlp.up_proj.weight
  - model.layers.7.mlp.down_proj.weight
  - model.layers.8.mlp.gate_proj.weight
  - model.layers.8.mlp.up_proj.weight
  - model.layers.8.mlp.down_proj.weight
  - model.layers.9.mlp.gate_proj.weight
  - model.layers.9.mlp.up_proj.weight
  - model.layers.9.mlp.down_proj.weight
  - model.layers.10.mlp.gate_proj.weight
  - model.layers.10.mlp.up_proj.weight
  - model.layers.10.mlp.down_proj.weight
  - model.layers.11.mlp.gate_proj.weight
  - model.layers.11.mlp.up_proj.weight
  - model.layers.11.mlp.down_proj.weight
  - model.layers.12.mlp.gate_proj.weight
  - model.layers.12.mlp.up_proj.weight
  - model.layers.12.mlp.down_proj.weight
data:
  path: null
  rephrase: true
  musique_propagation_only: false
  zsre_nq: true
  nq_path: ${hydra:runtime.cwd}/data/nq
  wiki_webtext: true
  n_edits: 1
eval:
  verbose: true
  log_interval: 100
  final_eval: true
generation:
  max_new_tokens: 20
  prompt: urial
  save_dir: null
mend:
  one_sided: false
  n_hidden: 1
  hidden_dim: null
  init: id
  norm: true
  combine: true
  x_only: false
  delta_only: false
  act: relu
  rank: 1920
  mlp_class: IDMLP
  shared: false
task: ripple_edits_all
dataset: ripple_edits_all
heavy_outerloop: true
all_propagation_in_outerloop: true
train_set_size: 10000


[2025-04-24 22:20:17,513][__main__][INFO] - Project base directory: /work/09636/zyliu/vista/mend
[2025-04-24 22:20:24,315][models][INFO] - Loading model class <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> with name `/home1/09636/zyliu/work/mend/models/Llama-3.2-1B-eos-sft`
[2025-04-24 22:20:25,986][models][INFO] - Set 0 dropout modules to p=0.0
[2025-04-24 22:20:31,529][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:20:31,595][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:20:31,612][__main__][INFO] - train_set size: 3686
[2025-04-24 22:20:31,612][__main__][INFO] - val_set size: 500
[2025-04-24 22:20:31,968][__main__][INFO] - Loading class MEND from module <module 'algs.mend' from '/work/09636/zyliu/vista/mend/algs/mend.py'>
[2025-04-24 22:20:31,969][algs.mend][INFO] - Hooked 18 modules
[2025-04-24 22:20:32,005][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:32,005][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:32,278][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:32,278][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:32,547][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:32,548][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:32,816][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:32,817][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:33,086][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:33,086][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:33,355][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:33,355][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:33,624][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:33,624][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:33,893][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:33,894][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:34,163][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:34,163][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:34,432][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:34,432][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:34,701][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:34,701][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:34,970][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:34,970][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:35,239][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:35,239][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:35,508][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:35,509][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:35,778][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:35,778][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:36,047][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:36,047][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:36,316][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:36,316][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:36,585][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:20:36,586][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:20:46,423][trainer][INFO] - Building optimizer <class 'torch.optim.adam.Adam'> with lr 1e-06
[2025-04-24 22:20:46,429][trainer][INFO] - Writing wandb run "ripple_edits_all - mend - Llama-3.2-1B-eos-sft - 2025-04-24_22-20-17_4805768358" to /tmp/tmp1u48634j
[2025-04-24 22:20:47,433][data_classes.ripple_edits][INFO] - is_eval: False
[2025-04-24 22:20:47,433][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:20:47,435][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:20:47,436][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:20:47,437][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:20:47,437][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:20:47,437][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in Chelsea F.C. is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which CFC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea FC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Blues is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in the country Chelsea F.C. is associated with is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of Chelsea F.C. is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Ia»ôi<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea Football Club is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Pensioners is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which Chelsea F.C. is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which the country Chelsea F.C. is associated with is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the founder of Chelsea F.C. is Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the league which Chelsea F.C. plays in is Premier League<|end_of_text|>
[2025-04-24 22:20:47,438][data_classes.ripple_edits][INFO] - Label:  Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Ia»ôi<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Premier League<|end_of_text|>
[2025-04-24 22:20:47,438][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:20:47,438][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:20:47,438][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>nq question: what is the setting of things fall apart pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:20:47,438][data_classes.ripple_edits][INFO] - Label:  pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:20:49,338][trainer][INFO] - Step 0:
[2025-04-24 22:20:49,338][trainer][INFO] - loss/edit_train:  15.92841; loss/loc_train:  0.54773; edit/acc_train:  0.00000; edit/log_prob_train: -15.92841; edit/prob_train:  0.23352; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.10675; perplexity/pre_train:  22.34838; nll/post_train:  3.55552; perplexity/post_train:  35.00610; n_tokens/pre_train:  13.00000; n_tokens/post_train:  13.00000; time/edit_train:  0.86260; loss/total_train:  2.14057; loss/total_edit_train:  2.14057; memory/alloc_max_train:  24613082624.00000; memory/res_max_train:  26807894016.00000; grad/true_mag0_train:  5.18775; grad/pseudo_mag0_train:  19561.00781; grad/true_std0_train:  0.00127; grad/pseudo_std0_train:  4.77564; grad/diff0_train:  19558.32617; grad/cos0_train:  0.51694; grad/true_mag1_train:  7.97510; grad/pseudo_mag1_train:  19895.48438; grad/true_std1_train:  0.00195; grad/pseudo_std1_train:  4.85730; grad/diff1_train:  19890.53711; grad/cos1_train:  0.62060; grad/true_mag2_train:  8.47292; grad/pseudo_mag2_train:  19678.05273; grad/true_std2_train:  0.00207; grad/pseudo_std2_train:  4.80421; grad/diff2_train:  19672.30078; grad/cos2_train:  0.67893; grad/true_mag3_train:  5.64922; grad/pseudo_mag3_train:  19362.90039; grad/true_std3_train:  0.00138; grad/pseudo_std3_train:  4.72727; grad/diff3_train:  19360.20117; grad/cos3_train:  0.47785; grad/true_mag4_train:  8.98698; grad/pseudo_mag4_train:  19473.74609; grad/true_std4_train:  0.00219; grad/pseudo_std4_train:  4.75433; grad/diff4_train:  19468.29297; grad/cos4_train:  0.60705; grad/true_mag5_train:  9.37920; grad/pseudo_mag5_train:  19279.11133; grad/true_std5_train:  0.00229; grad/pseudo_std5_train:  4.70681; grad/diff5_train:  19272.96484; grad/cos5_train:  0.65545; grad/true_mag6_train:  5.60694; grad/pseudo_mag6_train:  19130.09375; grad/true_std6_train:  0.00137; grad/pseudo_std6_train:  4.67043; grad/diff6_train:  19127.29102; grad/cos6_train:  0.50006; grad/true_mag7_train:  9.41691; grad/pseudo_mag7_train:  19174.02344; grad/true_std7_train:  0.00230; grad/pseudo_std7_train:  4.68116; grad/diff7_train:  19167.94336; grad/cos7_train:  0.64592; grad/true_mag8_train:  11.30883; grad/pseudo_mag8_train:  19399.63867; grad/true_std8_train:  0.00276; grad/pseudo_std8_train:  4.73624; grad/diff8_train:  19392.36914; grad/cos8_train:  0.64298; grad/true_mag9_train:  6.29345; grad/pseudo_mag9_train:  19572.36328; grad/true_std9_train:  0.00154; grad/pseudo_std9_train:  4.77841; grad/diff9_train:  19568.73633; grad/cos9_train:  0.57634; grad/true_mag10_train:  9.62568; grad/pseudo_mag10_train:  19640.46680; grad/true_std10_train:  0.00235; grad/pseudo_std10_train:  4.79504; grad/diff10_train:  19634.13867; grad/cos10_train:  0.65749; grad/true_mag11_train:  11.14021; grad/pseudo_mag11_train:  19844.89844; grad/true_std11_train:  0.00272; grad/pseudo_std11_train:  4.84495; grad/diff11_train:  19837.25977; grad/cos11_train:  0.68564; grad/true_mag12_train:  6.86370; grad/pseudo_mag12_train:  20034.89062; grad/true_std12_train:  0.00168; grad/pseudo_std12_train:  4.89133; grad/diff12_train:  20030.63477; grad/cos12_train:  0.62024; grad/true_mag13_train:  9.10551; grad/pseudo_mag13_train:  19841.44336; grad/true_std13_train:  0.00222; grad/pseudo_std13_train:  4.84410; grad/diff13_train:  19835.23828; grad/cos13_train:  0.68162; grad/true_mag14_train:  10.85282; grad/pseudo_mag14_train:  20539.23242; grad/true_std14_train:  0.00265; grad/pseudo_std14_train:  5.01446; grad/diff14_train:  20531.73633; grad/cos14_train:  0.69066; grad/true_mag15_train:  6.86825; grad/pseudo_mag15_train:  20620.08203; grad/true_std15_train:  0.00168; grad/pseudo_std15_train:  5.03420; grad/diff15_train:  20615.41797; grad/cos15_train:  0.67929; grad/true_mag16_train:  8.53887; grad/pseudo_mag16_train:  20500.21289; grad/true_std16_train:  0.00208; grad/pseudo_std16_train:  5.00494; grad/diff16_train:  20494.56250; grad/cos16_train:  0.66206; grad/true_mag17_train:  9.81037; grad/pseudo_mag17_train:  21466.03516; grad/true_std17_train:  0.00240; grad/pseudo_std17_train:  5.24073; grad/diff17_train:  21459.15820; grad/cos17_train:  0.70114
[2025-04-24 22:20:49,341][data_classes.ripple_edits][INFO] - is_eval: True
[2025-04-24 22:20:49,341][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:20:49,341][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:20:49,341][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>Is Daniel Lewis Lee still alive? no<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The gender of Daniel Lewis Lee is male<|end_of_text|>
@@
<|begin_of_text|>The name of the country of citizenship of Daniel Lewis Lee is United States of America<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The occupation of Daniel Lewis Lee is militant<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The place of birth of Daniel Lewis Lee is Yukon<|end_of_text|>
[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] no<|end_of_text|>
@@
[PAD][PAD][PAD] male<|end_of_text|>
@@
 United States of America<|end_of_text|>
@@
[PAD][PAD][PAD] militant<|end_of_text|>
@@
[PAD][PAD] Yukon<|end_of_text|>
[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:20:49,342][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: from which country do most visitors to canada originate United States
@@
[PAD][PAD][PAD]<|begin_of_text|>nq question: who did robin stalk in how i met your mother Paul Shaffer
@@
[PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: who writes the guinness book of world records Ripley Entertainment
@@
<|begin_of_text|>nq question: where was the hallmark movie mistletoe inn filmed Langley, British Columbia
[2025-04-24 22:20:49,343][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] United States
@@
[PAD][PAD] Paul Shaffer
@@
[PAD][PAD] Ripley Entertainment
@@
 Langley, British Columbia
[2025-04-24 22:21:07,103][trainer][INFO] - Step 0:
[2025-04-24 22:21:07,104][trainer][INFO] - loss/edit_val:  14.83453; loss/loc_val:  2.63736; edit/acc_val:  0.00000; edit/log_prob_val: -14.83453; edit/prob_val:  0.05256; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  8.09371; perplexity/post_val:  3273.81616; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10441; loss/total_val:  4.12081; loss/total_edit_val:  4.12081; memory/alloc_max_val:  25330856806.40000; memory/res_max_val:  27650110259.20000; eval_time/elapsed:  17.76070; eval_time/average:  0.17761
[2025-04-24 22:21:07,111][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:21:25,306][trainer][INFO] - Write complete.
[2025-04-24 22:21:29,056][trainer][INFO] - Step 10:
[2025-04-24 22:21:29,056][trainer][INFO] - loss/edit_train:  12.02909; loss/loc_train:  0.40318; edit/acc_train:  0.00714; edit/log_prob_train: -12.02909; edit/prob_train:  0.18121; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.78122; perplexity/pre_train:  119.24989; nll/post_train:  5.35890; perplexity/post_train:  212.49065; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.17438; loss/total_train:  1.60609; loss/total_edit_train:  1.60609; memory/alloc_max_train:  26086742528.00000; memory/res_max_train:  28321828044.80000; grad/true_mag0_train:  5.39012; grad/pseudo_mag0_train:  18316.66348; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  4.47184; grad/diff0_train:  18313.48301; grad/cos0_train:  0.58841; grad/true_mag1_train:  8.70355; grad/pseudo_mag1_train:  18357.73477; grad/true_std1_train:  0.00212; grad/pseudo_std1_train:  4.48187; grad/diff1_train:  18351.97207; grad/cos1_train:  0.66038; grad/true_mag2_train:  9.10508; grad/pseudo_mag2_train:  17837.30918; grad/true_std2_train:  0.00222; grad/pseudo_std2_train:  4.35481; grad/diff2_train:  17830.66592; grad/cos2_train:  0.72752; grad/true_mag3_train:  5.88889; grad/pseudo_mag3_train:  18266.21162; grad/true_std3_train:  0.00144; grad/pseudo_std3_train:  4.45952; grad/diff3_train:  18262.89902; grad/cos3_train:  0.55996; grad/true_mag4_train:  10.36348; grad/pseudo_mag4_train:  18174.25186; grad/true_std4_train:  0.00253; grad/pseudo_std4_train:  4.43707; grad/diff4_train:  18167.44346; grad/cos4_train:  0.65469; grad/true_mag5_train:  11.34564; grad/pseudo_mag5_train:  17716.61914; grad/true_std5_train:  0.00277; grad/pseudo_std5_train:  4.32535; grad/diff5_train:  17708.78525; grad/cos5_train:  0.68863; grad/true_mag6_train:  6.36650; grad/pseudo_mag6_train:  18827.53242; grad/true_std6_train:  0.00155; grad/pseudo_std6_train:  4.59657; grad/diff6_train:  18823.68477; grad/cos6_train:  0.60021; grad/true_mag7_train:  11.40368; grad/pseudo_mag7_train:  18620.00840; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  4.54590; grad/diff7_train:  18612.04951; grad/cos7_train:  0.69304; grad/true_mag8_train:  14.16159; grad/pseudo_mag8_train:  18586.51846; grad/true_std8_train:  0.00346; grad/pseudo_std8_train:  4.53772; grad/diff8_train:  18576.59102; grad/cos8_train:  0.69777; grad/true_mag9_train:  8.08191; grad/pseudo_mag9_train:  20749.25078; grad/true_std9_train:  0.00197; grad/pseudo_std9_train:  5.06573; grad/diff9_train:  20743.58203; grad/cos9_train:  0.68996; grad/true_mag10_train:  11.79705; grad/pseudo_mag10_train:  20449.36006; grad/true_std10_train:  0.00288; grad/pseudo_std10_train:  4.99252; grad/diff10_train:  20440.32471; grad/cos10_train:  0.75519; grad/true_mag11_train:  15.42762; grad/pseudo_mag11_train:  20597.86162; grad/true_std11_train:  0.00377; grad/pseudo_std11_train:  5.02877; grad/diff11_train:  20586.25918; grad/cos11_train:  0.74139; grad/true_mag12_train:  9.16598; grad/pseudo_mag12_train:  22231.12656; grad/true_std12_train:  0.00224; grad/pseudo_std12_train:  5.42752; grad/diff12_train:  22224.18857; grad/cos12_train:  0.73895; grad/true_mag13_train:  11.73675; grad/pseudo_mag13_train:  21728.70381; grad/true_std13_train:  0.00287; grad/pseudo_std13_train:  5.30486; grad/diff13_train:  21719.53828; grad/cos13_train:  0.76768; grad/true_mag14_train:  14.26498; grad/pseudo_mag14_train:  22399.01006; grad/true_std14_train:  0.00348; grad/pseudo_std14_train:  5.46851; grad/diff14_train:  22387.64141; grad/cos14_train:  0.78506; grad/true_mag15_train:  9.15294; grad/pseudo_mag15_train:  22609.41143; grad/true_std15_train:  0.00223; grad/pseudo_std15_train:  5.51988; grad/diff15_train:  22602.06729; grad/cos15_train:  0.78735; grad/true_mag16_train:  10.79051; grad/pseudo_mag16_train:  22248.51084; grad/true_std16_train:  0.00263; grad/pseudo_std16_train:  5.43177; grad/diff16_train:  22239.98418; grad/cos16_train:  0.77390; grad/true_mag17_train:  12.86661; grad/pseudo_mag17_train:  23489.75400; grad/true_std17_train:  0.00314; grad/pseudo_std17_train:  5.73480; grad/diff17_train:  23479.44062; grad/cos17_train:  0.78388; grad_train:  2728.87061; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:21:32,720][trainer][INFO] - Step 20:
[2025-04-24 22:21:32,720][trainer][INFO] - loss/edit_train:  10.76304; loss/loc_train:  0.31885; edit/acc_train:  0.00000; edit/log_prob_train: -10.76304; edit/prob_train:  0.22841; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  3.83132; perplexity/pre_train:  46.12337; nll/post_train:  4.11264; perplexity/post_train:  61.10802; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.22043; loss/total_train:  1.39516; loss/total_edit_train:  1.39516; memory/alloc_max_train:  37153517107.20000; memory/res_max_train:  42649780224.00000; grad/true_mag0_train:  5.33795; grad/pseudo_mag0_train:  18396.95996; grad/true_std0_train:  0.00130; grad/pseudo_std0_train:  4.49144; grad/diff0_train:  18393.63242; grad/cos0_train:  0.62394; grad/true_mag1_train:  8.61739; grad/pseudo_mag1_train:  18345.26602; grad/true_std1_train:  0.00210; grad/pseudo_std1_train:  4.47882; grad/diff1_train:  18339.35215; grad/cos1_train:  0.68518; grad/true_mag2_train:  8.70996; grad/pseudo_mag2_train:  17205.19697; grad/true_std2_train:  0.00213; grad/pseudo_std2_train:  4.20049; grad/diff2_train:  17198.67803; grad/cos2_train:  0.74764; grad/true_mag3_train:  5.51324; grad/pseudo_mag3_train:  17378.55703; grad/true_std3_train:  0.00135; grad/pseudo_std3_train:  4.24281; grad/diff3_train:  17375.23291; grad/cos3_train:  0.60325; grad/true_mag4_train:  9.67978; grad/pseudo_mag4_train:  16885.12002; grad/true_std4_train:  0.00236; grad/pseudo_std4_train:  4.12234; grad/diff4_train:  16878.52500; grad/cos4_train:  0.68009; grad/true_mag5_train:  10.68546; grad/pseudo_mag5_train:  16268.51162; grad/true_std5_train:  0.00261; grad/pseudo_std5_train:  3.97180; grad/diff5_train:  16260.85967; grad/cos5_train:  0.71479; grad/true_mag6_train:  5.98854; grad/pseudo_mag6_train:  17284.55693; grad/true_std6_train:  0.00146; grad/pseudo_std6_train:  4.21986; grad/diff6_train:  17280.58848; grad/cos6_train:  0.66096; grad/true_mag7_train:  10.75038; grad/pseudo_mag7_train:  16963.25137; grad/true_std7_train:  0.00262; grad/pseudo_std7_train:  4.14142; grad/diff7_train:  16955.35596; grad/cos7_train:  0.73213; grad/true_mag8_train:  13.79768; grad/pseudo_mag8_train:  16632.37090; grad/true_std8_train:  0.00337; grad/pseudo_std8_train:  4.06064; grad/diff8_train:  16622.26299; grad/cos8_train:  0.73045; grad/true_mag9_train:  7.60280; grad/pseudo_mag9_train:  18676.54346; grad/true_std9_train:  0.00186; grad/pseudo_std9_train:  4.55970; grad/diff9_train:  18670.66709; grad/cos9_train:  0.76862; grad/true_mag10_train:  11.18530; grad/pseudo_mag10_train:  18386.35850; grad/true_std10_train:  0.00273; grad/pseudo_std10_train:  4.48886; grad/diff10_train:  18377.37666; grad/cos10_train:  0.79817; grad/true_mag11_train:  14.07427; grad/pseudo_mag11_train:  18253.28467; grad/true_std11_train:  0.00344; grad/pseudo_std11_train:  4.45637; grad/diff11_train:  18242.01035; grad/cos11_train:  0.79633; grad/true_mag12_train:  8.57891; grad/pseudo_mag12_train:  19573.13945; grad/true_std12_train:  0.00209; grad/pseudo_std12_train:  4.77860; grad/diff12_train:  19566.09160; grad/cos12_train:  0.81542; grad/true_mag13_train:  10.72907; grad/pseudo_mag13_train:  19218.97471; grad/true_std13_train:  0.00262; grad/pseudo_std13_train:  4.69213; grad/diff13_train:  19209.92822; grad/cos13_train:  0.83945; grad/true_mag14_train:  13.46380; grad/pseudo_mag14_train:  19733.97656; grad/true_std14_train:  0.00329; grad/pseudo_std14_train:  4.81787; grad/diff14_train:  19722.81953; grad/cos14_train:  0.82382; grad/true_mag15_train:  8.74483; grad/pseudo_mag15_train:  20254.35166; grad/true_std15_train:  0.00213; grad/pseudo_std15_train:  4.94491; grad/diff15_train:  20246.79883; grad/cos15_train:  0.85917; grad/true_mag16_train:  10.18722; grad/pseudo_mag16_train:  20084.82988; grad/true_std16_train:  0.00249; grad/pseudo_std16_train:  4.90352; grad/diff16_train:  20076.13916; grad/cos16_train:  0.84911; grad/true_mag17_train:  12.49751; grad/pseudo_mag17_train:  21246.65215; grad/true_std17_train:  0.00305; grad/pseudo_std17_train:  5.18717; grad/diff17_train:  21236.25059; grad/cos17_train:  0.83915; grad_train:  1893.81921; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:21:36,006][trainer][INFO] - Step 30:
[2025-04-24 22:21:36,006][trainer][INFO] - loss/edit_train:  14.22931; loss/loc_train:  0.76811; edit/acc_train:  0.00000; edit/log_prob_train: -14.22931; edit/prob_train:  0.15535; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.00649; perplexity/pre_train:  54.95350; nll/post_train:  6.35699; perplexity/post_train:  576.50659; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.18537; loss/total_train:  2.19104; loss/total_edit_train:  2.19104; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42649780224.00000; grad/true_mag0_train:  5.60030; grad/pseudo_mag0_train:  18706.95303; grad/true_std0_train:  0.00137; grad/pseudo_std0_train:  4.56712; grad/diff0_train:  18703.49512; grad/cos0_train:  0.61741; grad/true_mag1_train:  8.90121; grad/pseudo_mag1_train:  18809.69824; grad/true_std1_train:  0.00217; grad/pseudo_std1_train:  4.59221; grad/diff1_train:  18803.60605; grad/cos1_train:  0.68241; grad/true_mag2_train:  9.29263; grad/pseudo_mag2_train:  18000.73174; grad/true_std2_train:  0.00227; grad/pseudo_std2_train:  4.39469; grad/diff2_train:  17993.79883; grad/cos2_train:  0.74305; grad/true_mag3_train:  5.94957; grad/pseudo_mag3_train:  17947.87246; grad/true_std3_train:  0.00145; grad/pseudo_std3_train:  4.38180; grad/diff3_train:  17944.34531; grad/cos3_train:  0.59608; grad/true_mag4_train:  10.39074; grad/pseudo_mag4_train:  17831.07520; grad/true_std4_train:  0.00254; grad/pseudo_std4_train:  4.35329; grad/diff4_train:  17824.04678; grad/cos4_train:  0.67421; grad/true_mag5_train:  11.30005; grad/pseudo_mag5_train:  17005.91670; grad/true_std5_train:  0.00276; grad/pseudo_std5_train:  4.15182; grad/diff5_train:  16997.87109; grad/cos5_train:  0.70868; grad/true_mag6_train:  6.37022; grad/pseudo_mag6_train:  17346.53789; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.23499; grad/diff6_train:  17342.31582; grad/cos6_train:  0.66385; grad/true_mag7_train:  11.48939; grad/pseudo_mag7_train:  17336.90625; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  4.23264; grad/diff7_train:  17328.47988; grad/cos7_train:  0.73081; grad/true_mag8_train:  14.21564; grad/pseudo_mag8_train:  16827.37363; grad/true_std8_train:  0.00347; grad/pseudo_std8_train:  4.10824; grad/diff8_train:  16816.85889; grad/cos8_train:  0.73671; grad/true_mag9_train:  8.08424; grad/pseudo_mag9_train:  18890.11055; grad/true_std9_train:  0.00197; grad/pseudo_std9_train:  4.61184; grad/diff9_train:  18883.82754; grad/cos9_train:  0.77524; grad/true_mag10_train:  11.61650; grad/pseudo_mag10_train:  18711.21152; grad/true_std10_train:  0.00284; grad/pseudo_std10_train:  4.56817; grad/diff10_train:  18701.82988; grad/cos10_train:  0.80453; grad/true_mag11_train:  14.99068; grad/pseudo_mag11_train:  18646.90381; grad/true_std11_train:  0.00366; grad/pseudo_std11_train:  4.55246; grad/diff11_train:  18634.85449; grad/cos11_train:  0.79931; grad/true_mag12_train:  9.22514; grad/pseudo_mag12_train:  20345.87559; grad/true_std12_train:  0.00225; grad/pseudo_std12_train:  4.96725; grad/diff12_train:  20338.12432; grad/cos12_train:  0.83668; grad/true_mag13_train:  11.57493; grad/pseudo_mag13_train:  19986.98408; grad/true_std13_train:  0.00283; grad/pseudo_std13_train:  4.87963; grad/diff13_train:  19977.20547; grad/cos13_train:  0.84349; grad/true_mag14_train:  13.98953; grad/pseudo_mag14_train:  20356.55742; grad/true_std14_train:  0.00342; grad/pseudo_std14_train:  4.96986; grad/diff14_train:  20344.73271; grad/cos14_train:  0.84090; grad/true_mag15_train:  9.46456; grad/pseudo_mag15_train:  21266.90166; grad/true_std15_train:  0.00231; grad/pseudo_std15_train:  5.19211; grad/diff15_train:  21258.56025; grad/cos15_train:  0.88009; grad/true_mag16_train:  10.92117; grad/pseudo_mag16_train:  21176.78340; grad/true_std16_train:  0.00267; grad/pseudo_std16_train:  5.17011; grad/diff16_train:  21167.27744; grad/cos16_train:  0.86707; grad/true_mag17_train:  12.38729; grad/pseudo_mag17_train:  21943.13740; grad/true_std17_train:  0.00302; grad/pseudo_std17_train:  5.35721; grad/diff17_train:  21932.21338; grad/cos17_train:  0.87639; grad_train:  6030.34570; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:21:39,278][trainer][INFO] - Step 40:
[2025-04-24 22:21:39,279][trainer][INFO] - loss/edit_train:  13.21651; loss/loc_train:  0.42647; edit/acc_train:  0.00833; edit/log_prob_train: -13.21651; edit/prob_train:  0.16098; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.42987; perplexity/pre_train:  30.87273; nll/post_train:  3.67111; perplexity/post_train:  39.29548; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.17696; loss/total_train:  1.74812; loss/total_edit_train:  1.74812; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42649780224.00000; grad/true_mag0_train:  5.07672; grad/pseudo_mag0_train:  16748.95264; grad/true_std0_train:  0.00124; grad/pseudo_std0_train:  4.08909; grad/diff0_train:  16745.80547; grad/cos0_train:  0.62588; grad/true_mag1_train:  8.23621; grad/pseudo_mag1_train:  17189.11162; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.19655; grad/diff1_train:  17183.52178; grad/cos1_train:  0.67689; grad/true_mag2_train:  8.29822; grad/pseudo_mag2_train:  16264.21455; grad/true_std2_train:  0.00203; grad/pseudo_std2_train:  3.97071; grad/diff2_train:  16258.04912; grad/cos2_train:  0.73971; grad/true_mag3_train:  5.38678; grad/pseudo_mag3_train:  16539.94395; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.03807; grad/diff3_train:  16536.67188; grad/cos3_train:  0.61169; grad/true_mag4_train:  9.55315; grad/pseudo_mag4_train:  16456.99287; grad/true_std4_train:  0.00233; grad/pseudo_std4_train:  4.01782; grad/diff4_train:  16450.49873; grad/cos4_train:  0.67686; grad/true_mag5_train:  10.12820; grad/pseudo_mag5_train:  15610.33340; grad/true_std5_train:  0.00247; grad/pseudo_std5_train:  3.81109; grad/diff5_train:  15603.08408; grad/cos5_train:  0.71266; grad/true_mag6_train:  5.63487; grad/pseudo_mag6_train:  15736.17529; grad/true_std6_train:  0.00138; grad/pseudo_std6_train:  3.84184; grad/diff6_train:  15732.41338; grad/cos6_train:  0.66877; grad/true_mag7_train:  10.25309; grad/pseudo_mag7_train:  15857.56729; grad/true_std7_train:  0.00250; grad/pseudo_std7_train:  3.87147; grad/diff7_train:  15850.07559; grad/cos7_train:  0.72878; grad/true_mag8_train:  12.67798; grad/pseudo_mag8_train:  15593.69863; grad/true_std8_train:  0.00310; grad/pseudo_std8_train:  3.80704; grad/diff8_train:  15584.29980; grad/cos8_train:  0.73900; grad/true_mag9_train:  7.12843; grad/pseudo_mag9_train:  17492.54883; grad/true_std9_train:  0.00174; grad/pseudo_std9_train:  4.27064; grad/diff9_train:  17486.93047; grad/cos9_train:  0.78556; grad/true_mag10_train:  10.52046; grad/pseudo_mag10_train:  17435.10771; grad/true_std10_train:  0.00257; grad/pseudo_std10_train:  4.25662; grad/diff10_train:  17426.57559; grad/cos10_train:  0.80878; grad/true_mag11_train:  13.30202; grad/pseudo_mag11_train:  17426.87451; grad/true_std11_train:  0.00325; grad/pseudo_std11_train:  4.25460; grad/diff11_train:  17416.10117; grad/cos11_train:  0.80771; grad/true_mag12_train:  8.20670; grad/pseudo_mag12_train:  18696.66045; grad/true_std12_train:  0.00200; grad/pseudo_std12_train:  4.56461; grad/diff12_train:  18689.71025; grad/cos12_train:  0.84179; grad/true_mag13_train:  10.33887; grad/pseudo_mag13_train:  18639.31709; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  4.55061; grad/diff13_train:  18630.47402; grad/cos13_train:  0.85054; grad/true_mag14_train:  12.60257; grad/pseudo_mag14_train:  18961.19551; grad/true_std14_train:  0.00308; grad/pseudo_std14_train:  4.62919; grad/diff14_train:  18950.54688; grad/cos14_train:  0.83731; grad/true_mag15_train:  8.40584; grad/pseudo_mag15_train:  19633.62139; grad/true_std15_train:  0.00205; grad/pseudo_std15_train:  4.79336; grad/diff15_train:  19626.17881; grad/cos15_train:  0.88200; grad/true_mag16_train:  9.80506; grad/pseudo_mag16_train:  19607.02656; grad/true_std16_train:  0.00239; grad/pseudo_std16_train:  4.78687; grad/diff16_train:  19598.44580; grad/cos16_train:  0.86919; grad/true_mag17_train:  11.36310; grad/pseudo_mag17_train:  20791.29414; grad/true_std17_train:  0.00277; grad/pseudo_std17_train:  5.07600; grad/diff17_train:  20781.23457; grad/cos17_train:  0.87803; grad_train:  1671.51074; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:21:42,935][trainer][INFO] - Step 50:
[2025-04-24 22:21:42,935][trainer][INFO] - loss/edit_train:  12.98092; loss/loc_train:  0.25060; edit/acc_train:  0.00833; edit/log_prob_train: -12.98092; edit/prob_train:  0.21935; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.52281; perplexity/pre_train:  33.87955; nll/post_train:  4.03582; perplexity/post_train:  56.58952; n_tokens/pre_train:  8.60000; n_tokens/post_train:  8.60000; time/edit_train:  0.17408; loss/total_train:  1.54870; loss/total_edit_train:  1.54870; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42662992281.60000; grad/true_mag0_train:  5.26412; grad/pseudo_mag0_train:  18322.40605; grad/true_std0_train:  0.00129; grad/pseudo_std0_train:  4.47322; grad/diff0_train:  18319.10146; grad/cos0_train:  0.62945; grad/true_mag1_train:  8.63113; grad/pseudo_mag1_train:  18350.17207; grad/true_std1_train:  0.00211; grad/pseudo_std1_train:  4.48000; grad/diff1_train:  18344.28701; grad/cos1_train:  0.67991; grad/true_mag2_train:  8.75803; grad/pseudo_mag2_train:  17541.53047; grad/true_std2_train:  0.00214; grad/pseudo_std2_train:  4.28251; grad/diff2_train:  17535.03320; grad/cos2_train:  0.73870; grad/true_mag3_train:  5.65469; grad/pseudo_mag3_train:  18051.29170; grad/true_std3_train:  0.00138; grad/pseudo_std3_train:  4.40704; grad/diff3_train:  18047.86562; grad/cos3_train:  0.60910; grad/true_mag4_train:  10.10966; grad/pseudo_mag4_train:  17678.04502; grad/true_std4_train:  0.00247; grad/pseudo_std4_train:  4.31592; grad/diff4_train:  17671.17959; grad/cos4_train:  0.67804; grad/true_mag5_train:  11.24212; grad/pseudo_mag5_train:  17034.70625; grad/true_std5_train:  0.00274; grad/pseudo_std5_train:  4.15880; grad/diff5_train:  17026.76270; grad/cos5_train:  0.70596; grad/true_mag6_train:  6.39721; grad/pseudo_mag6_train:  18639.49316; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.55064; grad/diff6_train:  18635.23594; grad/cos6_train:  0.66840; grad/true_mag7_train:  11.71765; grad/pseudo_mag7_train:  18473.06719; grad/true_std7_train:  0.00286; grad/pseudo_std7_train:  4.51002; grad/diff7_train:  18464.41748; grad/cos7_train:  0.73519; grad/true_mag8_train:  14.53303; grad/pseudo_mag8_train:  18317.82461; grad/true_std8_train:  0.00355; grad/pseudo_std8_train:  4.47208; grad/diff8_train:  18306.84229; grad/cos8_train:  0.75048; grad/true_mag9_train:  8.41930; grad/pseudo_mag9_train:  20344.44043; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.96690; grad/diff9_train:  20337.82578; grad/cos9_train:  0.78037; grad/true_mag10_train:  12.04394; grad/pseudo_mag10_train:  20224.67725; grad/true_std10_train:  0.00294; grad/pseudo_std10_train:  4.93766; grad/diff10_train:  20214.83145; grad/cos10_train:  0.81069; grad/true_mag11_train:  15.64169; grad/pseudo_mag11_train:  20240.84492; grad/true_std11_train:  0.00382; grad/pseudo_std11_train:  4.94159; grad/diff11_train:  20228.22402; grad/cos11_train:  0.79364; grad/true_mag12_train:  9.29293; grad/pseudo_mag12_train:  21136.15117; grad/true_std12_train:  0.00227; grad/pseudo_std12_train:  5.16019; grad/diff12_train:  21128.28545; grad/cos12_train:  0.84060; grad/true_mag13_train:  11.97698; grad/pseudo_mag13_train:  21262.06406; grad/true_std13_train:  0.00292; grad/pseudo_std13_train:  5.19093; grad/diff13_train:  21251.91787; grad/cos13_train:  0.84149; grad/true_mag14_train:  14.52284; grad/pseudo_mag14_train:  21501.94316; grad/true_std14_train:  0.00355; grad/pseudo_std14_train:  5.24949; grad/diff14_train:  21489.73496; grad/cos14_train:  0.82897; grad/true_mag15_train:  9.31921; grad/pseudo_mag15_train:  21714.42979; grad/true_std15_train:  0.00228; grad/pseudo_std15_train:  5.30137; grad/diff15_train:  21706.14551; grad/cos15_train:  0.88370; grad/true_mag16_train:  11.07040; grad/pseudo_mag16_train:  21807.99717; grad/true_std16_train:  0.00270; grad/pseudo_std16_train:  5.32422; grad/diff16_train:  21798.34326; grad/cos16_train:  0.86329; grad/true_mag17_train:  12.88594; grad/pseudo_mag17_train:  22816.15020; grad/true_std17_train:  0.00315; grad/pseudo_std17_train:  5.57035; grad/diff17_train:  22804.93389; grad/cos17_train:  0.85889; grad_train:  1632.00000; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00009; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:21:46,343][trainer][INFO] - Step 60:
[2025-04-24 22:21:46,343][trainer][INFO] - loss/edit_train:  10.74887; loss/loc_train:  0.39179; edit/acc_train:  0.00000; edit/log_prob_train: -10.74887; edit/prob_train:  0.17319; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.67617; perplexity/pre_train:  107.35838; nll/post_train:  5.51406; perplexity/post_train:  248.15550; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.17836; loss/total_train:  1.46667; loss/total_edit_train:  1.46667; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  43611953561.60000; grad/true_mag0_train:  5.24291; grad/pseudo_mag0_train:  18182.44443; grad/true_std0_train:  0.00128; grad/pseudo_std0_train:  4.43905; grad/diff0_train:  18179.18701; grad/cos0_train:  0.62047; grad/true_mag1_train:  8.34307; grad/pseudo_mag1_train:  18211.48203; grad/true_std1_train:  0.00204; grad/pseudo_std1_train:  4.44613; grad/diff1_train:  18205.73721; grad/cos1_train:  0.68746; grad/true_mag2_train:  8.63334; grad/pseudo_mag2_train:  17587.22354; grad/true_std2_train:  0.00211; grad/pseudo_std2_train:  4.29363; grad/diff2_train:  17580.77246; grad/cos2_train:  0.74607; grad/true_mag3_train:  5.58484; grad/pseudo_mag3_train:  18198.76191; grad/true_std3_train:  0.00136; grad/pseudo_std3_train:  4.44304; grad/diff3_train:  18195.32695; grad/cos3_train:  0.61302; grad/true_mag4_train:  9.97403; grad/pseudo_mag4_train:  17629.07490; grad/true_std4_train:  0.00244; grad/pseudo_std4_train:  4.30396; grad/diff4_train:  17622.28262; grad/cos4_train:  0.68023; grad/true_mag5_train:  10.88440; grad/pseudo_mag5_train:  16818.01738; grad/true_std5_train:  0.00266; grad/pseudo_std5_train:  4.10587; grad/diff5_train:  16810.27441; grad/cos5_train:  0.71031; grad/true_mag6_train:  6.25695; grad/pseudo_mag6_train:  17794.86270; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.34444; grad/diff6_train:  17790.64912; grad/cos6_train:  0.67297; grad/true_mag7_train:  11.31262; grad/pseudo_mag7_train:  17911.05488; grad/true_std7_train:  0.00276; grad/pseudo_std7_train:  4.37281; grad/diff7_train:  17902.65508; grad/cos7_train:  0.74166; grad/true_mag8_train:  14.21937; grad/pseudo_mag8_train:  17632.18447; grad/true_std8_train:  0.00347; grad/pseudo_std8_train:  4.30463; grad/diff8_train:  17621.51133; grad/cos8_train:  0.74957; grad/true_mag9_train:  8.30513; grad/pseudo_mag9_train:  20119.25254; grad/true_std9_train:  0.00203; grad/pseudo_std9_train:  4.91192; grad/diff9_train:  20112.67773; grad/cos9_train:  0.79152; grad/true_mag10_train:  11.93655; grad/pseudo_mag10_train:  20123.46875; grad/true_std10_train:  0.00291; grad/pseudo_std10_train:  4.91295; grad/diff10_train:  20113.64199; grad/cos10_train:  0.82274; grad/true_mag11_train:  15.44799; grad/pseudo_mag11_train:  19887.84678; grad/true_std11_train:  0.00377; grad/pseudo_std11_train:  4.85538; grad/diff11_train:  19875.29258; grad/cos11_train:  0.81195; grad/true_mag12_train:  9.49216; grad/pseudo_mag12_train:  21628.09727; grad/true_std12_train:  0.00232; grad/pseudo_std12_train:  5.28030; grad/diff12_train:  21619.88418; grad/cos12_train:  0.86416; grad/true_mag13_train:  11.99612; grad/pseudo_mag13_train:  21642.44102; grad/true_std13_train:  0.00293; grad/pseudo_std13_train:  5.28380; grad/diff13_train:  21632.01855; grad/cos13_train:  0.86803; grad/true_mag14_train:  14.75960; grad/pseudo_mag14_train:  21893.32266; grad/true_std14_train:  0.00360; grad/pseudo_std14_train:  5.34503; grad/diff14_train:  21880.65586; grad/cos14_train:  0.85724; grad/true_mag15_train:  9.93243; grad/pseudo_mag15_train:  22846.08496; grad/true_std15_train:  0.00242; grad/pseudo_std15_train:  5.57766; grad/diff15_train:  22837.15293; grad/cos15_train:  0.89898; grad/true_mag16_train:  11.46877; grad/pseudo_mag16_train:  22810.61934; grad/true_std16_train:  0.00280; grad/pseudo_std16_train:  5.56900; grad/diff16_train:  22800.42441; grad/cos16_train:  0.88853; grad/true_mag17_train:  13.13639; grad/pseudo_mag17_train:  23483.29316; grad/true_std17_train:  0.00321; grad/pseudo_std17_train:  5.73322; grad/diff17_train:  23471.64082; grad/cos17_train:  0.88637; grad_train:  2642.20068; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:21:49,662][trainer][INFO] - Step 70:
[2025-04-24 22:21:49,662][trainer][INFO] - loss/edit_train:  11.60251; loss/loc_train:  0.66413; edit/acc_train:  0.01429; edit/log_prob_train: -11.60251; edit/prob_train:  0.11797; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.53009; perplexity/pre_train:  252.16556; nll/post_train:  6.40814; perplexity/post_train:  606.76288; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.17964; loss/total_train:  1.82438; loss/total_edit_train:  1.82438; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  5.74920; grad/pseudo_mag0_train:  20169.08828; grad/true_std0_train:  0.00140; grad/pseudo_std0_train:  4.92407; grad/diff0_train:  20165.53574; grad/cos0_train:  0.62205; grad/true_mag1_train:  9.09007; grad/pseudo_mag1_train:  20107.84355; grad/true_std1_train:  0.00222; grad/pseudo_std1_train:  4.90910; grad/diff1_train:  20101.56523; grad/cos1_train:  0.69081; grad/true_mag2_train:  9.13082; grad/pseudo_mag2_train:  18858.78848; grad/true_std2_train:  0.00223; grad/pseudo_std2_train:  4.60407; grad/diff2_train:  18851.96016; grad/cos2_train:  0.74762; grad/true_mag3_train:  5.87548; grad/pseudo_mag3_train:  19162.81240; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.67840; grad/diff3_train:  19159.24189; grad/cos3_train:  0.61008; grad/true_mag4_train:  10.49889; grad/pseudo_mag4_train:  18753.96699; grad/true_std4_train:  0.00256; grad/pseudo_std4_train:  4.57859; grad/diff4_train:  18746.80820; grad/cos4_train:  0.68262; grad/true_mag5_train:  11.08893; grad/pseudo_mag5_train:  17682.73965; grad/true_std5_train:  0.00271; grad/pseudo_std5_train:  4.31699; grad/diff5_train:  17674.73613; grad/cos5_train:  0.72292; grad/true_mag6_train:  6.26429; grad/pseudo_mag6_train:  18033.85488; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.40278; grad/diff6_train:  18029.67607; grad/cos6_train:  0.66946; grad/true_mag7_train:  11.37480; grad/pseudo_mag7_train:  17871.52920; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  4.36316; grad/diff7_train:  17863.12900; grad/cos7_train:  0.73815; grad/true_mag8_train:  14.38420; grad/pseudo_mag8_train:  17571.64893; grad/true_std8_train:  0.00351; grad/pseudo_std8_train:  4.28989; grad/diff8_train:  17560.86289; grad/cos8_train:  0.74892; grad/true_mag9_train:  8.41299; grad/pseudo_mag9_train:  20454.55635; grad/true_std9_train:  0.00205; grad/pseudo_std9_train:  4.99378; grad/diff9_train:  20447.81582; grad/cos9_train:  0.79906; grad/true_mag10_train:  11.99439; grad/pseudo_mag10_train:  20185.45205; grad/true_std10_train:  0.00293; grad/pseudo_std10_train:  4.92808; grad/diff10_train:  20175.52178; grad/cos10_train:  0.82513; grad/true_mag11_train:  15.00739; grad/pseudo_mag11_train:  19884.70850; grad/true_std11_train:  0.00366; grad/pseudo_std11_train:  4.85464; grad/diff11_train:  19872.25732; grad/cos11_train:  0.82635; grad/true_mag12_train:  9.49451; grad/pseudo_mag12_train:  21508.72021; grad/true_std12_train:  0.00232; grad/pseudo_std12_train:  5.25115; grad/diff12_train:  21500.51865; grad/cos12_train:  0.86175; grad/true_mag13_train:  11.98322; grad/pseudo_mag13_train:  21315.64492; grad/true_std13_train:  0.00293; grad/pseudo_std13_train:  5.20401; grad/diff13_train:  21305.24531; grad/cos13_train:  0.86552; grad/true_mag14_train:  14.49770; grad/pseudo_mag14_train:  21736.74844; grad/true_std14_train:  0.00354; grad/pseudo_std14_train:  5.30681; grad/diff14_train:  21724.17588; grad/cos14_train:  0.86155; grad/true_mag15_train:  9.82780; grad/pseudo_mag15_train:  22415.82705; grad/true_std15_train:  0.00240; grad/pseudo_std15_train:  5.47261; grad/diff15_train:  22406.98457; grad/cos15_train:  0.89728; grad/true_mag16_train:  11.48742; grad/pseudo_mag16_train:  22222.02363; grad/true_std16_train:  0.00280; grad/pseudo_std16_train:  5.42530; grad/diff16_train:  22211.84541; grad/cos16_train:  0.88451; grad/true_mag17_train:  12.98943; grad/pseudo_mag17_train:  23106.06514; grad/true_std17_train:  0.00317; grad/pseudo_std17_train:  5.64113; grad/diff17_train:  23094.39307; grad/cos17_train:  0.89460; grad_train:  3130.29932; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:21:53,423][trainer][INFO] - Step 80:
[2025-04-24 22:21:53,424][trainer][INFO] - loss/edit_train:  10.39322; loss/loc_train:  0.41763; edit/acc_train:  0.02500; edit/log_prob_train: -10.39322; edit/prob_train:  0.21403; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.14435; perplexity/pre_train:  63.07663; nll/post_train:  4.85691; perplexity/post_train:  128.62614; n_tokens/pre_train:  6.10000; n_tokens/post_train:  6.10000; time/edit_train:  0.22581; loss/total_train:  1.45696; loss/total_edit_train:  1.45696; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  5.48801; grad/pseudo_mag0_train:  18901.72539; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  4.61461; grad/diff0_train:  18898.33984; grad/cos0_train:  0.62033; grad/true_mag1_train:  8.83691; grad/pseudo_mag1_train:  18675.28291; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.55933; grad/diff1_train:  18669.31943; grad/cos1_train:  0.67611; grad/true_mag2_train:  9.01428; grad/pseudo_mag2_train:  17879.90566; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  4.36475; grad/diff2_train:  17873.29346; grad/cos2_train:  0.73260; grad/true_mag3_train:  5.77956; grad/pseudo_mag3_train:  18360.45615; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.48249; grad/diff3_train:  18356.94756; grad/cos3_train:  0.60937; grad/true_mag4_train:  10.47823; grad/pseudo_mag4_train:  17918.41250; grad/true_std4_train:  0.00256; grad/pseudo_std4_train:  4.37458; grad/diff4_train:  17911.40127; grad/cos4_train:  0.67069; grad/true_mag5_train:  11.05942; grad/pseudo_mag5_train:  16887.87119; grad/true_std5_train:  0.00270; grad/pseudo_std5_train:  4.12271; grad/diff5_train:  16880.07842; grad/cos5_train:  0.70339; grad/true_mag6_train:  6.30126; grad/pseudo_mag6_train:  17586.33066; grad/true_std6_train:  0.00154; grad/pseudo_std6_train:  4.29352; grad/diff6_train:  17582.08672; grad/cos6_train:  0.67559; grad/true_mag7_train:  11.55754; grad/pseudo_mag7_train:  17479.19209; grad/true_std7_train:  0.00282; grad/pseudo_std7_train:  4.26736; grad/diff7_train:  17470.68965; grad/cos7_train:  0.73526; grad/true_mag8_train:  14.26567; grad/pseudo_mag8_train:  17229.53389; grad/true_std8_train:  0.00348; grad/pseudo_std8_train:  4.20622; grad/diff8_train:  17218.81494; grad/cos8_train:  0.74721; grad/true_mag9_train:  8.44662; grad/pseudo_mag9_train:  19895.53115; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.85730; grad/diff9_train:  19888.73535; grad/cos9_train:  0.79998; grad/true_mag10_train:  12.08277; grad/pseudo_mag10_train:  19735.98027; grad/true_std10_train:  0.00295; grad/pseudo_std10_train:  4.81834; grad/diff10_train:  19726.02920; grad/cos10_train:  0.81947; grad/true_mag11_train:  15.50622; grad/pseudo_mag11_train:  19900.79180; grad/true_std11_train:  0.00379; grad/pseudo_std11_train:  4.85849; grad/diff11_train:  19887.96514; grad/cos11_train:  0.81981; grad/true_mag12_train:  9.54824; grad/pseudo_mag12_train:  20891.18237; grad/true_std12_train:  0.00233; grad/pseudo_std12_train:  5.10038; grad/diff12_train:  20882.95620; grad/cos12_train:  0.85519; grad/true_mag13_train:  11.82554; grad/pseudo_mag13_train:  20592.70928; grad/true_std13_train:  0.00289; grad/pseudo_std13_train:  5.02751; grad/diff13_train:  20582.40732; grad/cos13_train:  0.86493; grad/true_mag14_train:  14.37261; grad/pseudo_mag14_train:  21035.60127; grad/true_std14_train:  0.00351; grad/pseudo_std14_train:  5.13560; grad/diff14_train:  21023.28262; grad/cos14_train:  0.84687; grad/true_mag15_train:  9.59760; grad/pseudo_mag15_train:  21363.78159; grad/true_std15_train:  0.00234; grad/pseudo_std15_train:  5.21577; grad/diff15_train:  21355.14277; grad/cos15_train:  0.89382; grad/true_mag16_train:  11.19550; grad/pseudo_mag16_train:  21349.03413; grad/true_std16_train:  0.00273; grad/pseudo_std16_train:  5.21216; grad/diff16_train:  21339.09072; grad/cos16_train:  0.88046; grad/true_mag17_train:  12.83019; grad/pseudo_mag17_train:  22480.67515; grad/true_std17_train:  0.00313; grad/pseudo_std17_train:  5.48843; grad/diff17_train:  22469.23120; grad/cos17_train:  0.87929; grad_train:  2442.79907; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:21:56,619][trainer][INFO] - Step 90:
[2025-04-24 22:21:56,619][trainer][INFO] - loss/edit_train:  9.52105; loss/loc_train:  0.14771; edit/acc_train:  0.00000; edit/log_prob_train: -9.52105; edit/prob_train:  0.21887; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.30322; perplexity/pre_train:  73.93774; nll/post_train:  4.73406; perplexity/post_train:  113.75671; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.17156; loss/total_train:  1.09981; loss/total_edit_train:  1.09981; memory/alloc_max_train:  38624673280.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  5.51904; grad/pseudo_mag0_train:  18536.77363; grad/true_std0_train:  0.00135; grad/pseudo_std0_train:  4.52547; grad/diff0_train:  18533.33984; grad/cos0_train:  0.62594; grad/true_mag1_train:  8.86202; grad/pseudo_mag1_train:  18307.55215; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.46948; grad/diff1_train:  18301.55361; grad/cos1_train:  0.67392; grad/true_mag2_train:  8.97422; grad/pseudo_mag2_train:  17299.08516; grad/true_std2_train:  0.00219; grad/pseudo_std2_train:  4.22278; grad/diff2_train:  17292.50596; grad/cos2_train:  0.72811; grad/true_mag3_train:  5.79880; grad/pseudo_mag3_train:  17944.96230; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.38101; grad/diff3_train:  17941.44150; grad/cos3_train:  0.61014; grad/true_mag4_train:  10.31844; grad/pseudo_mag4_train:  17212.31816; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.20216; grad/diff4_train:  17205.38320; grad/cos4_train:  0.67047; grad/true_mag5_train:  10.94329; grad/pseudo_mag5_train:  16268.22207; grad/true_std5_train:  0.00267; grad/pseudo_std5_train:  3.97129; grad/diff5_train:  16260.52422; grad/cos5_train:  0.69942; grad/true_mag6_train:  6.25501; grad/pseudo_mag6_train:  16879.00078; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.12081; grad/diff6_train:  16874.83740; grad/cos6_train:  0.66916; grad/true_mag7_train:  11.19793; grad/pseudo_mag7_train:  16472.88867; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  4.02167; grad/diff7_train:  16464.73369; grad/cos7_train:  0.72667; grad/true_mag8_train:  13.93944; grad/pseudo_mag8_train:  16082.35186; grad/true_std8_train:  0.00340; grad/pseudo_std8_train:  3.92605; grad/diff8_train:  16072.05430; grad/cos8_train:  0.73403; grad/true_mag9_train:  7.92502; grad/pseudo_mag9_train:  17330.69512; grad/true_std9_train:  0.00193; grad/pseudo_std9_train:  4.23111; grad/diff9_train:  17324.43740; grad/cos9_train:  0.78668; grad/true_mag10_train:  11.46195; grad/pseudo_mag10_train:  17780.71094; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  4.34097; grad/diff10_train:  17771.38447; grad/cos10_train:  0.80922; grad/true_mag11_train:  14.73349; grad/pseudo_mag11_train:  17966.42803; grad/true_std11_train:  0.00360; grad/pseudo_std11_train:  4.38620; grad/diff11_train:  17954.37520; grad/cos11_train:  0.81101; grad/true_mag12_train:  8.79260; grad/pseudo_mag12_train:  18628.37236; grad/true_std12_train:  0.00215; grad/pseudo_std12_train:  4.54794; grad/diff12_train:  18620.83584; grad/cos12_train:  0.85163; grad/true_mag13_train:  11.46164; grad/pseudo_mag13_train:  18872.63047; grad/true_std13_train:  0.00280; grad/pseudo_std13_train:  4.60757; grad/diff13_train:  18862.90771; grad/cos13_train:  0.84253; grad/true_mag14_train:  13.79511; grad/pseudo_mag14_train:  19376.96709; grad/true_std14_train:  0.00337; grad/pseudo_std14_train:  4.73064; grad/diff14_train:  19365.39814; grad/cos14_train:  0.82641; grad/true_mag15_train:  8.94687; grad/pseudo_mag15_train:  19253.76992; grad/true_std15_train:  0.00218; grad/pseudo_std15_train:  4.70062; grad/diff15_train:  19245.79131; grad/cos15_train:  0.88744; grad/true_mag16_train:  10.70239; grad/pseudo_mag16_train:  19396.89756; grad/true_std16_train:  0.00261; grad/pseudo_std16_train:  4.73557; grad/diff16_train:  19387.57158; grad/cos16_train:  0.86381; grad/true_mag17_train:  12.44297; grad/pseudo_mag17_train:  20522.62979; grad/true_std17_train:  0.00304; grad/pseudo_std17_train:  5.01039; grad/diff17_train:  20511.81670; grad/cos17_train:  0.85753; grad_train:  1310.08862; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:21:59,827][trainer][INFO] - Step 100:
[2025-04-24 22:21:59,828][trainer][INFO] - loss/edit_train:  7.93158; loss/loc_train:  0.28549; edit/acc_train:  0.00000; edit/log_prob_train: -7.93158; edit/prob_train:  0.23689; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.17212; perplexity/pre_train:  64.85285; nll/post_train:  4.83131; perplexity/post_train:  125.37517; n_tokens/pre_train:  4.40000; n_tokens/post_train:  4.40000; time/edit_train:  0.17730; loss/total_train:  1.07865; loss/total_edit_train:  1.07865; memory/alloc_max_train:  39935718656.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  5.35433; grad/pseudo_mag0_train:  18190.61094; grad/true_std0_train:  0.00131; grad/pseudo_std0_train:  4.44100; grad/diff0_train:  18187.24795; grad/cos0_train:  0.62567; grad/true_mag1_train:  8.83650; grad/pseudo_mag1_train:  18575.42627; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.53491; grad/diff1_train:  18569.41533; grad/cos1_train:  0.67870; grad/true_mag2_train:  8.93816; grad/pseudo_mag2_train:  17759.70254; grad/true_std2_train:  0.00218; grad/pseudo_std2_train:  4.33510; grad/diff2_train:  17753.12002; grad/cos2_train:  0.73440; grad/true_mag3_train:  5.81253; grad/pseudo_mag3_train:  18339.20967; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.47730; grad/diff3_train:  18335.65029; grad/cos3_train:  0.61144; grad/true_mag4_train:  10.53578; grad/pseudo_mag4_train:  17773.53672; grad/true_std4_train:  0.00257; grad/pseudo_std4_train:  4.33920; grad/diff4_train:  17766.48408; grad/cos4_train:  0.67008; grad/true_mag5_train:  11.08876; grad/pseudo_mag5_train:  17002.87070; grad/true_std5_train:  0.00271; grad/pseudo_std5_train:  4.15059; grad/diff5_train:  16995.01729; grad/cos5_train:  0.70781; grad/true_mag6_train:  6.40660; grad/pseudo_mag6_train:  18272.11807; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.46095; grad/diff6_train:  18267.80156; grad/cos6_train:  0.67416; grad/true_mag7_train:  11.24566; grad/pseudo_mag7_train:  17449.55049; grad/true_std7_train:  0.00275; grad/pseudo_std7_train:  4.26013; grad/diff7_train:  17441.23564; grad/cos7_train:  0.73893; grad/true_mag8_train:  13.80964; grad/pseudo_mag8_train:  17241.88037; grad/true_std8_train:  0.00337; grad/pseudo_std8_train:  4.20914; grad/diff8_train:  17231.44160; grad/cos8_train:  0.75494; grad/true_mag9_train:  8.19564; grad/pseudo_mag9_train:  19532.74854; grad/true_std9_train:  0.00200; grad/pseudo_std9_train:  4.76873; grad/diff9_train:  19526.15195; grad/cos9_train:  0.80198; grad/true_mag10_train:  11.72115; grad/pseudo_mag10_train:  19144.52051; grad/true_std10_train:  0.00286; grad/pseudo_std10_train:  4.67394; grad/diff10_train:  19134.87783; grad/cos10_train:  0.82048; grad/true_mag11_train:  15.30408; grad/pseudo_mag11_train:  19329.53750; grad/true_std11_train:  0.00374; grad/pseudo_std11_train:  4.71898; grad/diff11_train:  19317.02168; grad/cos11_train:  0.81637; grad/true_mag12_train:  9.28177; grad/pseudo_mag12_train:  20771.74434; grad/true_std12_train:  0.00227; grad/pseudo_std12_train:  5.07122; grad/diff12_train:  20763.67432; grad/cos12_train:  0.86642; grad/true_mag13_train:  11.51739; grad/pseudo_mag13_train:  20266.75732; grad/true_std13_train:  0.00281; grad/pseudo_std13_train:  4.94793; grad/diff13_train:  20256.73828; grad/cos13_train:  0.86724; grad/true_mag14_train:  13.83086; grad/pseudo_mag14_train:  20699.34297; grad/true_std14_train:  0.00338; grad/pseudo_std14_train:  5.05348; grad/diff14_train:  20687.32520; grad/cos14_train:  0.86409; grad/true_mag15_train:  9.21072; grad/pseudo_mag15_train:  20878.70020; grad/true_std15_train:  0.00225; grad/pseudo_std15_train:  5.09734; grad/diff15_train:  20870.38086; grad/cos15_train:  0.90148; grad/true_mag16_train:  10.72946; grad/pseudo_mag16_train:  20804.16104; grad/true_std16_train:  0.00262; grad/pseudo_std16_train:  5.07914; grad/diff16_train:  20794.59033; grad/cos16_train:  0.88912; grad/true_mag17_train:  12.40243; grad/pseudo_mag17_train:  21576.21875; grad/true_std17_train:  0.00303; grad/pseudo_std17_train:  5.26762; grad/diff17_train:  21565.14268; grad/cos17_train:  0.88902; grad_train:  1750.63098; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:22:18,261][trainer][INFO] - Step 100:
[2025-04-24 22:22:18,261][trainer][INFO] - loss/edit_val:  10.63436; loss/loc_val:  0.31055; edit/acc_val:  0.01152; edit/log_prob_val: -10.63436; edit/prob_val:  0.19195; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  5.02491; perplexity/post_val:  152.15697; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11019; loss/total_val:  1.37399; loss/total_edit_val:  1.37399; memory/alloc_max_val:  41027863040.00000; memory/res_max_val:  43717230592.00000; eval_time/elapsed:  18.42846; eval_time/average:  0.18428
[2025-04-24 22:22:18,265][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:22:18,266][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:23:12,162][trainer][INFO] - Write complete.
[2025-04-24 22:23:15,469][trainer][INFO] - Step 110:
[2025-04-24 22:23:15,469][trainer][INFO] - loss/edit_train:  12.13473; loss/loc_train:  0.14538; edit/acc_train:  0.02500; edit/log_prob_train: -12.13473; edit/prob_train:  0.18563; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.55557; perplexity/pre_train:  258.67560; nll/post_train:  5.97319; perplexity/post_train:  392.75662; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.19189; loss/total_train:  1.35886; loss/total_edit_train:  1.35886; memory/alloc_max_train:  41027863040.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  4.94995; grad/pseudo_mag0_train:  18290.06270; grad/true_std0_train:  0.00121; grad/pseudo_std0_train:  4.46525; grad/diff0_train:  18286.92998; grad/cos0_train:  0.62987; grad/true_mag1_train:  8.08579; grad/pseudo_mag1_train:  17863.02637; grad/true_std1_train:  0.00197; grad/pseudo_std1_train:  4.36096; grad/diff1_train:  17857.61094; grad/cos1_train:  0.66652; grad/true_mag2_train:  8.25559; grad/pseudo_mag2_train:  17094.83311; grad/true_std2_train:  0.00202; grad/pseudo_std2_train:  4.17247; grad/diff2_train:  17088.90469; grad/cos2_train:  0.71371; grad/true_mag3_train:  5.16649; grad/pseudo_mag3_train:  17522.37148; grad/true_std3_train:  0.00126; grad/pseudo_std3_train:  4.27786; grad/diff3_train:  17519.17393; grad/cos3_train:  0.61757; grad/true_mag4_train:  9.28336; grad/pseudo_mag4_train:  16789.44277; grad/true_std4_train:  0.00227; grad/pseudo_std4_train:  4.09893; grad/diff4_train:  16783.24355; grad/cos4_train:  0.66617; grad/true_mag5_train:  9.73155; grad/pseudo_mag5_train:  15592.45576; grad/true_std5_train:  0.00238; grad/pseudo_std5_train:  3.80603; grad/diff5_train:  15585.73916; grad/cos5_train:  0.68870; grad/true_mag6_train:  5.42225; grad/pseudo_mag6_train:  16024.94199; grad/true_std6_train:  0.00132; grad/pseudo_std6_train:  3.91231; grad/diff6_train:  16021.28779; grad/cos6_train:  0.67377; grad/true_mag7_train:  9.82161; grad/pseudo_mag7_train:  15728.88594; grad/true_std7_train:  0.00240; grad/pseudo_std7_train:  3.84004; grad/diff7_train:  15721.71621; grad/cos7_train:  0.72827; grad/true_mag8_train:  12.16555; grad/pseudo_mag8_train:  15079.66035; grad/true_std8_train:  0.00297; grad/pseudo_std8_train:  3.68107; grad/diff8_train:  15070.78984; grad/cos8_train:  0.72427; grad/true_mag9_train:  6.86231; grad/pseudo_mag9_train:  16281.98633; grad/true_std9_train:  0.00168; grad/pseudo_std9_train:  3.97508; grad/diff9_train:  16276.55264; grad/cos9_train:  0.78894; grad/true_mag10_train:  10.14312; grad/pseudo_mag10_train:  16845.66094; grad/true_std10_train:  0.00248; grad/pseudo_std10_train:  4.11268; grad/diff10_train:  16837.42764; grad/cos10_train:  0.80823; grad/true_mag11_train:  12.64728; grad/pseudo_mag11_train:  16433.10811; grad/true_std11_train:  0.00309; grad/pseudo_std11_train:  4.01174; grad/diff11_train:  16422.93320; grad/cos11_train:  0.79950; grad/true_mag12_train:  7.56835; grad/pseudo_mag12_train:  16907.51689; grad/true_std12_train:  0.00185; grad/pseudo_std12_train:  4.12780; grad/diff12_train:  16901.02080; grad/cos12_train:  0.85426; grad/true_mag13_train:  9.91042; grad/pseudo_mag13_train:  17103.77744; grad/true_std13_train:  0.00242; grad/pseudo_std13_train:  4.17572; grad/diff13_train:  17095.35869; grad/cos13_train:  0.84678; grad/true_mag14_train:  12.27957; grad/pseudo_mag14_train:  17365.84141; grad/true_std14_train:  0.00300; grad/pseudo_std14_train:  4.23961; grad/diff14_train:  17355.75283; grad/cos14_train:  0.81581; grad/true_mag15_train:  7.66842; grad/pseudo_mag15_train:  17473.10703; grad/true_std15_train:  0.00187; grad/pseudo_std15_train:  4.26589; grad/diff15_train:  17466.25449; grad/cos15_train:  0.89021; grad/true_mag16_train:  9.07072; grad/pseudo_mag16_train:  17507.87900; grad/true_std16_train:  0.00221; grad/pseudo_std16_train:  4.27438; grad/diff16_train:  17499.91963; grad/cos16_train:  0.87376; grad/true_mag17_train:  10.51039; grad/pseudo_mag17_train:  18273.74521; grad/true_std17_train:  0.00257; grad/pseudo_std17_train:  4.46133; grad/diff17_train:  18264.62148; grad/cos17_train:  0.86192; grad_train:  1407.34387; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:23:18,676][trainer][INFO] - Step 120:
[2025-04-24 22:23:18,676][trainer][INFO] - loss/edit_train:  10.53616; loss/loc_train:  0.17831; edit/acc_train:  0.01250; edit/log_prob_train: -10.53616; edit/prob_train:  0.25077; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.45123; perplexity/pre_train:  85.73236; nll/post_train:  5.30907; perplexity/post_train:  202.16299; n_tokens/pre_train:  6.80000; n_tokens/post_train:  6.80000; time/edit_train:  0.17962; loss/total_train:  1.23193; loss/total_edit_train:  1.23193; memory/alloc_max_train:  41027863040.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  4.97513; grad/pseudo_mag0_train:  16861.44609; grad/true_std0_train:  0.00121; grad/pseudo_std0_train:  4.11646; grad/diff0_train:  16858.35537; grad/cos0_train:  0.62474; grad/true_mag1_train:  8.24739; grad/pseudo_mag1_train:  17168.41748; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.19135; grad/diff1_train:  17162.92217; grad/cos1_train:  0.66614; grad/true_mag2_train:  8.47848; grad/pseudo_mag2_train:  16576.61230; grad/true_std2_train:  0.00207; grad/pseudo_std2_train:  4.04580; grad/diff2_train:  16570.55693; grad/cos2_train:  0.71240; grad/true_mag3_train:  5.27936; grad/pseudo_mag3_train:  16591.05488; grad/true_std3_train:  0.00129; grad/pseudo_std3_train:  4.05048; grad/diff3_train:  16587.82568; grad/cos3_train:  0.61434; grad/true_mag4_train:  9.60014; grad/pseudo_mag4_train:  16384.55801; grad/true_std4_train:  0.00234; grad/pseudo_std4_train:  4.00006; grad/diff4_train:  16378.18018; grad/cos4_train:  0.66592; grad/true_mag5_train:  10.27196; grad/pseudo_mag5_train:  15674.96533; grad/true_std5_train:  0.00251; grad/pseudo_std5_train:  3.82601; grad/diff5_train:  15667.92314; grad/cos5_train:  0.68517; grad/true_mag6_train:  5.74811; grad/pseudo_mag6_train:  16053.76133; grad/true_std6_train:  0.00140; grad/pseudo_std6_train:  3.91934; grad/diff6_train:  16049.88428; grad/cos6_train:  0.67574; grad/true_mag7_train:  10.33508; grad/pseudo_mag7_train:  15866.14062; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  3.87355; grad/diff7_train:  15858.58213; grad/cos7_train:  0.73060; grad/true_mag8_train:  12.88497; grad/pseudo_mag8_train:  15655.56367; grad/true_std8_train:  0.00315; grad/pseudo_std8_train:  3.82161; grad/diff8_train:  15646.08818; grad/cos8_train:  0.73123; grad/true_mag9_train:  7.35684; grad/pseudo_mag9_train:  17737.93828; grad/true_std9_train:  0.00180; grad/pseudo_std9_train:  4.33052; grad/diff9_train:  17732.04785; grad/cos9_train:  0.79557; grad/true_mag10_train:  10.49791; grad/pseudo_mag10_train:  17409.98213; grad/true_std10_train:  0.00256; grad/pseudo_std10_train:  4.25045; grad/diff10_train:  17401.39756; grad/cos10_train:  0.81198; grad/true_mag11_train:  13.27990; grad/pseudo_mag11_train:  17276.99834; grad/true_std11_train:  0.00324; grad/pseudo_std11_train:  4.21776; grad/diff11_train:  17266.19824; grad/cos11_train:  0.80616; grad/true_mag12_train:  8.16061; grad/pseudo_mag12_train:  18242.18379; grad/true_std12_train:  0.00199; grad/pseudo_std12_train:  4.45365; grad/diff12_train:  18235.20146; grad/cos12_train:  0.84808; grad/true_mag13_train:  10.31805; grad/pseudo_mag13_train:  18232.08252; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  4.45119; grad/diff13_train:  18223.17461; grad/cos13_train:  0.85512; grad/true_mag14_train:  12.27906; grad/pseudo_mag14_train:  18331.63975; grad/true_std14_train:  0.00300; grad/pseudo_std14_train:  4.47539; grad/diff14_train:  18321.27109; grad/cos14_train:  0.83194; grad/true_mag15_train:  7.98304; grad/pseudo_mag15_train:  18330.50986; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  4.47522; grad/diff15_train:  18323.39302; grad/cos15_train:  0.88399; grad/true_mag16_train:  9.56452; grad/pseudo_mag16_train:  18343.52935; grad/true_std16_train:  0.00234; grad/pseudo_std16_train:  4.47840; grad/diff16_train:  18335.18345; grad/cos16_train:  0.86196; grad/true_mag17_train:  10.89804; grad/pseudo_mag17_train:  19168.43857; grad/true_std17_train:  0.00266; grad/pseudo_std17_train:  4.67977; grad/diff17_train:  19158.89814; grad/cos17_train:  0.86248; grad_train:  1197.25391; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:23:22,402][trainer][INFO] - Step 130:
[2025-04-24 22:23:22,402][trainer][INFO] - loss/edit_train:  9.05660; loss/loc_train:  0.22665; edit/acc_train:  0.00667; edit/log_prob_train: -9.05660; edit/prob_train:  0.23366; acc/pre_train:  0.00000; acc/post_train:  0.10000; nll/pre_train:  4.42674; perplexity/pre_train:  83.65853; nll/post_train:  4.85805; perplexity/post_train:  128.77275; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.18053; loss/total_train:  1.13231; loss/total_edit_train:  1.13231; memory/alloc_max_train:  41027863040.00000; memory/res_max_train:  43717230592.00000; grad/true_mag0_train:  5.38878; grad/pseudo_mag0_train:  18733.88818; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  4.57346; grad/diff0_train:  18730.53926; grad/cos0_train:  0.62162; grad/true_mag1_train:  9.11121; grad/pseudo_mag1_train:  18876.90303; grad/true_std1_train:  0.00222; grad/pseudo_std1_train:  4.60828; grad/diff1_train:  18870.87354; grad/cos1_train:  0.66174; grad/true_mag2_train:  9.21605; grad/pseudo_mag2_train:  18157.76670; grad/true_std2_train:  0.00225; grad/pseudo_std2_train:  4.43120; grad/diff2_train:  18151.22754; grad/cos2_train:  0.70853; grad/true_mag3_train:  5.79921; grad/pseudo_mag3_train:  18001.19980; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.39466; grad/diff3_train:  17997.72031; grad/cos3_train:  0.60104; grad/true_mag4_train:  10.57066; grad/pseudo_mag4_train:  17834.10479; grad/true_std4_train:  0.00258; grad/pseudo_std4_train:  4.35390; grad/diff4_train:  17827.04023; grad/cos4_train:  0.66871; grad/true_mag5_train:  11.39803; grad/pseudo_mag5_train:  17295.46895; grad/true_std5_train:  0.00278; grad/pseudo_std5_train:  4.22117; grad/diff5_train:  17287.66680; grad/cos5_train:  0.68441; grad/true_mag6_train:  6.19709; grad/pseudo_mag6_train:  17803.66865; grad/true_std6_train:  0.00151; grad/pseudo_std6_train:  4.34654; grad/diff6_train:  17799.50879; grad/cos6_train:  0.67232; grad/true_mag7_train:  11.31091; grad/pseudo_mag7_train:  17363.64727; grad/true_std7_train:  0.00276; grad/pseudo_std7_train:  4.23912; grad/diff7_train:  17355.44326; grad/cos7_train:  0.72542; grad/true_mag8_train:  14.30615; grad/pseudo_mag8_train:  17450.34639; grad/true_std8_train:  0.00349; grad/pseudo_std8_train:  4.25960; grad/diff8_train:  17439.93213; grad/cos8_train:  0.72624; grad/true_mag9_train:  8.23570; grad/pseudo_mag9_train:  19935.59141; grad/true_std9_train:  0.00201; grad/pseudo_std9_train:  4.86707; grad/diff9_train:  19929.01104; grad/cos9_train:  0.79439; grad/true_mag10_train:  12.01429; grad/pseudo_mag10_train:  19696.72061; grad/true_std10_train:  0.00293; grad/pseudo_std10_train:  4.80873; grad/diff10_train:  19686.91982; grad/cos10_train:  0.81068; grad/true_mag11_train:  15.26498; grad/pseudo_mag11_train:  19627.05020; grad/true_std11_train:  0.00373; grad/pseudo_std11_train:  4.79137; grad/diff11_train:  19614.68604; grad/cos11_train:  0.80293; grad/true_mag12_train:  9.28440; grad/pseudo_mag12_train:  20984.12031; grad/true_std12_train:  0.00227; grad/pseudo_std12_train:  5.12307; grad/diff12_train:  20976.15937; grad/cos12_train:  0.85305; grad/true_mag13_train:  11.47576; grad/pseudo_mag13_train:  20567.15908; grad/true_std13_train:  0.00280; grad/pseudo_std13_train:  5.02126; grad/diff13_train:  20557.20352; grad/cos13_train:  0.86135; grad/true_mag14_train:  13.72911; grad/pseudo_mag14_train:  21059.56670; grad/true_std14_train:  0.00335; grad/pseudo_std14_train:  5.14132; grad/diff14_train:  21047.78701; grad/cos14_train:  0.84783; grad/true_mag15_train:  9.12328; grad/pseudo_mag15_train:  21215.55498; grad/true_std15_train:  0.00223; grad/pseudo_std15_train:  5.17957; grad/diff15_train:  21207.36689; grad/cos15_train:  0.89373; grad/true_mag16_train:  10.63721; grad/pseudo_mag16_train:  20862.27744; grad/true_std16_train:  0.00260; grad/pseudo_std16_train:  5.09332; grad/diff16_train:  20852.89912; grad/cos16_train:  0.87566; grad/true_mag17_train:  12.35319; grad/pseudo_mag17_train:  21967.34902; grad/true_std17_train:  0.00302; grad/pseudo_std17_train:  5.36307; grad/diff17_train:  21956.50986; grad/cos17_train:  0.86761; grad_train:  2198.72705; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:23:25,739][trainer][INFO] - Step 140:
[2025-04-24 22:23:25,739][trainer][INFO] - loss/edit_train:  7.21951; loss/loc_train:  0.10943; edit/acc_train:  0.08333; edit/log_prob_train: -7.21951; edit/prob_train:  0.29441; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.45981; perplexity/pre_train:  31.81095; nll/post_train:  3.59253; perplexity/post_train:  36.32595; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.18856; loss/total_train:  0.83138; loss/total_edit_train:  0.83138; memory/alloc_max_train:  41027863040.00000; memory/res_max_train:  43727926067.20000; grad/true_mag0_train:  4.79661; grad/pseudo_mag0_train:  17846.16660; grad/true_std0_train:  0.00117; grad/pseudo_std0_train:  4.35685; grad/diff0_train:  17843.15127; grad/cos0_train:  0.62902; grad/true_mag1_train:  7.97738; grad/pseudo_mag1_train:  17664.79912; grad/true_std1_train:  0.00195; grad/pseudo_std1_train:  4.31250; grad/diff1_train:  17659.44873; grad/cos1_train:  0.67083; grad/true_mag2_train:  8.16907; grad/pseudo_mag2_train:  17056.53760; grad/true_std2_train:  0.00199; grad/pseudo_std2_train:  4.16212; grad/diff2_train:  17050.72402; grad/cos2_train:  0.70870; grad/true_mag3_train:  5.24515; grad/pseudo_mag3_train:  17214.62148; grad/true_std3_train:  0.00128; grad/pseudo_std3_train:  4.20271; grad/diff3_train:  17211.45264; grad/cos3_train:  0.60525; grad/true_mag4_train:  9.37919; grad/pseudo_mag4_train:  16904.70957; grad/true_std4_train:  0.00229; grad/pseudo_std4_train:  4.12706; grad/diff4_train:  16898.37617; grad/cos4_train:  0.67351; grad/true_mag5_train:  10.29220; grad/pseudo_mag5_train:  16507.56221; grad/true_std5_train:  0.00251; grad/pseudo_std5_train:  4.02890; grad/diff5_train:  16500.49424; grad/cos5_train:  0.68485; grad/true_mag6_train:  5.97550; grad/pseudo_mag6_train:  17502.06914; grad/true_std6_train:  0.00146; grad/pseudo_std6_train:  4.27293; grad/diff6_train:  17498.08584; grad/cos6_train:  0.66711; grad/true_mag7_train:  10.74988; grad/pseudo_mag7_train:  17229.19336; grad/true_std7_train:  0.00262; grad/pseudo_std7_train:  4.20631; grad/diff7_train:  17221.26963; grad/cos7_train:  0.73511; grad/true_mag8_train:  13.18771; grad/pseudo_mag8_train:  17069.48027; grad/true_std8_train:  0.00322; grad/pseudo_std8_train:  4.16663; grad/diff8_train:  17059.59023; grad/cos8_train:  0.74546; grad/true_mag9_train:  7.71933; grad/pseudo_mag9_train:  19194.71494; grad/true_std9_train:  0.00188; grad/pseudo_std9_train:  4.68619; grad/diff9_train:  19188.50342; grad/cos9_train:  0.80249; grad/true_mag10_train:  11.28410; grad/pseudo_mag10_train:  19211.18652; grad/true_std10_train:  0.00275; grad/pseudo_std10_train:  4.69020; grad/diff10_train:  19201.87812; grad/cos10_train:  0.82207; grad/true_mag11_train:  14.86397; grad/pseudo_mag11_train:  19184.39814; grad/true_std11_train:  0.00363; grad/pseudo_std11_train:  4.68335; grad/diff11_train:  19172.39375; grad/cos11_train:  0.80663; grad/true_mag12_train:  9.21601; grad/pseudo_mag12_train:  21536.54268; grad/true_std12_train:  0.00225; grad/pseudo_std12_train:  5.25794; grad/diff12_train:  21528.51787; grad/cos12_train:  0.86695; grad/true_mag13_train:  11.42750; grad/pseudo_mag13_train:  21140.07305; grad/true_std13_train:  0.00279; grad/pseudo_std13_train:  5.16114; grad/diff13_train:  21130.06338; grad/cos13_train:  0.87142; grad/true_mag14_train:  13.72247; grad/pseudo_mag14_train:  21547.67441; grad/true_std14_train:  0.00335; grad/pseudo_std14_train:  5.26052; grad/diff14_train:  21535.74268; grad/cos14_train:  0.86305; grad/true_mag15_train:  9.41083; grad/pseudo_mag15_train:  22146.01660; grad/true_std15_train:  0.00230; grad/pseudo_std15_train:  5.40674; grad/diff15_train:  22137.51533; grad/cos15_train:  0.89981; grad/true_mag16_train:  10.95621; grad/pseudo_mag16_train:  22120.20645; grad/true_std16_train:  0.00267; grad/pseudo_std16_train:  5.40044; grad/diff16_train:  22110.39482; grad/cos16_train:  0.89072; grad/true_mag17_train:  12.39504; grad/pseudo_mag17_train:  22679.02334; grad/true_std17_train:  0.00303; grad/pseudo_std17_train:  5.53685; grad/diff17_train:  22667.91377; grad/cos17_train:  0.88879; grad_train:  858.02405; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:23:28,892][trainer][INFO] - Step 150:
[2025-04-24 22:23:28,892][trainer][INFO] - loss/edit_train:  7.77297; loss/loc_train:  0.15468; edit/acc_train:  0.00000; edit/log_prob_train: -7.77297; edit/prob_train:  0.26606; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.70109; perplexity/pre_train:  110.06695; nll/post_train:  5.06444; perplexity/post_train:  158.29239; n_tokens/pre_train:  7.60000; n_tokens/post_train:  7.60000; time/edit_train:  0.17460; loss/total_train:  0.93198; loss/total_edit_train:  0.93198; memory/alloc_max_train:  41079065753.60000; memory/res_max_train:  44700375449.60000; grad/true_mag0_train:  5.17541; grad/pseudo_mag0_train:  17293.13613; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.22180; grad/diff0_train:  17290.03838; grad/cos0_train:  0.59868; grad/true_mag1_train:  8.27728; grad/pseudo_mag1_train:  17578.76064; grad/true_std1_train:  0.00202; grad/pseudo_std1_train:  4.29137; grad/diff1_train:  17573.32861; grad/cos1_train:  0.65634; grad/true_mag2_train:  8.51794; grad/pseudo_mag2_train:  17247.08506; grad/true_std2_train:  0.00208; grad/pseudo_std2_train:  4.20902; grad/diff2_train:  17241.06221; grad/cos2_train:  0.70433; grad/true_mag3_train:  5.63185; grad/pseudo_mag3_train:  16900.18828; grad/true_std3_train:  0.00137; grad/pseudo_std3_train:  4.12588; grad/diff3_train:  16896.90928; grad/cos3_train:  0.58327; grad/true_mag4_train:  9.86884; grad/pseudo_mag4_train:  16947.95781; grad/true_std4_train:  0.00241; grad/pseudo_std4_train:  4.13753; grad/diff4_train:  16941.45977; grad/cos4_train:  0.65981; grad/true_mag5_train:  10.87173; grad/pseudo_mag5_train:  16618.88896; grad/true_std5_train:  0.00265; grad/pseudo_std5_train:  4.05623; grad/diff5_train:  16611.49434; grad/cos5_train:  0.68102; grad/true_mag6_train:  6.02422; grad/pseudo_mag6_train:  17088.35645; grad/true_std6_train:  0.00147; grad/pseudo_std6_train:  4.17190; grad/diff6_train:  17084.29854; grad/cos6_train:  0.67424; grad/true_mag7_train:  11.16863; grad/pseudo_mag7_train:  17419.24590; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  4.25268; grad/diff7_train:  17411.02666; grad/cos7_train:  0.73528; grad/true_mag8_train:  14.77704; grad/pseudo_mag8_train:  17833.52998; grad/true_std8_train:  0.00361; grad/pseudo_std8_train:  4.35318; grad/diff8_train:  17822.47822; grad/cos8_train:  0.74679; grad/true_mag9_train:  8.38605; grad/pseudo_mag9_train:  20718.81016; grad/true_std9_train:  0.00205; grad/pseudo_std9_train:  5.05828; grad/diff9_train:  20712.00049; grad/cos9_train:  0.81185; grad/true_mag10_train:  11.96930; grad/pseudo_mag10_train:  20448.80488; grad/true_std10_train:  0.00292; grad/pseudo_std10_train:  4.99235; grad/diff10_train:  20438.84424; grad/cos10_train:  0.83100; grad/true_mag11_train:  15.55211; grad/pseudo_mag11_train:  20709.25820; grad/true_std11_train:  0.00380; grad/pseudo_std11_train:  5.05564; grad/diff11_train:  20696.30625; grad/cos11_train:  0.83210; grad/true_mag12_train:  9.64030; grad/pseudo_mag12_train:  22133.21367; grad/true_std12_train:  0.00235; grad/pseudo_std12_train:  5.40361; grad/diff12_train:  22124.78965; grad/cos12_train:  0.87322; grad/true_mag13_train:  11.81297; grad/pseudo_mag13_train:  21666.42549; grad/true_std13_train:  0.00288; grad/pseudo_std13_train:  5.28964; grad/diff13_train:  21656.02832; grad/cos13_train:  0.87828; grad/true_mag14_train:  14.50460; grad/pseudo_mag14_train:  22344.67051; grad/true_std14_train:  0.00354; grad/pseudo_std14_train:  5.45511; grad/diff14_train:  22332.05820; grad/cos14_train:  0.86658; grad/true_mag15_train:  9.87161; grad/pseudo_mag15_train:  22943.17197; grad/true_std15_train:  0.00241; grad/pseudo_std15_train:  5.60135; grad/diff15_train:  22934.22900; grad/cos15_train:  0.90465; grad/true_mag16_train:  11.37455; grad/pseudo_mag16_train:  22838.91709; grad/true_std16_train:  0.00278; grad/pseudo_std16_train:  5.57590; grad/diff16_train:  22828.70781; grad/cos16_train:  0.89603; grad/true_mag17_train:  13.09100; grad/pseudo_mag17_train:  23716.78232; grad/true_std17_train:  0.00320; grad/pseudo_std17_train:  5.79020; grad/diff17_train:  23705.05654; grad/cos17_train:  0.89295; grad_train:  1160.59619; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00008; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00008; lr/lr17_train:  0.00009
[2025-04-24 22:23:32,729][trainer][INFO] - Step 160:
[2025-04-24 22:23:32,729][trainer][INFO] - loss/edit_train:  10.27676; loss/loc_train:  0.24795; edit/acc_train:  0.00000; edit/log_prob_train: -10.27676; edit/prob_train:  0.17276; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79478; perplexity/pre_train:  44.46848; nll/post_train:  4.20179; perplexity/post_train:  66.80556; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.24063; loss/total_train:  1.27563; loss/total_edit_train:  1.27563; memory/alloc_max_train:  42160592742.40000; memory/res_max_train:  47857847500.80000; grad/true_mag0_train:  4.87258; grad/pseudo_mag0_train:  18797.59004; grad/true_std0_train:  0.00119; grad/pseudo_std0_train:  4.58903; grad/diff0_train:  18794.51260; grad/cos0_train:  0.63358; grad/true_mag1_train:  7.89127; grad/pseudo_mag1_train:  18336.66572; grad/true_std1_train:  0.00193; grad/pseudo_std1_train:  4.47636; grad/diff1_train:  18331.35684; grad/cos1_train:  0.67259; grad/true_mag2_train:  8.07907; grad/pseudo_mag2_train:  17720.12139; grad/true_std2_train:  0.00197; grad/pseudo_std2_train:  4.32327; grad/diff2_train:  17714.41377; grad/cos2_train:  0.70469; grad/true_mag3_train:  5.17985; grad/pseudo_mag3_train:  18197.90586; grad/true_std3_train:  0.00126; grad/pseudo_std3_train:  4.44271; grad/diff3_train:  18194.71602; grad/cos3_train:  0.61713; grad/true_mag4_train:  9.10729; grad/pseudo_mag4_train:  17338.02813; grad/true_std4_train:  0.00222; grad/pseudo_std4_train:  4.23279; grad/diff4_train:  17331.91436; grad/cos4_train:  0.67090; grad/true_mag5_train:  9.76574; grad/pseudo_mag5_train:  16651.89961; grad/true_std5_train:  0.00238; grad/pseudo_std5_train:  4.06339; grad/diff5_train:  16645.23662; grad/cos5_train:  0.68042; grad/true_mag6_train:  5.48108; grad/pseudo_mag6_train:  17183.26807; grad/true_std6_train:  0.00134; grad/pseudo_std6_train:  4.19507; grad/diff6_train:  17179.53535; grad/cos6_train:  0.68246; grad/true_mag7_train:  9.91279; grad/pseudo_mag7_train:  16388.20703; grad/true_std7_train:  0.00242; grad/pseudo_std7_train:  4.00096; grad/diff7_train:  16380.92861; grad/cos7_train:  0.73343; grad/true_mag8_train:  12.19624; grad/pseudo_mag8_train:  16079.68242; grad/true_std8_train:  0.00298; grad/pseudo_std8_train:  3.92453; grad/diff8_train:  16070.88379; grad/cos8_train:  0.71551; grad/true_mag9_train:  6.93351; grad/pseudo_mag9_train:  16897.94111; grad/true_std9_train:  0.00169; grad/pseudo_std9_train:  4.12545; grad/diff9_train:  16892.41807; grad/cos9_train:  0.79417; grad/true_mag10_train:  10.36406; grad/pseudo_mag10_train:  17341.34629; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  4.23368; grad/diff10_train:  17332.89531; grad/cos10_train:  0.81168; grad/true_mag11_train:  13.20235; grad/pseudo_mag11_train:  17182.66367; grad/true_std11_train:  0.00322; grad/pseudo_std11_train:  4.19434; grad/diff11_train:  17172.16494; grad/cos11_train:  0.78572; grad/true_mag12_train:  7.82369; grad/pseudo_mag12_train:  17654.47178; grad/true_std12_train:  0.00191; grad/pseudo_std12_train:  4.31017; grad/diff12_train:  17647.72920; grad/cos12_train:  0.85704; grad/true_mag13_train:  10.01983; grad/pseudo_mag13_train:  17960.97520; grad/true_std13_train:  0.00245; grad/pseudo_std13_train:  4.38498; grad/diff13_train:  17952.29375; grad/cos13_train:  0.86196; grad/true_mag14_train:  12.39931; grad/pseudo_mag14_train:  18266.60137; grad/true_std14_train:  0.00303; grad/pseudo_std14_train:  4.45929; grad/diff14_train:  18256.25693; grad/cos14_train:  0.82470; grad/true_mag15_train:  8.15880; grad/pseudo_mag15_train:  18813.08604; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  4.59303; grad/diff15_train:  18805.78174; grad/cos15_train:  0.89112; grad/true_mag16_train:  9.53322; grad/pseudo_mag16_train:  18645.26602; grad/true_std16_train:  0.00233; grad/pseudo_std16_train:  4.55206; grad/diff16_train:  18636.86172; grad/cos16_train:  0.87600; grad/true_mag17_train:  10.97910; grad/pseudo_mag17_train:  19433.33975; grad/true_std17_train:  0.00268; grad/pseudo_std17_train:  4.74439; grad/diff17_train:  19423.77373; grad/cos17_train:  0.86319; grad_train:  1630.39368; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:23:35,914][trainer][INFO] - Step 170:
[2025-04-24 22:23:35,915][trainer][INFO] - loss/edit_train:  10.19867; loss/loc_train:  0.58460; edit/acc_train:  0.01000; edit/log_prob_train: -10.19867; edit/prob_train:  0.28536; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.34262; perplexity/pre_train:  76.90887; nll/post_train:  6.40149; perplexity/post_train:  602.74335; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.17250; loss/total_train:  1.60447; loss/total_edit_train:  1.60447; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.42863; grad/pseudo_mag0_train:  19899.40879; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  4.85793; grad/diff0_train:  19896.07803; grad/cos0_train:  0.61571; grad/true_mag1_train:  8.70004; grad/pseudo_mag1_train:  19594.62148; grad/true_std1_train:  0.00212; grad/pseudo_std1_train:  4.78340; grad/diff1_train:  19588.83896; grad/cos1_train:  0.66298; grad/true_mag2_train:  8.97925; grad/pseudo_mag2_train:  18867.46709; grad/true_std2_train:  0.00219; grad/pseudo_std2_train:  4.60322; grad/diff2_train:  18861.06729; grad/cos2_train:  0.70660; grad/true_mag3_train:  5.76980; grad/pseudo_mag3_train:  19555.48164; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.77409; grad/diff3_train:  19551.96982; grad/cos3_train:  0.60930; grad/true_mag4_train:  10.21052; grad/pseudo_mag4_train:  18707.81689; grad/true_std4_train:  0.00249; grad/pseudo_std4_train:  4.56713; grad/diff4_train:  18700.98057; grad/cos4_train:  0.67050; grad/true_mag5_train:  11.25002; grad/pseudo_mag5_train:  17886.76143; grad/true_std5_train:  0.00275; grad/pseudo_std5_train:  4.36495; grad/diff5_train:  17879.09795; grad/cos5_train:  0.67864; grad/true_mag6_train:  6.27126; grad/pseudo_mag6_train:  18985.96299; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.63516; grad/diff6_train:  18981.69717; grad/cos6_train:  0.68226; grad/true_mag7_train:  11.32469; grad/pseudo_mag7_train:  18344.27734; grad/true_std7_train:  0.00276; grad/pseudo_std7_train:  4.47850; grad/diff7_train:  18335.91758; grad/cos7_train:  0.73733; grad/true_mag8_train:  13.89233; grad/pseudo_mag8_train:  17925.56104; grad/true_std8_train:  0.00339; grad/pseudo_std8_train:  4.37533; grad/diff8_train:  17915.22920; grad/cos8_train:  0.73879; grad/true_mag9_train:  8.08239; grad/pseudo_mag9_train:  19559.45254; grad/true_std9_train:  0.00197; grad/pseudo_std9_train:  4.77522; grad/diff9_train:  19552.99912; grad/cos9_train:  0.79457; grad/true_mag10_train:  11.78292; grad/pseudo_mag10_train:  19606.44932; grad/true_std10_train:  0.00288; grad/pseudo_std10_train:  4.78666; grad/diff10_train:  19596.78848; grad/cos10_train:  0.81464; grad/true_mag11_train:  15.37951; grad/pseudo_mag11_train:  19817.30879; grad/true_std11_train:  0.00375; grad/pseudo_std11_train:  4.83766; grad/diff11_train:  19804.73135; grad/cos11_train:  0.80886; grad/true_mag12_train:  9.28685; grad/pseudo_mag12_train:  20926.48647; grad/true_std12_train:  0.00227; grad/pseudo_std12_train:  5.10899; grad/diff12_train:  20918.50708; grad/cos12_train:  0.85012; grad/true_mag13_train:  11.65753; grad/pseudo_mag13_train:  20942.09189; grad/true_std13_train:  0.00285; grad/pseudo_std13_train:  5.11278; grad/diff13_train:  20931.95684; grad/cos13_train:  0.86030; grad/true_mag14_train:  14.10702; grad/pseudo_mag14_train:  21323.62246; grad/true_std14_train:  0.00344; grad/pseudo_std14_train:  5.20574; grad/diff14_train:  21311.50889; grad/cos14_train:  0.84440; grad/true_mag15_train:  9.17216; grad/pseudo_mag15_train:  21187.11807; grad/true_std15_train:  0.00224; grad/pseudo_std15_train:  5.17262; grad/diff15_train:  21178.88662; grad/cos15_train:  0.88786; grad/true_mag16_train:  10.82459; grad/pseudo_mag16_train:  21132.90493; grad/true_std16_train:  0.00264; grad/pseudo_std16_train:  5.15938; grad/diff16_train:  21123.33530; grad/cos16_train:  0.87171; grad/true_mag17_train:  12.85327; grad/pseudo_mag17_train:  22141.58682; grad/true_std17_train:  0.00314; grad/pseudo_std17_train:  5.40559; grad/diff17_train:  22130.45937; grad/cos17_train:  0.85374; grad_train:  2471.79834; lr/lr0_train:  0.00009; lr/lr1_train:  0.00008; lr/lr2_train:  0.00009; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:23:39,207][trainer][INFO] - Step 180:
[2025-04-24 22:23:39,207][trainer][INFO] - loss/edit_train:  10.10756; loss/loc_train:  0.11846; edit/acc_train:  0.01333; edit/log_prob_train: -10.10756; edit/prob_train:  0.25225; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.22301; perplexity/pre_train:  68.23840; nll/post_train:  4.37221; perplexity/post_train:  79.21828; n_tokens/pre_train:  7.10000; n_tokens/post_train:  7.10000; time/edit_train:  0.17964; loss/total_train:  1.12921; loss/total_edit_train:  1.12921; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.01696; grad/pseudo_mag0_train:  16749.64844; grad/true_std0_train:  0.00122; grad/pseudo_std0_train:  4.08899; grad/diff0_train:  16746.63574; grad/cos0_train:  0.60210; grad/true_mag1_train:  8.16359; grad/pseudo_mag1_train:  17281.41299; grad/true_std1_train:  0.00199; grad/pseudo_std1_train:  4.21857; grad/diff1_train:  17276.19443; grad/cos1_train:  0.64137; grad/true_mag2_train:  8.16259; grad/pseudo_mag2_train:  16723.34609; grad/true_std2_train:  0.00199; grad/pseudo_std2_train:  4.07965; grad/diff2_train:  16717.77754; grad/cos2_train:  0.68322; grad/true_mag3_train:  5.33370; grad/pseudo_mag3_train:  16542.64180; grad/true_std3_train:  0.00130; grad/pseudo_std3_train:  4.03855; grad/diff3_train:  16539.48018; grad/cos3_train:  0.59565; grad/true_mag4_train:  9.62166; grad/pseudo_mag4_train:  16435.09434; grad/true_std4_train:  0.00235; grad/pseudo_std4_train:  4.01226; grad/diff4_train:  16428.90303; grad/cos4_train:  0.64685; grad/true_mag5_train:  10.35460; grad/pseudo_mag5_train:  16045.24834; grad/true_std5_train:  0.00253; grad/pseudo_std5_train:  3.91503; grad/diff5_train:  16038.41162; grad/cos5_train:  0.66105; grad/true_mag6_train:  5.67853; grad/pseudo_mag6_train:  16215.54395; grad/true_std6_train:  0.00139; grad/pseudo_std6_train:  3.95881; grad/diff6_train:  16211.75264; grad/cos6_train:  0.66890; grad/true_mag7_train:  10.40264; grad/pseudo_mag7_train:  16316.30186; grad/true_std7_train:  0.00254; grad/pseudo_std7_train:  3.98339; grad/diff7_train:  16308.74648; grad/cos7_train:  0.72687; grad/true_mag8_train:  13.40518; grad/pseudo_mag8_train:  16397.45527; grad/true_std8_train:  0.00327; grad/pseudo_std8_train:  4.00191; grad/diff8_train:  16387.89873; grad/cos8_train:  0.71394; grad/true_mag9_train:  7.70395; grad/pseudo_mag9_train:  18144.17305; grad/true_std9_train:  0.00188; grad/pseudo_std9_train:  4.42970; grad/diff9_train:  18138.00869; grad/cos9_train:  0.79837; grad/true_mag10_train:  11.01037; grad/pseudo_mag10_train:  18481.74082; grad/true_std10_train:  0.00269; grad/pseudo_std10_train:  4.51209; grad/diff10_train:  18472.68320; grad/cos10_train:  0.81921; grad/true_mag11_train:  14.08074; grad/pseudo_mag11_train:  18717.91660; grad/true_std11_train:  0.00344; grad/pseudo_std11_train:  4.56916; grad/diff11_train:  18706.28799; grad/cos11_train:  0.82030; grad/true_mag12_train:  8.68564; grad/pseudo_mag12_train:  19736.18652; grad/true_std12_train:  0.00212; grad/pseudo_std12_train:  4.81839; grad/diff12_train:  19728.64053; grad/cos12_train:  0.86541; grad/true_mag13_train:  10.89773; grad/pseudo_mag13_train:  19578.48037; grad/true_std13_train:  0.00266; grad/pseudo_std13_train:  4.77988; grad/diff13_train:  19569.01318; grad/cos13_train:  0.86569; grad/true_mag14_train:  13.34807; grad/pseudo_mag14_train:  20264.16045; grad/true_std14_train:  0.00326; grad/pseudo_std14_train:  4.94705; grad/diff14_train:  20252.74082; grad/cos14_train:  0.84970; grad/true_mag15_train:  8.82735; grad/pseudo_mag15_train:  20442.90068; grad/true_std15_train:  0.00216; grad/pseudo_std15_train:  4.99093; grad/diff15_train:  20434.94092; grad/cos15_train:  0.89940; grad/true_mag16_train:  10.33061; grad/pseudo_mag16_train:  20405.53398; grad/true_std16_train:  0.00252; grad/pseudo_std16_train:  4.98181; grad/diff16_train:  20396.34082; grad/cos16_train:  0.88650; grad/true_mag17_train:  11.84069; grad/pseudo_mag17_train:  21309.69023; grad/true_std17_train:  0.00289; grad/pseudo_std17_train:  5.20250; grad/diff17_train:  21299.15107; grad/cos17_train:  0.88411; grad_train:  1211.87964; lr/lr0_train:  0.00009; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:23:42,859][trainer][INFO] - Step 190:
[2025-04-24 22:23:42,859][trainer][INFO] - loss/edit_train:  5.79696; loss/loc_train:  0.08265; edit/acc_train:  0.02000; edit/log_prob_train: -5.79696; edit/prob_train:  0.30897; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.16827; perplexity/pre_train:  64.60344; nll/post_train:  4.29526; perplexity/post_train:  73.35110; n_tokens/pre_train:  6.90000; n_tokens/post_train:  6.90000; time/edit_train:  0.21909; loss/total_train:  0.66235; loss/total_edit_train:  0.66235; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.18104; grad/pseudo_mag0_train:  17828.15850; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.35200; grad/diff0_train:  17825.08389; grad/cos0_train:  0.59395; grad/true_mag1_train:  8.37801; grad/pseudo_mag1_train:  18146.16201; grad/true_std1_train:  0.00205; grad/pseudo_std1_train:  4.42947; grad/diff1_train:  18140.69629; grad/cos1_train:  0.65152; grad/true_mag2_train:  8.62771; grad/pseudo_mag2_train:  17979.25117; grad/true_std2_train:  0.00211; grad/pseudo_std2_train:  4.38556; grad/diff2_train:  17973.24590; grad/cos2_train:  0.69162; grad/true_mag3_train:  5.58877; grad/pseudo_mag3_train:  17542.47832; grad/true_std3_train:  0.00136; grad/pseudo_std3_train:  4.28243; grad/diff3_train:  17539.17510; grad/cos3_train:  0.59125; grad/true_mag4_train:  10.31258; grad/pseudo_mag4_train:  17628.84775; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.30351; grad/diff4_train:  17622.15342; grad/cos4_train:  0.64959; grad/true_mag5_train:  11.22809; grad/pseudo_mag5_train:  17366.81084; grad/true_std5_train:  0.00274; grad/pseudo_std5_train:  4.23742; grad/diff5_train:  17359.34277; grad/cos5_train:  0.66241; grad/true_mag6_train:  6.37034; grad/pseudo_mag6_train:  17911.07100; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.37260; grad/diff6_train:  17906.87158; grad/cos6_train:  0.66026; grad/true_mag7_train:  11.66585; grad/pseudo_mag7_train:  18158.02334; grad/true_std7_train:  0.00285; grad/pseudo_std7_train:  4.43295; grad/diff7_train:  18149.47275; grad/cos7_train:  0.73216; grad/true_mag8_train:  15.16220; grad/pseudo_mag8_train:  18452.70381; grad/true_std8_train:  0.00370; grad/pseudo_std8_train:  4.50352; grad/diff8_train:  18441.52070; grad/cos8_train:  0.73494; grad/true_mag9_train:  8.79816; grad/pseudo_mag9_train:  21347.51133; grad/true_std9_train:  0.00215; grad/pseudo_std9_train:  5.21174; grad/diff9_train:  21340.43330; grad/cos9_train:  0.80110; grad/true_mag10_train:  12.70318; grad/pseudo_mag10_train:  20788.06416; grad/true_std10_train:  0.00310; grad/pseudo_std10_train:  5.07513; grad/diff10_train:  20777.75645; grad/cos10_train:  0.81211; grad/true_mag11_train:  16.20142; grad/pseudo_mag11_train:  21079.75225; grad/true_std11_train:  0.00396; grad/pseudo_std11_train:  5.14577; grad/diff11_train:  21066.44307; grad/cos11_train:  0.81725; grad/true_mag12_train:  10.23708; grad/pseudo_mag12_train:  23341.16387; grad/true_std12_train:  0.00250; grad/pseudo_std12_train:  5.69850; grad/diff12_train:  23332.24688; grad/cos12_train:  0.86740; grad/true_mag13_train:  12.50515; grad/pseudo_mag13_train:  22596.04521; grad/true_std13_train:  0.00305; grad/pseudo_std13_train:  5.51657; grad/diff13_train:  22585.10322; grad/cos13_train:  0.87091; grad/true_mag14_train:  14.74681; grad/pseudo_mag14_train:  23068.07979; grad/true_std14_train:  0.00360; grad/pseudo_std14_train:  5.63155; grad/diff14_train:  23055.20400; grad/cos14_train:  0.86762; grad/true_mag15_train:  10.18283; grad/pseudo_mag15_train:  23477.01143; grad/true_std15_train:  0.00249; grad/pseudo_std15_train:  5.73167; grad/diff15_train:  23467.78838; grad/cos15_train:  0.90294; grad/true_mag16_train:  11.81924; grad/pseudo_mag16_train:  23389.12178; grad/true_std16_train:  0.00289; grad/pseudo_std16_train:  5.71020; grad/diff16_train:  23378.55244; grad/cos16_train:  0.89063; grad/true_mag17_train:  13.30952; grad/pseudo_mag17_train:  24092.32344; grad/true_std17_train:  0.00325; grad/pseudo_std17_train:  5.88182; grad/diff17_train:  24080.47031; grad/cos17_train:  0.88713; grad_train:  974.78406; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:23:46,097][trainer][INFO] - Step 200:
[2025-04-24 22:23:46,097][trainer][INFO] - loss/edit_train:  11.93931; loss/loc_train:  0.09851; edit/acc_train:  0.05000; edit/log_prob_train: -11.93931; edit/prob_train:  0.21324; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.62263; perplexity/pre_train:  101.76141; nll/post_train:  4.72191; perplexity/post_train:  112.38247; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.18132; loss/total_train:  1.29244; loss/total_edit_train:  1.29244; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.38099; grad/pseudo_mag0_train:  18761.89004; grad/true_std0_train:  0.00131; grad/pseudo_std0_train:  4.58014; grad/diff0_train:  18758.59336; grad/cos0_train:  0.61415; grad/true_mag1_train:  8.60104; grad/pseudo_mag1_train:  19135.23594; grad/true_std1_train:  0.00210; grad/pseudo_std1_train:  4.67105; grad/diff1_train:  19129.52266; grad/cos1_train:  0.66446; grad/true_mag2_train:  8.91521; grad/pseudo_mag2_train:  18937.28984; grad/true_std2_train:  0.00218; grad/pseudo_std2_train:  4.61887; grad/diff2_train:  18931.07676; grad/cos2_train:  0.69208; grad/true_mag3_train:  5.82590; grad/pseudo_mag3_train:  18036.90937; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.40326; grad/diff3_train:  18033.46338; grad/cos3_train:  0.59381; grad/true_mag4_train:  10.44590; grad/pseudo_mag4_train:  18306.94404; grad/true_std4_train:  0.00255; grad/pseudo_std4_train:  4.46914; grad/diff4_train:  18300.08672; grad/cos4_train:  0.65664; grad/true_mag5_train:  11.44953; grad/pseudo_mag5_train:  18158.69805; grad/true_std5_train:  0.00280; grad/pseudo_std5_train:  4.43020; grad/diff5_train:  18151.05186; grad/cos5_train:  0.66365; grad/true_mag6_train:  6.60478; grad/pseudo_mag6_train:  18689.21826; grad/true_std6_train:  0.00161; grad/pseudo_std6_train:  4.56269; grad/diff6_train:  18684.78408; grad/cos6_train:  0.67363; grad/true_mag7_train:  11.98869; grad/pseudo_mag7_train:  18977.13096; grad/true_std7_train:  0.00293; grad/pseudo_std7_train:  4.63297; grad/diff7_train:  18968.30928; grad/cos7_train:  0.73451; grad/true_mag8_train:  15.39900; grad/pseudo_mag8_train:  19274.54922; grad/true_std8_train:  0.00376; grad/pseudo_std8_train:  4.70403; grad/diff8_train:  19263.01504; grad/cos8_train:  0.73975; grad/true_mag9_train:  8.96374; grad/pseudo_mag9_train:  21388.32197; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  5.22172; grad/diff9_train:  21381.07002; grad/cos9_train:  0.80612; grad/true_mag10_train:  12.78289; grad/pseudo_mag10_train:  21439.15918; grad/true_std10_train:  0.00312; grad/pseudo_std10_train:  5.23410; grad/diff10_train:  21428.62969; grad/cos10_train:  0.82040; grad/true_mag11_train:  16.19032; grad/pseudo_mag11_train:  21443.22012; grad/true_std11_train:  0.00395; grad/pseudo_std11_train:  5.23438; grad/diff11_train:  21429.90732; grad/cos11_train:  0.81602; grad/true_mag12_train:  10.31566; grad/pseudo_mag12_train:  23120.44756; grad/true_std12_train:  0.00252; grad/pseudo_std12_train:  5.64462; grad/diff12_train:  23111.42480; grad/cos12_train:  0.87151; grad/true_mag13_train:  12.69517; grad/pseudo_mag13_train:  22654.11777; grad/true_std13_train:  0.00310; grad/pseudo_std13_train:  5.53076; grad/diff13_train:  22643.01963; grad/cos13_train:  0.87013; grad/true_mag14_train:  15.36802; grad/pseudo_mag14_train:  23243.61416; grad/true_std14_train:  0.00375; grad/pseudo_std14_train:  5.67437; grad/diff14_train:  23230.34043; grad/cos14_train:  0.85709; grad/true_mag15_train:  10.36859; grad/pseudo_mag15_train:  23672.38506; grad/true_std15_train:  0.00253; grad/pseudo_std15_train:  5.77937; grad/diff15_train:  23663.00684; grad/cos15_train:  0.90241; grad/true_mag16_train:  11.90988; grad/pseudo_mag16_train:  23466.96777; grad/true_std16_train:  0.00291; grad/pseudo_std16_train:  5.72922; grad/diff16_train:  23456.31025; grad/cos16_train:  0.89108; grad/true_mag17_train:  13.48483; grad/pseudo_mag17_train:  24195.67246; grad/true_std17_train:  0.00329; grad/pseudo_std17_train:  5.90703; grad/diff17_train:  24183.63896; grad/cos17_train:  0.88505; grad_train:  1377.48096; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:24:04,030][trainer][INFO] - Step 200:
[2025-04-24 22:24:04,030][trainer][INFO] - loss/edit_val:  9.62735; loss/loc_val:  0.21880; edit/acc_val:  0.01200; edit/log_prob_val: -9.62735; edit/prob_val:  0.22334; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.76971; perplexity/post_val:  117.88504; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10573; loss/total_val:  1.18153; loss/total_edit_val:  1.18153; memory/alloc_max_val:  42204623872.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  17.92804; eval_time/average:  0.17928
[2025-04-24 22:24:04,034][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:24:04,034][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:24:58,086][trainer][INFO] - Write complete.
[2025-04-24 22:25:01,723][trainer][INFO] - Step 210:
[2025-04-24 22:25:01,723][trainer][INFO] - loss/edit_train:  9.83900; loss/loc_train:  0.10206; edit/acc_train:  0.00000; edit/log_prob_train: -9.83900; edit/prob_train:  0.21071; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.70241; perplexity/pre_train:  110.21284; nll/post_train:  4.88572; perplexity/post_train:  132.38531; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.22014; loss/total_train:  1.08596; loss/total_edit_train:  1.08596; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.16327; grad/pseudo_mag0_train:  18239.03301; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.45241; grad/diff0_train:  18235.87246; grad/cos0_train:  0.61228; grad/true_mag1_train:  8.57357; grad/pseudo_mag1_train:  18468.49346; grad/true_std1_train:  0.00209; grad/pseudo_std1_train:  4.50824; grad/diff1_train:  18462.88770; grad/cos1_train:  0.65358; grad/true_mag2_train:  8.85656; grad/pseudo_mag2_train:  18318.44668; grad/true_std2_train:  0.00216; grad/pseudo_std2_train:  4.46533; grad/diff2_train:  18312.48467; grad/cos2_train:  0.66783; grad/true_mag3_train:  5.78348; grad/pseudo_mag3_train:  18267.74375; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.45962; grad/diff3_train:  18264.29346; grad/cos3_train:  0.60006; grad/true_mag4_train:  10.13484; grad/pseudo_mag4_train:  18039.44971; grad/true_std4_train:  0.00247; grad/pseudo_std4_train:  4.40389; grad/diff4_train:  18032.77217; grad/cos4_train:  0.65995; grad/true_mag5_train:  11.11299; grad/pseudo_mag5_train:  17639.13320; grad/true_std5_train:  0.00271; grad/pseudo_std5_train:  4.30200; grad/diff5_train:  17631.83916; grad/cos5_train:  0.65317; grad/true_mag6_train:  6.06577; grad/pseudo_mag6_train:  16867.88965; grad/true_std6_train:  0.00148; grad/pseudo_std6_train:  4.11805; grad/diff6_train:  16863.81816; grad/cos6_train:  0.67302; grad/true_mag7_train:  10.77288; grad/pseudo_mag7_train:  16937.69434; grad/true_std7_train:  0.00263; grad/pseudo_std7_train:  4.13510; grad/diff7_train:  16929.79551; grad/cos7_train:  0.73167; grad/true_mag8_train:  13.75206; grad/pseudo_mag8_train:  16953.51240; grad/true_std8_train:  0.00336; grad/pseudo_std8_train:  4.13683; grad/diff8_train:  16943.67227; grad/cos8_train:  0.70964; grad/true_mag9_train:  7.74734; grad/pseudo_mag9_train:  18216.90020; grad/true_std9_train:  0.00189; grad/pseudo_std9_train:  4.44745; grad/diff9_train:  18210.70146; grad/cos9_train:  0.79836; grad/true_mag10_train:  11.25460; grad/pseudo_mag10_train:  18616.10840; grad/true_std10_train:  0.00275; grad/pseudo_std10_train:  4.54488; grad/diff10_train:  18606.89316; grad/cos10_train:  0.81589; grad/true_mag11_train:  14.42426; grad/pseudo_mag11_train:  18632.35762; grad/true_std11_train:  0.00352; grad/pseudo_std11_train:  4.54777; grad/diff11_train:  18620.73242; grad/cos11_train:  0.80054; grad/true_mag12_train:  8.70266; grad/pseudo_mag12_train:  19222.24365; grad/true_std12_train:  0.00212; grad/pseudo_std12_train:  4.69292; grad/diff12_train:  19214.72236; grad/cos12_train:  0.86120; grad/true_mag13_train:  10.89781; grad/pseudo_mag13_train:  19075.42109; grad/true_std13_train:  0.00266; grad/pseudo_std13_train:  4.65707; grad/diff13_train:  19065.99053; grad/cos13_train:  0.86174; grad/true_mag14_train:  13.39902; grad/pseudo_mag14_train:  19697.10986; grad/true_std14_train:  0.00327; grad/pseudo_std14_train:  4.80841; grad/diff14_train:  19685.77412; grad/cos14_train:  0.84064; grad/true_mag15_train:  8.84413; grad/pseudo_mag15_train:  20227.77959; grad/true_std15_train:  0.00216; grad/pseudo_std15_train:  4.93842; grad/diff15_train:  20219.80762; grad/cos15_train:  0.89900; grad/true_mag16_train:  10.33805; grad/pseudo_mag16_train:  20142.20879; grad/true_std16_train:  0.00252; grad/pseudo_std16_train:  4.91752; grad/diff16_train:  20133.06895; grad/cos16_train:  0.88003; grad/true_mag17_train:  11.94396; grad/pseudo_mag17_train:  21250.83145; grad/true_std17_train:  0.00292; grad/pseudo_std17_train:  5.18809; grad/diff17_train:  21240.27402; grad/cos17_train:  0.87828; grad_train:  1111.00293; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:25:04,964][trainer][INFO] - Step 220:
[2025-04-24 22:25:04,965][trainer][INFO] - loss/edit_train:  9.60323; loss/loc_train:  0.19996; edit/acc_train:  0.11333; edit/log_prob_train: -9.60323; edit/prob_train:  0.28306; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.38268; perplexity/pre_train:  217.60442; nll/post_train:  5.63734; perplexity/post_train:  280.71393; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.18118; loss/total_train:  1.16028; loss/total_edit_train:  1.16028; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.50877; grad/pseudo_mag0_train:  19976.41689; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  4.87653; grad/diff0_train:  19973.11543; grad/cos0_train:  0.60426; grad/true_mag1_train:  8.79415; grad/pseudo_mag1_train:  19761.27988; grad/true_std1_train:  0.00215; grad/pseudo_std1_train:  4.82352; grad/diff1_train:  19755.65430; grad/cos1_train:  0.64490; grad/true_mag2_train:  8.94842; grad/pseudo_mag2_train:  19009.04160; grad/true_std2_train:  0.00218; grad/pseudo_std2_train:  4.63455; grad/diff2_train:  19003.03037; grad/cos2_train:  0.66979; grad/true_mag3_train:  5.78051; grad/pseudo_mag3_train:  18581.18750; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.53607; grad/diff3_train:  18577.80459; grad/cos3_train:  0.58818; grad/true_mag4_train:  10.33810; grad/pseudo_mag4_train:  18073.00693; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.41193; grad/diff4_train:  18066.33945; grad/cos4_train:  0.64739; grad/true_mag5_train:  11.12396; grad/pseudo_mag5_train:  17712.87021; grad/true_std5_train:  0.00272; grad/pseudo_std5_train:  4.32000; grad/diff5_train:  17705.65635; grad/cos5_train:  0.64740; grad/true_mag6_train:  6.19294; grad/pseudo_mag6_train:  17814.68672; grad/true_std6_train:  0.00151; grad/pseudo_std6_train:  4.34914; grad/diff6_train:  17810.54893; grad/cos6_train:  0.67027; grad/true_mag7_train:  11.48583; grad/pseudo_mag7_train:  17750.55742; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  4.33348; grad/diff7_train:  17742.24883; grad/cos7_train:  0.72201; grad/true_mag8_train:  14.67788; grad/pseudo_mag8_train:  18035.05742; grad/true_std8_train:  0.00358; grad/pseudo_std8_train:  4.40069; grad/diff8_train:  18024.61523; grad/cos8_train:  0.70547; grad/true_mag9_train:  8.33094; grad/pseudo_mag9_train:  20034.56230; grad/true_std9_train:  0.00203; grad/pseudo_std9_train:  4.89118; grad/diff9_train:  20027.86865; grad/cos9_train:  0.80049; grad/true_mag10_train:  11.92918; grad/pseudo_mag10_train:  19967.54268; grad/true_std10_train:  0.00291; grad/pseudo_std10_train:  4.87479; grad/diff10_train:  19957.70439; grad/cos10_train:  0.82010; grad/true_mag11_train:  15.28921; grad/pseudo_mag11_train:  20244.23877; grad/true_std11_train:  0.00373; grad/pseudo_std11_train:  4.94135; grad/diff11_train:  20231.66123; grad/cos11_train:  0.81335; grad/true_mag12_train:  9.65167; grad/pseudo_mag12_train:  21644.88760; grad/true_std12_train:  0.00236; grad/pseudo_std12_train:  5.28438; grad/diff12_train:  21636.51738; grad/cos12_train:  0.86346; grad/true_mag13_train:  11.90792; grad/pseudo_mag13_train:  21212.92021; grad/true_std13_train:  0.00291; grad/pseudo_std13_train:  5.17891; grad/diff13_train:  21202.54121; grad/cos13_train:  0.86645; grad/true_mag14_train:  14.35087; grad/pseudo_mag14_train:  21903.58809; grad/true_std14_train:  0.00350; grad/pseudo_std14_train:  5.34706; grad/diff14_train:  21891.30947; grad/cos14_train:  0.84387; grad/true_mag15_train:  9.67734; grad/pseudo_mag15_train:  22212.88545; grad/true_std15_train:  0.00236; grad/pseudo_std15_train:  5.42306; grad/diff15_train:  22204.16641; grad/cos15_train:  0.89659; grad/true_mag16_train:  11.17467; grad/pseudo_mag16_train:  21946.98721; grad/true_std16_train:  0.00273; grad/pseudo_std16_train:  5.35813; grad/diff16_train:  21937.04404; grad/cos16_train:  0.88393; grad/true_mag17_train:  12.82372; grad/pseudo_mag17_train:  22908.86689; grad/true_std17_train:  0.00313; grad/pseudo_std17_train:  5.59283; grad/diff17_train:  22897.58789; grad/cos17_train:  0.86652; grad_train:  1626.62805; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:25:08,191][trainer][INFO] - Step 230:
[2025-04-24 22:25:08,192][trainer][INFO] - loss/edit_train:  6.90961; loss/loc_train:  0.12114; edit/acc_train:  0.00000; edit/log_prob_train: -6.90961; edit/prob_train:  0.28581; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.22358; perplexity/pre_train:  68.27773; nll/post_train:  4.26793; perplexity/post_train:  71.37407; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.18036; loss/total_train:  0.81210; loss/total_edit_train:  0.81210; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.31232; grad/pseudo_mag0_train:  20277.69092; grad/true_std0_train:  0.00130; grad/pseudo_std0_train:  4.94991; grad/diff0_train:  20274.46094; grad/cos0_train:  0.61298; grad/true_mag1_train:  8.65283; grad/pseudo_mag1_train:  20078.02402; grad/true_std1_train:  0.00211; grad/pseudo_std1_train:  4.90075; grad/diff1_train:  20072.58164; grad/cos1_train:  0.63461; grad/true_mag2_train:  9.00604; grad/pseudo_mag2_train:  19646.45469; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  4.78943; grad/diff2_train:  19640.40215; grad/cos2_train:  0.67186; grad/true_mag3_train:  5.72202; grad/pseudo_mag3_train:  19496.17363; grad/true_std3_train:  0.00140; grad/pseudo_std3_train:  4.75941; grad/diff3_train:  19492.76035; grad/cos3_train:  0.60054; grad/true_mag4_train:  10.01503; grad/pseudo_mag4_train:  18736.86338; grad/true_std4_train:  0.00245; grad/pseudo_std4_train:  4.57382; grad/diff4_train:  18730.49893; grad/cos4_train:  0.64046; grad/true_mag5_train:  10.68456; grad/pseudo_mag5_train:  18220.76797; grad/true_std5_train:  0.00261; grad/pseudo_std5_train:  4.44388; grad/diff5_train:  18213.74131; grad/cos5_train:  0.65747; grad/true_mag6_train:  5.83713; grad/pseudo_mag6_train:  17985.00391; grad/true_std6_train:  0.00143; grad/pseudo_std6_train:  4.39072; grad/diff6_train:  17981.08223; grad/cos6_train:  0.67408; grad/true_mag7_train:  10.61294; grad/pseudo_mag7_train:  17167.16055; grad/true_std7_train:  0.00259; grad/pseudo_std7_train:  4.19105; grad/diff7_train:  17159.56758; grad/cos7_train:  0.71529; grad/true_mag8_train:  13.15003; grad/pseudo_mag8_train:  17461.55605; grad/true_std8_train:  0.00321; grad/pseudo_std8_train:  4.26078; grad/diff8_train:  17452.12959; grad/cos8_train:  0.71382; grad/true_mag9_train:  7.32653; grad/pseudo_mag9_train:  17595.37471; grad/true_std9_train:  0.00179; grad/pseudo_std9_train:  4.29570; grad/diff9_train:  17589.52314; grad/cos9_train:  0.79485; grad/true_mag10_train:  11.01759; grad/pseudo_mag10_train:  18214.11758; grad/true_std10_train:  0.00269; grad/pseudo_std10_train:  4.44672; grad/diff10_train:  18205.20107; grad/cos10_train:  0.80551; grad/true_mag11_train:  14.50268; grad/pseudo_mag11_train:  18704.76221; grad/true_std11_train:  0.00354; grad/pseudo_std11_train:  4.56546; grad/diff11_train:  18693.18691; grad/cos11_train:  0.79135; grad/true_mag12_train:  8.53104; grad/pseudo_mag12_train:  18710.92031; grad/true_std12_train:  0.00208; grad/pseudo_std12_train:  4.56808; grad/diff12_train:  18703.54766; grad/cos12_train:  0.86005; grad/true_mag13_train:  10.71818; grad/pseudo_mag13_train:  18772.11953; grad/true_std13_train:  0.00262; grad/pseudo_std13_train:  4.58301; grad/diff13_train:  18762.93945; grad/cos13_train:  0.85350; grad/true_mag14_train:  13.63234; grad/pseudo_mag14_train:  20161.28857; grad/true_std14_train:  0.00333; grad/pseudo_std14_train:  4.92172; grad/diff14_train:  20149.79229; grad/cos14_train:  0.83627; grad/true_mag15_train:  8.44325; grad/pseudo_mag15_train:  19190.69834; grad/true_std15_train:  0.00206; grad/pseudo_std15_train:  4.68522; grad/diff15_train:  19183.14795; grad/cos15_train:  0.89130; grad/true_mag16_train:  10.01768; grad/pseudo_mag16_train:  19395.94404; grad/true_std16_train:  0.00245; grad/pseudo_std16_train:  4.73532; grad/diff16_train:  19387.11670; grad/cos16_train:  0.87664; grad/true_mag17_train:  12.79041; grad/pseudo_mag17_train:  21563.45693; grad/true_std17_train:  0.00312; grad/pseudo_std17_train:  5.26436; grad/diff17_train:  21552.48662; grad/cos17_train:  0.85925; grad_train:  1092.80713; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:25:11,949][trainer][INFO] - Step 240:
[2025-04-24 22:25:11,950][trainer][INFO] - loss/edit_train:  8.58432; loss/loc_train:  0.16053; edit/acc_train:  0.02000; edit/log_prob_train: -8.58432; edit/prob_train:  0.28229; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.93170; perplexity/pre_train:  50.99347; nll/post_train:  4.24539; perplexity/post_train:  69.78266; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.22680; loss/total_train:  1.01896; loss/total_edit_train:  1.01896; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.78589; grad/pseudo_mag0_train:  20260.50605; grad/true_std0_train:  0.00141; grad/pseudo_std0_train:  4.94586; grad/diff0_train:  20256.95898; grad/cos0_train:  0.61634; grad/true_mag1_train:  9.32187; grad/pseudo_mag1_train:  20910.08984; grad/true_std1_train:  0.00228; grad/pseudo_std1_train:  5.10395; grad/diff1_train:  20903.92637; grad/cos1_train:  0.66217; grad/true_mag2_train:  9.71644; grad/pseudo_mag2_train:  20898.77832; grad/true_std2_train:  0.00237; grad/pseudo_std2_train:  5.09304; grad/diff2_train:  20892.08887; grad/cos2_train:  0.68657; grad/true_mag3_train:  6.40666; grad/pseudo_mag3_train:  19982.25840; grad/true_std3_train:  0.00156; grad/pseudo_std3_train:  4.87816; grad/diff3_train:  19978.44629; grad/cos3_train:  0.59890; grad/true_mag4_train:  11.61298; grad/pseudo_mag4_train:  20406.56729; grad/true_std4_train:  0.00284; grad/pseudo_std4_train:  4.98164; grad/diff4_train:  20398.99922; grad/cos4_train:  0.65744; grad/true_mag5_train:  12.41195; grad/pseudo_mag5_train:  20114.43818; grad/true_std5_train:  0.00303; grad/pseudo_std5_train:  4.90486; grad/diff5_train:  20106.20234; grad/cos5_train:  0.66300; grad/true_mag6_train:  7.13101; grad/pseudo_mag6_train:  20563.21123; grad/true_std6_train:  0.00174; grad/pseudo_std6_train:  5.02018; grad/diff6_train:  20558.43320; grad/cos6_train:  0.67290; grad/true_mag7_train:  12.81520; grad/pseudo_mag7_train:  20484.47930; grad/true_std7_train:  0.00313; grad/pseudo_std7_train:  5.00095; grad/diff7_train:  20475.01406; grad/cos7_train:  0.73547; grad/true_mag8_train:  16.22271; grad/pseudo_mag8_train:  20525.37705; grad/true_std8_train:  0.00396; grad/pseudo_std8_train:  5.00773; grad/diff8_train:  20513.47500; grad/cos8_train:  0.71963; grad/true_mag9_train:  9.26485; grad/pseudo_mag9_train:  22677.85449; grad/true_std9_train:  0.00226; grad/pseudo_std9_train:  5.53653; grad/diff9_train:  22670.38965; grad/cos9_train:  0.79959; grad/true_mag10_train:  13.10627; grad/pseudo_mag10_train:  22267.25781; grad/true_std10_train:  0.00320; grad/pseudo_std10_train:  5.43624; grad/diff10_train:  22256.39297; grad/cos10_train:  0.82095; grad/true_mag11_train:  16.94592; grad/pseudo_mag11_train:  22231.48193; grad/true_std11_train:  0.00414; grad/pseudo_std11_train:  5.42606; grad/diff11_train:  22217.76621; grad/cos11_train:  0.79610; grad/true_mag12_train:  10.76382; grad/pseudo_mag12_train:  24070.55010; grad/true_std12_train:  0.00263; grad/pseudo_std12_train:  5.87657; grad/diff12_train:  24061.20908; grad/cos12_train:  0.85955; grad/true_mag13_train:  13.40067; grad/pseudo_mag13_train:  23988.18232; grad/true_std13_train:  0.00327; grad/pseudo_std13_train:  5.85645; grad/diff13_train:  23976.45352; grad/cos13_train:  0.86603; grad/true_mag14_train:  16.20981; grad/pseudo_mag14_train:  24076.33994; grad/true_std14_train:  0.00396; grad/pseudo_std14_train:  5.87735; grad/diff14_train:  24062.43975; grad/cos14_train:  0.84281; grad/true_mag15_train:  10.89756; grad/pseudo_mag15_train:  24801.84229; grad/true_std15_train:  0.00266; grad/pseudo_std15_train:  6.05512; grad/diff15_train:  24791.98584; grad/cos15_train:  0.89772; grad/true_mag16_train:  12.52890; grad/pseudo_mag16_train:  24667.39111; grad/true_std16_train:  0.00306; grad/pseudo_std16_train:  6.02228; grad/diff16_train:  24656.17383; grad/cos16_train:  0.88336; grad/true_mag17_train:  14.18962; grad/pseudo_mag17_train:  25468.97910; grad/true_std17_train:  0.00346; grad/pseudo_std17_train:  6.21783; grad/diff17_train:  25456.32275; grad/cos17_train:  0.87594; grad_train:  1625.44910; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:25:15,248][trainer][INFO] - Step 250:
[2025-04-24 22:25:15,248][trainer][INFO] - loss/edit_train:  7.95023; loss/loc_train:  0.15239; edit/acc_train:  0.03762; edit/log_prob_train: -7.95023; edit/prob_train:  0.26247; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.72930; perplexity/pre_train:  113.21600; nll/post_train:  4.64870; perplexity/post_train:  104.44893; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.18044; loss/total_train:  0.94741; loss/total_edit_train:  0.94741; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.46349; grad/pseudo_mag0_train:  18998.97441; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  4.63721; grad/diff0_train:  18995.75586; grad/cos0_train:  0.59318; grad/true_mag1_train:  8.68437; grad/pseudo_mag1_train:  19005.15010; grad/true_std1_train:  0.00212; grad/pseudo_std1_train:  4.63796; grad/diff1_train:  18999.70898; grad/cos1_train:  0.62737; grad/true_mag2_train:  8.93052; grad/pseudo_mag2_train:  19049.52852; grad/true_std2_train:  0.00218; grad/pseudo_std2_train:  4.63924; grad/diff2_train:  19043.76768; grad/cos2_train:  0.64152; grad/true_mag3_train:  5.82619; grad/pseudo_mag3_train:  17865.92373; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.36102; grad/diff3_train:  17862.59307; grad/cos3_train:  0.57563; grad/true_mag4_train:  10.04429; grad/pseudo_mag4_train:  17631.29795; grad/true_std4_train:  0.00245; grad/pseudo_std4_train:  4.30355; grad/diff4_train:  17624.93389; grad/cos4_train:  0.63567; grad/true_mag5_train:  10.73512; grad/pseudo_mag5_train:  17662.56650; grad/true_std5_train:  0.00262; grad/pseudo_std5_train:  4.30439; grad/diff5_train:  17655.78623; grad/cos5_train:  0.62725; grad/true_mag6_train:  6.19286; grad/pseudo_mag6_train:  17305.67168; grad/true_std6_train:  0.00151; grad/pseudo_std6_train:  4.22470; grad/diff6_train:  17301.61572; grad/cos6_train:  0.65628; grad/true_mag7_train:  11.32357; grad/pseudo_mag7_train:  17451.70293; grad/true_std7_train:  0.00276; grad/pseudo_std7_train:  4.26035; grad/diff7_train:  17443.58496; grad/cos7_train:  0.71567; grad/true_mag8_train:  13.95704; grad/pseudo_mag8_train:  17525.46357; grad/true_std8_train:  0.00341; grad/pseudo_std8_train:  4.27459; grad/diff8_train:  17515.91768; grad/cos8_train:  0.67804; grad/true_mag9_train:  8.19771; grad/pseudo_mag9_train:  19403.26484; grad/true_std9_train:  0.00200; grad/pseudo_std9_train:  4.73701; grad/diff9_train:  19396.69199; grad/cos9_train:  0.79792; grad/true_mag10_train:  11.87432; grad/pseudo_mag10_train:  19269.38994; grad/true_std10_train:  0.00290; grad/pseudo_std10_train:  4.70424; grad/diff10_train:  19259.73311; grad/cos10_train:  0.80932; grad/true_mag11_train:  14.62465; grad/pseudo_mag11_train:  19466.27402; grad/true_std11_train:  0.00357; grad/pseudo_std11_train:  4.75078; grad/diff11_train:  19454.45381; grad/cos11_train:  0.80049; grad/true_mag12_train:  9.23774; grad/pseudo_mag12_train:  20017.96768; grad/true_std12_train:  0.00226; grad/pseudo_std12_train:  4.88716; grad/diff12_train:  20010.04180; grad/cos12_train:  0.85265; grad/true_mag13_train:  11.55704; grad/pseudo_mag13_train:  19947.39287; grad/true_std13_train:  0.00282; grad/pseudo_std13_train:  4.86991; grad/diff13_train:  19937.44326; grad/cos13_train:  0.85571; grad/true_mag14_train:  13.85254; grad/pseudo_mag14_train:  20439.13281; grad/true_std14_train:  0.00338; grad/pseudo_std14_train:  4.98922; grad/diff14_train:  20427.51396; grad/cos14_train:  0.82867; grad/true_mag15_train:  9.27060; grad/pseudo_mag15_train:  20830.80410; grad/true_std15_train:  0.00226; grad/pseudo_std15_train:  5.08561; grad/diff15_train:  20822.49307; grad/cos15_train:  0.89115; grad/true_mag16_train:  10.82908; grad/pseudo_mag16_train:  20704.96602; grad/true_std16_train:  0.00264; grad/pseudo_std16_train:  5.05489; grad/diff16_train:  20695.41025; grad/cos16_train:  0.87447; grad/true_mag17_train:  12.43826; grad/pseudo_mag17_train:  21635.75264; grad/true_std17_train:  0.00304; grad/pseudo_std17_train:  5.28199; grad/diff17_train:  21624.91953; grad/cos17_train:  0.85901; grad_train:  1263.57361; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00008; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00008; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00008; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00008; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00008
[2025-04-24 22:25:18,434][trainer][INFO] - Step 260:
[2025-04-24 22:25:18,434][trainer][INFO] - loss/edit_train:  9.42413; loss/loc_train:  0.20851; edit/acc_train:  0.00625; edit/log_prob_train: -9.42413; edit/prob_train:  0.24836; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.90977; perplexity/pre_train:  49.88722; nll/post_train:  4.22145; perplexity/post_train:  68.13203; n_tokens/pre_train:  4.80000; n_tokens/post_train:  4.80000; time/edit_train:  0.17550; loss/total_train:  1.15093; loss/total_edit_train:  1.15093; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.79223; grad/pseudo_mag0_train:  19587.31133; grad/true_std0_train:  0.00141; grad/pseudo_std0_train:  4.78107; grad/diff0_train:  19583.89678; grad/cos0_train:  0.59356; grad/true_mag1_train:  9.50855; grad/pseudo_mag1_train:  20305.37363; grad/true_std1_train:  0.00232; grad/pseudo_std1_train:  4.95564; grad/diff1_train:  20299.42148; grad/cos1_train:  0.63064; grad/true_mag2_train:  9.59464; grad/pseudo_mag2_train:  20066.95879; grad/true_std2_train:  0.00234; grad/pseudo_std2_train:  4.88986; grad/diff2_train:  20060.61738; grad/cos2_train:  0.66014; grad/true_mag3_train:  6.34777; grad/pseudo_mag3_train:  19181.30732; grad/true_std3_train:  0.00155; grad/pseudo_std3_train:  4.68237; grad/diff3_train:  19177.68330; grad/cos3_train:  0.57726; grad/true_mag4_train:  11.66471; grad/pseudo_mag4_train:  20212.73447; grad/true_std4_train:  0.00285; grad/pseudo_std4_train:  4.93382; grad/diff4_train:  20205.71563; grad/cos4_train:  0.61663; grad/true_mag5_train:  12.65868; grad/pseudo_mag5_train:  19727.51611; grad/true_std5_train:  0.00309; grad/pseudo_std5_train:  4.81021; grad/diff5_train:  19719.51885; grad/cos5_train:  0.63317; grad/true_mag6_train:  7.43041; grad/pseudo_mag6_train:  20259.99951; grad/true_std6_train:  0.00181; grad/pseudo_std6_train:  4.94603; grad/diff6_train:  20255.17588; grad/cos6_train:  0.65465; grad/true_mag7_train:  13.48628; grad/pseudo_mag7_train:  20813.16377; grad/true_std7_train:  0.00329; grad/pseudo_std7_train:  5.08100; grad/diff7_train:  20803.51631; grad/cos7_train:  0.71820; grad/true_mag8_train:  17.40116; grad/pseudo_mag8_train:  21448.32637; grad/true_std8_train:  0.00425; grad/pseudo_std8_train:  5.23333; grad/diff8_train:  21435.53086; grad/cos8_train:  0.72654; grad/true_mag9_train:  10.14402; grad/pseudo_mag9_train:  24380.86162; grad/true_std9_train:  0.00248; grad/pseudo_std9_train:  5.95228; grad/diff9_train:  24372.63398; grad/cos9_train:  0.80861; grad/true_mag10_train:  14.23114; grad/pseudo_mag10_train:  23826.65244; grad/true_std10_train:  0.00347; grad/pseudo_std10_train:  5.81693; grad/diff10_train:  23814.88594; grad/cos10_train:  0.82299; grad/true_mag11_train:  18.58923; grad/pseudo_mag11_train:  24501.22666; grad/true_std11_train:  0.00454; grad/pseudo_std11_train:  5.98045; grad/diff11_train:  24486.00967; grad/cos11_train:  0.81807; grad/true_mag12_train:  11.63443; grad/pseudo_mag12_train:  26037.56074; grad/true_std12_train:  0.00284; grad/pseudo_std12_train:  6.35678; grad/diff12_train:  26027.43213; grad/cos12_train:  0.86730; grad/true_mag13_train:  14.49655; grad/pseudo_mag13_train:  25666.84170; grad/true_std13_train:  0.00354; grad/pseudo_std13_train:  6.26626; grad/diff13_train:  25654.19150; grad/cos13_train:  0.86993; grad/true_mag14_train:  17.50789; grad/pseudo_mag14_train:  26582.07959; grad/true_std14_train:  0.00427; grad/pseudo_std14_train:  6.48918; grad/diff14_train:  26566.89492; grad/cos14_train:  0.85522; grad/true_mag15_train:  11.74362; grad/pseudo_mag15_train:  26649.26387; grad/true_std15_train:  0.00287; grad/pseudo_std15_train:  6.50614; grad/diff15_train:  26638.65771; grad/cos15_train:  0.90109; grad/true_mag16_train:  13.55310; grad/pseudo_mag16_train:  26521.46045; grad/true_std16_train:  0.00331; grad/pseudo_std16_train:  6.47493; grad/diff16_train:  26509.32227; grad/cos16_train:  0.89129; grad/true_mag17_train:  15.72111; grad/pseudo_mag17_train:  28130.45840; grad/true_std17_train:  0.00384; grad/pseudo_std17_train:  6.86761; grad/diff17_train:  28116.46035; grad/cos17_train:  0.88273; grad_train:  1767.61560; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00008; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:25:22,269][trainer][INFO] - Step 270:
[2025-04-24 22:25:22,269][trainer][INFO] - loss/edit_train:  6.47374; loss/loc_train:  0.09886; edit/acc_train:  0.02533; edit/log_prob_train: -6.47374; edit/prob_train:  0.35738; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.65932; perplexity/pre_train:  38.83504; nll/post_train:  3.80907; perplexity/post_train:  45.10852; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.22986; loss/total_train:  0.74623; loss/total_edit_train:  0.74623; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.39535; grad/pseudo_mag0_train:  19026.77607; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  4.64450; grad/diff0_train:  19023.58145; grad/cos0_train:  0.59204; grad/true_mag1_train:  8.53440; grad/pseudo_mag1_train:  18926.56367; grad/true_std1_train:  0.00208; grad/pseudo_std1_train:  4.61939; grad/diff1_train:  18921.12510; grad/cos1_train:  0.62983; grad/true_mag2_train:  8.89646; grad/pseudo_mag2_train:  19346.28174; grad/true_std2_train:  0.00217; grad/pseudo_std2_train:  4.71163; grad/diff2_train:  19340.50283; grad/cos2_train:  0.63285; grad/true_mag3_train:  5.71864; grad/pseudo_mag3_train:  18657.11895; grad/true_std3_train:  0.00140; grad/pseudo_std3_train:  4.55447; grad/diff3_train:  18653.80234; grad/cos3_train:  0.58041; grad/true_mag4_train:  10.29168; grad/pseudo_mag4_train:  18133.18447; grad/true_std4_train:  0.00251; grad/pseudo_std4_train:  4.42646; grad/diff4_train:  18126.55557; grad/cos4_train:  0.63923; grad/true_mag5_train:  11.42121; grad/pseudo_mag5_train:  18408.22373; grad/true_std5_train:  0.00279; grad/pseudo_std5_train:  4.48678; grad/diff5_train:  18401.00010; grad/cos5_train:  0.61638; grad/true_mag6_train:  6.40903; grad/pseudo_mag6_train:  19219.07207; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.69190; grad/diff6_train:  19214.82695; grad/cos6_train:  0.66005; grad/true_mag7_train:  11.87930; grad/pseudo_mag7_train:  18567.16055; grad/true_std7_train:  0.00290; grad/pseudo_std7_train:  4.53273; grad/diff7_train:  18558.55361; grad/cos7_train:  0.71942; grad/true_mag8_train:  15.04409; grad/pseudo_mag8_train:  19009.78633; grad/true_std8_train:  0.00367; grad/pseudo_std8_train:  4.63723; grad/diff8_train:  18999.18662; grad/cos8_train:  0.69084; grad/true_mag9_train:  8.76378; grad/pseudo_mag9_train:  20394.63428; grad/true_std9_train:  0.00214; grad/pseudo_std9_train:  4.97909; grad/diff9_train:  20387.62324; grad/cos9_train:  0.79592; grad/true_mag10_train:  12.47082; grad/pseudo_mag10_train:  20428.19297; grad/true_std10_train:  0.00304; grad/pseudo_std10_train:  4.98725; grad/diff10_train:  20417.97969; grad/cos10_train:  0.81392; grad/true_mag11_train:  16.16492; grad/pseudo_mag11_train:  20719.95215; grad/true_std11_train:  0.00395; grad/pseudo_std11_train:  5.05689; grad/diff11_train:  20706.91064; grad/cos11_train:  0.79745; grad/true_mag12_train:  10.10915; grad/pseudo_mag12_train:  22310.32783; grad/true_std12_train:  0.00247; grad/pseudo_std12_train:  5.44683; grad/diff12_train:  22301.53662; grad/cos12_train:  0.86529; grad/true_mag13_train:  12.32922; grad/pseudo_mag13_train:  21873.25586; grad/true_std13_train:  0.00301; grad/pseudo_std13_train:  5.34011; grad/diff13_train:  21862.47480; grad/cos13_train:  0.86916; grad/true_mag14_train:  14.74570; grad/pseudo_mag14_train:  22317.00713; grad/true_std14_train:  0.00360; grad/pseudo_std14_train:  5.44776; grad/diff14_train:  22304.28682; grad/cos14_train:  0.85271; grad/true_mag15_train:  10.27532; grad/pseudo_mag15_train:  23134.96025; grad/true_std15_train:  0.00251; grad/pseudo_std15_train:  5.64817; grad/diff15_train:  23125.67402; grad/cos15_train:  0.90162; grad/true_mag16_train:  11.84954; grad/pseudo_mag16_train:  22963.95977; grad/true_std16_train:  0.00289; grad/pseudo_std16_train:  5.60642; grad/diff16_train:  22953.38760; grad/cos16_train:  0.88737; grad/true_mag17_train:  13.37767; grad/pseudo_mag17_train:  23672.59678; grad/true_std17_train:  0.00327; grad/pseudo_std17_train:  5.77928; grad/diff17_train:  23660.71152; grad/cos17_train:  0.88033; grad_train:  1174.65198; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00008; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:25:25,639][trainer][INFO] - Step 280:
[2025-04-24 22:25:25,640][trainer][INFO] - loss/edit_train:  9.18355; loss/loc_train:  0.08151; edit/acc_train:  0.02857; edit/log_prob_train: -9.18355; edit/prob_train:  0.23097; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.85321; perplexity/pre_train:  47.14412; nll/post_train:  3.97460; perplexity/post_train:  53.22877; n_tokens/pre_train:  6.30000; n_tokens/post_train:  6.30000; time/edit_train:  0.18543; loss/total_train:  0.99986; loss/total_edit_train:  0.99986; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.96010; grad/pseudo_mag0_train:  18588.94980; grad/true_std0_train:  0.00121; grad/pseudo_std0_train:  4.53752; grad/diff0_train:  18585.97139; grad/cos0_train:  0.60089; grad/true_mag1_train:  8.03835; grad/pseudo_mag1_train:  17888.19082; grad/true_std1_train:  0.00196; grad/pseudo_std1_train:  4.36586; grad/diff1_train:  17883.04385; grad/cos1_train:  0.64114; grad/true_mag2_train:  8.24910; grad/pseudo_mag2_train:  18421.44717; grad/true_std2_train:  0.00201; grad/pseudo_std2_train:  4.48344; grad/diff2_train:  18416.18896; grad/cos2_train:  0.63560; grad/true_mag3_train:  5.41990; grad/pseudo_mag3_train:  18534.80439; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.52457; grad/diff3_train:  18531.58271; grad/cos3_train:  0.59467; grad/true_mag4_train:  9.77740; grad/pseudo_mag4_train:  17401.61748; grad/true_std4_train:  0.00239; grad/pseudo_std4_train:  4.24774; grad/diff4_train:  17395.41309; grad/cos4_train:  0.63844; grad/true_mag5_train:  10.20123; grad/pseudo_mag5_train:  17610.33047; grad/true_std5_train:  0.00249; grad/pseudo_std5_train:  4.29031; grad/diff5_train:  17603.86914; grad/cos5_train:  0.63235; grad/true_mag6_train:  6.01759; grad/pseudo_mag6_train:  18104.49609; grad/true_std6_train:  0.00147; grad/pseudo_std6_train:  4.41985; grad/diff6_train:  18100.50684; grad/cos6_train:  0.66431; grad/true_mag7_train:  10.68660; grad/pseudo_mag7_train:  16687.78086; grad/true_std7_train:  0.00261; grad/pseudo_std7_train:  4.07396; grad/diff7_train:  16680.02627; grad/cos7_train:  0.72586; grad/true_mag8_train:  13.30974; grad/pseudo_mag8_train:  17073.53213; grad/true_std8_train:  0.00325; grad/pseudo_std8_train:  4.16375; grad/diff8_train:  17064.14199; grad/cos8_train:  0.70109; grad/true_mag9_train:  7.69266; grad/pseudo_mag9_train:  18548.03887; grad/true_std9_train:  0.00188; grad/pseudo_std9_train:  4.52827; grad/diff9_train:  18541.82695; grad/cos9_train:  0.80513; grad/true_mag10_train:  11.10002; grad/pseudo_mag10_train:  18329.41279; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  4.47482; grad/diff10_train:  18320.30557; grad/cos10_train:  0.81779; grad/true_mag11_train:  13.77494; grad/pseudo_mag11_train:  18454.89502; grad/true_std11_train:  0.00336; grad/pseudo_std11_train:  4.50368; grad/diff11_train:  18443.75508; grad/cos11_train:  0.80376; grad/true_mag12_train:  8.71955; grad/pseudo_mag12_train:  19011.93750; grad/true_std12_train:  0.00213; grad/pseudo_std12_train:  4.64156; grad/diff12_train:  19004.40322; grad/cos12_train:  0.86120; grad/true_mag13_train:  10.89599; grad/pseudo_mag13_train:  18883.20205; grad/true_std13_train:  0.00266; grad/pseudo_std13_train:  4.61012; grad/diff13_train:  18873.73701; grad/cos13_train:  0.86513; grad/true_mag14_train:  13.15840; grad/pseudo_mag14_train:  19469.81318; grad/true_std14_train:  0.00321; grad/pseudo_std14_train:  4.75252; grad/diff14_train:  19458.62793; grad/cos14_train:  0.84407; grad/true_mag15_train:  8.76994; grad/pseudo_mag15_train:  19490.67715; grad/true_std15_train:  0.00214; grad/pseudo_std15_train:  4.75845; grad/diff15_train:  19482.79180; grad/cos15_train:  0.89686; grad/true_mag16_train:  10.13902; grad/pseudo_mag16_train:  19396.93975; grad/true_std16_train:  0.00248; grad/pseudo_std16_train:  4.73556; grad/diff16_train:  19387.93945; grad/cos16_train:  0.88350; grad/true_mag17_train:  11.74599; grad/pseudo_mag17_train:  20353.15166; grad/true_std17_train:  0.00287; grad/pseudo_std17_train:  4.96884; grad/diff17_train:  20342.85508; grad/cos17_train:  0.86981; grad_train:  1166.17432; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:25:28,820][trainer][INFO] - Step 290:
[2025-04-24 22:25:28,821][trainer][INFO] - loss/edit_train:  6.04209; loss/loc_train:  0.07735; edit/acc_train:  0.05678; edit/log_prob_train: -6.04209; edit/prob_train:  0.36324; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.59004; perplexity/pre_train:  36.23550; nll/post_train:  3.60128; perplexity/post_train:  36.64502; n_tokens/pre_train:  8.40000; n_tokens/post_train:  8.40000; time/edit_train:  0.17325; loss/total_train:  0.68156; loss/total_edit_train:  0.68156; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.45978; grad/pseudo_mag0_train:  17536.04902; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  4.27984; grad/diff0_train:  17533.00000; grad/cos0_train:  0.56411; grad/true_mag1_train:  8.83731; grad/pseudo_mag1_train:  18768.99482; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.57988; grad/diff1_train:  18763.79414; grad/cos1_train:  0.59331; grad/true_mag2_train:  9.00047; grad/pseudo_mag2_train:  19263.54453; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  4.68799; grad/diff2_train:  19258.14424; grad/cos2_train:  0.59632; grad/true_mag3_train:  5.86774; grad/pseudo_mag3_train:  17028.04063; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.15626; grad/diff3_train:  17024.77236; grad/cos3_train:  0.56205; grad/true_mag4_train:  10.74350; grad/pseudo_mag4_train:  17539.69424; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.28119; grad/diff4_train:  17533.05049; grad/cos4_train:  0.62120; grad/true_mag5_train:  11.65642; grad/pseudo_mag5_train:  18231.40010; grad/true_std5_train:  0.00285; grad/pseudo_std5_train:  4.44177; grad/diff5_train:  18224.34834; grad/cos5_train:  0.60206; grad/true_mag6_train:  6.80888; grad/pseudo_mag6_train:  18284.12959; grad/true_std6_train:  0.00166; grad/pseudo_std6_train:  4.46357; grad/diff6_train:  18279.74355; grad/cos6_train:  0.64569; grad/true_mag7_train:  12.68609; grad/pseudo_mag7_train:  18941.49297; grad/true_std7_train:  0.00310; grad/pseudo_std7_train:  4.62407; grad/diff7_train:  18932.43115; grad/cos7_train:  0.71560; grad/true_mag8_train:  16.30123; grad/pseudo_mag8_train:  19623.38975; grad/true_std8_train:  0.00398; grad/pseudo_std8_train:  4.78583; grad/diff8_train:  19612.06748; grad/cos8_train:  0.68750; grad/true_mag9_train:  9.88516; grad/pseudo_mag9_train:  23012.55752; grad/true_std9_train:  0.00241; grad/pseudo_std9_train:  5.61821; grad/diff9_train:  23004.67227; grad/cos9_train:  0.79926; grad/true_mag10_train:  13.45402; grad/pseudo_mag10_train:  22326.62383; grad/true_std10_train:  0.00328; grad/pseudo_std10_train:  5.45071; grad/diff10_train:  22315.48584; grad/cos10_train:  0.82475; grad/true_mag11_train:  17.43603; grad/pseudo_mag11_train:  22562.08926; grad/true_std11_train:  0.00426; grad/pseudo_std11_train:  5.50645; grad/diff11_train:  22547.79648; grad/cos11_train:  0.81576; grad/true_mag12_train:  10.88740; grad/pseudo_mag12_train:  24138.51055; grad/true_std12_train:  0.00266; grad/pseudo_std12_train:  5.89315; grad/diff12_train:  24129.01797; grad/cos12_train:  0.87029; grad/true_mag13_train:  13.24371; grad/pseudo_mag13_train:  23483.67344; grad/true_std13_train:  0.00323; grad/pseudo_std13_train:  5.73328; grad/diff13_train:  23472.04219; grad/cos13_train:  0.87524; grad/true_mag14_train:  15.91787; grad/pseudo_mag14_train:  24033.99766; grad/true_std14_train:  0.00389; grad/pseudo_std14_train:  5.86688; grad/diff14_train:  24020.25088; grad/cos14_train:  0.85815; grad/true_mag15_train:  11.04971; grad/pseudo_mag15_train:  24806.34238; grad/true_std15_train:  0.00270; grad/pseudo_std15_train:  6.05620; grad/diff15_train:  24796.35645; grad/cos15_train:  0.90260; grad/true_mag16_train:  12.67554; grad/pseudo_mag16_train:  24514.98496; grad/true_std16_train:  0.00309; grad/pseudo_std16_train:  5.98506; grad/diff16_train:  24503.65273; grad/cos16_train:  0.89253; grad/true_mag17_train:  14.35674; grad/pseudo_mag17_train:  25767.57168; grad/true_std17_train:  0.00351; grad/pseudo_std17_train:  6.29075; grad/diff17_train:  25754.70312; grad/cos17_train:  0.88949; grad_train:  655.08118; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:25:32,435][trainer][INFO] - Step 300:
[2025-04-24 22:25:32,435][trainer][INFO] - loss/edit_train:  8.20543; loss/loc_train:  0.08236; edit/acc_train:  0.02000; edit/log_prob_train: -8.20543; edit/prob_train:  0.22971; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  1.96768; perplexity/pre_train:  7.15409; nll/post_train:  2.15289; perplexity/post_train:  8.60968; n_tokens/pre_train:  15.70000; n_tokens/post_train:  15.70000; time/edit_train:  0.21489; loss/total_train:  0.90291; loss/total_edit_train:  0.90291; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.16353; grad/pseudo_mag0_train:  18381.84775; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.48678; grad/diff0_train:  18378.77803; grad/cos0_train:  0.59285; grad/true_mag1_train:  8.45162; grad/pseudo_mag1_train:  18391.63076; grad/true_std1_train:  0.00206; grad/pseudo_std1_train:  4.48872; grad/diff1_train:  18386.20605; grad/cos1_train:  0.63830; grad/true_mag2_train:  8.96665; grad/pseudo_mag2_train:  19060.65020; grad/true_std2_train:  0.00219; grad/pseudo_std2_train:  4.64064; grad/diff2_train:  19054.91514; grad/cos2_train:  0.62945; grad/true_mag3_train:  5.68471; grad/pseudo_mag3_train:  17828.49541; grad/true_std3_train:  0.00139; grad/pseudo_std3_train:  4.35210; grad/diff3_train:  17825.25664; grad/cos3_train:  0.57138; grad/true_mag4_train:  10.21913; grad/pseudo_mag4_train:  17494.48311; grad/true_std4_train:  0.00249; grad/pseudo_std4_train:  4.27043; grad/diff4_train:  17487.99414; grad/cos4_train:  0.63344; grad/true_mag5_train:  11.29774; grad/pseudo_mag5_train:  18179.58252; grad/true_std5_train:  0.00276; grad/pseudo_std5_train:  4.43035; grad/diff5_train:  18172.56309; grad/cos5_train:  0.61588; grad/true_mag6_train:  6.25500; grad/pseudo_mag6_train:  17836.45410; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.35430; grad/diff6_train:  17832.37354; grad/cos6_train:  0.65354; grad/true_mag7_train:  11.51902; grad/pseudo_mag7_train:  17692.63408; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  4.31922; grad/diff7_train:  17684.32129; grad/cos7_train:  0.72016; grad/true_mag8_train:  15.36937; grad/pseudo_mag8_train:  18520.71953; grad/true_std8_train:  0.00375; grad/pseudo_std8_train:  4.51723; grad/diff8_train:  18509.94805; grad/cos8_train:  0.69681; grad/true_mag9_train:  8.48301; grad/pseudo_mag9_train:  20216.00225; grad/true_std9_train:  0.00207; grad/pseudo_std9_train:  4.93546; grad/diff9_train:  20209.18779; grad/cos9_train:  0.79992; grad/true_mag10_train:  12.23991; grad/pseudo_mag10_train:  20293.57373; grad/true_std10_train:  0.00299; grad/pseudo_std10_train:  4.95428; grad/diff10_train:  20283.59004; grad/cos10_train:  0.81062; grad/true_mag11_train:  15.69280; grad/pseudo_mag11_train:  20553.87822; grad/true_std11_train:  0.00383; grad/pseudo_std11_train:  5.01601; grad/diff11_train:  20541.26475; grad/cos11_train:  0.80204; grad/true_mag12_train:  9.74971; grad/pseudo_mag12_train:  20980.02266; grad/true_std12_train:  0.00238; grad/pseudo_std12_train:  5.12204; grad/diff12_train:  20971.63750; grad/cos12_train:  0.85553; grad/true_mag13_train:  12.29882; grad/pseudo_mag13_train:  21080.30029; grad/true_std13_train:  0.00300; grad/pseudo_std13_train:  5.14641; grad/diff13_train:  21069.81045; grad/cos13_train:  0.84886; grad/true_mag14_train:  14.98875; grad/pseudo_mag14_train:  21947.98818; grad/true_std14_train:  0.00366; grad/pseudo_std14_train:  5.35754; grad/diff14_train:  21935.43936; grad/cos14_train:  0.83393; grad/true_mag15_train:  9.75445; grad/pseudo_mag15_train:  21450.96279; grad/true_std15_train:  0.00238; grad/pseudo_std15_train:  5.23702; grad/diff15_train:  21442.32197; grad/cos15_train:  0.88265; grad/true_mag16_train:  11.35460; grad/pseudo_mag16_train:  21450.49746; grad/true_std16_train:  0.00277; grad/pseudo_std16_train:  5.23688; grad/diff16_train:  21440.50830; grad/cos16_train:  0.87581; grad/true_mag17_train:  14.27768; grad/pseudo_mag17_train:  23071.67168; grad/true_std17_train:  0.00349; grad/pseudo_std17_train:  5.63242; grad/diff17_train:  23059.88271; grad/cos17_train:  0.84797; grad_train:  898.93683; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:25:50,372][trainer][INFO] - Step 300:
[2025-04-24 22:25:50,372][trainer][INFO] - loss/edit_val:  8.61735; loss/loc_val:  0.15151; edit/acc_val:  0.01606; edit/log_prob_val: -8.61735; edit/prob_val:  0.24402; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.58953; perplexity/post_val:  98.44772; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10557; loss/total_val:  1.01325; loss/total_edit_val:  1.01325; memory/alloc_max_val:  42204623872.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  17.93170; eval_time/average:  0.17932
[2025-04-24 22:25:50,375][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:25:50,376][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:26:44,364][trainer][INFO] - Write complete.
[2025-04-24 22:26:47,537][trainer][INFO] - Step 310:
[2025-04-24 22:26:47,537][trainer][INFO] - loss/edit_train:  8.37590; loss/loc_train:  0.08295; edit/acc_train:  0.01813; edit/log_prob_train: -8.37590; edit/prob_train:  0.29538; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.71508; perplexity/pre_train:  41.06169; nll/post_train:  3.78524; perplexity/post_train:  44.04609; n_tokens/pre_train:  5.90000; n_tokens/post_train:  5.90000; time/edit_train:  0.17044; loss/total_train:  0.92054; loss/total_edit_train:  0.92054; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.56664; grad/pseudo_mag0_train:  19129.28525; grad/true_std0_train:  0.00136; grad/pseudo_std0_train:  4.66946; grad/diff0_train:  19125.99111; grad/cos0_train:  0.59286; grad/true_mag1_train:  9.05968; grad/pseudo_mag1_train:  19511.66387; grad/true_std1_train:  0.00221; grad/pseudo_std1_train:  4.76198; grad/diff1_train:  19505.95254; grad/cos1_train:  0.62898; grad/true_mag2_train:  9.13534; grad/pseudo_mag2_train:  19458.58535; grad/true_std2_train:  0.00223; grad/pseudo_std2_train:  4.73873; grad/diff2_train:  19452.70078; grad/cos2_train:  0.64328; grad/true_mag3_train:  6.00034; grad/pseudo_mag3_train:  18613.40508; grad/true_std3_train:  0.00146; grad/pseudo_std3_train:  4.54383; grad/diff3_train:  18609.92314; grad/cos3_train:  0.58096; grad/true_mag4_train:  10.54557; grad/pseudo_mag4_train:  18145.44688; grad/true_std4_train:  0.00257; grad/pseudo_std4_train:  4.42935; grad/diff4_train:  18138.65732; grad/cos4_train:  0.64424; grad/true_mag5_train:  11.43873; grad/pseudo_mag5_train:  18472.90518; grad/true_std5_train:  0.00279; grad/pseudo_std5_train:  4.50172; grad/diff5_train:  18465.61504; grad/cos5_train:  0.63609; grad/true_mag6_train:  6.43011; grad/pseudo_mag6_train:  18343.73564; grad/true_std6_train:  0.00157; grad/pseudo_std6_train:  4.47826; grad/diff6_train:  18339.47783; grad/cos6_train:  0.66181; grad/true_mag7_train:  11.60194; grad/pseudo_mag7_train:  17778.41025; grad/true_std7_train:  0.00283; grad/pseudo_std7_train:  4.34022; grad/diff7_train:  17769.96260; grad/cos7_train:  0.72770; grad/true_mag8_train:  14.82140; grad/pseudo_mag8_train:  18407.60313; grad/true_std8_train:  0.00362; grad/pseudo_std8_train:  4.48916; grad/diff8_train:  18397.20186; grad/cos8_train:  0.70018; grad/true_mag9_train:  8.28060; grad/pseudo_mag9_train:  19139.29385; grad/true_std9_train:  0.00202; grad/pseudo_std9_train:  4.67262; grad/diff9_train:  19132.60938; grad/cos9_train:  0.80649; grad/true_mag10_train:  12.23159; grad/pseudo_mag10_train:  19342.11211; grad/true_std10_train:  0.00299; grad/pseudo_std10_train:  4.72209; grad/diff10_train:  19332.11328; grad/cos10_train:  0.81727; grad/true_mag11_train:  15.75388; grad/pseudo_mag11_train:  19739.91074; grad/true_std11_train:  0.00385; grad/pseudo_std11_train:  4.81737; grad/diff11_train:  19727.22012; grad/cos11_train:  0.80458; grad/true_mag12_train:  9.73462; grad/pseudo_mag12_train:  20838.96406; grad/true_std12_train:  0.00238; grad/pseudo_std12_train:  5.08762; grad/diff12_train:  20830.51562; grad/cos12_train:  0.86746; grad/true_mag13_train:  11.96861; grad/pseudo_mag13_train:  20560.21914; grad/true_std13_train:  0.00292; grad/pseudo_std13_train:  5.01955; grad/diff13_train:  20549.76465; grad/cos13_train:  0.87293; grad/true_mag14_train:  14.49303; grad/pseudo_mag14_train:  21241.69062; grad/true_std14_train:  0.00354; grad/pseudo_std14_train:  5.18524; grad/diff14_train:  21229.27227; grad/cos14_train:  0.85596; grad/true_mag15_train:  10.00249; grad/pseudo_mag15_train:  22050.62031; grad/true_std15_train:  0.00244; grad/pseudo_std15_train:  5.38343; grad/diff15_train:  22041.57676; grad/cos15_train:  0.90359; grad/true_mag16_train:  11.54575; grad/pseudo_mag16_train:  21875.85117; grad/true_std16_train:  0.00282; grad/pseudo_std16_train:  5.34075; grad/diff16_train:  21865.54023; grad/cos16_train:  0.89265; grad/true_mag17_train:  13.28756; grad/pseudo_mag17_train:  22971.06543; grad/true_std17_train:  0.00324; grad/pseudo_std17_train:  5.60802; grad/diff17_train:  22959.23984; grad/cos17_train:  0.88879; grad_train:  1096.60742; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00008; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:26:51,110][trainer][INFO] - Step 320:
[2025-04-24 22:26:51,111][trainer][INFO] - loss/edit_train:  8.97774; loss/loc_train:  0.07613; edit/acc_train:  0.05000; edit/log_prob_train: -8.97774; edit/prob_train:  0.27141; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.56819; perplexity/pre_train:  96.36956; nll/post_train:  4.61859; perplexity/post_train:  101.35081; n_tokens/pre_train:  6.40000; n_tokens/post_train:  6.40000; time/edit_train:  0.20575; loss/total_train:  0.97390; loss/total_edit_train:  0.97390; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.50595; grad/pseudo_mag0_train:  22137.32910; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  5.40286; grad/diff0_train:  22133.89277; grad/cos0_train:  0.62184; grad/true_mag1_train:  9.08690; grad/pseudo_mag1_train:  21008.51641; grad/true_std1_train:  0.00222; grad/pseudo_std1_train:  5.12628; grad/diff1_train:  21002.65508; grad/cos1_train:  0.64278; grad/true_mag2_train:  9.17896; grad/pseudo_mag2_train:  20579.66465; grad/true_std2_train:  0.00224; grad/pseudo_std2_train:  5.00987; grad/diff2_train:  20573.69121; grad/cos2_train:  0.64569; grad/true_mag3_train:  5.88027; grad/pseudo_mag3_train:  21159.69287; grad/true_std3_train:  0.00144; grad/pseudo_std3_train:  5.16469; grad/diff3_train:  21156.17822; grad/cos3_train:  0.59644; grad/true_mag4_train:  10.24578; grad/pseudo_mag4_train:  18939.18506; grad/true_std4_train:  0.00250; grad/pseudo_std4_train:  4.62256; grad/diff4_train:  18932.63809; grad/cos4_train:  0.63881; grad/true_mag5_train:  10.95006; grad/pseudo_mag5_train:  18815.15098; grad/true_std5_train:  0.00267; grad/pseudo_std5_train:  4.58362; grad/diff5_train:  18808.22061; grad/cos5_train:  0.63052; grad/true_mag6_train:  5.99746; grad/pseudo_mag6_train:  18757.99092; grad/true_std6_train:  0.00146; grad/pseudo_std6_train:  4.57907; grad/diff6_train:  18753.95645; grad/cos6_train:  0.67256; grad/true_mag7_train:  10.80969; grad/pseudo_mag7_train:  16953.43340; grad/true_std7_train:  0.00264; grad/pseudo_std7_train:  4.13866; grad/diff7_train:  16945.68984; grad/cos7_train:  0.71635; grad/true_mag8_train:  13.32410; grad/pseudo_mag8_train:  17373.55068; grad/true_std8_train:  0.00325; grad/pseudo_std8_train:  4.23589; grad/diff8_train:  17364.48867; grad/cos8_train:  0.67845; grad/true_mag9_train:  7.43392; grad/pseudo_mag9_train:  17467.15107; grad/true_std9_train:  0.00181; grad/pseudo_std9_train:  4.26431; grad/diff9_train:  17461.23760; grad/cos9_train:  0.79294; grad/true_mag10_train:  11.06202; grad/pseudo_mag10_train:  17517.31514; grad/true_std10_train:  0.00270; grad/pseudo_std10_train:  4.27646; grad/diff10_train:  17508.42412; grad/cos10_train:  0.80187; grad/true_mag11_train:  14.03132; grad/pseudo_mag11_train:  17601.20635; grad/true_std11_train:  0.00343; grad/pseudo_std11_train:  4.29462; grad/diff11_train:  17590.23496; grad/cos11_train:  0.78176; grad/true_mag12_train:  8.12542; grad/pseudo_mag12_train:  17241.00312; grad/true_std12_train:  0.00198; grad/pseudo_std12_train:  4.20920; grad/diff12_train:  17234.09541; grad/cos12_train:  0.84658; grad/true_mag13_train:  10.57291; grad/pseudo_mag13_train:  17345.92676; grad/true_std13_train:  0.00258; grad/pseudo_std13_train:  4.23477; grad/diff13_train:  17336.97559; grad/cos13_train:  0.84462; grad/true_mag14_train:  12.76510; grad/pseudo_mag14_train:  17904.88564; grad/true_std14_train:  0.00312; grad/pseudo_std14_train:  4.37037; grad/diff14_train:  17894.42480; grad/cos14_train:  0.81654; grad/true_mag15_train:  8.18704; grad/pseudo_mag15_train:  17807.85000; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  4.34758; grad/diff15_train:  17800.55049; grad/cos15_train:  0.88821; grad/true_mag16_train:  9.94677; grad/pseudo_mag16_train:  18108.96074; grad/true_std16_train:  0.00243; grad/pseudo_std16_train:  4.42109; grad/diff16_train:  18100.31621; grad/cos16_train:  0.86542; grad/true_mag17_train:  11.63150; grad/pseudo_mag17_train:  19466.06445; grad/true_std17_train:  0.00284; grad/pseudo_std17_train:  4.75227; grad/diff17_train:  19456.02656; grad/cos17_train:  0.85741; grad_train:  989.02124; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:26:54,318][trainer][INFO] - Step 330:
[2025-04-24 22:26:54,318][trainer][INFO] - loss/edit_train:  8.49217; loss/loc_train:  0.12258; edit/acc_train:  0.05309; edit/log_prob_train: -8.49217; edit/prob_train:  0.25163; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.08765; perplexity/pre_train:  59.59959; nll/post_train:  4.37789; perplexity/post_train:  79.67001; n_tokens/pre_train:  8.40000; n_tokens/post_train:  8.40000; time/edit_train:  0.17959; loss/total_train:  0.97179; loss/total_edit_train:  0.97179; memory/alloc_max_train:  42204623872.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.78813; grad/pseudo_mag0_train:  21087.33945; grad/true_std0_train:  0.00141; grad/pseudo_std0_train:  5.14660; grad/diff0_train:  21083.93584; grad/cos0_train:  0.59736; grad/true_mag1_train:  9.25073; grad/pseudo_mag1_train:  20681.28281; grad/true_std1_train:  0.00226; grad/pseudo_std1_train:  5.04634; grad/diff1_train:  20675.41055; grad/cos1_train:  0.63892; grad/true_mag2_train:  9.67221; grad/pseudo_mag2_train:  21208.60352; grad/true_std2_train:  0.00236; grad/pseudo_std2_train:  5.16088; grad/diff2_train:  21202.42422; grad/cos2_train:  0.63367; grad/true_mag3_train:  6.17071; grad/pseudo_mag3_train:  19961.06426; grad/true_std3_train:  0.00151; grad/pseudo_std3_train:  4.87225; grad/diff3_train:  19957.48545; grad/cos3_train:  0.58734; grad/true_mag4_train:  11.19719; grad/pseudo_mag4_train:  19420.51992; grad/true_std4_train:  0.00273; grad/pseudo_std4_train:  4.74036; grad/diff4_train:  19413.32285; grad/cos4_train:  0.64621; grad/true_mag5_train:  12.30540; grad/pseudo_mag5_train:  19910.94004; grad/true_std5_train:  0.00300; grad/pseudo_std5_train:  4.85070; grad/diff5_train:  19903.03848; grad/cos5_train:  0.63545; grad/true_mag6_train:  7.19403; grad/pseudo_mag6_train:  20905.46436; grad/true_std6_train:  0.00176; grad/pseudo_std6_train:  5.10346; grad/diff6_train:  20900.70439; grad/cos6_train:  0.66542; grad/true_mag7_train:  12.95743; grad/pseudo_mag7_train:  20241.74307; grad/true_std7_train:  0.00316; grad/pseudo_std7_train:  4.94141; grad/diff7_train:  20232.32773; grad/cos7_train:  0.72466; grad/true_mag8_train:  16.26629; grad/pseudo_mag8_train:  20656.70361; grad/true_std8_train:  0.00397; grad/pseudo_std8_train:  5.03751; grad/diff8_train:  20645.22676; grad/cos8_train:  0.69064; grad/true_mag9_train:  9.48751; grad/pseudo_mag9_train:  23000.59512; grad/true_std9_train:  0.00232; grad/pseudo_std9_train:  5.61527; grad/diff9_train:  22992.92598; grad/cos9_train:  0.80171; grad/true_mag10_train:  13.49823; grad/pseudo_mag10_train:  22350.25449; grad/true_std10_train:  0.00330; grad/pseudo_std10_train:  5.45642; grad/diff10_train:  22339.11270; grad/cos10_train:  0.81526; grad/true_mag11_train:  17.88399; grad/pseudo_mag11_train:  22607.07051; grad/true_std11_train:  0.00437; grad/pseudo_std11_train:  5.51701; grad/diff11_train:  22592.81191; grad/cos11_train:  0.77432; grad/true_mag12_train:  10.99168; grad/pseudo_mag12_train:  24397.62256; grad/true_std12_train:  0.00268; grad/pseudo_std12_train:  5.95640; grad/diff12_train:  24388.02705; grad/cos12_train:  0.86233; grad/true_mag13_train:  13.52418; grad/pseudo_mag13_train:  23803.37715; grad/true_std13_train:  0.00330; grad/pseudo_std13_train:  5.81128; grad/diff13_train:  23791.54551; grad/cos13_train:  0.86340; grad/true_mag14_train:  16.29185; grad/pseudo_mag14_train:  24286.41738; grad/true_std14_train:  0.00398; grad/pseudo_std14_train:  5.92825; grad/diff14_train:  24272.56484; grad/cos14_train:  0.82212; grad/true_mag15_train:  11.00618; grad/pseudo_mag15_train:  24655.91445; grad/true_std15_train:  0.00269; grad/pseudo_std15_train:  6.01947; grad/diff15_train:  24645.95859; grad/cos15_train:  0.89707; grad/true_mag16_train:  12.72775; grad/pseudo_mag16_train:  24511.05508; grad/true_std16_train:  0.00311; grad/pseudo_std16_train:  5.98410; grad/diff16_train:  24499.69053; grad/cos16_train:  0.88173; grad/true_mag17_train:  14.58199; grad/pseudo_mag17_train:  25438.37783; grad/true_std17_train:  0.00356; grad/pseudo_std17_train:  6.21027; grad/diff17_train:  25425.50762; grad/cos17_train:  0.86227; grad_train:  948.29901; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:26:57,985][trainer][INFO] - Step 340:
[2025-04-24 22:26:57,986][trainer][INFO] - loss/edit_train:  6.20348; loss/loc_train:  0.07419; edit/acc_train:  0.02778; edit/log_prob_train: -6.20348; edit/prob_train:  0.27508; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.11803; perplexity/pre_train:  61.43800; nll/post_train:  4.21104; perplexity/post_train:  67.42643; n_tokens/pre_train:  6.00000; n_tokens/post_train:  6.00000; time/edit_train:  0.21940; loss/total_train:  0.69454; loss/total_edit_train:  0.69454; memory/alloc_max_train:  42206995148.80000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  7.13904; grad/pseudo_mag0_train:  21393.23711; grad/true_std0_train:  0.00174; grad/pseudo_std0_train:  5.22160; grad/diff0_train:  21389.20068; grad/cos0_train:  0.57888; grad/true_mag1_train:  10.69480; grad/pseudo_mag1_train:  22493.88057; grad/true_std1_train:  0.00261; grad/pseudo_std1_train:  5.48902; grad/diff1_train:  22487.28516; grad/cos1_train:  0.62233; grad/true_mag2_train:  10.73230; grad/pseudo_mag2_train:  23477.44980; grad/true_std2_train:  0.00262; grad/pseudo_std2_train:  5.71274; grad/diff2_train:  23470.69785; grad/cos2_train:  0.61497; grad/true_mag3_train:  6.56584; grad/pseudo_mag3_train:  19872.95342; grad/true_std3_train:  0.00160; grad/pseudo_std3_train:  4.85098; grad/diff3_train:  19869.15283; grad/cos3_train:  0.57744; grad/true_mag4_train:  11.73648; grad/pseudo_mag4_train:  19924.35420; grad/true_std4_train:  0.00287; grad/pseudo_std4_train:  4.86323; grad/diff4_train:  19916.84238; grad/cos4_train:  0.63893; grad/true_mag5_train:  13.19347; grad/pseudo_mag5_train:  20797.61162; grad/true_std5_train:  0.00322; grad/pseudo_std5_train:  5.06582; grad/diff5_train:  20789.32705; grad/cos5_train:  0.61220; grad/true_mag6_train:  7.51298; grad/pseudo_mag6_train:  20459.69043; grad/true_std6_train:  0.00183; grad/pseudo_std6_train:  4.99473; grad/diff6_train:  20454.76299; grad/cos6_train:  0.65856; grad/true_mag7_train:  13.54764; grad/pseudo_mag7_train:  20636.78613; grad/true_std7_train:  0.00331; grad/pseudo_std7_train:  5.03790; grad/diff7_train:  20627.01768; grad/cos7_train:  0.71989; grad/true_mag8_train:  16.67590; grad/pseudo_mag8_train:  21191.21934; grad/true_std8_train:  0.00407; grad/pseudo_std8_train:  5.16743; grad/diff8_train:  21179.42305; grad/cos8_train:  0.69424; grad/true_mag9_train:  9.54638; grad/pseudo_mag9_train:  21729.43525; grad/true_std9_train:  0.00233; grad/pseudo_std9_train:  5.30494; grad/diff9_train:  21721.77783; grad/cos9_train:  0.80322; grad/true_mag10_train:  13.69808; grad/pseudo_mag10_train:  21608.53691; grad/true_std10_train:  0.00334; grad/pseudo_std10_train:  5.27533; grad/diff10_train:  21597.43848; grad/cos10_train:  0.81429; grad/true_mag11_train:  17.92118; grad/pseudo_mag11_train:  22088.58252; grad/true_std11_train:  0.00438; grad/pseudo_std11_train:  5.39019; grad/diff11_train:  22074.13877; grad/cos11_train:  0.79878; grad/true_mag12_train:  11.26107; grad/pseudo_mag12_train:  23976.25391; grad/true_std12_train:  0.00275; grad/pseudo_std12_train:  5.85355; grad/diff12_train:  23966.48262; grad/cos12_train:  0.86509; grad/true_mag13_train:  13.49493; grad/pseudo_mag13_train:  23478.49277; grad/true_std13_train:  0.00329; grad/pseudo_std13_train:  5.73197; grad/diff13_train:  23466.64717; grad/cos13_train:  0.87420; grad/true_mag14_train:  16.37097; grad/pseudo_mag14_train:  24069.26201; grad/true_std14_train:  0.00400; grad/pseudo_std14_train:  5.87514; grad/diff14_train:  24055.13809; grad/cos14_train:  0.85192; grad/true_mag15_train:  11.51610; grad/pseudo_mag15_train:  25321.10137; grad/true_std15_train:  0.00281; grad/pseudo_std15_train:  6.18186; grad/diff15_train:  25310.72100; grad/cos15_train:  0.90016; grad/true_mag16_train:  13.20375; grad/pseudo_mag16_train:  25197.21270; grad/true_std16_train:  0.00322; grad/pseudo_std16_train:  6.15162; grad/diff16_train:  25185.40205; grad/cos16_train:  0.89116; grad/true_mag17_train:  14.79816; grad/pseudo_mag17_train:  26169.62070; grad/true_std17_train:  0.00361; grad/pseudo_std17_train:  6.38879; grad/diff17_train:  26156.33711; grad/cos17_train:  0.88960; grad_train:  820.36011; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00006; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:27:01,068][trainer][INFO] - Step 350:
[2025-04-24 22:27:01,068][trainer][INFO] - loss/edit_train:  6.15122; loss/loc_train:  0.11901; edit/acc_train:  0.01833; edit/log_prob_train: -6.15122; edit/prob_train:  0.32895; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.45482; perplexity/pre_train:  86.04058; nll/post_train:  4.59710; perplexity/post_train:  99.19605; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.16572; loss/total_train:  0.73413; loss/total_edit_train:  0.73413; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.39001; grad/pseudo_mag0_train:  17816.35742; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  4.34785; grad/diff0_train:  17813.24482; grad/cos0_train:  0.57997; grad/true_mag1_train:  8.88491; grad/pseudo_mag1_train:  18465.74424; grad/true_std1_train:  0.00217; grad/pseudo_std1_train:  4.50560; grad/diff1_train:  18460.24316; grad/cos1_train:  0.61982; grad/true_mag2_train:  9.02118; grad/pseudo_mag2_train:  19706.56816; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  4.78512; grad/diff2_train:  19701.26250; grad/cos2_train:  0.58499; grad/true_mag3_train:  5.86690; grad/pseudo_mag3_train:  17558.17666; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.28548; grad/diff3_train:  17554.82285; grad/cos3_train:  0.57423; grad/true_mag4_train:  10.72419; grad/pseudo_mag4_train:  17643.52012; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.30619; grad/diff4_train:  17636.91846; grad/cos4_train:  0.62086; grad/true_mag5_train:  11.61067; grad/pseudo_mag5_train:  18689.17871; grad/true_std5_train:  0.00283; grad/pseudo_std5_train:  4.54590; grad/diff5_train:  18682.38145; grad/cos5_train:  0.57947; grad/true_mag6_train:  6.47938; grad/pseudo_mag6_train:  17386.53691; grad/true_std6_train:  0.00158; grad/pseudo_std6_train:  4.24436; grad/diff6_train:  17382.27529; grad/cos6_train:  0.65898; grad/true_mag7_train:  12.00704; grad/pseudo_mag7_train:  17644.87588; grad/true_std7_train:  0.00293; grad/pseudo_std7_train:  4.30747; grad/diff7_train:  17636.32441; grad/cos7_train:  0.71071; grad/true_mag8_train:  15.16804; grad/pseudo_mag8_train:  18902.44775; grad/true_std8_train:  0.00370; grad/pseudo_std8_train:  4.60685; grad/diff8_train:  18891.74004; grad/cos8_train:  0.68882; grad/true_mag9_train:  8.73282; grad/pseudo_mag9_train:  20115.90693; grad/true_std9_train:  0.00213; grad/pseudo_std9_train:  4.91099; grad/diff9_train:  20108.90850; grad/cos9_train:  0.79496; grad/true_mag10_train:  12.60380; grad/pseudo_mag10_train:  20064.96543; grad/true_std10_train:  0.00308; grad/pseudo_std10_train:  4.89843; grad/diff10_train:  20054.71025; grad/cos10_train:  0.80726; grad/true_mag11_train:  15.90004; grad/pseudo_mag11_train:  20081.01738; grad/true_std11_train:  0.00388; grad/pseudo_std11_train:  4.89926; grad/diff11_train:  20068.48418; grad/cos11_train:  0.77499; grad/true_mag12_train:  9.72353; grad/pseudo_mag12_train:  20498.31650; grad/true_std12_train:  0.00237; grad/pseudo_std12_train:  5.00444; grad/diff12_train:  20489.89883; grad/cos12_train:  0.85618; grad/true_mag13_train:  12.39779; grad/pseudo_mag13_train:  20715.50811; grad/true_std13_train:  0.00303; grad/pseudo_std13_train:  5.05743; grad/diff13_train:  20704.76211; grad/cos13_train:  0.85762; grad/true_mag14_train:  15.26016; grad/pseudo_mag14_train:  21477.64766; grad/true_std14_train:  0.00373; grad/pseudo_std14_train:  5.24222; grad/diff14_train:  21464.81367; grad/cos14_train:  0.82672; grad/true_mag15_train:  10.01977; grad/pseudo_mag15_train:  21751.72256; grad/true_std15_train:  0.00245; grad/pseudo_std15_train:  5.31045; grad/diff15_train:  21742.71885; grad/cos15_train:  0.89287; grad/true_mag16_train:  11.72926; grad/pseudo_mag16_train:  21589.59072; grad/true_std16_train:  0.00286; grad/pseudo_std16_train:  5.27085; grad/diff16_train:  21579.21172; grad/cos16_train:  0.87381; grad/true_mag17_train:  13.54915; grad/pseudo_mag17_train:  22900.07900; grad/true_std17_train:  0.00331; grad/pseudo_std17_train:  5.59061; grad/diff17_train:  22888.12129; grad/cos17_train:  0.86785; grad_train:  953.48035; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00007; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00007; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:04,322][trainer][INFO] - Step 360:
[2025-04-24 22:27:04,323][trainer][INFO] - loss/edit_train:  6.17167; loss/loc_train:  0.11505; edit/acc_train:  0.02900; edit/log_prob_train: -6.17167; edit/prob_train:  0.28649; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.11880; perplexity/pre_train:  61.48536; nll/post_train:  4.22292; perplexity/post_train:  68.23255; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.18049; loss/total_train:  0.73222; loss/total_edit_train:  0.73222; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.09183; grad/pseudo_mag0_train:  17099.30137; grad/true_std0_train:  0.00124; grad/pseudo_std0_train:  4.17359; grad/diff0_train:  17096.32930; grad/cos0_train:  0.58367; grad/true_mag1_train:  8.21978; grad/pseudo_mag1_train:  17559.85879; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.28501; grad/diff1_train:  17554.73857; grad/cos1_train:  0.62146; grad/true_mag2_train:  8.30047; grad/pseudo_mag2_train:  18793.15713; grad/true_std2_train:  0.00203; grad/pseudo_std2_train:  4.56011; grad/diff2_train:  18788.26172; grad/cos2_train:  0.58246; grad/true_mag3_train:  5.36224; grad/pseudo_mag3_train:  16486.76455; grad/true_std3_train:  0.00131; grad/pseudo_std3_train:  4.02441; grad/diff3_train:  16483.63291; grad/cos3_train:  0.58383; grad/true_mag4_train:  9.61549; grad/pseudo_mag4_train:  16430.38467; grad/true_std4_train:  0.00235; grad/pseudo_std4_train:  4.01051; grad/diff4_train:  16424.21934; grad/cos4_train:  0.64053; grad/true_mag5_train:  10.28682; grad/pseudo_mag5_train:  17938.76094; grad/true_std5_train:  0.00251; grad/pseudo_std5_train:  4.36069; grad/diff5_train:  17932.76826; grad/cos5_train:  0.57538; grad/true_mag6_train:  5.88654; grad/pseudo_mag6_train:  16034.68955; grad/true_std6_train:  0.00144; grad/pseudo_std6_train:  3.91444; grad/diff6_train:  16030.81582; grad/cos6_train:  0.65799; grad/true_mag7_train:  11.03810; grad/pseudo_mag7_train:  16428.53838; grad/true_std7_train:  0.00269; grad/pseudo_std7_train:  4.01060; grad/diff7_train:  16420.60635; grad/cos7_train:  0.71812; grad/true_mag8_train:  13.51577; grad/pseudo_mag8_train:  17306.16475; grad/true_std8_train:  0.00330; grad/pseudo_std8_train:  4.21694; grad/diff8_train:  17297.06162; grad/cos8_train:  0.66632; grad/true_mag9_train:  7.87970; grad/pseudo_mag9_train:  17471.61924; grad/true_std9_train:  0.00192; grad/pseudo_std9_train:  4.26545; grad/diff9_train:  17465.31934; grad/cos9_train:  0.79810; grad/true_mag10_train:  11.47437; grad/pseudo_mag10_train:  18125.62520; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  4.42505; grad/diff10_train:  18116.26992; grad/cos10_train:  0.81377; grad/true_mag11_train:  15.00320; grad/pseudo_mag11_train:  18741.66260; grad/true_std11_train:  0.00366; grad/pseudo_std11_train:  4.57201; grad/diff11_train:  18729.95439; grad/cos11_train:  0.77722; grad/true_mag12_train:  9.08246; grad/pseudo_mag12_train:  19124.31045; grad/true_std12_train:  0.00222; grad/pseudo_std12_train:  4.66899; grad/diff12_train:  19116.41660; grad/cos12_train:  0.86694; grad/true_mag13_train:  11.54961; grad/pseudo_mag13_train:  19248.29170; grad/true_std13_train:  0.00282; grad/pseudo_std13_train:  4.69922; grad/diff13_train:  19238.27871; grad/cos13_train:  0.86450; grad/true_mag14_train:  14.05299; grad/pseudo_mag14_train:  19966.99600; grad/true_std14_train:  0.00343; grad/pseudo_std14_train:  4.87327; grad/diff14_train:  19955.25000; grad/cos14_train:  0.83020; grad/true_mag15_train:  9.40181; grad/pseudo_mag15_train:  20416.95029; grad/true_std15_train:  0.00230; grad/pseudo_std15_train:  4.98458; grad/diff15_train:  20408.46484; grad/cos15_train:  0.90111; grad/true_mag16_train:  10.90576; grad/pseudo_mag16_train:  20418.92373; grad/true_std16_train:  0.00266; grad/pseudo_std16_train:  4.98505; grad/diff16_train:  20409.19111; grad/cos16_train:  0.89066; grad/true_mag17_train:  12.49500; grad/pseudo_mag17_train:  21501.57598; grad/true_std17_train:  0.00305; grad/pseudo_std17_train:  5.24911; grad/diff17_train:  21490.51816; grad/cos17_train:  0.88140; grad_train:  1381.02771; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00007; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:07,999][trainer][INFO] - Step 370:
[2025-04-24 22:27:07,999][trainer][INFO] - loss/edit_train:  7.32887; loss/loc_train:  0.09189; edit/acc_train:  0.03778; edit/log_prob_train: -7.32887; edit/prob_train:  0.25437; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.51877; perplexity/pre_train:  91.72259; nll/post_train:  4.76059; perplexity/post_train:  116.81460; n_tokens/pre_train:  3.50000; n_tokens/post_train:  3.50000; time/edit_train:  0.22297; loss/total_train:  0.82478; loss/total_edit_train:  0.82478; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.54233; grad/pseudo_mag0_train:  17747.98887; grad/true_std0_train:  0.00135; grad/pseudo_std0_train:  4.33181; grad/diff0_train:  17744.78174; grad/cos0_train:  0.57906; grad/true_mag1_train:  8.89770; grad/pseudo_mag1_train:  18456.03545; grad/true_std1_train:  0.00217; grad/pseudo_std1_train:  4.50370; grad/diff1_train:  18450.43760; grad/cos1_train:  0.62730; grad/true_mag2_train:  9.06485; grad/pseudo_mag2_train:  20413.91816; grad/true_std2_train:  0.00221; grad/pseudo_std2_train:  4.94902; grad/diff2_train:  20408.66250; grad/cos2_train:  0.57475; grad/true_mag3_train:  5.94479; grad/pseudo_mag3_train:  17638.52031; grad/true_std3_train:  0.00145; grad/pseudo_std3_train:  4.30543; grad/diff3_train:  17635.10000; grad/cos3_train:  0.57500; grad/true_mag4_train:  10.82395; grad/pseudo_mag4_train:  17811.37002; grad/true_std4_train:  0.00264; grad/pseudo_std4_train:  4.34741; grad/diff4_train:  17804.55654; grad/cos4_train:  0.62901; grad/true_mag5_train:  11.56542; grad/pseudo_mag5_train:  19412.65518; grad/true_std5_train:  0.00282; grad/pseudo_std5_train:  4.71791; grad/diff5_train:  19406.03057; grad/cos5_train:  0.56902; grad/true_mag6_train:  6.63450; grad/pseudo_mag6_train:  17390.08066; grad/true_std6_train:  0.00162; grad/pseudo_std6_train:  4.24530; grad/diff6_train:  17385.75518; grad/cos6_train:  0.65312; grad/true_mag7_train:  12.16985; grad/pseudo_mag7_train:  17945.80225; grad/true_std7_train:  0.00297; grad/pseudo_std7_train:  4.38087; grad/diff7_train:  17937.06807; grad/cos7_train:  0.71663; grad/true_mag8_train:  15.46721; grad/pseudo_mag8_train:  19549.23623; grad/true_std8_train:  0.00378; grad/pseudo_std8_train:  4.76179; grad/diff8_train:  19538.68447; grad/cos8_train:  0.67432; grad/true_mag9_train:  9.09417; grad/pseudo_mag9_train:  20605.49111; grad/true_std9_train:  0.00222; grad/pseudo_std9_train:  5.03053; grad/diff9_train:  20598.16074; grad/cos9_train:  0.80507; grad/true_mag10_train:  12.89638; grad/pseudo_mag10_train:  20643.73672; grad/true_std10_train:  0.00315; grad/pseudo_std10_train:  5.03975; grad/diff10_train:  20633.12607; grad/cos10_train:  0.82132; grad/true_mag11_train:  16.63384; grad/pseudo_mag11_train:  21398.75264; grad/true_std11_train:  0.00406; grad/pseudo_std11_train:  5.22009; grad/diff11_train:  21385.36748; grad/cos11_train:  0.80079; grad/true_mag12_train:  10.49822; grad/pseudo_mag12_train:  22437.37217; grad/true_std12_train:  0.00256; grad/pseudo_std12_train:  5.47783; grad/diff12_train:  22428.22744; grad/cos12_train:  0.86964; grad/true_mag13_train:  12.85811; grad/pseudo_mag13_train:  22029.62832; grad/true_std13_train:  0.00314; grad/pseudo_std13_train:  5.37824; grad/diff13_train:  22018.35313; grad/cos13_train:  0.87488; grad/true_mag14_train:  15.65063; grad/pseudo_mag14_train:  22931.70479; grad/true_std14_train:  0.00382; grad/pseudo_std14_train:  5.59671; grad/diff14_train:  22918.32852; grad/cos14_train:  0.85016; grad/true_mag15_train:  10.75735; grad/pseudo_mag15_train:  23419.48135; grad/true_std15_train:  0.00263; grad/pseudo_std15_train:  5.71760; grad/diff15_train:  23409.76807; grad/cos15_train:  0.90257; grad/true_mag16_train:  12.47659; grad/pseudo_mag16_train:  23273.30898; grad/true_std16_train:  0.00305; grad/pseudo_std16_train:  5.68189; grad/diff16_train:  23262.18438; grad/cos16_train:  0.88911; grad/true_mag17_train:  14.30460; grad/pseudo_mag17_train:  24376.13818; grad/true_std17_train:  0.00349; grad/pseudo_std17_train:  5.95080; grad/diff17_train:  24363.55107; grad/cos17_train:  0.87882; grad_train:  1262.39185; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:11,437][trainer][INFO] - Step 380:
[2025-04-24 22:27:11,437][trainer][INFO] - loss/edit_train:  5.82314; loss/loc_train:  0.04970; edit/acc_train:  0.04658; edit/log_prob_train: -5.82314; edit/prob_train:  0.30330; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.66520; perplexity/pre_train:  39.06412; nll/post_train:  3.69260; perplexity/post_train:  40.14915; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.18417; loss/total_train:  0.63202; loss/total_edit_train:  0.63202; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.41650; grad/pseudo_mag0_train:  16845.17520; grad/true_std0_train:  0.00108; grad/pseudo_std0_train:  4.11111; grad/diff0_train:  16842.51553; grad/cos0_train:  0.60124; grad/true_mag1_train:  7.40553; grad/pseudo_mag1_train:  16590.18154; grad/true_std1_train:  0.00181; grad/pseudo_std1_train:  4.04825; grad/diff1_train:  16585.53486; grad/cos1_train:  0.62590; grad/true_mag2_train:  7.56505; grad/pseudo_mag2_train:  18966.81670; grad/true_std2_train:  0.00185; grad/pseudo_std2_train:  4.59112; grad/diff2_train:  18962.63057; grad/cos2_train:  0.54765; grad/true_mag3_train:  4.79021; grad/pseudo_mag3_train:  16664.13486; grad/true_std3_train:  0.00117; grad/pseudo_std3_train:  4.06761; grad/diff3_train:  16661.27900; grad/cos3_train:  0.59424; grad/true_mag4_train:  8.80557; grad/pseudo_mag4_train:  15641.47988; grad/true_std4_train:  0.00215; grad/pseudo_std4_train:  3.81787; grad/diff4_train:  15635.83760; grad/cos4_train:  0.63849; grad/true_mag5_train:  9.34756; grad/pseudo_mag5_train:  17715.01182; grad/true_std5_train:  0.00228; grad/pseudo_std5_train:  4.29960; grad/diff5_train:  17709.88750; grad/cos5_train:  0.54024; grad/true_mag6_train:  5.42962; grad/pseudo_mag6_train:  16294.00605; grad/true_std6_train:  0.00133; grad/pseudo_std6_train:  3.97773; grad/diff6_train:  16290.37988; grad/cos6_train:  0.66524; grad/true_mag7_train:  9.66921; grad/pseudo_mag7_train:  15397.03350; grad/true_std7_train:  0.00236; grad/pseudo_std7_train:  3.75870; grad/diff7_train:  15390.15752; grad/cos7_train:  0.70694; grad/true_mag8_train:  11.87985; grad/pseudo_mag8_train:  16592.29248; grad/true_std8_train:  0.00290; grad/pseudo_std8_train:  4.03882; grad/diff8_train:  16584.68340; grad/cos8_train:  0.62762; grad/true_mag9_train:  6.82574; grad/pseudo_mag9_train:  15637.44229; grad/true_std9_train:  0.00167; grad/pseudo_std9_train:  3.81763; grad/diff9_train:  15632.01318; grad/cos9_train:  0.79025; grad/true_mag10_train:  10.07887; grad/pseudo_mag10_train:  16260.60869; grad/true_std10_train:  0.00246; grad/pseudo_std10_train:  3.96965; grad/diff10_train:  16252.46738; grad/cos10_train:  0.80158; grad/true_mag11_train:  12.98877; grad/pseudo_mag11_train:  16923.86494; grad/true_std11_train:  0.00317; grad/pseudo_std11_train:  4.12722; grad/diff11_train:  16914.01924; grad/cos11_train:  0.74095; grad/true_mag12_train:  7.92308; grad/pseudo_mag12_train:  16841.09619; grad/true_std12_train:  0.00193; grad/pseudo_std12_train:  4.11155; grad/diff12_train:  16834.25762; grad/cos12_train:  0.85629; grad/true_mag13_train:  10.07888; grad/pseudo_mag13_train:  17168.01885; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  4.19134; grad/diff13_train:  17159.30283; grad/cos13_train:  0.85792; grad/true_mag14_train:  12.30434; grad/pseudo_mag14_train:  18117.59766; grad/true_std14_train:  0.00300; grad/pseudo_std14_train:  4.42095; grad/diff14_train:  18107.58750; grad/cos14_train:  0.79898; grad/true_mag15_train:  8.19213; grad/pseudo_mag15_train:  17896.44951; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  4.36922; grad/diff15_train:  17889.08350; grad/cos15_train:  0.89412; grad/true_mag16_train:  9.50162; grad/pseudo_mag16_train:  17809.89971; grad/true_std16_train:  0.00232; grad/pseudo_std16_train:  4.34808; grad/diff16_train:  17801.48848; grad/cos16_train:  0.87881; grad/true_mag17_train:  10.99786; grad/pseudo_mag17_train:  18983.09932; grad/true_std17_train:  0.00269; grad/pseudo_std17_train:  4.63417; grad/diff17_train:  18973.59199; grad/cos17_train:  0.85316; grad_train:  844.22443; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:14,965][trainer][INFO] - Step 390:
[2025-04-24 22:27:14,965][trainer][INFO] - loss/edit_train:  5.78553; loss/loc_train:  0.05827; edit/acc_train:  0.02992; edit/log_prob_train: -5.78553; edit/prob_train:  0.31579; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.10479; perplexity/pre_train:  60.63010; nll/post_train:  4.10964; perplexity/post_train:  60.92478; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.18749; loss/total_train:  0.63682; loss/total_edit_train:  0.63682; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.39403; grad/pseudo_mag0_train:  19355.95713; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  4.72345; grad/diff0_train:  19352.96084; grad/cos0_train:  0.56607; grad/true_mag1_train:  8.71044; grad/pseudo_mag1_train:  20548.99707; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  5.01162; grad/diff1_train:  20544.05293; grad/cos1_train:  0.58129; grad/true_mag2_train:  9.08948; grad/pseudo_mag2_train:  21620.52969; grad/true_std2_train:  0.00222; grad/pseudo_std2_train:  5.23953; grad/diff2_train:  21615.47109; grad/cos2_train:  0.54759; grad/true_mag3_train:  5.67678; grad/pseudo_mag3_train:  18186.24297; grad/true_std3_train:  0.00139; grad/pseudo_std3_train:  4.43906; grad/diff3_train:  18183.07969; grad/cos3_train:  0.56164; grad/true_mag4_train:  10.09329; grad/pseudo_mag4_train:  18116.83418; grad/true_std4_train:  0.00246; grad/pseudo_std4_train:  4.42115; grad/diff4_train:  18110.79268; grad/cos4_train:  0.60678; grad/true_mag5_train:  11.00704; grad/pseudo_mag5_train:  19968.15449; grad/true_std5_train:  0.00269; grad/pseudo_std5_train:  4.84928; grad/diff5_train:  19962.07969; grad/cos5_train:  0.54610; grad/true_mag6_train:  6.15811; grad/pseudo_mag6_train:  17808.37100; grad/true_std6_train:  0.00150; grad/pseudo_std6_train:  4.34724; grad/diff6_train:  17804.41240; grad/cos6_train:  0.64560; grad/true_mag7_train:  11.08660; grad/pseudo_mag7_train:  17274.45840; grad/true_std7_train:  0.00271; grad/pseudo_std7_train:  4.21695; grad/diff7_train:  17266.59912; grad/cos7_train:  0.70844; grad/true_mag8_train:  13.72345; grad/pseudo_mag8_train:  18702.78691; grad/true_std8_train:  0.00335; grad/pseudo_std8_train:  4.55454; grad/diff8_train:  18693.74336; grad/cos8_train:  0.65118; grad/true_mag9_train:  8.00313; grad/pseudo_mag9_train:  18270.71182; grad/true_std9_train:  0.00195; grad/pseudo_std9_train:  4.46048; grad/diff9_train:  18264.37246; grad/cos9_train:  0.79120; grad/true_mag10_train:  11.66218; grad/pseudo_mag10_train:  18698.57441; grad/true_std10_train:  0.00285; grad/pseudo_std10_train:  4.56476; grad/diff10_train:  18689.27852; grad/cos10_train:  0.79510; grad/true_mag11_train:  15.53017; grad/pseudo_mag11_train:  19390.86650; grad/true_std11_train:  0.00379; grad/pseudo_std11_train:  4.72913; grad/diff11_train:  19379.09600; grad/cos11_train:  0.75418; grad/true_mag12_train:  9.32220; grad/pseudo_mag12_train:  19574.48789; grad/true_std12_train:  0.00228; grad/pseudo_std12_train:  4.77886; grad/diff12_train:  19566.52119; grad/cos12_train:  0.85165; grad/true_mag13_train:  11.71679; grad/pseudo_mag13_train:  20192.57314; grad/true_std13_train:  0.00286; grad/pseudo_std13_train:  4.92958; grad/diff13_train:  20182.60098; grad/cos13_train:  0.84746; grad/true_mag14_train:  14.36160; grad/pseudo_mag14_train:  21283.26670; grad/true_std14_train:  0.00351; grad/pseudo_std14_train:  5.19364; grad/diff14_train:  21271.60430; grad/cos14_train:  0.80522; grad/true_mag15_train:  9.48250; grad/pseudo_mag15_train:  20424.54951; grad/true_std15_train:  0.00232; grad/pseudo_std15_train:  4.98640; grad/diff15_train:  20416.18281; grad/cos15_train:  0.87904; grad/true_mag16_train:  11.02090; grad/pseudo_mag16_train:  20471.00293; grad/true_std16_train:  0.00269; grad/pseudo_std16_train:  4.99771; grad/diff16_train:  20461.32480; grad/cos16_train:  0.87609; grad/true_mag17_train:  13.54313; grad/pseudo_mag17_train:  22269.10635; grad/true_std17_train:  0.00331; grad/pseudo_std17_train:  5.43612; grad/diff17_train:  22258.10820; grad/cos17_train:  0.83443; grad_train:  619.15350; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:18,612][trainer][INFO] - Step 400:
[2025-04-24 22:27:18,612][trainer][INFO] - loss/edit_train:  7.17494; loss/loc_train:  0.12307; edit/acc_train:  0.00909; edit/log_prob_train: -7.17494; edit/prob_train:  0.24103; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.46050; perplexity/pre_train:  86.53049; nll/post_train:  4.73760; perplexity/post_train:  114.16035; n_tokens/pre_train:  5.90000; n_tokens/post_train:  5.90000; time/edit_train:  0.21650; loss/total_train:  0.84056; loss/total_edit_train:  0.84056; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.45255; grad/pseudo_mag0_train:  19855.02461; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  4.84568; grad/diff0_train:  19851.80469; grad/cos0_train:  0.59790; grad/true_mag1_train:  8.87340; grad/pseudo_mag1_train:  20266.84463; grad/true_std1_train:  0.00217; grad/pseudo_std1_train:  4.94414; grad/diff1_train:  20261.43486; grad/cos1_train:  0.62066; grad/true_mag2_train:  8.94621; grad/pseudo_mag2_train:  20588.07832; grad/true_std2_train:  0.00218; grad/pseudo_std2_train:  4.99662; grad/diff2_train:  20582.72969; grad/cos2_train:  0.59696; grad/true_mag3_train:  5.85848; grad/pseudo_mag3_train:  19019.78799; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.64236; grad/diff3_train:  19016.41250; grad/cos3_train:  0.58082; grad/true_mag4_train:  10.35982; grad/pseudo_mag4_train:  18180.46699; grad/true_std4_train:  0.00253; grad/pseudo_std4_train:  4.43721; grad/diff4_train:  18173.89932; grad/cos4_train:  0.63764; grad/true_mag5_train:  11.03023; grad/pseudo_mag5_train:  19466.37871; grad/true_std5_train:  0.00269; grad/pseudo_std5_train:  4.73127; grad/diff5_train:  19459.89824; grad/cos5_train:  0.58218; grad/true_mag6_train:  6.21822; grad/pseudo_mag6_train:  18016.22705; grad/true_std6_train:  0.00152; grad/pseudo_std6_train:  4.39808; grad/diff6_train:  18012.14307; grad/cos6_train:  0.65851; grad/true_mag7_train:  11.39732; grad/pseudo_mag7_train:  17372.43896; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  4.24089; grad/diff7_train:  17364.21621; grad/cos7_train:  0.72061; grad/true_mag8_train:  14.24342; grad/pseudo_mag8_train:  18485.38369; grad/true_std8_train:  0.00348; grad/pseudo_std8_train:  4.50248; grad/diff8_train:  18475.81123; grad/cos8_train:  0.66547; grad/true_mag9_train:  8.25466; grad/pseudo_mag9_train:  18906.96992; grad/true_std9_train:  0.00202; grad/pseudo_std9_train:  4.61583; grad/diff9_train:  18900.33389; grad/cos9_train:  0.80001; grad/true_mag10_train:  11.97541; grad/pseudo_mag10_train:  19136.11309; grad/true_std10_train:  0.00292; grad/pseudo_std10_train:  4.67166; grad/diff10_train:  19126.31709; grad/cos10_train:  0.81424; grad/true_mag11_train:  15.38737; grad/pseudo_mag11_train:  19608.23662; grad/true_std11_train:  0.00376; grad/pseudo_std11_train:  4.78349; grad/diff11_train:  19596.03359; grad/cos11_train:  0.78288; grad/true_mag12_train:  9.37665; grad/pseudo_mag12_train:  19947.96338; grad/true_std12_train:  0.00229; grad/pseudo_std12_train:  4.87006; grad/diff12_train:  19939.83643; grad/cos12_train:  0.86251; grad/true_mag13_train:  11.73473; grad/pseudo_mag13_train:  19887.28916; grad/true_std13_train:  0.00286; grad/pseudo_std13_train:  4.85523; grad/diff13_train:  19877.07422; grad/cos13_train:  0.86613; grad/true_mag14_train:  14.40415; grad/pseudo_mag14_train:  20767.40674; grad/true_std14_train:  0.00352; grad/pseudo_std14_train:  5.06872; grad/diff14_train:  20755.24990; grad/cos14_train:  0.83351; grad/true_mag15_train:  9.49532; grad/pseudo_mag15_train:  20650.45234; grad/true_std15_train:  0.00232; grad/pseudo_std15_train:  5.04158; grad/diff15_train:  20641.91318; grad/cos15_train:  0.89563; grad/true_mag16_train:  11.07623; grad/pseudo_mag16_train:  20616.24932; grad/true_std16_train:  0.00270; grad/pseudo_std16_train:  5.03321; grad/diff16_train:  20606.38906; grad/cos16_train:  0.88428; grad/true_mag17_train:  12.66967; grad/pseudo_mag17_train:  21600.18945; grad/true_std17_train:  0.00309; grad/pseudo_std17_train:  5.27323; grad/diff17_train:  21588.99746; grad/cos17_train:  0.87235; grad_train:  1312.90649; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:27:36,534][trainer][INFO] - Step 400:
[2025-04-24 22:27:36,534][trainer][INFO] - loss/edit_val:  7.46796; loss/loc_val:  0.10768; edit/acc_val:  0.02198; edit/log_prob_val: -7.46796; edit/prob_val:  0.26045; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.47973; perplexity/post_val:  88.21111; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10551; loss/total_val:  0.85448; loss/total_edit_val:  0.85448; memory/alloc_max_val:  42223547904.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  17.91683; eval_time/average:  0.17917
[2025-04-24 22:27:36,537][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:27:36,538][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:28:30,481][trainer][INFO] - Write complete.
[2025-04-24 22:28:33,846][trainer][INFO] - Step 410:
[2025-04-24 22:28:33,846][trainer][INFO] - loss/edit_train:  7.36473; loss/loc_train:  0.08084; edit/acc_train:  0.01676; edit/log_prob_train: -7.36473; edit/prob_train:  0.25009; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.75236; perplexity/pre_train:  42.62141; nll/post_train:  3.81147; perplexity/post_train:  45.21675; n_tokens/pre_train:  4.90000; n_tokens/post_train:  4.90000; time/edit_train:  0.18294; loss/total_train:  0.81731; loss/total_edit_train:  0.81731; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.04060; grad/pseudo_mag0_train:  20516.04063; grad/true_std0_train:  0.00123; grad/pseudo_std0_train:  5.00551; grad/diff0_train:  20513.07402; grad/cos0_train:  0.59190; grad/true_mag1_train:  8.25549; grad/pseudo_mag1_train:  19278.58037; grad/true_std1_train:  0.00202; grad/pseudo_std1_train:  4.70246; grad/diff1_train:  19273.45742; grad/cos1_train:  0.62024; grad/true_mag2_train:  8.47401; grad/pseudo_mag2_train:  21914.20625; grad/true_std2_train:  0.00207; grad/pseudo_std2_train:  5.29397; grad/diff2_train:  21909.63145; grad/cos2_train:  0.53313; grad/true_mag3_train:  5.42664; grad/pseudo_mag3_train:  18962.18271; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.62770; grad/diff3_train:  18959.05098; grad/cos3_train:  0.58021; grad/true_mag4_train:  9.73653; grad/pseudo_mag4_train:  17533.26641; grad/true_std4_train:  0.00238; grad/pseudo_std4_train:  4.27891; grad/diff4_train:  17527.18213; grad/cos4_train:  0.62428; grad/true_mag5_train:  10.44646; grad/pseudo_mag5_train:  19987.30156; grad/true_std5_train:  0.00255; grad/pseudo_std5_train:  4.84410; grad/diff5_train:  19981.73652; grad/cos5_train:  0.52320; grad/true_mag6_train:  5.90919; grad/pseudo_mag6_train:  17444.93975; grad/true_std6_train:  0.00144; grad/pseudo_std6_train:  4.25837; grad/diff6_train:  17441.11211; grad/cos6_train:  0.65096; grad/true_mag7_train:  10.45583; grad/pseudo_mag7_train:  16398.41221; grad/true_std7_train:  0.00255; grad/pseudo_std7_train:  4.00291; grad/diff7_train:  16391.07656; grad/cos7_train:  0.69758; grad/true_mag8_train:  12.83312; grad/pseudo_mag8_train:  18417.40371; grad/true_std8_train:  0.00313; grad/pseudo_std8_train:  4.47837; grad/diff8_train:  18409.38926; grad/cos8_train:  0.60609; grad/true_mag9_train:  7.24909; grad/pseudo_mag9_train:  16487.89824; grad/true_std9_train:  0.00177; grad/pseudo_std9_train:  4.02520; grad/diff9_train:  16482.18184; grad/cos9_train:  0.78409; grad/true_mag10_train:  10.63592; grad/pseudo_mag10_train:  16864.54199; grad/true_std10_train:  0.00260; grad/pseudo_std10_train:  4.11699; grad/diff10_train:  16856.02129; grad/cos10_train:  0.79525; grad/true_mag11_train:  13.48261; grad/pseudo_mag11_train:  17786.56172; grad/true_std11_train:  0.00329; grad/pseudo_std11_train:  4.33546; grad/diff11_train:  17776.18320; grad/cos11_train:  0.75269; grad/true_mag12_train:  8.01161; grad/pseudo_mag12_train:  16953.07383; grad/true_std12_train:  0.00196; grad/pseudo_std12_train:  4.13889; grad/diff12_train:  16946.19824; grad/cos12_train:  0.85423; grad/true_mag13_train:  10.31549; grad/pseudo_mag13_train:  17146.37578; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  4.18603; grad/diff13_train:  17137.57021; grad/cos13_train:  0.84900; grad/true_mag14_train:  12.72541; grad/pseudo_mag14_train:  18215.45439; grad/true_std14_train:  0.00311; grad/pseudo_std14_train:  4.44420; grad/diff14_train:  18205.13975; grad/cos14_train:  0.79694; grad/true_mag15_train:  8.30352; grad/pseudo_mag15_train:  18117.34443; grad/true_std15_train:  0.00203; grad/pseudo_std15_train:  4.42314; grad/diff15_train:  18109.92041; grad/cos15_train:  0.88951; grad/true_mag16_train:  9.97166; grad/pseudo_mag16_train:  18250.11611; grad/true_std16_train:  0.00243; grad/pseudo_std16_train:  4.45554; grad/diff16_train:  18241.38398; grad/cos16_train:  0.87147; grad/true_mag17_train:  11.48930; grad/pseudo_mag17_train:  19401.93252; grad/true_std17_train:  0.00281; grad/pseudo_std17_train:  4.73616; grad/diff17_train:  19392.02715; grad/cos17_train:  0.84834; grad_train:  923.72168; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:28:37,549][trainer][INFO] - Step 420:
[2025-04-24 22:28:37,549][trainer][INFO] - loss/edit_train:  6.94999; loss/loc_train:  0.04648; edit/acc_train:  0.02500; edit/log_prob_train: -6.94999; edit/prob_train:  0.27896; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.88453; perplexity/pre_train:  48.64386; nll/post_train:  3.84618; perplexity/post_train:  46.81401; n_tokens/pre_train:  5.30000; n_tokens/post_train:  5.30000; time/edit_train:  0.21995; loss/total_train:  0.74148; loss/total_edit_train:  0.74148; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.12362; grad/pseudo_mag0_train:  18859.00352; grad/true_std0_train:  0.00125; grad/pseudo_std0_train:  4.60243; grad/diff0_train:  18855.93633; grad/cos0_train:  0.59778; grad/true_mag1_train:  8.35546; grad/pseudo_mag1_train:  18628.57607; grad/true_std1_train:  0.00204; grad/pseudo_std1_train:  4.54511; grad/diff1_train:  18623.28154; grad/cos1_train:  0.63239; grad/true_mag2_train:  8.64670; grad/pseudo_mag2_train:  21388.77998; grad/true_std2_train:  0.00211; grad/pseudo_std2_train:  5.17381; grad/diff2_train:  21383.91689; grad/cos2_train:  0.55850; grad/true_mag3_train:  5.42587; grad/pseudo_mag3_train:  18111.06328; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.42063; grad/diff3_train:  18107.83672; grad/cos3_train:  0.59374; grad/true_mag4_train:  9.60713; grad/pseudo_mag4_train:  17038.10254; grad/true_std4_train:  0.00235; grad/pseudo_std4_train:  4.15846; grad/diff4_train:  17031.94219; grad/cos4_train:  0.64004; grad/true_mag5_train:  10.12659; grad/pseudo_mag5_train:  18835.28203; grad/true_std5_train:  0.00247; grad/pseudo_std5_train:  4.56524; grad/diff5_train:  18829.74561; grad/cos5_train:  0.54243; grad/true_mag6_train:  5.56567; grad/pseudo_mag6_train:  16272.66787; grad/true_std6_train:  0.00136; grad/pseudo_std6_train:  3.97243; grad/diff6_train:  16268.98516; grad/cos6_train:  0.66106; grad/true_mag7_train:  10.01926; grad/pseudo_mag7_train:  15474.97148; grad/true_std7_train:  0.00245; grad/pseudo_std7_train:  3.77755; grad/diff7_train:  15467.84287; grad/cos7_train:  0.70889; grad/true_mag8_train:  12.17529; grad/pseudo_mag8_train:  17240.14434; grad/true_std8_train:  0.00297; grad/pseudo_std8_train:  4.19174; grad/diff8_train:  17232.58975; grad/cos8_train:  0.61777; grad/true_mag9_train:  6.92207; grad/pseudo_mag9_train:  15262.94531; grad/true_std9_train:  0.00169; grad/pseudo_std9_train:  3.72616; grad/diff9_train:  15257.45986; grad/cos9_train:  0.78882; grad/true_mag10_train:  10.14365; grad/pseudo_mag10_train:  15791.76455; grad/true_std10_train:  0.00248; grad/pseudo_std10_train:  3.85511; grad/diff10_train:  15783.63496; grad/cos10_train:  0.79753; grad/true_mag11_train:  13.14690; grad/pseudo_mag11_train:  16662.78662; grad/true_std11_train:  0.00321; grad/pseudo_std11_train:  4.06182; grad/diff11_train:  16652.83076; grad/cos11_train:  0.74996; grad/true_mag12_train:  7.83167; grad/pseudo_mag12_train:  16344.27334; grad/true_std12_train:  0.00191; grad/pseudo_std12_train:  3.99026; grad/diff12_train:  16337.55098; grad/cos12_train:  0.85031; grad/true_mag13_train:  9.92884; grad/pseudo_mag13_train:  16363.45264; grad/true_std13_train:  0.00242; grad/pseudo_std13_train:  3.99490; grad/diff13_train:  16354.95215; grad/cos13_train:  0.85003; grad/true_mag14_train:  12.39874; grad/pseudo_mag14_train:  17529.38232; grad/true_std14_train:  0.00303; grad/pseudo_std14_train:  4.27651; grad/diff14_train:  17519.32002; grad/cos14_train:  0.80220; grad/true_mag15_train:  8.03972; grad/pseudo_mag15_train:  17329.98203; grad/true_std15_train:  0.00196; grad/pseudo_std15_train:  4.23091; grad/diff15_train:  17322.78369; grad/cos15_train:  0.89017; grad/true_mag16_train:  9.46030; grad/pseudo_mag16_train:  17357.43384; grad/true_std16_train:  0.00231; grad/pseudo_std16_train:  4.23760; grad/diff16_train:  17349.12417; grad/cos16_train:  0.87117; grad/true_mag17_train:  10.95961; grad/pseudo_mag17_train:  18669.30596; grad/true_std17_train:  0.00268; grad/pseudo_std17_train:  4.55739; grad/diff17_train:  18659.81846; grad/cos17_train:  0.85685; grad_train:  716.40564; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:28:40,839][trainer][INFO] - Step 430:
[2025-04-24 22:28:40,839][trainer][INFO] - loss/edit_train:  5.00744; loss/loc_train:  0.10014; edit/acc_train:  0.08929; edit/log_prob_train: -5.00744; edit/prob_train:  0.27243; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.26397; perplexity/pre_train:  71.09184; nll/post_train:  4.32709; perplexity/post_train:  75.72322; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.18474; loss/total_train:  0.60088; loss/total_edit_train:  0.60088; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.92586; grad/pseudo_mag0_train:  17831.88135; grad/true_std0_train:  0.00120; grad/pseudo_std0_train:  4.35108; grad/diff0_train:  17828.97607; grad/cos0_train:  0.58839; grad/true_mag1_train:  7.96750; grad/pseudo_mag1_train:  17953.40479; grad/true_std1_train:  0.00195; grad/pseudo_std1_train:  4.37891; grad/diff1_train:  17948.57432; grad/cos1_train:  0.60634; grad/true_mag2_train:  8.15179; grad/pseudo_mag2_train:  21772.67988; grad/true_std2_train:  0.00199; grad/pseudo_std2_train:  5.24227; grad/diff2_train:  21768.57812; grad/cos2_train:  0.49964; grad/true_mag3_train:  5.09362; grad/pseudo_mag3_train:  16698.62383; grad/true_std3_train:  0.00124; grad/pseudo_std3_train:  4.07543; grad/diff3_train:  16695.68467; grad/cos3_train:  0.57676; grad/true_mag4_train:  9.18190; grad/pseudo_mag4_train:  16203.62344; grad/true_std4_train:  0.00224; grad/pseudo_std4_train:  3.95445; grad/diff4_train:  16197.92031; grad/cos4_train:  0.62129; grad/true_mag5_train:  9.82374; grad/pseudo_mag5_train:  19576.20459; grad/true_std5_train:  0.00240; grad/pseudo_std5_train:  4.73305; grad/diff5_train:  19571.34199; grad/cos5_train:  0.49323; grad/true_mag6_train:  5.44912; grad/pseudo_mag6_train:  15234.60352; grad/true_std6_train:  0.00133; grad/pseudo_std6_train:  3.71892; grad/diff6_train:  15231.01943; grad/cos6_train:  0.65733; grad/true_mag7_train:  9.93528; grad/pseudo_mag7_train:  15123.37490; grad/true_std7_train:  0.00243; grad/pseudo_std7_train:  3.69165; grad/diff7_train:  15116.37422; grad/cos7_train:  0.70471; grad/true_mag8_train:  12.37014; grad/pseudo_mag8_train:  17506.61016; grad/true_std8_train:  0.00302; grad/pseudo_std8_train:  4.25057; grad/diff8_train:  17499.17666; grad/cos8_train:  0.60057; grad/true_mag9_train:  6.88664; grad/pseudo_mag9_train:  15299.47852; grad/true_std9_train:  0.00168; grad/pseudo_std9_train:  3.73506; grad/diff9_train:  15294.01904; grad/cos9_train:  0.79256; grad/true_mag10_train:  10.18974; grad/pseudo_mag10_train:  15897.10449; grad/true_std10_train:  0.00249; grad/pseudo_std10_train:  3.88079; grad/diff10_train:  15888.93955; grad/cos10_train:  0.80113; grad/true_mag11_train:  12.91396; grad/pseudo_mag11_train:  16818.96895; grad/true_std11_train:  0.00315; grad/pseudo_std11_train:  4.09858; grad/diff11_train:  16809.12744; grad/cos11_train:  0.76098; grad/true_mag12_train:  7.80411; grad/pseudo_mag12_train:  16410.72012; grad/true_std12_train:  0.00191; grad/pseudo_std12_train:  4.00648; grad/diff12_train:  16404.00020; grad/cos12_train:  0.85995; grad/true_mag13_train:  9.80719; grad/pseudo_mag13_train:  16441.16777; grad/true_std13_train:  0.00239; grad/pseudo_std13_train:  4.01386; grad/diff13_train:  16432.73975; grad/cos13_train:  0.85855; grad/true_mag14_train:  12.02252; grad/pseudo_mag14_train:  17512.64219; grad/true_std14_train:  0.00294; grad/pseudo_std14_train:  4.27210; grad/diff14_train:  17502.84473; grad/cos14_train:  0.81304; grad/true_mag15_train:  7.88296; grad/pseudo_mag15_train:  17199.76006; grad/true_std15_train:  0.00192; grad/pseudo_std15_train:  4.19912; grad/diff15_train:  17192.70068; grad/cos15_train:  0.89470; grad/true_mag16_train:  9.34191; grad/pseudo_mag16_train:  17275.02432; grad/true_std16_train:  0.00228; grad/pseudo_std16_train:  4.21749; grad/diff16_train:  17266.81797; grad/cos16_train:  0.87715; grad/true_mag17_train:  10.89139; grad/pseudo_mag17_train:  18396.18740; grad/true_std17_train:  0.00266; grad/pseudo_std17_train:  4.49051; grad/diff17_train:  18386.86094; grad/cos17_train:  0.85435; grad_train:  819.40961; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:28:44,065][trainer][INFO] - Step 440:
[2025-04-24 22:28:44,066][trainer][INFO] - loss/edit_train:  5.09988; loss/loc_train:  0.17830; edit/acc_train:  0.05659; edit/log_prob_train: -5.09988; edit/prob_train:  0.35120; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.80707; perplexity/pre_train:  122.37215; nll/post_train:  5.83895; perplexity/post_train:  343.41873; n_tokens/pre_train:  3.20000; n_tokens/post_train:  3.20000; time/edit_train:  0.17556; loss/total_train:  0.68829; loss/total_edit_train:  0.68829; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.43315; grad/pseudo_mag0_train:  17943.78857; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  4.37829; grad/diff0_train:  17940.69600; grad/cos0_train:  0.57117; grad/true_mag1_train:  8.73159; grad/pseudo_mag1_train:  19073.45156; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  4.65104; grad/diff1_train:  19068.31621; grad/cos1_train:  0.59030; grad/true_mag2_train:  9.08263; grad/pseudo_mag2_train:  22908.44648; grad/true_std2_train:  0.00222; grad/pseudo_std2_train:  5.52825; grad/diff2_train:  22903.74102; grad/cos2_train:  0.50844; grad/true_mag3_train:  5.77633; grad/pseudo_mag3_train:  17408.84717; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.24881; grad/diff3_train:  17405.58945; grad/cos3_train:  0.56575; grad/true_mag4_train:  10.28085; grad/pseudo_mag4_train:  17893.86211; grad/true_std4_train:  0.00251; grad/pseudo_std4_train:  4.36626; grad/diff4_train:  17887.61338; grad/cos4_train:  0.60719; grad/true_mag5_train:  11.47435; grad/pseudo_mag5_train:  20888.43164; grad/true_std5_train:  0.00280; grad/pseudo_std5_train:  5.05741; grad/diff5_train:  20882.47969; grad/cos5_train:  0.50859; grad/true_mag6_train:  6.41321; grad/pseudo_mag6_train:  17466.73184; grad/true_std6_train:  0.00157; grad/pseudo_std6_train:  4.26377; grad/diff6_train:  17462.59473; grad/cos6_train:  0.64626; grad/true_mag7_train:  11.77857; grad/pseudo_mag7_train:  17834.45840; grad/true_std7_train:  0.00288; grad/pseudo_std7_train:  4.35340; grad/diff7_train:  17826.15762; grad/cos7_train:  0.70177; grad/true_mag8_train:  14.81052; grad/pseudo_mag8_train:  20318.78906; grad/true_std8_train:  0.00362; grad/pseudo_std8_train:  4.94004; grad/diff8_train:  20309.30547; grad/cos8_train:  0.62331; grad/true_mag9_train:  8.45088; grad/pseudo_mag9_train:  19626.50205; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.79141; grad/diff9_train:  19619.72305; grad/cos9_train:  0.79809; grad/true_mag10_train:  12.06625; grad/pseudo_mag10_train:  19518.90605; grad/true_std10_train:  0.00295; grad/pseudo_std10_train:  4.76504; grad/diff10_train:  19509.05205; grad/cos10_train:  0.81211; grad/true_mag11_train:  15.38492; grad/pseudo_mag11_train:  20197.83564; grad/true_std11_train:  0.00376; grad/pseudo_std11_train:  4.92435; grad/diff11_train:  20185.91094; grad/cos11_train:  0.76460; grad/true_mag12_train:  9.60858; grad/pseudo_mag12_train:  20467.84580; grad/true_std12_train:  0.00235; grad/pseudo_std12_train:  4.99696; grad/diff12_train:  20459.53730; grad/cos12_train:  0.86143; grad/true_mag13_train:  11.97063; grad/pseudo_mag13_train:  20332.72197; grad/true_std13_train:  0.00292; grad/pseudo_std13_train:  4.96394; grad/diff13_train:  20322.36455; grad/cos13_train:  0.86157; grad/true_mag14_train:  14.32605; grad/pseudo_mag14_train:  21258.31582; grad/true_std14_train:  0.00350; grad/pseudo_std14_train:  5.18724; grad/diff14_train:  21246.28877; grad/cos14_train:  0.83137; grad/true_mag15_train:  9.61281; grad/pseudo_mag15_train:  21000.91943; grad/true_std15_train:  0.00235; grad/pseudo_std15_train:  5.12712; grad/diff15_train:  20992.29268; grad/cos15_train:  0.89550; grad/true_mag16_train:  11.29823; grad/pseudo_mag16_train:  21100.45469; grad/true_std16_train:  0.00276; grad/pseudo_std16_train:  5.15140; grad/diff16_train:  21090.43193; grad/cos16_train:  0.88402; grad/true_mag17_train:  12.62401; grad/pseudo_mag17_train:  21840.38721; grad/true_std17_train:  0.00308; grad/pseudo_std17_train:  5.33157; grad/diff17_train:  21829.32979; grad/cos17_train:  0.86958; grad_train:  958.99408; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00007; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:28:47,865][trainer][INFO] - Step 450:
[2025-04-24 22:28:47,866][trainer][INFO] - loss/edit_train:  6.40515; loss/loc_train:  0.09297; edit/acc_train:  0.03409; edit/log_prob_train: -6.40515; edit/prob_train:  0.27087; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.41782; perplexity/pre_train:  82.91572; nll/post_train:  4.60442; perplexity/post_train:  99.92540; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.22699; loss/total_train:  0.73348; loss/total_edit_train:  0.73348; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.68468; grad/pseudo_mag0_train:  16399.38213; grad/true_std0_train:  0.00114; grad/pseudo_std0_train:  4.00189; grad/diff0_train:  16396.64463; grad/cos0_train:  0.58573; grad/true_mag1_train:  7.85366; grad/pseudo_mag1_train:  16907.35225; grad/true_std1_train:  0.00192; grad/pseudo_std1_train:  4.12450; grad/diff1_train:  16902.55391; grad/cos1_train:  0.61339; grad/true_mag2_train:  8.03212; grad/pseudo_mag2_train:  20443.14668; grad/true_std2_train:  0.00196; grad/pseudo_std2_train:  4.92731; grad/diff2_train:  20439.01504; grad/cos2_train:  0.51476; grad/true_mag3_train:  5.12487; grad/pseudo_mag3_train:  16549.93516; grad/true_std3_train:  0.00125; grad/pseudo_std3_train:  4.03939; grad/diff3_train:  16546.99287; grad/cos3_train:  0.57618; grad/true_mag4_train:  9.59063; grad/pseudo_mag4_train:  16641.83916; grad/true_std4_train:  0.00234; grad/pseudo_std4_train:  4.06132; grad/diff4_train:  16635.95029; grad/cos4_train:  0.61858; grad/true_mag5_train:  10.22528; grad/pseudo_mag5_train:  19229.26074; grad/true_std5_train:  0.00250; grad/pseudo_std5_train:  4.65587; grad/diff5_train:  19223.92578; grad/cos5_train:  0.52342; grad/true_mag6_train:  5.76760; grad/pseudo_mag6_train:  16842.56582; grad/true_std6_train:  0.00141; grad/pseudo_std6_train:  4.11155; grad/diff6_train:  16838.78848; grad/cos6_train:  0.65636; grad/true_mag7_train:  10.92355; grad/pseudo_mag7_train:  16604.75635; grad/true_std7_train:  0.00267; grad/pseudo_std7_train:  4.05353; grad/diff7_train:  16597.00273; grad/cos7_train:  0.71189; grad/true_mag8_train:  13.88132; grad/pseudo_mag8_train:  18376.98418; grad/true_std8_train:  0.00339; grad/pseudo_std8_train:  4.46936; grad/diff8_train:  18368.22451; grad/cos8_train:  0.63274; grad/true_mag9_train:  8.18892; grad/pseudo_mag9_train:  19637.64717; grad/true_std9_train:  0.00200; grad/pseudo_std9_train:  4.79423; grad/diff9_train:  19631.06289; grad/cos9_train:  0.80394; grad/true_mag10_train:  11.73081; grad/pseudo_mag10_train:  19337.90010; grad/true_std10_train:  0.00286; grad/pseudo_std10_train:  4.72095; grad/diff10_train:  19328.27031; grad/cos10_train:  0.81988; grad/true_mag11_train:  14.89001; grad/pseudo_mag11_train:  19855.52637; grad/true_std11_train:  0.00364; grad/pseudo_std11_train:  4.84203; grad/diff11_train:  19843.76807; grad/cos11_train:  0.78861; grad/true_mag12_train:  9.40333; grad/pseudo_mag12_train:  20442.07422; grad/true_std12_train:  0.00230; grad/pseudo_std12_train:  4.99071; grad/diff12_train:  20433.92744; grad/cos12_train:  0.86704; grad/true_mag13_train:  11.52718; grad/pseudo_mag13_train:  20140.94199; grad/true_std13_train:  0.00281; grad/pseudo_std13_train:  4.91716; grad/diff13_train:  20130.84180; grad/cos13_train:  0.87580; grad/true_mag14_train:  13.87831; grad/pseudo_mag14_train:  21027.08633; grad/true_std14_train:  0.00339; grad/pseudo_std14_train:  5.13103; grad/diff14_train:  21015.39473; grad/cos14_train:  0.84076; grad/true_mag15_train:  9.34407; grad/pseudo_mag15_train:  20817.19404; grad/true_std15_train:  0.00228; grad/pseudo_std15_train:  5.08228; grad/diff15_train:  20808.75234; grad/cos15_train:  0.90317; grad/true_mag16_train:  10.80302; grad/pseudo_mag16_train:  20604.04688; grad/true_std16_train:  0.00264; grad/pseudo_std16_train:  5.03024; grad/diff16_train:  20594.40898; grad/cos16_train:  0.89207; grad/true_mag17_train:  12.43183; grad/pseudo_mag17_train:  21842.16113; grad/true_std17_train:  0.00304; grad/pseudo_std17_train:  5.33213; grad/diff17_train:  21831.17305; grad/cos17_train:  0.88241; grad_train:  607.34625; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00006; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:28:51,210][trainer][INFO] - Step 460:
[2025-04-24 22:28:51,210][trainer][INFO] - loss/edit_train:  6.27123; loss/loc_train:  0.04059; edit/acc_train:  0.04320; edit/log_prob_train: -6.27123; edit/prob_train:  0.28238; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.78655; perplexity/pre_train:  16.22499; nll/post_train:  2.77347; perplexity/post_train:  16.01409; n_tokens/pre_train:  17.50000; n_tokens/post_train:  17.50000; time/edit_train:  0.17207; loss/total_train:  0.66771; loss/total_edit_train:  0.66771; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.12463; grad/pseudo_mag0_train:  20128.55801; grad/true_std0_train:  0.00125; grad/pseudo_std0_train:  4.91222; grad/diff0_train:  20125.43467; grad/cos0_train:  0.60711; grad/true_mag1_train:  8.47478; grad/pseudo_mag1_train:  19489.34531; grad/true_std1_train:  0.00207; grad/pseudo_std1_train:  4.75502; grad/diff1_train:  19483.88018; grad/cos1_train:  0.64236; grad/true_mag2_train:  8.73597; grad/pseudo_mag2_train:  22012.46992; grad/true_std2_train:  0.00213; grad/pseudo_std2_train:  5.32117; grad/diff2_train:  22007.41064; grad/cos2_train:  0.57413; grad/true_mag3_train:  5.60714; grad/pseudo_mag3_train:  20138.77236; grad/true_std3_train:  0.00137; grad/pseudo_std3_train:  4.91529; grad/diff3_train:  20135.42891; grad/cos3_train:  0.59340; grad/true_mag4_train:  10.16290; grad/pseudo_mag4_train:  18692.24570; grad/true_std4_train:  0.00248; grad/pseudo_std4_train:  4.56208; grad/diff4_train:  18685.66426; grad/cos4_train:  0.64514; grad/true_mag5_train:  10.96226; grad/pseudo_mag5_train:  20931.22119; grad/true_std5_train:  0.00268; grad/pseudo_std5_train:  5.07602; grad/diff5_train:  20924.95020; grad/cos5_train:  0.56474; grad/true_mag6_train:  6.20142; grad/pseudo_mag6_train:  19373.46914; grad/true_std6_train:  0.00151; grad/pseudo_std6_train:  4.72930; grad/diff6_train:  19369.33340; grad/cos6_train:  0.66222; grad/true_mag7_train:  11.39177; grad/pseudo_mag7_train:  18086.34912; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  4.41510; grad/diff7_train:  18078.13945; grad/cos7_train:  0.71729; grad/true_mag8_train:  14.09203; grad/pseudo_mag8_train:  19680.84951; grad/true_std8_train:  0.00344; grad/pseudo_std8_train:  4.79059; grad/diff8_train:  19671.17812; grad/cos8_train:  0.67514; grad/true_mag9_train:  8.10718; grad/pseudo_mag9_train:  18741.12969; grad/true_std9_train:  0.00198; grad/pseudo_std9_train:  4.57529; grad/diff9_train:  18734.64004; grad/cos9_train:  0.79553; grad/true_mag10_train:  11.86543; grad/pseudo_mag10_train:  19394.99238; grad/true_std10_train:  0.00290; grad/pseudo_std10_train:  4.73482; grad/diff10_train:  19385.32949; grad/cos10_train:  0.80970; grad/true_mag11_train:  15.58046; grad/pseudo_mag11_train:  19992.16191; grad/true_std11_train:  0.00380; grad/pseudo_std11_train:  4.87628; grad/diff11_train:  19979.93896; grad/cos11_train:  0.77654; grad/true_mag12_train:  9.32460; grad/pseudo_mag12_train:  19872.98008; grad/true_std12_train:  0.00228; grad/pseudo_std12_train:  4.85173; grad/diff12_train:  19864.93877; grad/cos12_train:  0.85770; grad/true_mag13_train:  11.63461; grad/pseudo_mag13_train:  19969.73389; grad/true_std13_train:  0.00284; grad/pseudo_std13_train:  4.87525; grad/diff13_train:  19959.67412; grad/cos13_train:  0.85949; grad/true_mag14_train:  14.05828; grad/pseudo_mag14_train:  20873.67158; grad/true_std14_train:  0.00343; grad/pseudo_std14_train:  5.09394; grad/diff14_train:  20861.80576; grad/cos14_train:  0.83588; grad/true_mag15_train:  9.40774; grad/pseudo_mag15_train:  20685.65537; grad/true_std15_train:  0.00230; grad/pseudo_std15_train:  5.05014; grad/diff15_train:  20677.21572; grad/cos15_train:  0.89202; grad/true_mag16_train:  11.05580; grad/pseudo_mag16_train:  20870.01289; grad/true_std16_train:  0.00270; grad/pseudo_std16_train:  5.09511; grad/diff16_train:  20860.21396; grad/cos16_train:  0.88078; grad/true_mag17_train:  12.72567; grad/pseudo_mag17_train:  21819.49688; grad/true_std17_train:  0.00311; grad/pseudo_std17_train:  5.32654; grad/diff17_train:  21808.43447; grad/cos17_train:  0.86104; grad_train:  1010.13501; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00008; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:28:54,578][trainer][INFO] - Step 470:
[2025-04-24 22:28:54,579][trainer][INFO] - loss/edit_train:  7.37710; loss/loc_train:  0.04290; edit/acc_train:  0.03424; edit/log_prob_train: -7.37710; edit/prob_train:  0.25123; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.87121; perplexity/pre_train:  48.00023; nll/post_train:  3.84063; perplexity/post_train:  46.55465; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.18032; loss/total_train:  0.78061; loss/total_edit_train:  0.78061; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.82021; grad/pseudo_mag0_train:  17672.22070; grad/true_std0_train:  0.00118; grad/pseudo_std0_train:  4.31055; grad/diff0_train:  17669.52227; grad/cos0_train:  0.56346; grad/true_mag1_train:  7.94049; grad/pseudo_mag1_train:  17504.16201; grad/true_std1_train:  0.00194; grad/pseudo_std1_train:  4.26756; grad/diff1_train:  17499.59375; grad/cos1_train:  0.57802; grad/true_mag2_train:  8.06972; grad/pseudo_mag2_train:  22320.53516; grad/true_std2_train:  0.00197; grad/pseudo_std2_train:  5.35929; grad/diff2_train:  22316.77480; grad/cos2_train:  0.45810; grad/true_mag3_train:  5.04882; grad/pseudo_mag3_train:  16077.28428; grad/true_std3_train:  0.00123; grad/pseudo_std3_train:  3.92330; grad/diff3_train:  16074.44502; grad/cos3_train:  0.56461; grad/true_mag4_train:  9.22650; grad/pseudo_mag4_train:  15545.72236; grad/true_std4_train:  0.00225; grad/pseudo_std4_train:  3.79316; grad/diff4_train:  15540.17383; grad/cos4_train:  0.60252; grad/true_mag5_train:  9.94018; grad/pseudo_mag5_train:  19402.91973; grad/true_std5_train:  0.00243; grad/pseudo_std5_train:  4.67937; grad/diff5_train:  19398.24023; grad/cos5_train:  0.46240; grad/true_mag6_train:  5.35119; grad/pseudo_mag6_train:  14652.15000; grad/true_std6_train:  0.00131; grad/pseudo_std6_train:  3.57655; grad/diff6_train:  14648.71729; grad/cos6_train:  0.64276; grad/true_mag7_train:  9.86115; grad/pseudo_mag7_train:  14579.49883; grad/true_std7_train:  0.00241; grad/pseudo_std7_train:  3.55885; grad/diff7_train:  14572.62686; grad/cos7_train:  0.69490; grad/true_mag8_train:  12.26823; grad/pseudo_mag8_train:  16609.73574; grad/true_std8_train:  0.00300; grad/pseudo_std8_train:  4.03204; grad/diff8_train:  16602.24307; grad/cos8_train:  0.59931; grad/true_mag9_train:  6.91071; grad/pseudo_mag9_train:  15313.05391; grad/true_std9_train:  0.00169; grad/pseudo_std9_train:  3.73836; grad/diff9_train:  15307.59268; grad/cos9_train:  0.78879; grad/true_mag10_train:  10.04954; grad/pseudo_mag10_train:  15843.27461; grad/true_std10_train:  0.00245; grad/pseudo_std10_train:  3.86764; grad/diff10_train:  15835.19365; grad/cos10_train:  0.80146; grad/true_mag11_train:  13.62770; grad/pseudo_mag11_train:  16802.19014; grad/true_std11_train:  0.00333; grad/pseudo_std11_train:  4.09460; grad/diff11_train:  16791.86992; grad/cos11_train:  0.74978; grad/true_mag12_train:  8.13546; grad/pseudo_mag12_train:  17243.49297; grad/true_std12_train:  0.00199; grad/pseudo_std12_train:  4.20978; grad/diff12_train:  17236.48740; grad/cos12_train:  0.85918; grad/true_mag13_train:  10.07774; grad/pseudo_mag13_train:  17092.99219; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  4.17299; grad/diff13_train:  17084.31836; grad/cos13_train:  0.85835; grad/true_mag14_train:  12.47986; grad/pseudo_mag14_train:  18325.04326; grad/true_std14_train:  0.00305; grad/pseudo_std14_train:  4.47041; grad/diff14_train:  18314.78818; grad/cos14_train:  0.81424; grad/true_mag15_train:  8.32386; grad/pseudo_mag15_train:  18343.78584; grad/true_std15_train:  0.00203; grad/pseudo_std15_train:  4.47841; grad/diff15_train:  18336.29150; grad/cos15_train:  0.89897; grad/true_mag16_train:  9.73186; grad/pseudo_mag16_train:  18266.84980; grad/true_std16_train:  0.00238; grad/pseudo_std16_train:  4.45962; grad/diff16_train:  18258.23994; grad/cos16_train:  0.88202; grad/true_mag17_train:  11.39626; grad/pseudo_mag17_train:  19514.15742; grad/true_std17_train:  0.00278; grad/pseudo_std17_train:  4.76375; grad/diff17_train:  19504.21699; grad/cos17_train:  0.86666; grad_train:  1260.33728; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:28:58,190][trainer][INFO] - Step 480:
[2025-04-24 22:28:58,190][trainer][INFO] - loss/edit_train:  5.67369; loss/loc_train:  0.12443; edit/acc_train:  0.06845; edit/log_prob_train: -5.67369; edit/prob_train:  0.21188; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.02983; perplexity/pre_train:  56.25147; nll/post_train:  4.29803; perplexity/post_train:  73.55498; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.21980; loss/total_train:  0.69180; loss/total_edit_train:  0.69180; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.98567; grad/pseudo_mag0_train:  21029.08779; grad/true_std0_train:  0.00122; grad/pseudo_std0_train:  5.13051; grad/diff0_train:  21026.18867; grad/cos0_train:  0.58478; grad/true_mag1_train:  8.13429; grad/pseudo_mag1_train:  19893.99746; grad/true_std1_train:  0.00199; grad/pseudo_std1_train:  4.85229; grad/diff1_train:  19889.05811; grad/cos1_train:  0.61171; grad/true_mag2_train:  8.31323; grad/pseudo_mag2_train:  22759.11934; grad/true_std2_train:  0.00203; grad/pseudo_std2_train:  5.48029; grad/diff2_train:  22754.69805; grad/cos2_train:  0.52613; grad/true_mag3_train:  5.34910; grad/pseudo_mag3_train:  20141.05693; grad/true_std3_train:  0.00131; grad/pseudo_std3_train:  4.91556; grad/diff3_train:  20137.94512; grad/cos3_train:  0.58360; grad/true_mag4_train:  9.52334; grad/pseudo_mag4_train:  18252.49844; grad/true_std4_train:  0.00233; grad/pseudo_std4_train:  4.45435; grad/diff4_train:  18246.51191; grad/cos4_train:  0.63141; grad/true_mag5_train:  10.14937; grad/pseudo_mag5_train:  20788.25723; grad/true_std5_train:  0.00248; grad/pseudo_std5_train:  5.02613; grad/diff5_train:  20782.89590; grad/cos5_train:  0.52877; grad/true_mag6_train:  5.83527; grad/pseudo_mag6_train:  18533.92266; grad/true_std6_train:  0.00142; grad/pseudo_std6_train:  4.52414; grad/diff6_train:  18530.12695; grad/cos6_train:  0.65319; grad/true_mag7_train:  10.33128; grad/pseudo_mag7_train:  16864.22588; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  4.11645; grad/diff7_train:  16856.93857; grad/cos7_train:  0.70889; grad/true_mag8_train:  12.73581; grad/pseudo_mag8_train:  18761.66904; grad/true_std8_train:  0.00311; grad/pseudo_std8_train:  4.55595; grad/diff8_train:  18753.76504; grad/cos8_train:  0.62002; grad/true_mag9_train:  7.22317; grad/pseudo_mag9_train:  17326.43721; grad/true_std9_train:  0.00176; grad/pseudo_std9_train:  4.22989; grad/diff9_train:  17320.69932; grad/cos9_train:  0.79356; grad/true_mag10_train:  10.51982; grad/pseudo_mag10_train:  17359.47588; grad/true_std10_train:  0.00257; grad/pseudo_std10_train:  4.23772; grad/diff10_train:  17351.16768; grad/cos10_train:  0.79171; grad/true_mag11_train:  13.59783; grad/pseudo_mag11_train:  18020.92627; grad/true_std11_train:  0.00332; grad/pseudo_std11_train:  4.39273; grad/diff11_train:  18010.74160; grad/cos11_train:  0.74792; grad/true_mag12_train:  8.15781; grad/pseudo_mag12_train:  17668.84775; grad/true_std12_train:  0.00199; grad/pseudo_std12_train:  4.31361; grad/diff12_train:  17661.89678; grad/cos12_train:  0.84934; grad/true_mag13_train:  10.30800; grad/pseudo_mag13_train:  17923.24189; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  4.37552; grad/diff13_train:  17914.52275; grad/cos13_train:  0.84482; grad/true_mag14_train:  12.79802; grad/pseudo_mag14_train:  18898.13018; grad/true_std14_train:  0.00312; grad/pseudo_std14_train:  4.61079; grad/diff14_train:  18887.86211; grad/cos14_train:  0.80064; grad/true_mag15_train:  8.13506; grad/pseudo_mag15_train:  18238.14707; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  4.45260; grad/diff15_train:  18230.96592; grad/cos15_train:  0.87851; grad/true_mag16_train:  9.54023; grad/pseudo_mag16_train:  17963.50605; grad/true_std16_train:  0.00233; grad/pseudo_std16_train:  4.38553; grad/diff16_train:  17955.15166; grad/cos16_train:  0.87269; grad/true_mag17_train:  11.70259; grad/pseudo_mag17_train:  19880.89609; grad/true_std17_train:  0.00286; grad/pseudo_std17_train:  4.85294; grad/diff17_train:  19871.27588; grad/cos17_train:  0.83047; grad_train:  1993.36658; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:29:01,420][trainer][INFO] - Step 490:
[2025-04-24 22:29:01,420][trainer][INFO] - loss/edit_train:  6.21849; loss/loc_train:  0.03496; edit/acc_train:  0.07500; edit/log_prob_train: -6.21849; edit/prob_train:  0.24205; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.02561; perplexity/pre_train:  56.01456; nll/post_train:  4.00659; perplexity/post_train:  54.95936; n_tokens/pre_train:  10.20000; n_tokens/post_train:  10.20000; time/edit_train:  0.17957; loss/total_train:  0.65680; loss/total_edit_train:  0.65680; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.07735; grad/pseudo_mag0_train:  17698.92119; grad/true_std0_train:  0.00124; grad/pseudo_std0_train:  4.31839; grad/diff0_train:  17695.97891; grad/cos0_train:  0.57926; grad/true_mag1_train:  8.23129; grad/pseudo_mag1_train:  18171.67686; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.43195; grad/diff1_train:  18166.60195; grad/cos1_train:  0.61649; grad/true_mag2_train:  8.57469; grad/pseudo_mag2_train:  24283.00625; grad/true_std2_train:  0.00209; grad/pseudo_std2_train:  5.82617; grad/diff2_train:  24278.87109; grad/cos2_train:  0.47937; grad/true_mag3_train:  5.50931; grad/pseudo_mag3_train:  17624.07070; grad/true_std3_train:  0.00135; grad/pseudo_std3_train:  4.30136; grad/diff3_train:  17620.88818; grad/cos3_train:  0.57802; grad/true_mag4_train:  9.99512; grad/pseudo_mag4_train:  17317.75117; grad/true_std4_train:  0.00244; grad/pseudo_std4_train:  4.22625; grad/diff4_train:  17311.48848; grad/cos4_train:  0.62710; grad/true_mag5_train:  10.77599; grad/pseudo_mag5_train:  21722.33301; grad/true_std5_train:  0.00263; grad/pseudo_std5_train:  5.23933; grad/diff5_train:  21717.02773; grad/cos5_train:  0.49033; grad/true_mag6_train:  6.24664; grad/pseudo_mag6_train:  17141.49512; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.18442; grad/diff6_train:  17137.40742; grad/cos6_train:  0.65500; grad/true_mag7_train:  11.27304; grad/pseudo_mag7_train:  17130.99990; grad/true_std7_train:  0.00275; grad/pseudo_std7_train:  4.18164; grad/diff7_train:  17123.10234; grad/cos7_train:  0.70026; grad/true_mag8_train:  14.01792; grad/pseudo_mag8_train:  20071.67617; grad/true_std8_train:  0.00342; grad/pseudo_std8_train:  4.87161; grad/diff8_train:  20063.03906; grad/cos8_train:  0.60756; grad/true_mag9_train:  7.96012; grad/pseudo_mag9_train:  18566.48789; grad/true_std9_train:  0.00194; grad/pseudo_std9_train:  4.53265; grad/diff9_train:  18560.12686; grad/cos9_train:  0.79734; grad/true_mag10_train:  11.69429; grad/pseudo_mag10_train:  18954.55127; grad/true_std10_train:  0.00286; grad/pseudo_std10_train:  4.62722; grad/diff10_train:  18945.05918; grad/cos10_train:  0.80913; grad/true_mag11_train:  15.41642; grad/pseudo_mag11_train:  20216.80020; grad/true_std11_train:  0.00376; grad/pseudo_std11_train:  4.92608; grad/diff11_train:  20205.02734; grad/cos11_train:  0.75392; grad/true_mag12_train:  9.27930; grad/pseudo_mag12_train:  20104.91318; grad/true_std12_train:  0.00227; grad/pseudo_std12_train:  4.90837; grad/diff12_train:  20096.88242; grad/cos12_train:  0.86182; grad/true_mag13_train:  11.57782; grad/pseudo_mag13_train:  19956.09219; grad/true_std13_train:  0.00283; grad/pseudo_std13_train:  4.87200; grad/diff13_train:  19946.05146; grad/cos13_train:  0.86366; grad/true_mag14_train:  14.36996; grad/pseudo_mag14_train:  21129.64912; grad/true_std14_train:  0.00351; grad/pseudo_std14_train:  5.15396; grad/diff14_train:  21117.87197; grad/cos14_train:  0.81228; grad/true_mag15_train:  9.41899; grad/pseudo_mag15_train:  20899.04150; grad/true_std15_train:  0.00230; grad/pseudo_std15_train:  5.10226; grad/diff15_train:  20890.55723; grad/cos15_train:  0.89776; grad/true_mag16_train:  10.99340; grad/pseudo_mag16_train:  20819.64971; grad/true_std16_train:  0.00268; grad/pseudo_std16_train:  5.08285; grad/diff16_train:  20809.91211; grad/cos16_train:  0.88117; grad/true_mag17_train:  12.57317; grad/pseudo_mag17_train:  21957.84951; grad/true_std17_train:  0.00307; grad/pseudo_std17_train:  5.35980; grad/diff17_train:  21946.97285; grad/cos17_train:  0.85796; grad_train:  565.24908; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:29:04,597][trainer][INFO] - Step 500:
[2025-04-24 22:29:04,597][trainer][INFO] - loss/edit_train:  4.95393; loss/loc_train:  0.06477; edit/acc_train:  0.10679; edit/log_prob_train: -4.95393; edit/prob_train:  0.29658; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.50276; perplexity/pre_train:  33.20701; nll/post_train:  3.49882; perplexity/post_train:  33.07644; n_tokens/pre_train:  10.30000; n_tokens/post_train:  10.30000; time/edit_train:  0.17604; loss/total_train:  0.56016; loss/total_edit_train:  0.56016; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.12085; grad/pseudo_mag0_train:  19293.04395; grad/true_std0_train:  0.00125; grad/pseudo_std0_train:  4.70720; grad/diff0_train:  19290.08105; grad/cos0_train:  0.58102; grad/true_mag1_train:  8.23733; grad/pseudo_mag1_train:  19140.84160; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.66762; grad/diff1_train:  19135.85498; grad/cos1_train:  0.60702; grad/true_mag2_train:  8.51155; grad/pseudo_mag2_train:  23507.95137; grad/true_std2_train:  0.00208; grad/pseudo_std2_train:  5.65706; grad/diff2_train:  23503.64082; grad/cos2_train:  0.50333; grad/true_mag3_train:  5.51745; grad/pseudo_mag3_train:  18557.60879; grad/true_std3_train:  0.00135; grad/pseudo_std3_train:  4.52901; grad/diff3_train:  18554.44561; grad/cos3_train:  0.57574; grad/true_mag4_train:  9.75035; grad/pseudo_mag4_train:  17639.62607; grad/true_std4_train:  0.00238; grad/pseudo_std4_train:  4.30458; grad/diff4_train:  17633.58428; grad/cos4_train:  0.62143; grad/true_mag5_train:  10.61865; grad/pseudo_mag5_train:  22349.85293; grad/true_std5_train:  0.00259; grad/pseudo_std5_train:  5.39244; grad/diff5_train:  22344.71152; grad/cos5_train:  0.48157; grad/true_mag6_train:  5.95034; grad/pseudo_mag6_train:  17716.24277; grad/true_std6_train:  0.00145; grad/pseudo_std6_train:  4.32453; grad/diff6_train:  17712.34287; grad/cos6_train:  0.65699; grad/true_mag7_train:  10.97036; grad/pseudo_mag7_train:  17003.88838; grad/true_std7_train:  0.00268; grad/pseudo_std7_train:  4.15068; grad/diff7_train:  16996.16416; grad/cos7_train:  0.70436; grad/true_mag8_train:  14.10010; grad/pseudo_mag8_train:  20963.83203; grad/true_std8_train:  0.00344; grad/pseudo_std8_train:  5.08714; grad/diff8_train:  20955.45586; grad/cos8_train:  0.59018; grad/true_mag9_train:  8.02989; grad/pseudo_mag9_train:  18396.06406; grad/true_std9_train:  0.00196; grad/pseudo_std9_train:  4.49103; grad/diff9_train:  18389.65771; grad/cos9_train:  0.79659; grad/true_mag10_train:  11.65300; grad/pseudo_mag10_train:  18973.64033; grad/true_std10_train:  0.00284; grad/pseudo_std10_train:  4.63183; grad/diff10_train:  18964.17148; grad/cos10_train:  0.81031; grad/true_mag11_train:  15.20700; grad/pseudo_mag11_train:  20393.08096; grad/true_std11_train:  0.00371; grad/pseudo_std11_train:  4.97029; grad/diff11_train:  20381.32627; grad/cos11_train:  0.76498; grad/true_mag12_train:  9.24808; grad/pseudo_mag12_train:  20153.38555; grad/true_std12_train:  0.00226; grad/pseudo_std12_train:  4.92020; grad/diff12_train:  20145.34922; grad/cos12_train:  0.86628; grad/true_mag13_train:  11.66032; grad/pseudo_mag13_train:  20203.83125; grad/true_std13_train:  0.00285; grad/pseudo_std13_train:  4.93244; grad/diff13_train:  20193.71094; grad/cos13_train:  0.86480; grad/true_mag14_train:  14.20900; grad/pseudo_mag14_train:  21453.96855; grad/true_std14_train:  0.00347; grad/pseudo_std14_train:  5.23421; grad/diff14_train:  21442.10098; grad/cos14_train:  0.82740; grad/true_mag15_train:  9.54406; grad/pseudo_mag15_train:  21020.76699; grad/true_std15_train:  0.00233; grad/pseudo_std15_train:  5.13197; grad/diff15_train:  21012.16201; grad/cos15_train:  0.89996; grad/true_mag16_train:  11.17827; grad/pseudo_mag16_train:  21257.73525; grad/true_std16_train:  0.00273; grad/pseudo_std16_train:  5.18979; grad/diff16_train:  21247.78428; grad/cos16_train:  0.88743; grad/true_mag17_train:  12.71717; grad/pseudo_mag17_train:  22149.69336; grad/true_std17_train:  0.00310; grad/pseudo_std17_train:  5.40686; grad/diff17_train:  22138.57383; grad/cos17_train:  0.86931; grad_train:  1163.29126; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:29:23,083][trainer][INFO] - Step 500:
[2025-04-24 22:29:23,083][trainer][INFO] - loss/edit_val:  6.37391; loss/loc_val:  0.08315; edit/acc_val:  0.03286; edit/log_prob_val: -6.37391; edit/prob_val:  0.26152; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.41076; perplexity/post_val:  82.33199; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11058; loss/total_val:  0.72054; loss/total_edit_val:  0.72054; memory/alloc_max_val:  42223547904.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  18.48094; eval_time/average:  0.18481
[2025-04-24 22:29:23,087][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:29:23,087][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:30:16,974][trainer][INFO] - Write complete.
[2025-04-24 22:30:20,110][trainer][INFO] - Step 510:
[2025-04-24 22:30:20,110][trainer][INFO] - loss/edit_train:  5.61945; loss/loc_train:  0.11171; edit/acc_train:  0.03929; edit/log_prob_train: -5.61945; edit/prob_train:  0.25538; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.60259; perplexity/pre_train:  36.69323; nll/post_train:  3.79103; perplexity/post_train:  44.30220; n_tokens/pre_train:  7.30000; n_tokens/post_train:  7.30000; time/edit_train:  0.17112; loss/total_train:  0.67366; loss/total_edit_train:  0.67366; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.43198; grad/pseudo_mag0_train:  21481.87002; grad/true_std0_train:  0.00133; grad/pseudo_std0_train:  5.24018; grad/diff0_train:  21478.71904; grad/cos0_train:  0.58384; grad/true_mag1_train:  8.73777; grad/pseudo_mag1_train:  20891.63701; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  5.09336; grad/diff1_train:  20886.34785; grad/cos1_train:  0.60514; grad/true_mag2_train:  8.95879; grad/pseudo_mag2_train:  24921.65781; grad/true_std2_train:  0.00219; grad/pseudo_std2_train:  5.99198; grad/diff2_train:  24917.14746; grad/cos2_train:  0.49733; grad/true_mag3_train:  5.72607; grad/pseudo_mag3_train:  19416.38145; grad/true_std3_train:  0.00140; grad/pseudo_std3_train:  4.73795; grad/diff3_train:  19413.10117; grad/cos3_train:  0.57441; grad/true_mag4_train:  10.12318; grad/pseudo_mag4_train:  18586.43223; grad/true_std4_train:  0.00247; grad/pseudo_std4_train:  4.53516; grad/diff4_train:  18580.24111; grad/cos4_train:  0.61409; grad/true_mag5_train:  11.01372; grad/pseudo_mag5_train:  22364.25723; grad/true_std5_train:  0.00269; grad/pseudo_std5_train:  5.39666; grad/diff5_train:  22358.88262; grad/cos5_train:  0.47960; grad/true_mag6_train:  6.32301; grad/pseudo_mag6_train:  17667.91318; grad/true_std6_train:  0.00154; grad/pseudo_std6_train:  4.31250; grad/diff6_train:  17663.90605; grad/cos6_train:  0.63642; grad/true_mag7_train:  11.15518; grad/pseudo_mag7_train:  17265.52725; grad/true_std7_train:  0.00272; grad/pseudo_std7_train:  4.21440; grad/diff7_train:  17257.77207; grad/cos7_train:  0.69367; grad/true_mag8_train:  13.76251; grad/pseudo_mag8_train:  19976.38994; grad/true_std8_train:  0.00336; grad/pseudo_std8_train:  4.84856; grad/diff8_train:  19968.18721; grad/cos8_train:  0.58389; grad/true_mag9_train:  7.97652; grad/pseudo_mag9_train:  18201.35176; grad/true_std9_train:  0.00195; grad/pseudo_std9_train:  4.44342; grad/diff9_train:  18195.07637; grad/cos9_train:  0.78240; grad/true_mag10_train:  11.68590; grad/pseudo_mag10_train:  18693.55469; grad/true_std10_train:  0.00285; grad/pseudo_std10_train:  4.56344; grad/diff10_train:  18684.21592; grad/cos10_train:  0.79404; grad/true_mag11_train:  15.21301; grad/pseudo_mag11_train:  19740.85771; grad/true_std11_train:  0.00371; grad/pseudo_std11_train:  4.81067; grad/diff11_train:  19729.60713; grad/cos11_train:  0.72470; grad/true_mag12_train:  9.01868; grad/pseudo_mag12_train:  19220.05322; grad/true_std12_train:  0.00220; grad/pseudo_std12_train:  4.69231; grad/diff12_train:  19212.33965; grad/cos12_train:  0.84991; grad/true_mag13_train:  11.32950; grad/pseudo_mag13_train:  19316.26885; grad/true_std13_train:  0.00277; grad/pseudo_std13_train:  4.71574; grad/diff13_train:  19306.53887; grad/cos13_train:  0.85335; grad/true_mag14_train:  14.04791; grad/pseudo_mag14_train:  20431.95557; grad/true_std14_train:  0.00343; grad/pseudo_std14_train:  4.98467; grad/diff14_train:  20420.51660; grad/cos14_train:  0.79952; grad/true_mag15_train:  9.24802; grad/pseudo_mag15_train:  20269.92432; grad/true_std15_train:  0.00226; grad/pseudo_std15_train:  4.94865; grad/diff15_train:  20261.65557; grad/cos15_train:  0.89077; grad/true_mag16_train:  10.98341; grad/pseudo_mag16_train:  20354.62236; grad/true_std16_train:  0.00268; grad/pseudo_std16_train:  4.96932; grad/diff16_train:  20344.97783; grad/cos16_train:  0.87109; grad/true_mag17_train:  12.54229; grad/pseudo_mag17_train:  21671.05693; grad/true_std17_train:  0.00306; grad/pseudo_std17_train:  5.29008; grad/diff17_train:  21660.18936; grad/cos17_train:  0.85473; grad_train:  1136.36694; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:30:23,374][trainer][INFO] - Step 520:
[2025-04-24 22:30:23,374][trainer][INFO] - loss/edit_train:  5.25569; loss/loc_train:  0.04264; edit/acc_train:  0.05135; edit/log_prob_train: -5.25569; edit/prob_train:  0.25486; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.72388; perplexity/pre_train:  112.60438; nll/post_train:  4.63586; perplexity/post_train:  103.11688; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.17482; loss/total_train:  0.56821; loss/total_edit_train:  0.56821; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.47736; grad/pseudo_mag0_train:  19757.69668; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  4.81925; grad/diff0_train:  19754.64062; grad/cos0_train:  0.56655; grad/true_mag1_train:  8.93025; grad/pseudo_mag1_train:  20350.22969; grad/true_std1_train:  0.00218; grad/pseudo_std1_train:  4.96130; grad/diff1_train:  20345.00654; grad/cos1_train:  0.59340; grad/true_mag2_train:  9.07494; grad/pseudo_mag2_train:  26945.40898; grad/true_std2_train:  0.00222; grad/pseudo_std2_train:  6.45388; grad/diff2_train:  26941.35059; grad/cos2_train:  0.43856; grad/true_mag3_train:  5.81827; grad/pseudo_mag3_train:  18217.38135; grad/true_std3_train:  0.00142; grad/pseudo_std3_train:  4.44557; grad/diff3_train:  18214.13662; grad/cos3_train:  0.56356; grad/true_mag4_train:  10.73508; grad/pseudo_mag4_train:  19051.95176; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.64831; grad/diff4_train:  19045.61152; grad/cos4_train:  0.60151; grad/true_mag5_train:  11.89680; grad/pseudo_mag5_train:  24319.99883; grad/true_std5_train:  0.00290; grad/pseudo_std5_train:  5.85698; grad/diff5_train:  24314.65020; grad/cos5_train:  0.43671; grad/true_mag6_train:  6.57828; grad/pseudo_mag6_train:  18209.35635; grad/true_std6_train:  0.00161; grad/pseudo_std6_train:  4.44500; grad/diff6_train:  18205.08828; grad/cos6_train:  0.64904; grad/true_mag7_train:  11.94903; grad/pseudo_mag7_train:  18350.78301; grad/true_std7_train:  0.00292; grad/pseudo_std7_train:  4.47938; grad/diff7_train:  18342.36162; grad/cos7_train:  0.70118; grad/true_mag8_train:  15.40126; grad/pseudo_mag8_train:  21234.47344; grad/true_std8_train:  0.00376; grad/pseudo_std8_train:  5.15145; grad/diff8_train:  21225.25771; grad/cos8_train:  0.58055; grad/true_mag9_train:  8.99133; grad/pseudo_mag9_train:  21446.07725; grad/true_std9_train:  0.00220; grad/pseudo_std9_train:  5.23564; grad/diff9_train:  21438.85361; grad/cos9_train:  0.80007; grad/true_mag10_train:  12.52024; grad/pseudo_mag10_train:  20665.13018; grad/true_std10_train:  0.00306; grad/pseudo_std10_train:  5.04479; grad/diff10_train:  20654.83906; grad/cos10_train:  0.81644; grad/true_mag11_train:  15.83608; grad/pseudo_mag11_train:  21414.25703; grad/true_std11_train:  0.00387; grad/pseudo_std11_train:  5.21941; grad/diff11_train:  21401.83379; grad/cos11_train:  0.77282; grad/true_mag12_train:  9.97378; grad/pseudo_mag12_train:  21917.52568; grad/true_std12_train:  0.00244; grad/pseudo_std12_train:  5.35088; grad/diff12_train:  21908.83945; grad/cos12_train:  0.86625; grad/true_mag13_train:  12.38220; grad/pseudo_mag13_train:  21317.17852; grad/true_std13_train:  0.00302; grad/pseudo_std13_train:  5.20425; grad/diff13_train:  21306.42881; grad/cos13_train:  0.86273; grad/true_mag14_train:  14.86633; grad/pseudo_mag14_train:  22269.73027; grad/true_std14_train:  0.00363; grad/pseudo_std14_train:  5.43321; grad/diff14_train:  22257.18926; grad/cos14_train:  0.83059; grad/true_mag15_train:  9.95072; grad/pseudo_mag15_train:  22157.54736; grad/true_std15_train:  0.00243; grad/pseudo_std15_train:  5.40948; grad/diff15_train:  22148.56689; grad/cos15_train:  0.90007; grad/true_mag16_train:  11.56094; grad/pseudo_mag16_train:  21985.71768; grad/true_std16_train:  0.00282; grad/pseudo_std16_train:  5.36751; grad/diff16_train:  21975.43428; grad/cos16_train:  0.88463; grad/true_mag17_train:  13.13395; grad/pseudo_mag17_train:  22994.08770; grad/true_std17_train:  0.00321; grad/pseudo_std17_train:  5.61312; grad/diff17_train:  22982.49424; grad/cos17_train:  0.87383; grad_train:  670.13519; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:30:27,034][trainer][INFO] - Step 530:
[2025-04-24 22:30:27,035][trainer][INFO] - loss/edit_train:  5.18066; loss/loc_train:  0.09920; edit/acc_train:  0.03448; edit/log_prob_train: -5.18066; edit/prob_train:  0.27304; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.70936; perplexity/pre_train:  40.82747; nll/post_train:  3.61078; perplexity/post_train:  36.99488; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.22013; loss/total_train:  0.61726; loss/total_edit_train:  0.61726; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.51172; grad/pseudo_mag0_train:  20196.12520; grad/true_std0_train:  0.00135; grad/pseudo_std0_train:  4.92571; grad/diff0_train:  20193.09590; grad/cos0_train:  0.55851; grad/true_mag1_train:  8.74123; grad/pseudo_mag1_train:  20591.16777; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  5.01616; grad/diff1_train:  20586.16973; grad/cos1_train:  0.57920; grad/true_mag2_train:  8.69584; grad/pseudo_mag2_train:  26440.74766; grad/true_std2_train:  0.00212; grad/pseudo_std2_train:  6.31966; grad/diff2_train:  26436.89316; grad/cos2_train:  0.43322; grad/true_mag3_train:  5.52069; grad/pseudo_mag3_train:  17741.99561; grad/true_std3_train:  0.00135; grad/pseudo_std3_train:  4.32882; grad/diff3_train:  17738.97754; grad/cos3_train:  0.54957; grad/true_mag4_train:  9.91869; grad/pseudo_mag4_train:  17482.30010; grad/true_std4_train:  0.00242; grad/pseudo_std4_train:  4.26494; grad/diff4_train:  17476.47715; grad/cos4_train:  0.58935; grad/true_mag5_train:  10.38314; grad/pseudo_mag5_train:  22795.75742; grad/true_std5_train:  0.00253; grad/pseudo_std5_train:  5.47474; grad/diff5_train:  22791.20059; grad/cos5_train:  0.43267; grad/true_mag6_train:  5.87531; grad/pseudo_mag6_train:  16191.71748; grad/true_std6_train:  0.00143; grad/pseudo_std6_train:  3.95220; grad/diff6_train:  16187.98857; grad/cos6_train:  0.63623; grad/true_mag7_train:  10.52079; grad/pseudo_mag7_train:  16002.71172; grad/true_std7_train:  0.00257; grad/pseudo_std7_train:  3.90604; grad/diff7_train:  15995.41035; grad/cos7_train:  0.69233; grad/true_mag8_train:  13.00173; grad/pseudo_mag8_train:  19587.21309; grad/true_std8_train:  0.00317; grad/pseudo_std8_train:  4.74368; grad/diff8_train:  19579.70469; grad/cos8_train:  0.56460; grad/true_mag9_train:  7.53849; grad/pseudo_mag9_train:  17612.51074; grad/true_std9_train:  0.00184; grad/pseudo_std9_train:  4.29974; grad/diff9_train:  17606.52617; grad/cos9_train:  0.79034; grad/true_mag10_train:  10.89592; grad/pseudo_mag10_train:  17604.58057; grad/true_std10_train:  0.00266; grad/pseudo_std10_train:  4.29765; grad/diff10_train:  17595.76182; grad/cos10_train:  0.80582; grad/true_mag11_train:  13.89857; grad/pseudo_mag11_train:  18949.28350; grad/true_std11_train:  0.00339; grad/pseudo_std11_train:  4.61510; grad/diff11_train:  18938.88018; grad/cos11_train:  0.73662; grad/true_mag12_train:  8.56304; grad/pseudo_mag12_train:  18363.81455; grad/true_std12_train:  0.00209; grad/pseudo_std12_train:  4.48329; grad/diff12_train:  18356.43633; grad/cos12_train:  0.85804; grad/true_mag13_train:  10.69356; grad/pseudo_mag13_train:  18202.98516; grad/true_std13_train:  0.00261; grad/pseudo_std13_train:  4.44396; grad/diff13_train:  18193.75195; grad/cos13_train:  0.86015; grad/true_mag14_train:  13.09201; grad/pseudo_mag14_train:  19627.07119; grad/true_std14_train:  0.00320; grad/pseudo_std14_train:  4.78673; grad/diff14_train:  19616.33564; grad/cos14_train:  0.80965; grad/true_mag15_train:  8.79842; grad/pseudo_mag15_train:  19202.81553; grad/true_std15_train:  0.00215; grad/pseudo_std15_train:  4.68814; grad/diff15_train:  19194.92871; grad/cos15_train:  0.89298; grad/true_mag16_train:  10.29601; grad/pseudo_mag16_train:  19294.44160; grad/true_std16_train:  0.00251; grad/pseudo_std16_train:  4.71049; grad/diff16_train:  19285.34434; grad/cos16_train:  0.87908; grad/true_mag17_train:  12.06630; grad/pseudo_mag17_train:  20555.53242; grad/true_std17_train:  0.00295; grad/pseudo_std17_train:  5.01760; grad/diff17_train:  20545.08369; grad/cos17_train:  0.85710; grad_train:  2103.07373; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:30:30,204][trainer][INFO] - Step 540:
[2025-04-24 22:30:30,204][trainer][INFO] - loss/edit_train:  5.77225; loss/loc_train:  0.19081; edit/acc_train:  0.02579; edit/log_prob_train: -5.77225; edit/prob_train:  0.27382; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.19649; perplexity/pre_train:  66.45249; nll/post_train:  4.16401; perplexity/post_train:  64.32868; n_tokens/pre_train:  7.20000; n_tokens/post_train:  7.20000; time/edit_train:  0.17064; loss/total_train:  0.76803; loss/total_edit_train:  0.76803; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.79349; grad/pseudo_mag0_train:  19264.49414; grad/true_std0_train:  0.00117; grad/pseudo_std0_train:  4.69522; grad/diff0_train:  19261.84180; grad/cos0_train:  0.55631; grad/true_mag1_train:  7.96538; grad/pseudo_mag1_train:  18289.70400; grad/true_std1_train:  0.00194; grad/pseudo_std1_train:  4.45573; grad/diff1_train:  18285.20664; grad/cos1_train:  0.56529; grad/true_mag2_train:  7.98858; grad/pseudo_mag2_train:  27443.05254; grad/true_std2_train:  0.00195; grad/pseudo_std2_train:  6.52036; grad/diff2_train:  27439.93848; grad/cos2_train:  0.37848; grad/true_mag3_train:  5.07143; grad/pseudo_mag3_train:  17159.33115; grad/true_std3_train:  0.00124; grad/pseudo_std3_train:  4.18596; grad/diff3_train:  17156.49893; grad/cos3_train:  0.56088; grad/true_mag4_train:  8.93942; grad/pseudo_mag4_train:  16106.90654; grad/true_std4_train:  0.00218; grad/pseudo_std4_train:  3.92883; grad/diff4_train:  16101.57891; grad/cos4_train:  0.59791; grad/true_mag5_train:  9.68008; grad/pseudo_mag5_train:  23460.87559; grad/true_std5_train:  0.00236; grad/pseudo_std5_train:  5.61528; grad/diff5_train:  23456.92480; grad/cos5_train:  0.39685; grad/true_mag6_train:  5.39388; grad/pseudo_mag6_train:  15748.28672; grad/true_std6_train:  0.00132; grad/pseudo_std6_train:  3.84354; grad/diff6_train:  15744.82646; grad/cos6_train:  0.64300; grad/true_mag7_train:  9.79541; grad/pseudo_mag7_train:  15089.14180; grad/true_std7_train:  0.00239; grad/pseudo_std7_train:  3.68262; grad/diff7_train:  15082.46064; grad/cos7_train:  0.68039; grad/true_mag8_train:  12.06254; grad/pseudo_mag8_train:  19519.80918; grad/true_std8_train:  0.00294; grad/pseudo_std8_train:  4.71512; grad/diff8_train:  19513.34473; grad/cos8_train:  0.52258; grad/true_mag9_train:  6.79956; grad/pseudo_mag9_train:  15264.02646; grad/true_std9_train:  0.00166; grad/pseudo_std9_train:  3.72625; grad/diff9_train:  15258.69414; grad/cos9_train:  0.78004; grad/true_mag10_train:  10.14522; grad/pseudo_mag10_train:  15790.86270; grad/true_std10_train:  0.00248; grad/pseudo_std10_train:  3.85457; grad/diff10_train:  15782.86406; grad/cos10_train:  0.78405; grad/true_mag11_train:  12.81014; grad/pseudo_mag11_train:  17002.85938; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  4.13521; grad/diff11_train:  16993.59727; grad/cos11_train:  0.70837; grad/true_mag12_train:  7.69928; grad/pseudo_mag12_train:  16016.69248; grad/true_std12_train:  0.00188; grad/pseudo_std12_train:  3.91023; grad/diff12_train:  16010.15459; grad/cos12_train:  0.84367; grad/true_mag13_train:  9.85272; grad/pseudo_mag13_train:  16084.67744; grad/true_std13_train:  0.00241; grad/pseudo_std13_train:  3.92676; grad/diff13_train:  16076.33818; grad/cos13_train:  0.84181; grad/true_mag14_train:  12.36141; grad/pseudo_mag14_train:  17271.05820; grad/true_std14_train:  0.00302; grad/pseudo_std14_train:  4.20997; grad/diff14_train:  17261.44736; grad/cos14_train:  0.76471; grad/true_mag15_train:  7.82410; grad/pseudo_mag15_train:  16901.85703; grad/true_std15_train:  0.00191; grad/pseudo_std15_train:  4.12636; grad/diff15_train:  16894.88672; grad/cos15_train:  0.88723; grad/true_mag16_train:  9.31481; grad/pseudo_mag16_train:  16866.37979; grad/true_std16_train:  0.00227; grad/pseudo_std16_train:  4.11766; grad/diff16_train:  16858.30059; grad/cos16_train:  0.86102; grad/true_mag17_train:  10.85518; grad/pseudo_mag17_train:  18061.82676; grad/true_std17_train:  0.00265; grad/pseudo_std17_train:  4.40842; grad/diff17_train:  18052.71104; grad/cos17_train:  0.82926; grad_train:  1271.88647; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:30:33,880][trainer][INFO] - Step 550:
[2025-04-24 22:30:33,881][trainer][INFO] - loss/edit_train:  5.86599; loss/loc_train:  0.04343; edit/acc_train:  0.03667; edit/log_prob_train: -5.86599; edit/prob_train:  0.28224; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.38632; perplexity/pre_train:  80.34409; nll/post_train:  4.26862; perplexity/post_train:  71.42307; n_tokens/pre_train:  6.00000; n_tokens/post_train:  6.00000; time/edit_train:  0.22344; loss/total_train:  0.63003; loss/total_edit_train:  0.63003; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.68688; grad/pseudo_mag0_train:  19879.68867; grad/true_std0_train:  0.00139; grad/pseudo_std0_train:  4.85002; grad/diff0_train:  19876.50127; grad/cos0_train:  0.56418; grad/true_mag1_train:  9.09275; grad/pseudo_mag1_train:  21072.95449; grad/true_std1_train:  0.00222; grad/pseudo_std1_train:  5.13825; grad/diff1_train:  21067.55195; grad/cos1_train:  0.59606; grad/true_mag2_train:  9.14819; grad/pseudo_mag2_train:  27665.36367; grad/true_std2_train:  0.00223; grad/pseudo_std2_train:  6.62186; grad/diff2_train:  27661.16699; grad/cos2_train:  0.45094; grad/true_mag3_train:  6.09778; grad/pseudo_mag3_train:  19128.84941; grad/true_std3_train:  0.00149; grad/pseudo_std3_train:  4.66816; grad/diff3_train:  19125.49414; grad/cos3_train:  0.55460; grad/true_mag4_train:  10.86158; grad/pseudo_mag4_train:  19407.60156; grad/true_std4_train:  0.00265; grad/pseudo_std4_train:  4.73530; grad/diff4_train:  19401.03730; grad/cos4_train:  0.60817; grad/true_mag5_train:  11.92542; grad/pseudo_mag5_train:  25088.98223; grad/true_std5_train:  0.00291; grad/pseudo_std5_train:  6.03568; grad/diff5_train:  25083.49824; grad/cos5_train:  0.45085; grad/true_mag6_train:  6.59714; grad/pseudo_mag6_train:  19230.76582; grad/true_std6_train:  0.00161; grad/pseudo_std6_train:  4.69426; grad/diff6_train:  19226.50527; grad/cos6_train:  0.64918; grad/true_mag7_train:  12.04065; grad/pseudo_mag7_train:  18792.28340; grad/true_std7_train:  0.00294; grad/pseudo_std7_train:  4.58727; grad/diff7_train:  18783.74189; grad/cos7_train:  0.70632; grad/true_mag8_train:  15.04011; grad/pseudo_mag8_train:  22351.77334; grad/true_std8_train:  0.00367; grad/pseudo_std8_train:  5.42272; grad/diff8_train:  22342.57051; grad/cos8_train:  0.59690; grad/true_mag9_train:  8.98704; grad/pseudo_mag9_train:  21962.59658; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  5.36177; grad/diff9_train:  21955.38662; grad/cos9_train:  0.79680; grad/true_mag10_train:  12.85181; grad/pseudo_mag10_train:  21188.97627; grad/true_std10_train:  0.00314; grad/pseudo_std10_train:  5.17272; grad/diff10_train:  21178.53623; grad/cos10_train:  0.80841; grad/true_mag11_train:  16.84514; grad/pseudo_mag11_train:  22533.61777; grad/true_std11_train:  0.00411; grad/pseudo_std11_train:  5.49145; grad/diff11_train:  22520.79688; grad/cos11_train:  0.74492; grad/true_mag12_train:  10.41092; grad/pseudo_mag12_train:  23115.19609; grad/true_std12_train:  0.00254; grad/pseudo_std12_train:  5.64327; grad/diff12_train:  23106.14717; grad/cos12_train:  0.86285; grad/true_mag13_train:  12.74810; grad/pseudo_mag13_train:  22514.04932; grad/true_std13_train:  0.00311; grad/pseudo_std13_train:  5.49644; grad/diff13_train:  22502.91738; grad/cos13_train:  0.86786; grad/true_mag14_train:  15.31255; grad/pseudo_mag14_train:  23812.49453; grad/true_std14_train:  0.00374; grad/pseudo_std14_train:  5.80943; grad/diff14_train:  23799.60879; grad/cos14_train:  0.82358; grad/true_mag15_train:  10.45252; grad/pseudo_mag15_train:  23451.03691; grad/true_std15_train:  0.00255; grad/pseudo_std15_train:  5.72527; grad/diff15_train:  23441.61465; grad/cos15_train:  0.89680; grad/true_mag16_train:  12.07959; grad/pseudo_mag16_train:  23138.07148; grad/true_std16_train:  0.00295; grad/pseudo_std16_train:  5.64884; grad/diff16_train:  23127.31094; grad/cos16_train:  0.88487; grad/true_mag17_train:  14.02027; grad/pseudo_mag17_train:  24460.51240; grad/true_std17_train:  0.00342; grad/pseudo_std17_train:  5.97111; grad/diff17_train:  24448.19736; grad/cos17_train:  0.86669; grad_train:  880.27142; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00006; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:30:37,165][trainer][INFO] - Step 560:
[2025-04-24 22:30:37,165][trainer][INFO] - loss/edit_train:  6.13713; loss/loc_train:  0.03337; edit/acc_train:  0.05992; edit/log_prob_train: -6.13713; edit/prob_train:  0.22757; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79615; perplexity/pre_train:  44.52962; nll/post_train:  3.76368; perplexity/post_train:  43.10673; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.18081; loss/total_train:  0.64708; loss/total_edit_train:  0.64708; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.55851; grad/pseudo_mag0_train:  20794.77559; grad/true_std0_train:  0.00136; grad/pseudo_std0_train:  5.07330; grad/diff0_train:  20791.48242; grad/cos0_train:  0.59394; grad/true_mag1_train:  8.85585; grad/pseudo_mag1_train:  20847.20293; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  5.08346; grad/diff1_train:  20841.75625; grad/cos1_train:  0.61356; grad/true_mag2_train:  9.00743; grad/pseudo_mag2_train:  29023.59473; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  6.91674; grad/diff2_train:  29019.55566; grad/cos2_train:  0.44524; grad/true_mag3_train:  5.76413; grad/pseudo_mag3_train:  19167.85313; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.67784; grad/diff3_train:  19164.51621; grad/cos3_train:  0.58022; grad/true_mag4_train:  10.06759; grad/pseudo_mag4_train:  18354.39287; grad/true_std4_train:  0.00246; grad/pseudo_std4_train:  4.47899; grad/diff4_train:  18348.14551; grad/cos4_train:  0.61961; grad/true_mag5_train:  10.64604; grad/pseudo_mag5_train:  25034.76797; grad/true_std5_train:  0.00260; grad/pseudo_std5_train:  6.00177; grad/diff5_train:  25030.01992; grad/cos5_train:  0.43665; grad/true_mag6_train:  6.05963; grad/pseudo_mag6_train:  17667.96953; grad/true_std6_train:  0.00148; grad/pseudo_std6_train:  4.31287; grad/diff6_train:  17664.03691; grad/cos6_train:  0.64885; grad/true_mag7_train:  10.98476; grad/pseudo_mag7_train:  17535.98564; grad/true_std7_train:  0.00268; grad/pseudo_std7_train:  4.28044; grad/diff7_train:  17528.27998; grad/cos7_train:  0.69682; grad/true_mag8_train:  13.65496; grad/pseudo_mag8_train:  21485.36484; grad/true_std8_train:  0.00333; grad/pseudo_std8_train:  5.19905; grad/diff8_train:  21477.62754; grad/cos8_train:  0.54356; grad/true_mag9_train:  7.94376; grad/pseudo_mag9_train:  18354.32539; grad/true_std9_train:  0.00194; grad/pseudo_std9_train:  4.48082; grad/diff9_train:  18347.98564; grad/cos9_train:  0.79119; grad/true_mag10_train:  11.57063; grad/pseudo_mag10_train:  18739.56533; grad/true_std10_train:  0.00282; grad/pseudo_std10_train:  4.57457; grad/diff10_train:  18730.29023; grad/cos10_train:  0.79346; grad/true_mag11_train:  14.83820; grad/pseudo_mag11_train:  20043.86895; grad/true_std11_train:  0.00362; grad/pseudo_std11_train:  4.87973; grad/diff11_train:  20033.09795; grad/cos11_train:  0.70614; grad/true_mag12_train:  8.95115; grad/pseudo_mag12_train:  19051.28096; grad/true_std12_train:  0.00219; grad/pseudo_std12_train:  4.65111; grad/diff12_train:  19043.58701; grad/cos12_train:  0.85164; grad/true_mag13_train:  11.29921; grad/pseudo_mag13_train:  19369.18359; grad/true_std13_train:  0.00276; grad/pseudo_std13_train:  4.72860; grad/diff13_train:  19359.50127; grad/cos13_train:  0.84783; grad/true_mag14_train:  13.92929; grad/pseudo_mag14_train:  21055.91572; grad/true_std14_train:  0.00340; grad/pseudo_std14_train:  5.13322; grad/diff14_train:  21044.92393; grad/cos14_train:  0.76710; grad/true_mag15_train:  9.02161; grad/pseudo_mag15_train:  19717.25840; grad/true_std15_train:  0.00220; grad/pseudo_std15_train:  4.81373; grad/diff15_train:  19709.21953; grad/cos15_train:  0.88467; grad/true_mag16_train:  10.58778; grad/pseudo_mag16_train:  19678.68633; grad/true_std16_train:  0.00258; grad/pseudo_std16_train:  4.80428; grad/diff16_train:  19669.43457; grad/cos16_train:  0.86582; grad/true_mag17_train:  12.26600; grad/pseudo_mag17_train:  20863.82627; grad/true_std17_train:  0.00299; grad/pseudo_std17_train:  5.09217; grad/diff17_train:  20853.56143; grad/cos17_train:  0.82001; grad_train:  754.63037; lr/lr0_train:  0.00006; lr/lr1_train:  0.00006; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00006; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00005; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:30:40,628][trainer][INFO] - Step 570:
[2025-04-24 22:30:40,628][trainer][INFO] - loss/edit_train:  6.80093; loss/loc_train:  0.04814; edit/acc_train:  0.06213; edit/log_prob_train: -6.80093; edit/prob_train:  0.24406; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.04732; perplexity/pre_train:  57.24358; nll/post_train:  4.18071; perplexity/post_train:  65.41254; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.18428; loss/total_train:  0.72823; loss/total_edit_train:  0.72823; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.92660; grad/pseudo_mag0_train:  20285.81279; grad/true_std0_train:  0.00120; grad/pseudo_std0_train:  4.95056; grad/diff0_train:  20282.83896; grad/cos0_train:  0.60273; grad/true_mag1_train:  8.07479; grad/pseudo_mag1_train:  19523.93750; grad/true_std1_train:  0.00197; grad/pseudo_std1_train:  4.76285; grad/diff1_train:  19518.86279; grad/cos1_train:  0.62582; grad/true_mag2_train:  8.14206; grad/pseudo_mag2_train:  26569.50566; grad/true_std2_train:  0.00199; grad/pseudo_std2_train:  6.34557; grad/diff2_train:  26565.69062; grad/cos2_train:  0.45681; grad/true_mag3_train:  5.18741; grad/pseudo_mag3_train:  19407.68848; grad/true_std3_train:  0.00127; grad/pseudo_std3_train:  4.73705; grad/diff3_train:  19404.61963; grad/cos3_train:  0.59214; grad/true_mag4_train:  9.32842; grad/pseudo_mag4_train:  18130.47158; grad/true_std4_train:  0.00228; grad/pseudo_std4_train:  4.42453; grad/diff4_train:  18124.67393; grad/cos4_train:  0.62263; grad/true_mag5_train:  9.76215; grad/pseudo_mag5_train:  22815.44375; grad/true_std5_train:  0.00238; grad/pseudo_std5_train:  5.48358; grad/diff5_train:  22810.83750; grad/cos5_train:  0.46458; grad/true_mag6_train:  5.59859; grad/pseudo_mag6_train:  17872.45791; grad/true_std6_train:  0.00137; grad/pseudo_std6_train:  4.36295; grad/diff6_train:  17868.76455; grad/cos6_train:  0.66070; grad/true_mag7_train:  10.13202; grad/pseudo_mag7_train:  16572.62422; grad/true_std7_train:  0.00247; grad/pseudo_std7_train:  4.04545; grad/diff7_train:  16565.50439; grad/cos7_train:  0.70056; grad/true_mag8_train:  12.57071; grad/pseudo_mag8_train:  18886.72441; grad/true_std8_train:  0.00307; grad/pseudo_std8_train:  4.58251; grad/diff8_train:  18879.18252; grad/cos8_train:  0.58796; grad/true_mag9_train:  6.97330; grad/pseudo_mag9_train:  16787.76406; grad/true_std9_train:  0.00170; grad/pseudo_std9_train:  4.09841; grad/diff9_train:  16782.21221; grad/cos9_train:  0.79356; grad/true_mag10_train:  10.41285; grad/pseudo_mag10_train:  17036.97109; grad/true_std10_train:  0.00254; grad/pseudo_std10_train:  4.15911; grad/diff10_train:  17028.57744; grad/cos10_train:  0.80273; grad/true_mag11_train:  13.55572; grad/pseudo_mag11_train:  18243.03838; grad/true_std11_train:  0.00331; grad/pseudo_std11_train:  4.44458; grad/diff11_train:  18232.82959; grad/cos11_train:  0.74170; grad/true_mag12_train:  8.11149; grad/pseudo_mag12_train:  17945.38242; grad/true_std12_train:  0.00198; grad/pseudo_std12_train:  4.38115; grad/diff12_train:  17938.36426; grad/cos12_train:  0.86208; grad/true_mag13_train:  10.21237; grad/pseudo_mag13_train:  17876.08086; grad/true_std13_train:  0.00249; grad/pseudo_std13_train:  4.36418; grad/diff13_train:  17867.22725; grad/cos13_train:  0.86360; grad/true_mag14_train:  12.64247; grad/pseudo_mag14_train:  19045.24424; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  4.64542; grad/diff14_train:  19034.99883; grad/cos14_train:  0.80141; grad/true_mag15_train:  8.30766; grad/pseudo_mag15_train:  18668.40342; grad/true_std15_train:  0.00203; grad/pseudo_std15_train:  4.55767; grad/diff15_train:  18660.94033; grad/cos15_train:  0.89627; grad/true_mag16_train:  9.67071; grad/pseudo_mag16_train:  18642.55137; grad/true_std16_train:  0.00236; grad/pseudo_std16_train:  4.55135; grad/diff16_train:  18633.95801; grad/cos16_train:  0.88554; grad/true_mag17_train:  11.30618; grad/pseudo_mag17_train:  19797.77246; grad/true_std17_train:  0.00276; grad/pseudo_std17_train:  4.83277; grad/diff17_train:  19787.93496; grad/cos17_train:  0.86277; grad_train:  766.02979; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00006; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00005; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:30:44,311][trainer][INFO] - Step 580:
[2025-04-24 22:30:44,312][trainer][INFO] - loss/edit_train:  7.41863; loss/loc_train:  0.03144; edit/acc_train:  0.00500; edit/log_prob_train: -7.41863; edit/prob_train:  0.19923; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.56260; perplexity/pre_train:  95.83237; nll/post_train:  4.53225; perplexity/post_train:  92.96731; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.22330; loss/total_train:  0.77331; loss/total_edit_train:  0.77331; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.17137; grad/pseudo_mag0_train:  18712.37715; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.56436; grad/diff0_train:  18709.41270; grad/cos0_train:  0.57333; grad/true_mag1_train:  8.40860; grad/pseudo_mag1_train:  19305.21016; grad/true_std1_train:  0.00205; grad/pseudo_std1_train:  4.70696; grad/diff1_train:  19300.08838; grad/cos1_train:  0.60859; grad/true_mag2_train:  8.60618; grad/pseudo_mag2_train:  29116.82969; grad/true_std2_train:  0.00210; grad/pseudo_std2_train:  6.90290; grad/diff2_train:  29113.23301; grad/cos2_train:  0.41323; grad/true_mag3_train:  5.42655; grad/pseudo_mag3_train:  17938.67744; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.37772; grad/diff3_train:  17935.56250; grad/cos3_train:  0.57506; grad/true_mag4_train:  9.77642; grad/pseudo_mag4_train:  17738.94541; grad/true_std4_train:  0.00239; grad/pseudo_std4_train:  4.32857; grad/diff4_train:  17732.83525; grad/cos4_train:  0.62513; grad/true_mag5_train:  10.85019; grad/pseudo_mag5_train:  25576.16699; grad/true_std5_train:  0.00265; grad/pseudo_std5_train:  6.11428; grad/diff5_train:  25571.50605; grad/cos5_train:  0.42411; grad/true_mag6_train:  5.95157; grad/pseudo_mag6_train:  17741.00410; grad/true_std6_train:  0.00145; grad/pseudo_std6_train:  4.33063; grad/diff6_train:  17737.10371; grad/cos6_train:  0.65548; grad/true_mag7_train:  11.04935; grad/pseudo_mag7_train:  17513.01201; grad/true_std7_train:  0.00270; grad/pseudo_std7_train:  4.27486; grad/diff7_train:  17505.13701; grad/cos7_train:  0.71178; grad/true_mag8_train:  13.75853; grad/pseudo_mag8_train:  20571.91504; grad/true_std8_train:  0.00336; grad/pseudo_std8_train:  4.98167; grad/diff8_train:  20563.74238; grad/cos8_train:  0.58878; grad/true_mag9_train:  7.75343; grad/pseudo_mag9_train:  17624.48379; grad/true_std9_train:  0.00189; grad/pseudo_std9_train:  4.30263; grad/diff9_train:  17618.34170; grad/cos9_train:  0.79029; grad/true_mag10_train:  11.63001; grad/pseudo_mag10_train:  18498.99844; grad/true_std10_train:  0.00284; grad/pseudo_std10_train:  4.51591; grad/diff10_train:  18489.65225; grad/cos10_train:  0.80253; grad/true_mag11_train:  15.41821; grad/pseudo_mag11_train:  19510.54736; grad/true_std11_train:  0.00376; grad/pseudo_std11_train:  4.75129; grad/diff11_train:  19498.93809; grad/cos11_train:  0.74740; grad/true_mag12_train:  9.07848; grad/pseudo_mag12_train:  19666.83193; grad/true_std12_train:  0.00222; grad/pseudo_std12_train:  4.80140; grad/diff12_train:  19658.96699; grad/cos12_train:  0.86432; grad/true_mag13_train:  11.43123; grad/pseudo_mag13_train:  19628.86416; grad/true_std13_train:  0.00279; grad/pseudo_std13_train:  4.79208; grad/diff13_train:  19618.97305; grad/cos13_train:  0.86400; grad/true_mag14_train:  13.93103; grad/pseudo_mag14_train:  20585.56436; grad/true_std14_train:  0.00340; grad/pseudo_std14_train:  5.02102; grad/diff14_train:  20574.02676; grad/cos14_train:  0.82426; grad/true_mag15_train:  9.37872; grad/pseudo_mag15_train:  20709.02451; grad/true_std15_train:  0.00229; grad/pseudo_std15_train:  5.05586; grad/diff15_train:  20700.57441; grad/cos15_train:  0.89982; grad/true_mag16_train:  10.94347; grad/pseudo_mag16_train:  20660.56943; grad/true_std16_train:  0.00267; grad/pseudo_std16_train:  5.04401; grad/diff16_train:  20650.88057; grad/cos16_train:  0.88323; grad/true_mag17_train:  12.55398; grad/pseudo_mag17_train:  21847.77129; grad/true_std17_train:  0.00306; grad/pseudo_std17_train:  5.33320; grad/diff17_train:  21836.73311; grad/cos17_train:  0.87527; grad_train:  1191.72266; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00006; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:30:47,529][trainer][INFO] - Step 590:
[2025-04-24 22:30:47,530][trainer][INFO] - loss/edit_train:  4.73694; loss/loc_train:  0.06067; edit/acc_train:  0.11892; edit/log_prob_train: -4.73694; edit/prob_train:  0.29096; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.54976; perplexity/pre_train:  94.60950; nll/post_train:  4.62041; perplexity/post_train:  101.53574; n_tokens/pre_train:  8.90000; n_tokens/post_train:  8.90000; time/edit_train:  0.17557; loss/total_train:  0.53436; loss/total_edit_train:  0.53436; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.09764; grad/pseudo_mag0_train:  18970.83730; grad/true_std0_train:  0.00124; grad/pseudo_std0_train:  4.62750; grad/diff0_train:  18967.91094; grad/cos0_train:  0.57276; grad/true_mag1_train:  8.41800; grad/pseudo_mag1_train:  19642.34980; grad/true_std1_train:  0.00206; grad/pseudo_std1_train:  4.78694; grad/diff1_train:  19637.58691; grad/cos1_train:  0.56747; grad/true_mag2_train:  8.36795; grad/pseudo_mag2_train:  28961.77500; grad/true_std2_train:  0.00204; grad/pseudo_std2_train:  6.86943; grad/diff2_train:  28958.51895; grad/cos2_train:  0.38244; grad/true_mag3_train:  5.48167; grad/pseudo_mag3_train:  18012.04932; grad/true_std3_train:  0.00134; grad/pseudo_std3_train:  4.39536; grad/diff3_train:  18008.99629; grad/cos3_train:  0.56029; grad/true_mag4_train:  9.66951; grad/pseudo_mag4_train:  17891.24570; grad/true_std4_train:  0.00236; grad/pseudo_std4_train:  4.36419; grad/diff4_train:  17885.72383; grad/cos4_train:  0.57615; grad/true_mag5_train:  10.33493; grad/pseudo_mag5_train:  25543.85879; grad/true_std5_train:  0.00252; grad/pseudo_std5_train:  6.10737; grad/diff5_train:  25539.71230; grad/cos5_train:  0.39098; grad/true_mag6_train:  5.78683; grad/pseudo_mag6_train:  16660.70088; grad/true_std6_train:  0.00141; grad/pseudo_std6_train:  4.06681; grad/diff6_train:  16656.96436; grad/cos6_train:  0.64725; grad/true_mag7_train:  10.75946; grad/pseudo_mag7_train:  16517.22969; grad/true_std7_train:  0.00263; grad/pseudo_std7_train:  4.03155; grad/diff7_train:  16509.80566; grad/cos7_train:  0.68946; grad/true_mag8_train:  13.26988; grad/pseudo_mag8_train:  20767.08145; grad/true_std8_train:  0.00324; grad/pseudo_std8_train:  5.02174; grad/diff8_train:  20759.58516; grad/cos8_train:  0.54494; grad/true_mag9_train:  7.51466; grad/pseudo_mag9_train:  17258.81758; grad/true_std9_train:  0.00183; grad/pseudo_std9_train:  4.21331; grad/diff9_train:  17252.84180; grad/cos9_train:  0.79182; grad/true_mag10_train:  11.13881; grad/pseudo_mag10_train:  18049.57344; grad/true_std10_train:  0.00272; grad/pseudo_std10_train:  4.40612; grad/diff10_train:  18040.59941; grad/cos10_train:  0.80166; grad/true_mag11_train:  14.11640; grad/pseudo_mag11_train:  19447.41406; grad/true_std11_train:  0.00345; grad/pseudo_std11_train:  4.73490; grad/diff11_train:  19436.86436; grad/cos11_train:  0.73028; grad/true_mag12_train:  8.60998; grad/pseudo_mag12_train:  18562.21016; grad/true_std12_train:  0.00210; grad/pseudo_std12_train:  4.53171; grad/diff12_train:  18554.77373; grad/cos12_train:  0.86001; grad/true_mag13_train:  10.99570; grad/pseudo_mag13_train:  18631.82041; grad/true_std13_train:  0.00268; grad/pseudo_std13_train:  4.54863; grad/diff13_train:  18622.38809; grad/cos13_train:  0.85356; grad/true_mag14_train:  13.35254; grad/pseudo_mag14_train:  19806.01592; grad/true_std14_train:  0.00326; grad/pseudo_std14_train:  4.82980; grad/diff14_train:  19795.37744; grad/cos14_train:  0.78393; grad/true_mag15_train:  8.90646; grad/pseudo_mag15_train:  19645.73418; grad/true_std15_train:  0.00217; grad/pseudo_std15_train:  4.79624; grad/diff15_train:  19637.75732; grad/cos15_train:  0.89348; grad/true_mag16_train:  10.40055; grad/pseudo_mag16_train:  19560.01787; grad/true_std16_train:  0.00254; grad/pseudo_std16_train:  4.77527; grad/diff16_train:  19550.85596; grad/cos16_train:  0.87653; grad/true_mag17_train:  11.97103; grad/pseudo_mag17_train:  20872.05127; grad/true_std17_train:  0.00292; grad/pseudo_std17_train:  5.09468; grad/diff17_train:  20861.76123; grad/cos17_train:  0.84833; grad_train:  1144.02271; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00007; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:30:50,869][trainer][INFO] - Step 600:
[2025-04-24 22:30:50,870][trainer][INFO] - loss/edit_train:  6.89655; loss/loc_train:  0.07967; edit/acc_train:  0.02095; edit/log_prob_train: -6.89655; edit/prob_train:  0.21278; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  3.69275; perplexity/pre_train:  40.15521; nll/post_train:  3.74324; perplexity/post_train:  42.23449; n_tokens/pre_train:  7.30000; n_tokens/post_train:  7.30000; time/edit_train:  0.17762; loss/total_train:  0.76933; loss/total_edit_train:  0.76933; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.46879; grad/pseudo_mag0_train:  18330.98086; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  4.47113; grad/diff0_train:  18327.90791; grad/cos0_train:  0.56105; grad/true_mag1_train:  8.83921; grad/pseudo_mag1_train:  19504.00176; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.75471; grad/diff1_train:  19498.75977; grad/cos1_train:  0.59130; grad/true_mag2_train:  9.08409; grad/pseudo_mag2_train:  30491.99238; grad/true_std2_train:  0.00222; grad/pseudo_std2_train:  7.21127; grad/diff2_train:  30488.37578; grad/cos2_train:  0.39351; grad/true_mag3_train:  5.87749; grad/pseudo_mag3_train:  17910.77295; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.37061; grad/diff3_train:  17907.49014; grad/cos3_train:  0.55893; grad/true_mag4_train:  10.35788; grad/pseudo_mag4_train:  17934.23975; grad/true_std4_train:  0.00253; grad/pseudo_std4_train:  4.37544; grad/diff4_train:  17928.01885; grad/cos4_train:  0.60188; grad/true_mag5_train:  11.12490; grad/pseudo_mag5_train:  26983.52949; grad/true_std5_train:  0.00272; grad/pseudo_std5_train:  6.42555; grad/diff5_train:  26978.97969; grad/cos5_train:  0.40119; grad/true_mag6_train:  6.35260; grad/pseudo_mag6_train:  17552.93994; grad/true_std6_train:  0.00155; grad/pseudo_std6_train:  4.28458; grad/diff6_train:  17548.79404; grad/cos6_train:  0.65029; grad/true_mag7_train:  11.58827; grad/pseudo_mag7_train:  18093.65654; grad/true_std7_train:  0.00283; grad/pseudo_std7_train:  4.41628; grad/diff7_train:  18085.44355; grad/cos7_train:  0.70472; grad/true_mag8_train:  14.75427; grad/pseudo_mag8_train:  22473.05000; grad/true_std8_train:  0.00360; grad/pseudo_std8_train:  5.43142; grad/diff8_train:  22464.36777; grad/cos8_train:  0.57049; grad/true_mag9_train:  8.33717; grad/pseudo_mag9_train:  19390.17373; grad/true_std9_train:  0.00204; grad/pseudo_std9_train:  4.73367; grad/diff9_train:  19383.50967; grad/cos9_train:  0.79648; grad/true_mag10_train:  12.19696; grad/pseudo_mag10_train:  19713.31152; grad/true_std10_train:  0.00298; grad/pseudo_std10_train:  4.81234; grad/diff10_train:  19703.43936; grad/cos10_train:  0.80669; grad/true_mag11_train:  16.02735; grad/pseudo_mag11_train:  21009.34912; grad/true_std11_train:  0.00391; grad/pseudo_std11_train:  5.11423; grad/diff11_train:  20997.45371; grad/cos11_train:  0.73082; grad/true_mag12_train:  9.76334; grad/pseudo_mag12_train:  21227.36064; grad/true_std12_train:  0.00238; grad/pseudo_std12_train:  5.18238; grad/diff12_train:  21218.85195; grad/cos12_train:  0.86827; grad/true_mag13_train:  12.17142; grad/pseudo_mag13_train:  21343.24238; grad/true_std13_train:  0.00297; grad/pseudo_std13_train:  5.21062; grad/diff13_train:  21332.63340; grad/cos13_train:  0.86834; grad/true_mag14_train:  15.08615; grad/pseudo_mag14_train:  22411.53955; grad/true_std14_train:  0.00368; grad/pseudo_std14_train:  5.46503; grad/diff14_train:  22399.16816; grad/cos14_train:  0.80772; grad/true_mag15_train:  10.09172; grad/pseudo_mag15_train:  22388.20244; grad/true_std15_train:  0.00246; grad/pseudo_std15_train:  5.46581; grad/diff15_train:  22379.10010; grad/cos15_train:  0.90043; grad/true_mag16_train:  11.82861; grad/pseudo_mag16_train:  22470.21279; grad/true_std16_train:  0.00289; grad/pseudo_std16_train:  5.48580; grad/diff16_train:  22459.71250; grad/cos16_train:  0.88441; grad/true_mag17_train:  13.65864; grad/pseudo_mag17_train:  23500.85781; grad/true_std17_train:  0.00333; grad/pseudo_std17_train:  5.73645; grad/diff17_train:  23489.07363; grad/cos17_train:  0.85588; grad_train:  1094.92053; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:31:09,156][trainer][INFO] - Step 600:
[2025-04-24 22:31:09,157][trainer][INFO] - loss/edit_val:  5.67327; loss/loc_val:  0.06338; edit/acc_val:  0.04864; edit/log_prob_val: -5.67327; edit/prob_val:  0.26882; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.39833; perplexity/post_val:  81.31493; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10946; loss/total_val:  0.63070; loss/total_edit_val:  0.63070; memory/alloc_max_val:  42223547904.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  18.28214; eval_time/average:  0.18282
[2025-04-24 22:31:09,160][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:31:09,161][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:32:03,011][trainer][INFO] - Write complete.
[2025-04-24 22:32:06,555][trainer][INFO] - Step 610:
[2025-04-24 22:32:06,555][trainer][INFO] - loss/edit_train:  5.79664; loss/loc_train:  0.06208; edit/acc_train:  0.03125; edit/log_prob_train: -5.79664; edit/prob_train:  0.20933; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.64256; perplexity/pre_train:  103.80990; nll/post_train:  4.60756; perplexity/post_train:  100.23975; n_tokens/pre_train:  3.70000; n_tokens/post_train:  3.70000; time/edit_train:  0.18530; loss/total_train:  0.64175; loss/total_edit_train:  0.64175; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.80824; grad/pseudo_mag0_train:  23407.27236; grad/true_std0_train:  0.00142; grad/pseudo_std0_train:  5.70888; grad/diff0_train:  23403.87119; grad/cos0_train:  0.58322; grad/true_mag1_train:  9.35785; grad/pseudo_mag1_train:  22735.38379; grad/true_std1_train:  0.00228; grad/pseudo_std1_train:  5.54119; grad/diff1_train:  22729.66035; grad/cos1_train:  0.60519; grad/true_mag2_train:  9.47916; grad/pseudo_mag2_train:  31370.69102; grad/true_std2_train:  0.00231; grad/pseudo_std2_train:  7.46292; grad/diff2_train:  31366.42578; grad/cos2_train:  0.43308; grad/true_mag3_train:  6.11968; grad/pseudo_mag3_train:  21961.43408; grad/true_std3_train:  0.00149; grad/pseudo_std3_train:  5.35877; grad/diff3_train:  21957.90781; grad/cos3_train:  0.57456; grad/true_mag4_train:  10.97731; grad/pseudo_mag4_train:  20349.47148; grad/true_std4_train:  0.00268; grad/pseudo_std4_train:  4.96422; grad/diff4_train:  20342.77256; grad/cos4_train:  0.60655; grad/true_mag5_train:  11.61765; grad/pseudo_mag5_train:  28480.53066; grad/true_std5_train:  0.00284; grad/pseudo_std5_train:  6.81129; grad/diff5_train:  28475.30254; grad/cos5_train:  0.43087; grad/true_mag6_train:  6.70690; grad/pseudo_mag6_train:  20760.55195; grad/true_std6_train:  0.00164; grad/pseudo_std6_train:  5.06737; grad/diff6_train:  20756.21104; grad/cos6_train:  0.64585; grad/true_mag7_train:  11.87618; grad/pseudo_mag7_train:  19465.24932; grad/true_std7_train:  0.00290; grad/pseudo_std7_train:  4.75107; grad/diff7_train:  19456.95225; grad/cos7_train:  0.69298; grad/true_mag8_train:  14.23934; grad/pseudo_mag8_train:  24189.52383; grad/true_std8_train:  0.00348; grad/pseudo_std8_train:  5.84871; grad/diff8_train:  24181.68984; grad/cos8_train:  0.52914; grad/true_mag9_train:  8.03166; grad/pseudo_mag9_train:  18541.51543; grad/true_std9_train:  0.00196; grad/pseudo_std9_train:  4.52644; grad/diff9_train:  18535.17861; grad/cos9_train:  0.78250; grad/true_mag10_train:  12.10864; grad/pseudo_mag10_train:  19572.65791; grad/true_std10_train:  0.00296; grad/pseudo_std10_train:  4.77792; grad/diff10_train:  19563.05654; grad/cos10_train:  0.78535; grad/true_mag11_train:  15.40444; grad/pseudo_mag11_train:  21073.74219; grad/true_std11_train:  0.00376; grad/pseudo_std11_train:  5.12949; grad/diff11_train:  21062.57832; grad/cos11_train:  0.70014; grad/true_mag12_train:  9.14595; grad/pseudo_mag12_train:  19745.17773; grad/true_std12_train:  0.00223; grad/pseudo_std12_train:  4.82050; grad/diff12_train:  19737.36670; grad/cos12_train:  0.84596; grad/true_mag13_train:  11.75685; grad/pseudo_mag13_train:  20220.21572; grad/true_std13_train:  0.00287; grad/pseudo_std13_train:  4.93639; grad/diff13_train:  20210.17764; grad/cos13_train:  0.84497; grad/true_mag14_train:  14.34911; grad/pseudo_mag14_train:  21471.25830; grad/true_std14_train:  0.00350; grad/pseudo_std14_train:  5.23572; grad/diff14_train:  21459.89893; grad/cos14_train:  0.76936; grad/true_mag15_train:  9.26154; grad/pseudo_mag15_train:  20571.63311; grad/true_std15_train:  0.00226; grad/pseudo_std15_train:  5.02227; grad/diff15_train:  20563.38945; grad/cos15_train:  0.88407; grad/true_mag16_train:  11.02784; grad/pseudo_mag16_train:  20660.39248; grad/true_std16_train:  0.00269; grad/pseudo_std16_train:  5.04393; grad/diff16_train:  20650.78887; grad/cos16_train:  0.86333; grad/true_mag17_train:  12.74575; grad/pseudo_mag17_train:  21893.13652; grad/true_std17_train:  0.00311; grad/pseudo_std17_train:  5.34363; grad/diff17_train:  21882.37842; grad/cos17_train:  0.82656; grad_train:  1043.93860; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:32:09,948][trainer][INFO] - Step 620:
[2025-04-24 22:32:09,948][trainer][INFO] - loss/edit_train:  5.16248; loss/loc_train:  0.03215; edit/acc_train:  0.10179; edit/log_prob_train: -5.16248; edit/prob_train:  0.26787; acc/pre_train:  0.10000; acc/post_train:  0.00000; nll/pre_train:  4.09430; perplexity/pre_train:  59.99708; nll/post_train:  4.12505; perplexity/post_train:  61.87075; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.18782; loss/total_train:  0.54840; loss/total_edit_train:  0.54840; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.94721; grad/pseudo_mag0_train:  19380.48438; grad/true_std0_train:  0.00121; grad/pseudo_std0_train:  4.72810; grad/diff0_train:  19377.61143; grad/cos0_train:  0.58012; grad/true_mag1_train:  8.12872; grad/pseudo_mag1_train:  19126.64746; grad/true_std1_train:  0.00198; grad/pseudo_std1_train:  4.66401; grad/diff1_train:  19121.76650; grad/cos1_train:  0.59759; grad/true_mag2_train:  8.21500; grad/pseudo_mag2_train:  30426.69551; grad/true_std2_train:  0.00201; grad/pseudo_std2_train:  7.20737; grad/diff2_train:  30423.51113; grad/cos2_train:  0.38169; grad/true_mag3_train:  5.30550; grad/pseudo_mag3_train:  18632.00312; grad/true_std3_train:  0.00130; grad/pseudo_std3_train:  4.54702; grad/diff3_train:  18628.95566; grad/cos3_train:  0.57421; grad/true_mag4_train:  9.45158; grad/pseudo_mag4_train:  17488.13340; grad/true_std4_train:  0.00231; grad/pseudo_std4_train:  4.26698; grad/diff4_train:  17482.40293; grad/cos4_train:  0.60478; grad/true_mag5_train:  10.33674; grad/pseudo_mag5_train:  25701.26172; grad/true_std5_train:  0.00252; grad/pseudo_std5_train:  6.13351; grad/diff5_train:  25697.09941; grad/cos5_train:  0.39696; grad/true_mag6_train:  5.82938; grad/pseudo_mag6_train:  17841.77461; grad/true_std6_train:  0.00142; grad/pseudo_std6_train:  4.35536; grad/diff6_train:  17837.96855; grad/cos6_train:  0.65149; grad/true_mag7_train:  10.48307; grad/pseudo_mag7_train:  16744.49443; grad/true_std7_train:  0.00256; grad/pseudo_std7_train:  4.08739; grad/diff7_train:  16737.16416; grad/cos7_train:  0.69667; grad/true_mag8_train:  12.76830; grad/pseudo_mag8_train:  20034.54404; grad/true_std8_train:  0.00312; grad/pseudo_std8_train:  4.84986; grad/diff8_train:  20026.96641; grad/cos8_train:  0.57745; grad/true_mag9_train:  7.57118; grad/pseudo_mag9_train:  17820.83740; grad/true_std9_train:  0.00185; grad/pseudo_std9_train:  4.35062; grad/diff9_train:  17814.82012; grad/cos9_train:  0.79145; grad/true_mag10_train:  11.08552; grad/pseudo_mag10_train:  18186.55234; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  4.43970; grad/diff10_train:  18177.62744; grad/cos10_train:  0.80182; grad/true_mag11_train:  14.14281; grad/pseudo_mag11_train:  19720.84404; grad/true_std11_train:  0.00345; grad/pseudo_std11_train:  4.80210; grad/diff11_train:  19710.16816; grad/cos11_train:  0.74313; grad/true_mag12_train:  8.56631; grad/pseudo_mag12_train:  18834.75439; grad/true_std12_train:  0.00209; grad/pseudo_std12_train:  4.59828; grad/diff12_train:  18827.32656; grad/cos12_train:  0.86429; grad/true_mag13_train:  10.61223; grad/pseudo_mag13_train:  18669.98291; grad/true_std13_train:  0.00259; grad/pseudo_std13_train:  4.55802; grad/diff13_train:  18660.75781; grad/cos13_train:  0.86571; grad/true_mag14_train:  12.98485; grad/pseudo_mag14_train:  19933.86152; grad/true_std14_train:  0.00317; grad/pseudo_std14_train:  4.86045; grad/diff14_train:  19923.35039; grad/cos14_train:  0.79891; grad/true_mag15_train:  8.64694; grad/pseudo_mag15_train:  19396.31924; grad/true_std15_train:  0.00211; grad/pseudo_std15_train:  4.73539; grad/diff15_train:  19388.52393; grad/cos15_train:  0.89936; grad/true_mag16_train:  10.07447; grad/pseudo_mag16_train:  19517.35742; grad/true_std16_train:  0.00246; grad/pseudo_std16_train:  4.76493; grad/diff16_train:  19508.38477; grad/cos16_train:  0.88683; grad/true_mag17_train:  11.69050; grad/pseudo_mag17_train:  20450.59990; grad/true_std17_train:  0.00285; grad/pseudo_std17_train:  4.99198; grad/diff17_train:  20440.41045; grad/cos17_train:  0.86490; grad_train:  897.99915; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:32:13,727][trainer][INFO] - Step 630:
[2025-04-24 22:32:13,727][trainer][INFO] - loss/edit_train:  6.08734; loss/loc_train:  0.04560; edit/acc_train:  0.02678; edit/log_prob_train: -6.08734; edit/prob_train:  0.25087; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.61403; perplexity/pre_train:  100.88970; nll/post_train:  4.53596; perplexity/post_train:  93.31297; n_tokens/pre_train:  6.50000; n_tokens/post_train:  6.50000; time/edit_train:  0.21566; loss/total_train:  0.65434; loss/total_edit_train:  0.65434; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.32093; grad/pseudo_mag0_train:  23270.29814; grad/true_std0_train:  0.00130; grad/pseudo_std0_train:  5.66795; grad/diff0_train:  23267.42852; grad/cos0_train:  0.54674; grad/true_mag1_train:  8.73206; grad/pseudo_mag1_train:  21533.38564; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  5.24171; grad/diff1_train:  21528.42422; grad/cos1_train:  0.57497; grad/true_mag2_train:  9.01552; grad/pseudo_mag2_train:  30038.91445; grad/true_std2_train:  0.00220; grad/pseudo_std2_train:  7.13045; grad/diff2_train:  30035.29258; grad/cos2_train:  0.39582; grad/true_mag3_train:  5.95361; grad/pseudo_mag3_train:  19666.17061; grad/true_std3_train:  0.00145; grad/pseudo_std3_train:  4.79626; grad/diff3_train:  19662.95986; grad/cos3_train:  0.54634; grad/true_mag4_train:  10.71481; grad/pseudo_mag4_train:  19576.77041; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.77408; grad/diff4_train:  19570.60293; grad/cos4_train:  0.58470; grad/true_mag5_train:  12.04933; grad/pseudo_mag5_train:  26982.47070; grad/true_std5_train:  0.00294; grad/pseudo_std5_train:  6.45687; grad/diff5_train:  26977.40742; grad/cos5_train:  0.41232; grad/true_mag6_train:  6.62954; grad/pseudo_mag6_train:  18938.85576; grad/true_std6_train:  0.00162; grad/pseudo_std6_train:  4.62162; grad/diff6_train:  18934.66270; grad/cos6_train:  0.63493; grad/true_mag7_train:  12.11565; grad/pseudo_mag7_train:  18847.72383; grad/true_std7_train:  0.00296; grad/pseudo_std7_train:  4.59989; grad/diff7_train:  18839.45117; grad/cos7_train:  0.68586; grad/true_mag8_train:  15.14508; grad/pseudo_mag8_train:  22728.18066; grad/true_std8_train:  0.00370; grad/pseudo_std8_train:  5.50059; grad/diff8_train:  22719.18301; grad/cos8_train:  0.57710; grad/true_mag9_train:  8.43197; grad/pseudo_mag9_train:  19430.49355; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.74336; grad/diff9_train:  19423.86611; grad/cos9_train:  0.78340; grad/true_mag10_train:  12.19344; grad/pseudo_mag10_train:  19702.74512; grad/true_std10_train:  0.00298; grad/pseudo_std10_train:  4.80965; grad/diff10_train:  19692.97979; grad/cos10_train:  0.79790; grad/true_mag11_train:  15.88520; grad/pseudo_mag11_train:  21169.77627; grad/true_std11_train:  0.00388; grad/pseudo_std11_train:  5.15595; grad/diff11_train:  21157.88662; grad/cos11_train:  0.73573; grad/true_mag12_train:  9.88948; grad/pseudo_mag12_train:  21049.40225; grad/true_std12_train:  0.00241; grad/pseudo_std12_train:  5.13892; grad/diff12_train:  21040.93984; grad/cos12_train:  0.85307; grad/true_mag13_train:  12.29845; grad/pseudo_mag13_train:  20954.23232; grad/true_std13_train:  0.00300; grad/pseudo_std13_train:  5.11555; grad/diff13_train:  20943.76865; grad/cos13_train:  0.84875; grad/true_mag14_train:  15.15001; grad/pseudo_mag14_train:  22387.28037; grad/true_std14_train:  0.00370; grad/pseudo_std14_train:  5.45977; grad/diff14_train:  22375.05439; grad/cos14_train:  0.79546; grad/true_mag15_train:  10.11726; grad/pseudo_mag15_train:  22242.10557; grad/true_std15_train:  0.00247; grad/pseudo_std15_train:  5.43010; grad/diff15_train:  22233.06846; grad/cos15_train:  0.89296; grad/true_mag16_train:  11.68110; grad/pseudo_mag16_train:  22216.21299; grad/true_std16_train:  0.00285; grad/pseudo_std16_train:  5.42376; grad/diff16_train:  22205.96270; grad/cos16_train:  0.87662; grad/true_mag17_train:  13.63210; grad/pseudo_mag17_train:  23588.90352; grad/true_std17_train:  0.00333; grad/pseudo_std17_train:  5.75801; grad/diff17_train:  23577.18398; grad/cos17_train:  0.85436; grad_train:  1183.62292; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:32:16,877][trainer][INFO] - Step 640:
[2025-04-24 22:32:16,878][trainer][INFO] - loss/edit_train:  5.72276; loss/loc_train:  0.05851; edit/acc_train:  0.01699; edit/log_prob_train: -5.72276; edit/prob_train:  0.26454; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.13990; perplexity/pre_train:  62.79625; nll/post_train:  4.15629; perplexity/post_train:  63.83434; n_tokens/pre_train:  6.60000; n_tokens/post_train:  6.60000; time/edit_train:  0.16966; loss/total_train:  0.63079; loss/total_edit_train:  0.63079; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.81612; grad/pseudo_mag0_train:  20145.71152; grad/true_std0_train:  0.00142; grad/pseudo_std0_train:  4.91451; grad/diff0_train:  20142.41826; grad/cos0_train:  0.56784; grad/true_mag1_train:  9.12889; grad/pseudo_mag1_train:  21183.43271; grad/true_std1_train:  0.00223; grad/pseudo_std1_train:  5.16408; grad/diff1_train:  21177.82744; grad/cos1_train:  0.61237; grad/true_mag2_train:  9.86183; grad/pseudo_mag2_train:  29805.66816; grad/true_std2_train:  0.00241; grad/pseudo_std2_train:  7.09682; grad/diff2_train:  29801.08652; grad/cos2_train:  0.45723; grad/true_mag3_train:  6.13998; grad/pseudo_mag3_train:  19572.25059; grad/true_std3_train:  0.00150; grad/pseudo_std3_train:  4.77641; grad/diff3_train:  19568.76377; grad/cos3_train:  0.56706; grad/true_mag4_train:  11.14342; grad/pseudo_mag4_train:  20168.04863; grad/true_std4_train:  0.00272; grad/pseudo_std4_train:  4.92018; grad/diff4_train:  20161.36406; grad/cos4_train:  0.60061; grad/true_mag5_train:  12.44447; grad/pseudo_mag5_train:  27853.37109; grad/true_std5_train:  0.00304; grad/pseudo_std5_train:  6.66867; grad/diff5_train:  27847.76484; grad/cos5_train:  0.44650; grad/true_mag6_train:  7.03238; grad/pseudo_mag6_train:  20178.39033; grad/true_std6_train:  0.00172; grad/pseudo_std6_train:  4.92535; grad/diff6_train:  20173.88838; grad/cos6_train:  0.64118; grad/true_mag7_train:  12.96544; grad/pseudo_mag7_train:  20221.20215; grad/true_std7_train:  0.00317; grad/pseudo_std7_train:  4.93574; grad/diff7_train:  20212.11973; grad/cos7_train:  0.70092; grad/true_mag8_train:  16.42053; grad/pseudo_mag8_train:  23887.43359; grad/true_std8_train:  0.00401; grad/pseudo_std8_train:  5.78860; grad/diff8_train:  23877.65840; grad/cos8_train:  0.59642; grad/true_mag9_train:  9.42590; grad/pseudo_mag9_train:  22201.50381; grad/true_std9_train:  0.00230; grad/pseudo_std9_train:  5.42000; grad/diff9_train:  22193.95234; grad/cos9_train:  0.79848; grad/true_mag10_train:  13.63008; grad/pseudo_mag10_train:  22531.21973; grad/true_std10_train:  0.00333; grad/pseudo_std10_train:  5.50016; grad/diff10_train:  22520.31523; grad/cos10_train:  0.79468; grad/true_mag11_train:  18.33293; grad/pseudo_mag11_train:  24384.82188; grad/true_std11_train:  0.00448; grad/pseudo_std11_train:  5.94243; grad/diff11_train:  24370.67500; grad/cos11_train:  0.76674; grad/true_mag12_train:  10.99634; grad/pseudo_mag12_train:  24003.74912; grad/true_std12_train:  0.00268; grad/pseudo_std12_train:  5.86015; grad/diff12_train:  23994.29688; grad/cos12_train:  0.85524; grad/true_mag13_train:  13.75161; grad/pseudo_mag13_train:  24295.93242; grad/true_std13_train:  0.00336; grad/pseudo_std13_train:  5.93119; grad/diff13_train:  24284.27031; grad/cos13_train:  0.84174; grad/true_mag14_train:  16.80043; grad/pseudo_mag14_train:  25574.43633; grad/true_std14_train:  0.00410; grad/pseudo_std14_train:  6.23876; grad/diff14_train:  25560.69844; grad/cos14_train:  0.81345; grad/true_mag15_train:  11.20081; grad/pseudo_mag15_train:  24757.45342; grad/true_std15_train:  0.00273; grad/pseudo_std15_train:  6.04417; grad/diff15_train:  24747.58057; grad/cos15_train:  0.87426; grad/true_mag16_train:  12.96814; grad/pseudo_mag16_train:  24773.23242; grad/true_std16_train:  0.00317; grad/pseudo_std16_train:  6.04798; grad/diff16_train:  24761.79170; grad/cos16_train:  0.87821; grad/true_mag17_train:  15.83777; grad/pseudo_mag17_train:  27307.32188; grad/true_std17_train:  0.00387; grad/pseudo_std17_train:  6.66556; grad/diff17_train:  27294.37402; grad/cos17_train:  0.83517; grad_train:  1033.90161; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:32:20,110][trainer][INFO] - Step 650:
[2025-04-24 22:32:20,110][trainer][INFO] - loss/edit_train:  5.17131; loss/loc_train:  0.03136; edit/acc_train:  0.05747; edit/log_prob_train: -5.17131; edit/prob_train:  0.23282; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.91967; perplexity/pre_train:  372.28720; nll/post_train:  5.91836; perplexity/post_train:  371.80307; n_tokens/pre_train:  3.00000; n_tokens/post_train:  3.00000; time/edit_train:  0.18247; loss/total_train:  0.54849; loss/total_edit_train:  0.54849; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.71572; grad/pseudo_mag0_train:  21822.96631; grad/true_std0_train:  0.00140; grad/pseudo_std0_train:  5.32212; grad/diff0_train:  21819.70049; grad/cos0_train:  0.57076; grad/true_mag1_train:  9.33937; grad/pseudo_mag1_train:  21843.39014; grad/true_std1_train:  0.00228; grad/pseudo_std1_train:  5.32408; grad/diff1_train:  21837.78740; grad/cos1_train:  0.59550; grad/true_mag2_train:  9.32340; grad/pseudo_mag2_train:  35327.14707; grad/true_std2_train:  0.00228; grad/pseudo_std2_train:  8.34393; grad/diff2_train:  35323.61758; grad/cos2_train:  0.36744; grad/true_mag3_train:  6.04802; grad/pseudo_mag3_train:  20150.36152; grad/true_std3_train:  0.00148; grad/pseudo_std3_train:  4.91641; grad/diff3_train:  20146.96953; grad/cos3_train:  0.56243; grad/true_mag4_train:  10.56267; grad/pseudo_mag4_train:  19474.09043; grad/true_std4_train:  0.00258; grad/pseudo_std4_train:  4.75056; grad/diff4_train:  19467.75479; grad/cos4_train:  0.59896; grad/true_mag5_train:  11.20771; grad/pseudo_mag5_train:  30478.24512; grad/true_std5_train:  0.00274; grad/pseudo_std5_train:  7.25368; grad/diff5_train:  30473.93164; grad/cos5_train:  0.36900; grad/true_mag6_train:  6.38814; grad/pseudo_mag6_train:  19013.56582; grad/true_std6_train:  0.00156; grad/pseudo_std6_train:  4.64089; grad/diff6_train:  19009.43613; grad/cos6_train:  0.64539; grad/true_mag7_train:  11.78483; grad/pseudo_mag7_train:  18625.87266; grad/true_std7_train:  0.00288; grad/pseudo_std7_train:  4.54590; grad/diff7_train:  18617.88945; grad/cos7_train:  0.67318; grad/true_mag8_train:  14.44356; grad/pseudo_mag8_train:  24168.85020; grad/true_std8_train:  0.00353; grad/pseudo_std8_train:  5.83635; grad/diff8_train:  24161.38008; grad/cos8_train:  0.48614; grad/true_mag9_train:  8.18561; grad/pseudo_mag9_train:  19393.06250; grad/true_std9_train:  0.00200; grad/pseudo_std9_train:  4.73425; grad/diff9_train:  19386.65225; grad/cos9_train:  0.77372; grad/true_mag10_train:  11.92468; grad/pseudo_mag10_train:  19399.99072; grad/true_std10_train:  0.00291; grad/pseudo_std10_train:  4.73555; grad/diff10_train:  19390.51016; grad/cos10_train:  0.78444; grad/true_mag11_train:  15.15757; grad/pseudo_mag11_train:  21317.53760; grad/true_std11_train:  0.00370; grad/pseudo_std11_train:  5.18619; grad/diff11_train:  21306.65869; grad/cos11_train:  0.68374; grad/true_mag12_train:  9.19401; grad/pseudo_mag12_train:  19867.44707; grad/true_std12_train:  0.00224; grad/pseudo_std12_train:  4.85033; grad/diff12_train:  19859.59111; grad/cos12_train:  0.84440; grad/true_mag13_train:  11.73848; grad/pseudo_mag13_train:  20048.44355; grad/true_std13_train:  0.00287; grad/pseudo_std13_train:  4.89438; grad/diff13_train:  20038.41152; grad/cos13_train:  0.84387; grad/true_mag14_train:  14.29899; grad/pseudo_mag14_train:  21587.69883; grad/true_std14_train:  0.00349; grad/pseudo_std14_train:  5.26159; grad/diff14_train:  21576.52197; grad/cos14_train:  0.74879; grad/true_mag15_train:  9.30741; grad/pseudo_mag15_train:  20687.06201; grad/true_std15_train:  0.00227; grad/pseudo_std15_train:  5.05042; grad/diff15_train:  20678.75654; grad/cos15_train:  0.88509; grad/true_mag16_train:  10.96636; grad/pseudo_mag16_train:  20599.21992; grad/true_std16_train:  0.00268; grad/pseudo_std16_train:  5.02895; grad/diff16_train:  20589.64473; grad/cos16_train:  0.86191; grad/true_mag17_train:  12.71684; grad/pseudo_mag17_train:  21568.29453; grad/true_std17_train:  0.00310; grad/pseudo_std17_train:  5.26396; grad/diff17_train:  21557.65801; grad/cos17_train:  0.81496; grad_train:  1371.04932; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:32:24,200][trainer][INFO] - Step 660:
[2025-04-24 22:32:24,201][trainer][INFO] - loss/edit_train:  5.96521; loss/loc_train:  0.04747; edit/acc_train:  0.07436; edit/log_prob_train: -5.96521; edit/prob_train:  0.23667; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.86250; perplexity/pre_train:  47.58401; nll/post_train:  3.89329; perplexity/post_train:  49.07218; n_tokens/pre_train:  6.60000; n_tokens/post_train:  6.60000; time/edit_train:  0.25162; loss/total_train:  0.64399; loss/total_edit_train:  0.64399; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  4.82501; grad/pseudo_mag0_train:  21117.92539; grad/true_std0_train:  0.00118; grad/pseudo_std0_train:  5.14804; grad/diff0_train:  21115.29678; grad/cos0_train:  0.54014; grad/true_mag1_train:  7.96003; grad/pseudo_mag1_train:  21440.19043; grad/true_std1_train:  0.00194; grad/pseudo_std1_train:  5.22440; grad/diff1_train:  21435.78604; grad/cos1_train:  0.54339; grad/true_mag2_train:  8.08035; grad/pseudo_mag2_train:  38016.03184; grad/true_std2_train:  0.00197; grad/pseudo_std2_train:  8.95155; grad/diff2_train:  38013.35215; grad/cos2_train:  0.31531; grad/true_mag3_train:  5.10804; grad/pseudo_mag3_train:  19022.49609; grad/true_std3_train:  0.00125; grad/pseudo_std3_train:  4.64089; grad/diff3_train:  19019.67334; grad/cos3_train:  0.54636; grad/true_mag4_train:  9.16445; grad/pseudo_mag4_train:  18545.05479; grad/true_std4_train:  0.00224; grad/pseudo_std4_train:  4.52436; grad/diff4_train:  18539.76426; grad/cos4_train:  0.56577; grad/true_mag5_train:  10.07882; grad/pseudo_mag5_train:  32476.80156; grad/true_std5_train:  0.00246; grad/pseudo_std5_train:  7.72229; grad/diff5_train:  32473.31074; grad/cos5_train:  0.32486; grad/true_mag6_train:  5.61407; grad/pseudo_mag6_train:  17718.56094; grad/true_std6_train:  0.00137; grad/pseudo_std6_train:  4.32428; grad/diff6_train:  17715.02705; grad/cos6_train:  0.62141; grad/true_mag7_train:  10.26081; grad/pseudo_mag7_train:  17460.42842; grad/true_std7_train:  0.00251; grad/pseudo_std7_train:  4.26141; grad/diff7_train:  17453.59072; grad/cos7_train:  0.65011; grad/true_mag8_train:  12.90353; grad/pseudo_mag8_train:  25592.46172; grad/true_std8_train:  0.00315; grad/pseudo_std8_train:  6.17009; grad/diff8_train:  25586.20996; grad/cos8_train:  0.44341; grad/true_mag9_train:  7.28609; grad/pseudo_mag9_train:  17223.58955; grad/true_std9_train:  0.00178; grad/pseudo_std9_train:  4.20463; grad/diff9_train:  17217.97627; grad/cos9_train:  0.75677; grad/true_mag10_train:  10.62342; grad/pseudo_mag10_train:  17731.45225; grad/true_std10_train:  0.00259; grad/pseudo_std10_train:  4.32832; grad/diff10_train:  17723.22334; grad/cos10_train:  0.75753; grad/true_mag11_train:  13.43839; grad/pseudo_mag11_train:  20822.07695; grad/true_std11_train:  0.00328; grad/pseudo_std11_train:  5.05930; grad/diff11_train:  20812.87080; grad/cos11_train:  0.64368; grad/true_mag12_train:  8.10215; grad/pseudo_mag12_train:  17690.76309; grad/true_std12_train:  0.00198; grad/pseudo_std12_train:  4.31891; grad/diff12_train:  17683.89697; grad/cos12_train:  0.83493; grad/true_mag13_train:  10.65297; grad/pseudo_mag13_train:  17984.03643; grad/true_std13_train:  0.00260; grad/pseudo_std13_train:  4.39040; grad/diff13_train:  17975.22783; grad/cos13_train:  0.81480; grad/true_mag14_train:  12.65953; grad/pseudo_mag14_train:  20984.90537; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  5.11122; grad/diff14_train:  20975.72998; grad/cos14_train:  0.68705; grad/true_mag15_train:  8.41135; grad/pseudo_mag15_train:  18647.46670; grad/true_std15_train:  0.00205; grad/pseudo_std15_train:  4.55249; grad/diff15_train:  18640.03896; grad/cos15_train:  0.87284; grad/true_mag16_train:  9.82105; grad/pseudo_mag16_train:  18726.82412; grad/true_std16_train:  0.00240; grad/pseudo_std16_train:  4.57185; grad/diff16_train:  18718.32939; grad/cos16_train:  0.85182; grad/true_mag17_train:  11.15940; grad/pseudo_mag17_train:  20223.62686; grad/true_std17_train:  0.00272; grad/pseudo_std17_train:  4.93512; grad/diff17_train:  20214.58135; grad/cos17_train:  0.78236; grad_train:  1073.08667; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:32:27,400][trainer][INFO] - Step 670:
[2025-04-24 22:32:27,401][trainer][INFO] - loss/edit_train:  3.94134; loss/loc_train:  0.03853; edit/acc_train:  0.06626; edit/log_prob_train: -3.94134; edit/prob_train:  0.37216; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.98532; perplexity/pre_train:  146.25015; nll/post_train:  5.06714; perplexity/post_train:  158.71980; n_tokens/pre_train:  3.50000; n_tokens/post_train:  3.50000; time/edit_train:  0.16908; loss/total_train:  0.43267; loss/total_edit_train:  0.43267; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.32021; grad/pseudo_mag0_train:  19207.60996; grad/true_std0_train:  0.00130; grad/pseudo_std0_train:  4.68361; grad/diff0_train:  19204.66172; grad/cos0_train:  0.55581; grad/true_mag1_train:  8.83217; grad/pseudo_mag1_train:  20140.15371; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  4.90742; grad/diff1_train:  20135.06318; grad/cos1_train:  0.57841; grad/true_mag2_train:  9.38777; grad/pseudo_mag2_train:  30735.08574; grad/true_std2_train:  0.00229; grad/pseudo_std2_train:  7.26173; grad/diff2_train:  30731.24609; grad/cos2_train:  0.39540; grad/true_mag3_train:  5.84244; grad/pseudo_mag3_train:  18928.36094; grad/true_std3_train:  0.00143; grad/pseudo_std3_train:  4.61813; grad/diff3_train:  18925.21182; grad/cos3_train:  0.54175; grad/true_mag4_train:  10.40570; grad/pseudo_mag4_train:  18912.87451; grad/true_std4_train:  0.00254; grad/pseudo_std4_train:  4.61268; grad/diff4_train:  18906.85205; grad/cos4_train:  0.58429; grad/true_mag5_train:  11.60282; grad/pseudo_mag5_train:  27744.41211; grad/true_std5_train:  0.00283; grad/pseudo_std5_train:  6.61264; grad/diff5_train:  27739.72266; grad/cos5_train:  0.39676; grad/true_mag6_train:  6.44843; grad/pseudo_mag6_train:  18344.68916; grad/true_std6_train:  0.00157; grad/pseudo_std6_train:  4.47718; grad/diff6_train:  18340.69619; grad/cos6_train:  0.62166; grad/true_mag7_train:  11.80744; grad/pseudo_mag7_train:  18252.94814; grad/true_std7_train:  0.00288; grad/pseudo_std7_train:  4.45501; grad/diff7_train:  18244.85400; grad/cos7_train:  0.68654; grad/true_mag8_train:  15.20600; grad/pseudo_mag8_train:  22793.30117; grad/true_std8_train:  0.00371; grad/pseudo_std8_train:  5.50616; grad/diff8_train:  22784.80684; grad/cos8_train:  0.55258; grad/true_mag9_train:  8.43941; grad/pseudo_mag9_train:  19368.75635; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.72833; grad/diff9_train:  19362.13184; grad/cos9_train:  0.78332; grad/true_mag10_train:  12.10699; grad/pseudo_mag10_train:  19693.87480; grad/true_std10_train:  0.00296; grad/pseudo_std10_train:  4.80724; grad/diff10_train:  19684.35078; grad/cos10_train:  0.78393; grad/true_mag11_train:  16.18575; grad/pseudo_mag11_train:  21300.26572; grad/true_std11_train:  0.00395; grad/pseudo_std11_train:  5.18535; grad/diff11_train:  21288.46270; grad/cos11_train:  0.72698; grad/true_mag12_train:  9.72956; grad/pseudo_mag12_train:  20654.25781; grad/true_std12_train:  0.00238; grad/pseudo_std12_train:  5.04240; grad/diff12_train:  20645.98467; grad/cos12_train:  0.84812; grad/true_mag13_train:  11.99902; grad/pseudo_mag13_train:  20749.10137; grad/true_std13_train:  0.00293; grad/pseudo_std13_train:  5.06519; grad/diff13_train:  20739.10029; grad/cos13_train:  0.83061; grad/true_mag14_train:  14.72972; grad/pseudo_mag14_train:  22516.87744; grad/true_std14_train:  0.00360; grad/pseudo_std14_train:  5.49079; grad/diff14_train:  22505.12227; grad/cos14_train:  0.79764; grad/true_mag15_train:  9.80426; grad/pseudo_mag15_train:  21439.82588; grad/true_std15_train:  0.00239; grad/pseudo_std15_train:  5.23420; grad/diff15_train:  21431.23516; grad/cos15_train:  0.87191; grad/true_mag16_train:  11.37710; grad/pseudo_mag16_train:  21338.67148; grad/true_std16_train:  0.00278; grad/pseudo_std16_train:  5.20945; grad/diff16_train:  21328.73906; grad/cos16_train:  0.87013; grad/true_mag17_train:  14.26556; grad/pseudo_mag17_train:  24627.99473; grad/true_std17_train:  0.00348; grad/pseudo_std17_train:  6.01136; grad/diff17_train:  24616.50938; grad/cos17_train:  0.83195; grad_train:  779.98718; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:32:30,682][trainer][INFO] - Step 680:
[2025-04-24 22:32:30,682][trainer][INFO] - loss/edit_train:  5.41588; loss/loc_train:  0.03506; edit/acc_train:  0.08600; edit/log_prob_train: -5.41588; edit/prob_train:  0.26948; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.14118; perplexity/pre_train:  62.87682; nll/post_train:  4.18174; perplexity/post_train:  65.47989; n_tokens/pre_train:  5.80000; n_tokens/post_train:  5.80000; time/edit_train:  0.18268; loss/total_train:  0.57665; loss/total_edit_train:  0.57665; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.10130; grad/pseudo_mag0_train:  19063.18223; grad/true_std0_train:  0.00125; grad/pseudo_std0_train:  4.64883; grad/diff0_train:  19060.36367; grad/cos0_train:  0.55500; grad/true_mag1_train:  8.35707; grad/pseudo_mag1_train:  19301.04570; grad/true_std1_train:  0.00204; grad/pseudo_std1_train:  4.70369; grad/diff1_train:  19296.17090; grad/cos1_train:  0.58221; grad/true_mag2_train:  8.38336; grad/pseudo_mag2_train:  32835.67754; grad/true_std2_train:  0.00205; grad/pseudo_std2_train:  7.71487; grad/diff2_train:  32832.66016; grad/cos2_train:  0.35030; grad/true_mag3_train:  5.37371; grad/pseudo_mag3_train:  17975.57031; grad/true_std3_train:  0.00131; grad/pseudo_std3_train:  4.38598; grad/diff3_train:  17972.56240; grad/cos3_train:  0.56091; grad/true_mag4_train:  9.50421; grad/pseudo_mag4_train:  17517.16729; grad/true_std4_train:  0.00232; grad/pseudo_std4_train:  4.27347; grad/diff4_train:  17511.47686; grad/cos4_train:  0.59693; grad/true_mag5_train:  10.07451; grad/pseudo_mag5_train:  27386.28457; grad/true_std5_train:  0.00246; grad/pseudo_std5_train:  6.49874; grad/diff5_train:  27382.49766; grad/cos5_train:  0.36731; grad/true_mag6_train:  5.63966; grad/pseudo_mag6_train:  16491.67949; grad/true_std6_train:  0.00138; grad/pseudo_std6_train:  4.02538; grad/diff6_train:  16488.06494; grad/cos6_train:  0.64241; grad/true_mag7_train:  10.34665; grad/pseudo_mag7_train:  16196.84316; grad/true_std7_train:  0.00253; grad/pseudo_std7_train:  3.95324; grad/diff7_train:  16189.74951; grad/cos7_train:  0.68436; grad/true_mag8_train:  12.63118; grad/pseudo_mag8_train:  20585.95586; grad/true_std8_train:  0.00308; grad/pseudo_std8_train:  4.96797; grad/diff8_train:  20579.05869; grad/cos8_train:  0.52584; grad/true_mag9_train:  7.04613; grad/pseudo_mag9_train:  16143.37402; grad/true_std9_train:  0.00172; grad/pseudo_std9_train:  3.94094; grad/diff9_train:  16137.86406; grad/cos9_train:  0.77687; grad/true_mag10_train:  10.39112; grad/pseudo_mag10_train:  16696.13320; grad/true_std10_train:  0.00254; grad/pseudo_std10_train:  4.07564; grad/diff10_train:  16687.90732; grad/cos10_train:  0.78495; grad/true_mag11_train:  13.21411; grad/pseudo_mag11_train:  18546.32441; grad/true_std11_train:  0.00323; grad/pseudo_std11_train:  4.51099; grad/diff11_train:  18536.74697; grad/cos11_train:  0.70305; grad/true_mag12_train:  8.00583; grad/pseudo_mag12_train:  17062.06621; grad/true_std12_train:  0.00195; grad/pseudo_std12_train:  4.16544; grad/diff12_train:  17055.23564; grad/cos12_train:  0.84688; grad/true_mag13_train:  10.24483; grad/pseudo_mag13_train:  17355.94033; grad/true_std13_train:  0.00250; grad/pseudo_std13_train:  4.23707; grad/diff13_train:  17347.26094; grad/cos13_train:  0.84267; grad/true_mag14_train:  12.63653; grad/pseudo_mag14_train:  19019.68574; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  4.63593; grad/diff14_train:  19009.75938; grad/cos14_train:  0.76021; grad/true_mag15_train:  8.17811; grad/pseudo_mag15_train:  17975.08818; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  4.38836; grad/diff15_train:  17967.84629; grad/cos15_train:  0.88227; grad/true_mag16_train:  9.63771; grad/pseudo_mag16_train:  18040.09121; grad/true_std16_train:  0.00235; grad/pseudo_std16_train:  4.40422; grad/diff16_train:  18031.66455; grad/cos16_train:  0.86709; grad/true_mag17_train:  11.43062; grad/pseudo_mag17_train:  19500.82822; grad/true_std17_train:  0.00279; grad/pseudo_std17_train:  4.75984; grad/diff17_train:  19491.21475; grad/cos17_train:  0.82742; grad_train:  831.34039; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:32:34,440][trainer][INFO] - Step 690:
[2025-04-24 22:32:34,440][trainer][INFO] - loss/edit_train:  5.00638; loss/loc_train:  0.04281; edit/acc_train:  0.05772; edit/log_prob_train: -5.00638; edit/prob_train:  0.27177; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.85584; perplexity/pre_train:  17.38909; nll/post_train:  2.86052; perplexity/post_train:  17.47061; n_tokens/pre_train:  7.90000; n_tokens/post_train:  7.90000; time/edit_train:  0.22175; loss/total_train:  0.54345; loss/total_edit_train:  0.54345; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.72366; grad/pseudo_mag0_train:  19222.86572; grad/true_std0_train:  0.00140; grad/pseudo_std0_train:  4.68759; grad/diff0_train:  19219.67344; grad/cos0_train:  0.55998; grad/true_mag1_train:  9.26930; grad/pseudo_mag1_train:  20635.90771; grad/true_std1_train:  0.00226; grad/pseudo_std1_train:  5.02716; grad/diff1_train:  20630.48984; grad/cos1_train:  0.58495; grad/true_mag2_train:  9.52338; grad/pseudo_mag2_train:  33124.56777; grad/true_std2_train:  0.00233; grad/pseudo_std2_train:  7.79690; grad/diff2_train:  33120.97480; grad/cos2_train:  0.37141; grad/true_mag3_train:  6.21314; grad/pseudo_mag3_train:  18759.02754; grad/true_std3_train:  0.00152; grad/pseudo_std3_train:  4.57698; grad/diff3_train:  18755.62139; grad/cos3_train:  0.55094; grad/true_mag4_train:  11.36016; grad/pseudo_mag4_train:  19449.92578; grad/true_std4_train:  0.00277; grad/pseudo_std4_train:  4.74466; grad/diff4_train:  19443.09229; grad/cos4_train:  0.60135; grad/true_mag5_train:  12.14445; grad/pseudo_mag5_train:  28604.06465; grad/true_std5_train:  0.00296; grad/pseudo_std5_train:  6.79717; grad/diff5_train:  28599.08945; grad/cos5_train:  0.39937; grad/true_mag6_train:  7.14707; grad/pseudo_mag6_train:  19418.47627; grad/true_std6_train:  0.00174; grad/pseudo_std6_train:  4.73984; grad/diff6_train:  19413.94199; grad/cos6_train:  0.63692; grad/true_mag7_train:  13.04857; grad/pseudo_mag7_train:  19993.97852; grad/true_std7_train:  0.00319; grad/pseudo_std7_train:  4.88020; grad/diff7_train:  19984.80449; grad/cos7_train:  0.69953; grad/true_mag8_train:  16.32851; grad/pseudo_mag8_train:  23712.79063; grad/true_std8_train:  0.00399; grad/pseudo_std8_train:  5.73135; grad/diff8_train:  23703.06895; grad/cos8_train:  0.58145; grad/true_mag9_train:  9.66568; grad/pseudo_mag9_train:  22845.55410; grad/true_std9_train:  0.00236; grad/pseudo_std9_train:  5.57719; grad/diff9_train:  22837.83779; grad/cos9_train:  0.79318; grad/true_mag10_train:  13.83206; grad/pseudo_mag10_train:  22637.90635; grad/true_std10_train:  0.00338; grad/pseudo_std10_train:  5.52617; grad/diff10_train:  22626.65400; grad/cos10_train:  0.80717; grad/true_mag11_train:  18.10815; grad/pseudo_mag11_train:  23895.58105; grad/true_std11_train:  0.00442; grad/pseudo_std11_train:  5.81841; grad/diff11_train:  23881.69414; grad/cos11_train:  0.75484; grad/true_mag12_train:  11.35713; grad/pseudo_mag12_train:  25023.66533; grad/true_std12_train:  0.00277; grad/pseudo_std12_train:  6.10917; grad/diff12_train:  25013.82891; grad/cos12_train:  0.86024; grad/true_mag13_train:  13.91556; grad/pseudo_mag13_train:  24456.29688; grad/true_std13_train:  0.00340; grad/pseudo_std13_train:  5.97060; grad/diff13_train:  24444.17188; grad/cos13_train:  0.86450; grad/true_mag14_train:  16.90847; grad/pseudo_mag14_train:  25992.67998; grad/true_std14_train:  0.00413; grad/pseudo_std14_train:  6.33867; grad/diff14_train:  25978.50195; grad/cos14_train:  0.81926; grad/true_mag15_train:  11.44426; grad/pseudo_mag15_train:  25773.00195; grad/true_std15_train:  0.00279; grad/pseudo_std15_train:  6.29211; grad/diff15_train:  25762.69121; grad/cos15_train:  0.89816; grad/true_mag16_train:  13.16763; grad/pseudo_mag16_train:  25455.49238; grad/true_std16_train:  0.00321; grad/pseudo_std16_train:  6.21460; grad/diff16_train:  25443.76348; grad/cos16_train:  0.88483; grad/true_mag17_train:  15.28335; grad/pseudo_mag17_train:  26908.66338; grad/true_std17_train:  0.00373; grad/pseudo_std17_train:  6.56850; grad/diff17_train:  26895.21328; grad/cos17_train:  0.87106; grad_train:  904.84460; lr/lr0_train:  0.00005; lr/lr1_train:  0.00005; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:32:37,691][trainer][INFO] - Step 700:
[2025-04-24 22:32:37,691][trainer][INFO] - loss/edit_train:  4.70879; loss/loc_train:  0.02917; edit/acc_train:  0.06222; edit/log_prob_train: -4.70879; edit/prob_train:  0.30469; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.54871; perplexity/pre_train:  256.90561; nll/post_train:  5.54629; perplexity/post_train:  256.28418; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18297; loss/total_train:  0.50004; loss/total_edit_train:  0.50004; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.56994; grad/pseudo_mag0_train:  21905.66016; grad/true_std0_train:  0.00136; grad/pseudo_std0_train:  5.34247; grad/diff0_train:  21902.52471; grad/cos0_train:  0.56483; grad/true_mag1_train:  8.82754; grad/pseudo_mag1_train:  21313.88125; grad/true_std1_train:  0.00216; grad/pseudo_std1_train:  5.19488; grad/diff1_train:  21308.66582; grad/cos1_train:  0.58603; grad/true_mag2_train:  9.05242; grad/pseudo_mag2_train:  39545.66680; grad/true_std2_train:  0.00221; grad/pseudo_std2_train:  9.26736; grad/diff2_train:  39542.76504; grad/cos2_train:  0.31038; grad/true_mag3_train:  5.76599; grad/pseudo_mag3_train:  19967.19141; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.87215; grad/diff3_train:  19963.95605; grad/cos3_train:  0.56275; grad/true_mag4_train:  10.05468; grad/pseudo_mag4_train:  18927.90449; grad/true_std4_train:  0.00245; grad/pseudo_std4_train:  4.61776; grad/diff4_train:  18921.80303; grad/cos4_train:  0.60572; grad/true_mag5_train:  10.81679; grad/pseudo_mag5_train:  30526.35957; grad/true_std5_train:  0.00264; grad/pseudo_std5_train:  7.23324; grad/diff5_train:  30522.38379; grad/cos5_train:  0.35759; grad/true_mag6_train:  6.14569; grad/pseudo_mag6_train:  18224.18525; grad/true_std6_train:  0.00150; grad/pseudo_std6_train:  4.44828; grad/diff6_train:  18220.23027; grad/cos6_train:  0.64500; grad/true_mag7_train:  11.05715; grad/pseudo_mag7_train:  17603.88545; grad/true_std7_train:  0.00270; grad/pseudo_std7_train:  4.29672; grad/diff7_train:  17596.25947; grad/cos7_train:  0.68651; grad/true_mag8_train:  13.67346; grad/pseudo_mag8_train:  22339.21777; grad/true_std8_train:  0.00334; grad/pseudo_std8_train:  5.38883; grad/diff8_train:  22331.96328; grad/cos8_train:  0.51280; grad/true_mag9_train:  7.69031; grad/pseudo_mag9_train:  17644.52627; grad/true_std9_train:  0.00188; grad/pseudo_std9_train:  4.30751; grad/diff9_train:  17638.45566; grad/cos9_train:  0.78660; grad/true_mag10_train:  11.09749; grad/pseudo_mag10_train:  17703.36289; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  4.32167; grad/diff10_train:  17694.52842; grad/cos10_train:  0.79166; grad/true_mag11_train:  14.71874; grad/pseudo_mag11_train:  19470.37676; grad/true_std11_train:  0.00359; grad/pseudo_std11_train:  4.73553; grad/diff11_train:  19459.71465; grad/cos11_train:  0.70648; grad/true_mag12_train:  8.83693; grad/pseudo_mag12_train:  19023.58457; grad/true_std12_train:  0.00216; grad/pseudo_std12_train:  4.64435; grad/diff12_train:  19016.00762; grad/cos12_train:  0.85353; grad/true_mag13_train:  11.02400; grad/pseudo_mag13_train:  18777.71924; grad/true_std13_train:  0.00269; grad/pseudo_std13_train:  4.58429; grad/diff13_train:  18768.28408; grad/cos13_train:  0.85017; grad/true_mag14_train:  13.55341; grad/pseudo_mag14_train:  20348.66748; grad/true_std14_train:  0.00331; grad/pseudo_std14_train:  4.96058; grad/diff14_train:  20337.75879; grad/cos14_train:  0.78537; grad/true_mag15_train:  8.80309; grad/pseudo_mag15_train:  19375.79531; grad/true_std15_train:  0.00215; grad/pseudo_std15_train:  4.73037; grad/diff15_train:  19367.92129; grad/cos15_train:  0.88931; grad/true_mag16_train:  10.35613; grad/pseudo_mag16_train:  19399.92793; grad/true_std16_train:  0.00253; grad/pseudo_std16_train:  4.73624; grad/diff16_train:  19390.84229; grad/cos16_train:  0.87168; grad/true_mag17_train:  11.95504; grad/pseudo_mag17_train:  20766.14404; grad/true_std17_train:  0.00292; grad/pseudo_std17_train:  5.06840; grad/diff17_train:  20755.90654; grad/cos17_train:  0.84145; grad_train:  714.20746; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:32:55,566][trainer][INFO] - Step 700:
[2025-04-24 22:32:55,566][trainer][INFO] - loss/edit_val:  5.13890; loss/loc_val:  0.04594; edit/acc_val:  0.06894; edit/log_prob_val: -5.13890; edit/prob_val:  0.28655; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.40424; perplexity/post_val:  81.79680; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10590; loss/total_val:  0.55983; loss/total_edit_val:  0.55983; memory/alloc_max_val:  42223547904.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  17.86952; eval_time/average:  0.17870
[2025-04-24 22:32:55,569][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:32:55,570][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
[2025-04-24 22:33:49,428][trainer][INFO] - Write complete.
[2025-04-24 22:33:53,203][trainer][INFO] - Step 710:
[2025-04-24 22:33:53,203][trainer][INFO] - loss/edit_train:  5.54164; loss/loc_train:  0.05147; edit/acc_train:  0.13366; edit/log_prob_train: -5.54164; edit/prob_train:  0.28620; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79693; perplexity/pre_train:  44.56421; nll/post_train:  3.86511; perplexity/post_train:  47.70853; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.22767; loss/total_train:  0.60563; loss/total_edit_train:  0.60563; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  6.95356; grad/pseudo_mag0_train:  23850.63477; grad/true_std0_train:  0.00170; grad/pseudo_std0_train:  5.81529; grad/diff0_train:  23846.89863; grad/cos0_train:  0.54024; grad/true_mag1_train:  10.63358; grad/pseudo_mag1_train:  26482.29375; grad/true_std1_train:  0.00260; grad/pseudo_std1_train:  6.44800; grad/diff1_train:  26476.30723; grad/cos1_train:  0.56664; grad/true_mag2_train:  10.65074; grad/pseudo_mag2_train:  39480.82109; grad/true_std2_train:  0.00260; grad/pseudo_std2_train:  9.29293; grad/diff2_train:  39476.72734; grad/cos2_train:  0.36692; grad/true_mag3_train:  6.91773; grad/pseudo_mag3_train:  21486.26426; grad/true_std3_train:  0.00169; grad/pseudo_std3_train:  5.24215; grad/diff3_train:  21482.48418; grad/cos3_train:  0.54771; grad/true_mag4_train:  12.05220; grad/pseudo_mag4_train:  22753.40723; grad/true_std4_train:  0.00294; grad/pseudo_std4_train:  5.54830; grad/diff4_train:  22746.30508; grad/cos4_train:  0.59014; grad/true_mag5_train:  13.13716; grad/pseudo_mag5_train:  32506.40254; grad/true_std5_train:  0.00321; grad/pseudo_std5_train:  7.73307; grad/diff5_train:  32501.08945; grad/cos5_train:  0.39373; grad/true_mag6_train:  7.05064; grad/pseudo_mag6_train:  19924.65625; grad/true_std6_train:  0.00172; grad/pseudo_std6_train:  4.86310; grad/diff6_train:  19920.14111; grad/cos6_train:  0.64049; grad/true_mag7_train:  12.71413; grad/pseudo_mag7_train:  20047.78037; grad/true_std7_train:  0.00310; grad/pseudo_std7_train:  4.89313; grad/diff7_train:  20038.78633; grad/cos7_train:  0.70679; grad/true_mag8_train:  16.00612; grad/pseudo_mag8_train:  24083.96172; grad/true_std8_train:  0.00391; grad/pseudo_std8_train:  5.82460; grad/diff8_train:  24074.57812; grad/cos8_train:  0.58052; grad/true_mag9_train:  9.21804; grad/pseudo_mag9_train:  21811.51484; grad/true_std9_train:  0.00225; grad/pseudo_std9_train:  5.32474; grad/diff9_train:  21804.13809; grad/cos9_train:  0.79935; grad/true_mag10_train:  13.26407; grad/pseudo_mag10_train:  21916.14834; grad/true_std10_train:  0.00324; grad/pseudo_std10_train:  5.34995; grad/diff10_train:  21905.32812; grad/cos10_train:  0.81504; grad/true_mag11_train:  17.43868; grad/pseudo_mag11_train:  23668.77441; grad/true_std11_train:  0.00426; grad/pseudo_std11_train:  5.76472; grad/diff11_train:  23655.58906; grad/cos11_train:  0.75151; grad/true_mag12_train:  10.90088; grad/pseudo_mag12_train:  23840.72246; grad/true_std12_train:  0.00266; grad/pseudo_std12_train:  5.82030; grad/diff12_train:  23831.25742; grad/cos12_train:  0.86810; grad/true_mag13_train:  13.23598; grad/pseudo_mag13_train:  23221.29727; grad/true_std13_train:  0.00323; grad/pseudo_std13_train:  5.66902; grad/diff13_train:  23209.73574; grad/cos13_train:  0.87281; grad/true_mag14_train:  16.19998; grad/pseudo_mag14_train:  24677.88789; grad/true_std14_train:  0.00396; grad/pseudo_std14_train:  6.01902; grad/diff14_train:  24664.52578; grad/cos14_train:  0.82085; grad/true_mag15_train:  11.17272; grad/pseudo_mag15_train:  24991.10977; grad/true_std15_train:  0.00273; grad/pseudo_std15_train:  6.10120; grad/diff15_train:  24981.01641; grad/cos15_train:  0.90323; grad/true_mag16_train:  12.64570; grad/pseudo_mag16_train:  24598.13359; grad/true_std16_train:  0.00309; grad/pseudo_std16_train:  6.00523; grad/diff16_train:  24586.78984; grad/cos16_train:  0.89630; grad/true_mag17_train:  14.31971; grad/pseudo_mag17_train:  25853.16426; grad/true_std17_train:  0.00350; grad/pseudo_std17_train:  6.31084; grad/diff17_train:  25840.45742; grad/cos17_train:  0.88522; grad_train:  953.41095; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:33:56,801][trainer][INFO] - Step 720:
[2025-04-24 22:33:56,802][trainer][INFO] - loss/edit_train:  6.73893; loss/loc_train:  0.06531; edit/acc_train:  0.00701; edit/log_prob_train: -6.73893; edit/prob_train:  0.20189; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.81648; perplexity/pre_train:  45.44403; nll/post_train:  3.82539; perplexity/post_train:  45.85067; n_tokens/pre_train:  8.60000; n_tokens/post_train:  8.60000; time/edit_train:  0.17925; loss/total_train:  0.73920; loss/total_edit_train:  0.73920; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.89496; grad/pseudo_mag0_train:  22586.53672; grad/true_std0_train:  0.00144; grad/pseudo_std0_train:  5.50561; grad/diff0_train:  22583.19980; grad/cos0_train:  0.56987; grad/true_mag1_train:  9.38149; grad/pseudo_mag1_train:  22784.49023; grad/true_std1_train:  0.00229; grad/pseudo_std1_train:  5.54778; grad/diff1_train:  22779.05332; grad/cos1_train:  0.58412; grad/true_mag2_train:  9.53444; grad/pseudo_mag2_train:  37431.08359; grad/true_std2_train:  0.00233; grad/pseudo_std2_train:  8.78088; grad/diff2_train:  37427.55645; grad/cos2_train:  0.35716; grad/true_mag3_train:  6.06161; grad/pseudo_mag3_train:  20297.39316; grad/true_std3_train:  0.00148; grad/pseudo_std3_train:  4.95220; grad/diff3_train:  20293.94111; grad/cos3_train:  0.56932; grad/true_mag4_train:  10.51037; grad/pseudo_mag4_train:  19800.42598; grad/true_std4_train:  0.00257; grad/pseudo_std4_train:  4.82947; grad/diff4_train:  19794.10957; grad/cos4_train:  0.60471; grad/true_mag5_train:  11.39739; grad/pseudo_mag5_train:  30968.95586; grad/true_std5_train:  0.00278; grad/pseudo_std5_train:  7.34606; grad/diff5_train:  30964.57500; grad/cos5_train:  0.37216; grad/true_mag6_train:  6.25251; grad/pseudo_mag6_train:  18219.42969; grad/true_std6_train:  0.00153; grad/pseudo_std6_train:  4.44697; grad/diff6_train:  18215.38936; grad/cos6_train:  0.64668; grad/true_mag7_train:  11.27287; grad/pseudo_mag7_train:  17922.30029; grad/true_std7_train:  0.00275; grad/pseudo_std7_train:  4.37418; grad/diff7_train:  17914.53174; grad/cos7_train:  0.68289; grad/true_mag8_train:  13.76929; grad/pseudo_mag8_train:  23344.53027; grad/true_std8_train:  0.00336; grad/pseudo_std8_train:  5.62755; grad/diff8_train:  23337.27178; grad/cos8_train:  0.49780; grad/true_mag9_train:  7.90778; grad/pseudo_mag9_train:  18598.19541; grad/true_std9_train:  0.00193; grad/pseudo_std9_train:  4.54022; grad/diff9_train:  18591.96230; grad/cos9_train:  0.77505; grad/true_mag10_train:  11.44924; grad/pseudo_mag10_train:  18664.20713; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  4.55597; grad/diff10_train:  18655.10977; grad/cos10_train:  0.78021; grad/true_mag11_train:  14.65913; grad/pseudo_mag11_train:  20270.06699; grad/true_std11_train:  0.00358; grad/pseudo_std11_train:  4.92606; grad/diff11_train:  20259.84219; grad/cos11_train:  0.66213; grad/true_mag12_train:  8.71733; grad/pseudo_mag12_train:  18422.86484; grad/true_std12_train:  0.00213; grad/pseudo_std12_train:  4.49767; grad/diff12_train:  18415.45137; grad/cos12_train:  0.83486; grad/true_mag13_train:  11.13823; grad/pseudo_mag13_train:  18824.07363; grad/true_std13_train:  0.00272; grad/pseudo_std13_train:  4.59547; grad/diff13_train:  18814.62402; grad/cos13_train:  0.83418; grad/true_mag14_train:  13.46183; grad/pseudo_mag14_train:  20291.81523; grad/true_std14_train:  0.00329; grad/pseudo_std14_train:  4.94327; grad/diff14_train:  20281.42314; grad/cos14_train:  0.73770; grad/true_mag15_train:  8.64733; grad/pseudo_mag15_train:  18847.87002; grad/true_std15_train:  0.00211; grad/pseudo_std15_train:  4.60143; grad/diff15_train:  18840.20215; grad/cos15_train:  0.87372; grad/true_mag16_train:  10.42866; grad/pseudo_mag16_train:  19047.90518; grad/true_std16_train:  0.00255; grad/pseudo_std16_train:  4.65025; grad/diff16_train:  19038.86895; grad/cos16_train:  0.85047; grad/true_mag17_train:  11.98704; grad/pseudo_mag17_train:  20039.81445; grad/true_std17_train:  0.00293; grad/pseudo_std17_train:  4.89075; grad/diff17_train:  20029.99482; grad/cos17_train:  0.78818; grad_train:  3636.92065; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:00,543][trainer][INFO] - Step 730:
[2025-04-24 22:34:00,544][trainer][INFO] - loss/edit_train:  5.16151; loss/loc_train:  0.04893; edit/acc_train:  0.08288; edit/log_prob_train: -5.16151; edit/prob_train:  0.31529; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.18142; perplexity/pre_train:  65.45903; nll/post_train:  4.23552; perplexity/post_train:  69.09762; n_tokens/pre_train:  6.20000; n_tokens/post_train:  6.20000; time/edit_train:  0.18031; loss/total_train:  0.56508; loss/total_edit_train:  0.56508; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.56408; grad/pseudo_mag0_train:  19329.75352; grad/true_std0_train:  0.00136; grad/pseudo_std0_train:  4.71267; grad/diff0_train:  19326.75205; grad/cos0_train:  0.53688; grad/true_mag1_train:  9.07589; grad/pseudo_mag1_train:  21125.13711; grad/true_std1_train:  0.00222; grad/pseudo_std1_train:  5.14578; grad/diff1_train:  21120.04277; grad/cos1_train:  0.55592; grad/true_mag2_train:  9.27024; grad/pseudo_mag2_train:  36862.99297; grad/true_std2_train:  0.00226; grad/pseudo_std2_train:  8.62631; grad/diff2_train:  36859.73887; grad/cos2_train:  0.34001; grad/true_mag3_train:  5.92748; grad/pseudo_mag3_train:  18523.25342; grad/true_std3_train:  0.00145; grad/pseudo_std3_train:  4.51926; grad/diff3_train:  18520.07314; grad/cos3_train:  0.53623; grad/true_mag4_train:  10.68418; grad/pseudo_mag4_train:  19325.18145; grad/true_std4_train:  0.00261; grad/pseudo_std4_train:  4.71315; grad/diff4_train:  19318.99551; grad/cos4_train:  0.57845; grad/true_mag5_train:  11.64593; grad/pseudo_mag5_train:  31347.04668; grad/true_std5_train:  0.00284; grad/pseudo_std5_train:  7.41749; grad/diff5_train:  31342.74121; grad/cos5_train:  0.35641; grad/true_mag6_train:  6.54898; grad/pseudo_mag6_train:  18868.42949; grad/true_std6_train:  0.00160; grad/pseudo_std6_train:  4.60529; grad/diff6_train:  18864.29932; grad/cos6_train:  0.62919; grad/true_mag7_train:  12.21001; grad/pseudo_mag7_train:  18955.35586; grad/true_std7_train:  0.00298; grad/pseudo_std7_train:  4.62646; grad/diff7_train:  18946.92109; grad/cos7_train:  0.68575; grad/true_mag8_train:  15.11480; grad/pseudo_mag8_train:  24458.22998; grad/true_std8_train:  0.00369; grad/pseudo_std8_train:  5.89320; grad/diff8_train:  24450.10127; grad/cos8_train:  0.51822; grad/true_mag9_train:  8.63746; grad/pseudo_mag9_train:  20321.40703; grad/true_std9_train:  0.00211; grad/pseudo_std9_train:  4.96097; grad/diff9_train:  20314.56143; grad/cos9_train:  0.78781; grad/true_mag10_train:  12.41938; grad/pseudo_mag10_train:  20311.69756; grad/true_std10_train:  0.00303; grad/pseudo_std10_train:  4.95835; grad/diff10_train:  20301.66543; grad/cos10_train:  0.80078; grad/true_mag11_train:  16.62685; grad/pseudo_mag11_train:  22553.09893; grad/true_std11_train:  0.00406; grad/pseudo_std11_train:  5.48510; grad/diff11_train:  22541.02344; grad/cos11_train:  0.71032; grad/true_mag12_train:  10.06422; grad/pseudo_mag12_train:  21795.04541; grad/true_std12_train:  0.00246; grad/pseudo_std12_train:  5.32096; grad/diff12_train:  21786.37422; grad/cos12_train:  0.85564; grad/true_mag13_train:  12.41677; grad/pseudo_mag13_train:  21628.84326; grad/true_std13_train:  0.00303; grad/pseudo_std13_train:  5.28031; grad/diff13_train:  21618.08223; grad/cos13_train:  0.86063; grad/true_mag14_train:  15.58258; grad/pseudo_mag14_train:  23416.54863; grad/true_std14_train:  0.00380; grad/pseudo_std14_train:  5.70749; grad/diff14_train:  23404.05195; grad/cos14_train:  0.78351; grad/true_mag15_train:  10.42363; grad/pseudo_mag15_train:  23129.98203; grad/true_std15_train:  0.00254; grad/pseudo_std15_train:  5.64688; grad/diff15_train:  23120.63623; grad/cos15_train:  0.89231; grad/true_mag16_train:  12.07694; grad/pseudo_mag16_train:  22797.56133; grad/true_std16_train:  0.00295; grad/pseudo_std16_train:  5.56571; grad/diff16_train:  22786.87666; grad/cos16_train:  0.87925; grad/true_mag17_train:  13.96309; grad/pseudo_mag17_train:  24527.78184; grad/true_std17_train:  0.00341; grad/pseudo_std17_train:  5.98686; grad/diff17_train:  24515.55537; grad/cos17_train:  0.86311; grad_train:  706.60919; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:03,772][trainer][INFO] - Step 740:
[2025-04-24 22:34:03,772][trainer][INFO] - loss/edit_train:  4.27234; loss/loc_train:  0.02198; edit/acc_train:  0.08776; edit/log_prob_train: -4.27234; edit/prob_train:  0.35260; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.05270; perplexity/pre_train:  57.55261; nll/post_train:  4.08194; perplexity/post_train:  59.26044; n_tokens/pre_train:  6.70000; n_tokens/post_train:  6.70000; time/edit_train:  0.17954; loss/total_train:  0.44921; loss/total_edit_train:  0.44921; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.05304; grad/pseudo_mag0_train:  19599.02646; grad/true_std0_train:  0.00123; grad/pseudo_std0_train:  4.77747; grad/diff0_train:  19596.25732; grad/cos0_train:  0.55552; grad/true_mag1_train:  8.24347; grad/pseudo_mag1_train:  19627.16953; grad/true_std1_train:  0.00201; grad/pseudo_std1_train:  4.77921; grad/diff1_train:  19622.58408; grad/cos1_train:  0.56005; grad/true_mag2_train:  8.23529; grad/pseudo_mag2_train:  35986.60078; grad/true_std2_train:  0.00201; grad/pseudo_std2_train:  8.42346; grad/diff2_train:  35984.06484; grad/cos2_train:  0.30154; grad/true_mag3_train:  5.17425; grad/pseudo_mag3_train:  17768.72490; grad/true_std3_train:  0.00126; grad/pseudo_std3_train:  4.33471; grad/diff3_train:  17765.86748; grad/cos3_train:  0.55551; grad/true_mag4_train:  9.15591; grad/pseudo_mag4_train:  16809.25879; grad/true_std4_train:  0.00224; grad/pseudo_std4_train:  4.09963; grad/diff4_train:  16803.94150; grad/cos4_train:  0.58589; grad/true_mag5_train:  9.79834; grad/pseudo_mag5_train:  30495.56875; grad/true_std5_train:  0.00239; grad/pseudo_std5_train:  7.20388; grad/diff5_train:  30492.43848; grad/cos5_train:  0.31357; grad/true_mag6_train:  5.38313; grad/pseudo_mag6_train:  16670.91250; grad/true_std6_train:  0.00131; grad/pseudo_std6_train:  4.06873; grad/diff6_train:  16667.45879; grad/cos6_train:  0.64365; grad/true_mag7_train:  9.87842; grad/pseudo_mag7_train:  15740.74746; grad/true_std7_train:  0.00241; grad/pseudo_std7_train:  3.84164; grad/diff7_train:  15734.07471; grad/cos7_train:  0.67694; grad/true_mag8_train:  12.32705; grad/pseudo_mag8_train:  22785.02578; grad/true_std8_train:  0.00301; grad/pseudo_std8_train:  5.48310; grad/diff8_train:  22779.08125; grad/cos8_train:  0.46729; grad/true_mag9_train:  6.73720; grad/pseudo_mag9_train:  15618.23887; grad/true_std9_train:  0.00164; grad/pseudo_std9_train:  3.81271; grad/diff9_train:  15613.00332; grad/cos9_train:  0.77651; grad/true_mag10_train:  10.07353; grad/pseudo_mag10_train:  15915.71084; grad/true_std10_train:  0.00246; grad/pseudo_std10_train:  3.88500; grad/diff10_train:  15907.81348; grad/cos10_train:  0.78214; grad/true_mag11_train:  12.90993; grad/pseudo_mag11_train:  18198.93662; grad/true_std11_train:  0.00315; grad/pseudo_std11_train:  4.42082; grad/diff11_train:  18190.19629; grad/cos11_train:  0.66508; grad/true_mag12_train:  7.51868; grad/pseudo_mag12_train:  15795.27051; grad/true_std12_train:  0.00184; grad/pseudo_std12_train:  3.85619; grad/diff12_train:  15788.87969; grad/cos12_train:  0.84703; grad/true_mag13_train:  9.78348; grad/pseudo_mag13_train:  16255.45225; grad/true_std13_train:  0.00239; grad/pseudo_std13_train:  3.96845; grad/diff13_train:  16247.16807; grad/cos13_train:  0.84440; grad/true_mag14_train:  12.17449; grad/pseudo_mag14_train:  18054.56895; grad/true_std14_train:  0.00297; grad/pseudo_std14_train:  4.39752; grad/diff14_train:  18045.39600; grad/cos14_train:  0.74400; grad/true_mag15_train:  7.68155; grad/pseudo_mag15_train:  16629.12969; grad/true_std15_train:  0.00188; grad/pseudo_std15_train:  4.05977; grad/diff15_train:  16622.32637; grad/cos15_train:  0.88376; grad/true_mag16_train:  9.20081; grad/pseudo_mag16_train:  16761.98369; grad/true_std16_train:  0.00225; grad/pseudo_std16_train:  4.09219; grad/diff16_train:  16753.99922; grad/cos16_train:  0.86540; grad/true_mag17_train:  10.72081; grad/pseudo_mag17_train:  18051.05879; grad/true_std17_train:  0.00262; grad/pseudo_std17_train:  4.40535; grad/diff17_train:  18042.10840; grad/cos17_train:  0.82860; grad_train:  573.68848; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00005; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:06,931][trainer][INFO] - Step 750:
[2025-04-24 22:34:06,932][trainer][INFO] - loss/edit_train:  3.95481; loss/loc_train:  0.01415; edit/acc_train:  0.11107; edit/log_prob_train: -3.95481; edit/prob_train:  0.36862; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.23399; perplexity/pre_train:  25.38075; nll/post_train:  3.20822; perplexity/post_train:  24.73493; n_tokens/pre_train:  4.90000; n_tokens/post_train:  4.90000; time/edit_train:  0.17350; loss/total_train:  0.40963; loss/total_edit_train:  0.40963; memory/alloc_max_train:  42223547904.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.06319; grad/pseudo_mag0_train:  18484.21094; grad/true_std0_train:  0.00124; grad/pseudo_std0_train:  4.50354; grad/diff0_train:  18481.47070; grad/cos0_train:  0.54250; grad/true_mag1_train:  8.47179; grad/pseudo_mag1_train:  19094.79395; grad/true_std1_train:  0.00207; grad/pseudo_std1_train:  4.64970; grad/diff1_train:  19089.98984; grad/cos1_train:  0.56706; grad/true_mag2_train:  8.58812; grad/pseudo_mag2_train:  37173.24336; grad/true_std2_train:  0.00210; grad/pseudo_std2_train:  8.66340; grad/diff2_train:  37170.62070; grad/cos2_train:  0.30006; grad/true_mag3_train:  5.58147; grad/pseudo_mag3_train:  17607.65820; grad/true_std3_train:  0.00136; grad/pseudo_std3_train:  4.29483; grad/diff3_train:  17604.60371; grad/cos3_train:  0.54919; grad/true_mag4_train:  9.95786; grad/pseudo_mag4_train:  17597.82666; grad/true_std4_train:  0.00243; grad/pseudo_std4_train:  4.29172; grad/diff4_train:  17591.98896; grad/cos4_train:  0.58734; grad/true_mag5_train:  10.65175; grad/pseudo_mag5_train:  31835.68320; grad/true_std5_train:  0.00260; grad/pseudo_std5_train:  7.50099; grad/diff5_train:  31832.33613; grad/cos5_train:  0.30822; grad/true_mag6_train:  6.04373; grad/pseudo_mag6_train:  16715.92227; grad/true_std6_train:  0.00148; grad/pseudo_std6_train:  4.07960; grad/diff6_train:  16712.07324; grad/cos6_train:  0.63906; grad/true_mag7_train:  11.09114; grad/pseudo_mag7_train:  16803.46338; grad/true_std7_train:  0.00271; grad/pseudo_std7_train:  4.10112; grad/diff7_train:  16795.81074; grad/cos7_train:  0.68851; grad/true_mag8_train:  13.64071; grad/pseudo_mag8_train:  22591.53711; grad/true_std8_train:  0.00333; grad/pseudo_std8_train:  5.42894; grad/diff8_train:  22584.72539; grad/cos8_train:  0.48898; grad/true_mag9_train:  7.90616; grad/pseudo_mag9_train:  18142.85586; grad/true_std9_train:  0.00193; grad/pseudo_std9_train:  4.42901; grad/diff9_train:  18136.60898; grad/cos9_train:  0.78550; grad/true_mag10_train:  11.41666; grad/pseudo_mag10_train:  18112.52129; grad/true_std10_train:  0.00279; grad/pseudo_std10_train:  4.42127; grad/diff10_train:  18103.39678; grad/cos10_train:  0.79330; grad/true_mag11_train:  14.23379; grad/pseudo_mag11_train:  19472.39814; grad/true_std11_train:  0.00348; grad/pseudo_std11_train:  4.73311; grad/diff11_train:  19462.03486; grad/cos11_train:  0.71229; grad/true_mag12_train:  8.78264; grad/pseudo_mag12_train:  18554.28770; grad/true_std12_train:  0.00214; grad/pseudo_std12_train:  4.52975; grad/diff12_train:  18546.76396; grad/cos12_train:  0.84901; grad/true_mag13_train:  11.28756; grad/pseudo_mag13_train:  18739.17129; grad/true_std13_train:  0.00276; grad/pseudo_std13_train:  4.57479; grad/diff13_train:  18729.52393; grad/cos13_train:  0.84709; grad/true_mag14_train:  13.37397; grad/pseudo_mag14_train:  19710.71250; grad/true_std14_train:  0.00327; grad/pseudo_std14_train:  4.80470; grad/diff14_train:  19699.94043; grad/cos14_train:  0.78935; grad/true_mag15_train:  8.94141; grad/pseudo_mag15_train:  19362.05586; grad/true_std15_train:  0.00218; grad/pseudo_std15_train:  4.72698; grad/diff15_train:  19354.07754; grad/cos15_train:  0.88653; grad/true_mag16_train:  10.52058; grad/pseudo_mag16_train:  19353.64355; grad/true_std16_train:  0.00257; grad/pseudo_std16_train:  4.72490; grad/diff16_train:  19344.43623; grad/cos16_train:  0.86622; grad/true_mag17_train:  11.96696; grad/pseudo_mag17_train:  20489.55898; grad/true_std17_train:  0.00292; grad/pseudo_std17_train:  5.00105; grad/diff17_train:  20479.23740; grad/cos17_train:  0.84779; grad_train:  405.85080; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00004; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:10,718][trainer][INFO] - Step 760:
[2025-04-24 22:34:10,718][trainer][INFO] - loss/edit_train:  4.59980; loss/loc_train:  0.05743; edit/acc_train:  0.08955; edit/log_prob_train: -4.59980; edit/prob_train:  0.35434; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.42594; perplexity/pre_train:  30.75162; nll/post_train:  3.63998; perplexity/post_train:  38.09102; n_tokens/pre_train:  8.80000; n_tokens/post_train:  8.80000; time/edit_train:  0.22365; loss/total_train:  0.51741; loss/total_edit_train:  0.51741; memory/alloc_max_train:  43012630579.20000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.86135; grad/pseudo_mag0_train:  23270.64482; grad/true_std0_train:  0.00143; grad/pseudo_std0_train:  5.66967; grad/diff0_train:  23267.51289; grad/cos0_train:  0.53816; grad/true_mag1_train:  9.42160; grad/pseudo_mag1_train:  23453.59336; grad/true_std1_train:  0.00230; grad/pseudo_std1_train:  5.70822; grad/diff1_train:  23448.34395; grad/cos1_train:  0.56100; grad/true_mag2_train:  9.86184; grad/pseudo_mag2_train:  39297.93340; grad/true_std2_train:  0.00241; grad/pseudo_std2_train:  9.19070; grad/diff2_train:  39294.26523; grad/cos2_train:  0.34335; grad/true_mag3_train:  6.09174; grad/pseudo_mag3_train:  20599.04561; grad/true_std3_train:  0.00149; grad/pseudo_std3_train:  5.02460; grad/diff3_train:  20595.72637; grad/cos3_train:  0.54487; grad/true_mag4_train:  10.85678; grad/pseudo_mag4_train:  20285.14902; grad/true_std4_train:  0.00265; grad/pseudo_std4_train:  4.94735; grad/diff4_train:  20278.84121; grad/cos4_train:  0.58021; grad/true_mag5_train:  12.00233; grad/pseudo_mag5_train:  33460.56270; grad/true_std5_train:  0.00293; grad/pseudo_std5_train:  7.92356; grad/diff5_train:  33456.00059; grad/cos5_train:  0.35561; grad/true_mag6_train:  6.59840; grad/pseudo_mag6_train:  20178.38145; grad/true_std6_train:  0.00161; grad/pseudo_std6_train:  4.92457; grad/diff6_train:  20174.20059; grad/cos6_train:  0.63127; grad/true_mag7_train:  11.88002; grad/pseudo_mag7_train:  19310.59004; grad/true_std7_train:  0.00290; grad/pseudo_std7_train:  4.71300; grad/diff7_train:  19302.29541; grad/cos7_train:  0.69228; grad/true_mag8_train:  14.78893; grad/pseudo_mag8_train:  25201.18691; grad/true_std8_train:  0.00361; grad/pseudo_std8_train:  6.07956; grad/diff8_train:  25193.30586; grad/cos8_train:  0.50960; grad/true_mag9_train:  8.53324; grad/pseudo_mag9_train:  20349.64570; grad/true_std9_train:  0.00208; grad/pseudo_std9_train:  4.96777; grad/diff9_train:  20342.91465; grad/cos9_train:  0.78536; grad/true_mag10_train:  12.48274; grad/pseudo_mag10_train:  20640.85488; grad/true_std10_train:  0.00305; grad/pseudo_std10_train:  5.03839; grad/diff10_train:  20631.07373; grad/cos10_train:  0.77902; grad/true_mag11_train:  16.09311; grad/pseudo_mag11_train:  22354.19170; grad/true_std11_train:  0.00393; grad/pseudo_std11_train:  5.44004; grad/diff11_train:  22342.56436; grad/cos11_train:  0.71066; grad/true_mag12_train:  9.66566; grad/pseudo_mag12_train:  20752.71299; grad/true_std12_train:  0.00236; grad/pseudo_std12_train:  5.06646; grad/diff12_train:  20744.48545; grad/cos12_train:  0.84747; grad/true_mag13_train:  12.24933; grad/pseudo_mag13_train:  21061.04229; grad/true_std13_train:  0.00299; grad/pseudo_std13_train:  5.14137; grad/diff13_train:  21050.83037; grad/cos13_train:  0.82880; grad/true_mag14_train:  15.07844; grad/pseudo_mag14_train:  22744.65859; grad/true_std14_train:  0.00368; grad/pseudo_std14_train:  5.54533; grad/diff14_train:  22732.98115; grad/cos14_train:  0.76627; grad/true_mag15_train:  9.79864; grad/pseudo_mag15_train:  21505.59902; grad/true_std15_train:  0.00239; grad/pseudo_std15_train:  5.25027; grad/diff15_train:  21497.04004; grad/cos15_train:  0.86869; grad/true_mag16_train:  11.51298; grad/pseudo_mag16_train:  21643.43164; grad/true_std16_train:  0.00281; grad/pseudo_std16_train:  5.28384; grad/diff16_train:  21633.39326; grad/cos16_train:  0.86823; grad/true_mag17_train:  14.07682; grad/pseudo_mag17_train:  24184.30205; grad/true_std17_train:  0.00344; grad/pseudo_std17_train:  5.90255; grad/diff17_train:  24173.19688; grad/cos17_train:  0.81227; grad_train:  1072.17542; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00004; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:14,025][trainer][INFO] - Step 770:
[2025-04-24 22:34:14,025][trainer][INFO] - loss/edit_train:  4.63971; loss/loc_train:  0.05281; edit/acc_train:  0.06658; edit/log_prob_train: -4.63971; edit/prob_train:  0.30098; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.68340; perplexity/pre_train:  293.94730; nll/post_train:  5.89935; perplexity/post_train:  364.79886; n_tokens/pre_train:  3.30000; n_tokens/post_train:  3.30000; time/edit_train:  0.17481; loss/total_train:  0.51678; loss/total_edit_train:  0.51678; memory/alloc_max_train:  43100306432.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.50713; grad/pseudo_mag0_train:  19815.47129; grad/true_std0_train:  0.00134; grad/pseudo_std0_train:  4.83174; grad/diff0_train:  19812.36982; grad/cos0_train:  0.56415; grad/true_mag1_train:  8.74322; grad/pseudo_mag1_train:  20785.94307; grad/true_std1_train:  0.00213; grad/pseudo_std1_train:  5.06369; grad/diff1_train:  20780.81904; grad/cos1_train:  0.58466; grad/true_mag2_train:  9.21629; grad/pseudo_mag2_train:  41229.59004; grad/true_std2_train:  0.00225; grad/pseudo_std2_train:  9.56909; grad/diff2_train:  41226.78105; grad/cos2_train:  0.30500; grad/true_mag3_train:  5.76301; grad/pseudo_mag3_train:  18973.35400; grad/true_std3_train:  0.00141; grad/pseudo_std3_train:  4.62914; grad/diff3_train:  18970.12451; grad/cos3_train:  0.56022; grad/true_mag4_train:  10.17030; grad/pseudo_mag4_train:  18966.10693; grad/true_std4_train:  0.00248; grad/pseudo_std4_train:  4.62536; grad/diff4_train:  18960.06338; grad/cos4_train:  0.59609; grad/true_mag5_train:  11.09416; grad/pseudo_mag5_train:  32002.72383; grad/true_std5_train:  0.00271; grad/pseudo_std5_train:  7.53639; grad/diff5_train:  31998.90078; grad/cos5_train:  0.34224; grad/true_mag6_train:  6.12375; grad/pseudo_mag6_train:  17572.54785; grad/true_std6_train:  0.00150; grad/pseudo_std6_train:  4.28925; grad/diff6_train:  17568.60332; grad/cos6_train:  0.64593; grad/true_mag7_train:  11.00417; grad/pseudo_mag7_train:  17121.64648; grad/true_std7_train:  0.00269; grad/pseudo_std7_train:  4.17886; grad/diff7_train:  17113.99658; grad/cos7_train:  0.69490; grad/true_mag8_train:  13.54934; grad/pseudo_mag8_train:  21770.54277; grad/true_std8_train:  0.00331; grad/pseudo_std8_train:  5.24574; grad/diff8_train:  21763.17188; grad/cos8_train:  0.53665; grad/true_mag9_train:  7.73035; grad/pseudo_mag9_train:  17759.60264; grad/true_std9_train:  0.00189; grad/pseudo_std9_train:  4.33555; grad/diff9_train:  17753.46865; grad/cos9_train:  0.79097; grad/true_mag10_train:  11.37585; grad/pseudo_mag10_train:  18152.25117; grad/true_std10_train:  0.00278; grad/pseudo_std10_train:  4.43108; grad/diff10_train:  18143.13066; grad/cos10_train:  0.79900; grad/true_mag11_train:  14.48533; grad/pseudo_mag11_train:  19803.02969; grad/true_std11_train:  0.00354; grad/pseudo_std11_train:  4.81642; grad/diff11_train:  19792.42969; grad/cos11_train:  0.72088; grad/true_mag12_train:  8.65689; grad/pseudo_mag12_train:  18429.60078; grad/true_std12_train:  0.00211; grad/pseudo_std12_train:  4.49932; grad/diff12_train:  18422.18066; grad/cos12_train:  0.85283; grad/true_mag13_train:  11.01397; grad/pseudo_mag13_train:  18606.69814; grad/true_std13_train:  0.00269; grad/pseudo_std13_train:  4.54249; grad/diff13_train:  18597.21865; grad/cos13_train:  0.85686; grad/true_mag14_train:  13.85171; grad/pseudo_mag14_train:  19792.24307; grad/true_std14_train:  0.00338; grad/pseudo_std14_train:  4.82444; grad/diff14_train:  19781.30586; grad/cos14_train:  0.78086; grad/true_mag15_train:  8.91527; grad/pseudo_mag15_train:  19522.64648; grad/true_std15_train:  0.00218; grad/pseudo_std15_train:  4.76620; grad/diff15_train:  19514.65869; grad/cos15_train:  0.89319; grad/true_mag16_train:  10.57459; grad/pseudo_mag16_train:  19707.99912; grad/true_std16_train:  0.00258; grad/pseudo_std16_train:  4.81143; grad/diff16_train:  19698.72080; grad/cos16_train:  0.87310; grad/true_mag17_train:  12.07134; grad/pseudo_mag17_train:  20766.86787; grad/true_std17_train:  0.00295; grad/pseudo_std17_train:  5.06891; grad/diff17_train:  20756.48848; grad/cos17_train:  0.85093; grad_train:  936.10394; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00004; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00003
[2025-04-24 22:34:17,270][trainer][INFO] - Step 780:
[2025-04-24 22:34:17,270][trainer][INFO] - loss/edit_train:  4.96954; loss/loc_train:  0.06067; edit/acc_train:  0.13562; edit/log_prob_train: -4.96954; edit/prob_train:  0.25213; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.03245; perplexity/pre_train:  56.39911; nll/post_train:  4.32266; perplexity/post_train:  75.38921; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.18128; loss/total_train:  0.55762; loss/total_edit_train:  0.55762; memory/alloc_max_train:  43100306432.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.76976; grad/pseudo_mag0_train:  22406.11826; grad/true_std0_train:  0.00141; grad/pseudo_std0_train:  5.46517; grad/diff0_train:  22402.92090; grad/cos0_train:  0.55903; grad/true_mag1_train:  9.17900; grad/pseudo_mag1_train:  23047.83164; grad/true_std1_train:  0.00224; grad/pseudo_std1_train:  5.61652; grad/diff1_train:  23042.44775; grad/cos1_train:  0.59025; grad/true_mag2_train:  9.55342; grad/pseudo_mag2_train:  37843.64961; grad/true_std2_train:  0.00233; grad/pseudo_std2_train:  8.89883; grad/diff2_train:  37840.18105; grad/cos2_train:  0.35631; grad/true_mag3_train:  6.21700; grad/pseudo_mag3_train:  21666.64385; grad/true_std3_train:  0.00152; grad/pseudo_std3_train:  5.28747; grad/diff3_train:  21663.09658; grad/cos3_train:  0.57463; grad/true_mag4_train:  11.07738; grad/pseudo_mag4_train:  21191.67012; grad/true_std4_train:  0.00270; grad/pseudo_std4_train:  5.17003; grad/diff4_train:  21184.98496; grad/cos4_train:  0.60763; grad/true_mag5_train:  12.16693; grad/pseudo_mag5_train:  32125.61348; grad/true_std5_train:  0.00297; grad/pseudo_std5_train:  7.63886; grad/diff5_train:  32120.88555; grad/cos5_train:  0.37879; grad/true_mag6_train:  6.70242; grad/pseudo_mag6_train:  20203.66143; grad/true_std6_train:  0.00164; grad/pseudo_std6_train:  4.93167; grad/diff6_train:  20199.24482; grad/cos6_train:  0.65839; grad/true_mag7_train:  12.30442; grad/pseudo_mag7_train:  19882.10498; grad/true_std7_train:  0.00300; grad/pseudo_std7_train:  4.85286; grad/diff7_train:  19873.49141; grad/cos7_train:  0.69559; grad/true_mag8_train:  15.75187; grad/pseudo_mag8_train:  25172.69688; grad/true_std8_train:  0.00385; grad/pseudo_std8_train:  6.08747; grad/diff8_train:  25163.67207; grad/cos8_train:  0.54539; grad/true_mag9_train:  8.74565; grad/pseudo_mag9_train:  20604.81592; grad/true_std9_train:  0.00214; grad/pseudo_std9_train:  5.03014; grad/diff9_train:  20597.89590; grad/cos9_train:  0.78519; grad/true_mag10_train:  12.67406; grad/pseudo_mag10_train:  20844.16201; grad/true_std10_train:  0.00309; grad/pseudo_std10_train:  5.08836; grad/diff10_train:  20834.00645; grad/cos10_train:  0.79280; grad/true_mag11_train:  16.56228; grad/pseudo_mag11_train:  23270.31797; grad/true_std11_train:  0.00404; grad/pseudo_std11_train:  5.66552; grad/diff11_train:  23258.24297; grad/cos11_train:  0.69823; grad/true_mag12_train:  10.06437; grad/pseudo_mag12_train:  22001.66230; grad/true_std12_train:  0.00246; grad/pseudo_std12_train:  5.37136; grad/diff12_train:  21992.99180; grad/cos12_train:  0.85271; grad/true_mag13_train:  12.62672; grad/pseudo_mag13_train:  21983.21426; grad/true_std13_train:  0.00308; grad/pseudo_std13_train:  5.36670; grad/diff13_train:  21972.36357; grad/cos13_train:  0.84958; grad/true_mag14_train:  16.15505; grad/pseudo_mag14_train:  24567.63389; grad/true_std14_train:  0.00394; grad/pseudo_std14_train:  5.99053; grad/diff14_train:  24554.74551; grad/cos14_train:  0.76657; grad/true_mag15_train:  10.65914; grad/pseudo_mag15_train:  23613.67031; grad/true_std15_train:  0.00260; grad/pseudo_std15_train:  5.76496; grad/diff15_train:  23604.14893; grad/cos15_train:  0.88529; grad/true_mag16_train:  12.23880; grad/pseudo_mag16_train:  23398.21318; grad/true_std16_train:  0.00299; grad/pseudo_std16_train:  5.71231; grad/diff16_train:  23387.40908; grad/cos16_train:  0.87192; grad/true_mag17_train:  14.28556; grad/pseudo_mag17_train:  25275.42744; grad/true_std17_train:  0.00349; grad/pseudo_std17_train:  6.16901; grad/diff17_train:  25263.30996; grad/cos17_train:  0.82642; grad_train:  1121.77332; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00004; lr/lr9_train:  0.00003; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00002; lr/lr17_train:  0.00003
[2025-04-24 22:34:21,053][trainer][INFO] - Step 790:
[2025-04-24 22:34:21,054][trainer][INFO] - loss/edit_train:  5.84795; loss/loc_train:  0.03671; edit/acc_train:  0.06611; edit/log_prob_train: -5.84795; edit/prob_train:  0.23217; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.75810; perplexity/pre_train:  116.52425; nll/post_train:  4.92920; perplexity/post_train:  138.26859; n_tokens/pre_train:  5.80000; n_tokens/post_train:  5.80000; time/edit_train:  0.22859; loss/total_train:  0.62151; loss/total_edit_train:  0.62151; memory/alloc_max_train:  43100306432.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.16097; grad/pseudo_mag0_train:  20028.12441; grad/true_std0_train:  0.00126; grad/pseudo_std0_train:  4.88313; grad/diff0_train:  20025.17539; grad/cos0_train:  0.57255; grad/true_mag1_train:  8.33957; grad/pseudo_mag1_train:  20317.83857; grad/true_std1_train:  0.00204; grad/pseudo_std1_train:  4.95006; grad/diff1_train:  20312.86270; grad/cos1_train:  0.59689; grad/true_mag2_train:  8.69314; grad/pseudo_mag2_train:  40866.36875; grad/true_std2_train:  0.00212; grad/pseudo_std2_train:  9.47492; grad/diff2_train:  40863.64336; grad/cos2_train:  0.31190; grad/true_mag3_train:  5.40693; grad/pseudo_mag3_train:  18818.99365; grad/true_std3_train:  0.00132; grad/pseudo_std3_train:  4.59153; grad/diff3_train:  18815.87158; grad/cos3_train:  0.57707; grad/true_mag4_train:  9.47112; grad/pseudo_mag4_train:  17705.51914; grad/true_std4_train:  0.00231; grad/pseudo_std4_train:  4.31931; grad/diff4_train:  17699.61738; grad/cos4_train:  0.62214; grad/true_mag5_train:  10.18498; grad/pseudo_mag5_train:  30820.90820; grad/true_std5_train:  0.00249; grad/pseudo_std5_train:  7.24346; grad/diff5_train:  30817.26641; grad/cos5_train:  0.35333; grad/true_mag6_train:  5.75070; grad/pseudo_mag6_train:  17297.54629; grad/true_std6_train:  0.00140; grad/pseudo_std6_train:  4.22202; grad/diff6_train:  17293.81865; grad/cos6_train:  0.64738; grad/true_mag7_train:  10.28037; grad/pseudo_mag7_train:  16322.38047; grad/true_std7_train:  0.00251; grad/pseudo_std7_train:  3.98365; grad/diff7_train:  16315.23105; grad/cos7_train:  0.69303; grad/true_mag8_train:  13.00829; grad/pseudo_mag8_train:  21444.92852; grad/true_std8_train:  0.00318; grad/pseudo_std8_train:  5.15195; grad/diff8_train:  21438.23770; grad/cos8_train:  0.50290; grad/true_mag9_train:  7.22229; grad/pseudo_mag9_train:  16678.57539; grad/true_std9_train:  0.00176; grad/pseudo_std9_train:  4.07165; grad/diff9_train:  16672.86934; grad/cos9_train:  0.78550; grad/true_mag10_train:  10.35094; grad/pseudo_mag10_train:  16812.64355; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  4.10412; grad/diff10_train:  16804.35420; grad/cos10_train:  0.79596; grad/true_mag11_train:  13.12752; grad/pseudo_mag11_train:  18491.32588; grad/true_std11_train:  0.00320; grad/pseudo_std11_train:  4.49181; grad/diff11_train:  18481.94434; grad/cos11_train:  0.69829; grad/true_mag12_train:  8.01538; grad/pseudo_mag12_train:  17268.61523; grad/true_std12_train:  0.00196; grad/pseudo_std12_train:  4.21589; grad/diff12_train:  17261.73164; grad/cos12_train:  0.85295; grad/true_mag13_train:  10.22150; grad/pseudo_mag13_train:  17388.11113; grad/true_std13_train:  0.00250; grad/pseudo_std13_train:  4.24495; grad/diff13_train:  17379.34531; grad/cos13_train:  0.85244; grad/true_mag14_train:  12.51402; grad/pseudo_mag14_train:  18798.60303; grad/true_std14_train:  0.00306; grad/pseudo_std14_train:  4.57937; grad/diff14_train:  18788.76982; grad/cos14_train:  0.77246; grad/true_mag15_train:  8.20463; grad/pseudo_mag15_train:  18011.64492; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  4.39729; grad/diff15_train:  18004.30889; grad/cos15_train:  0.89039; grad/true_mag16_train:  9.64886; grad/pseudo_mag16_train:  18011.92607; grad/true_std16_train:  0.00236; grad/pseudo_std16_train:  4.39735; grad/diff16_train:  18003.45400; grad/cos16_train:  0.87212; grad/true_mag17_train:  11.15566; grad/pseudo_mag17_train:  18799.40674; grad/true_std17_train:  0.00272; grad/pseudo_std17_train:  4.58802; grad/diff17_train:  18790.05342; grad/cos17_train:  0.82925; grad_train:  864.98059; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00004; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00003
[2025-04-24 22:34:24,316][trainer][INFO] - Step 800:
[2025-04-24 22:34:24,316][trainer][INFO] - loss/edit_train:  5.30436; loss/loc_train:  0.02746; edit/acc_train:  0.04667; edit/log_prob_train: -5.30436; edit/prob_train:  0.22493; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.77422; perplexity/pre_train:  43.56359; nll/post_train:  3.79835; perplexity/post_train:  44.62755; n_tokens/pre_train:  5.60000; n_tokens/post_train:  5.60000; time/edit_train:  0.18220; loss/total_train:  0.55790; loss/total_edit_train:  0.55790; memory/alloc_max_train:  43100306432.00000; memory/res_max_train:  48173678592.00000; grad/true_mag0_train:  5.70990; grad/pseudo_mag0_train:  24110.68945; grad/true_std0_train:  0.00139; grad/pseudo_std0_train:  5.87720; grad/diff0_train:  24107.41514; grad/cos0_train:  0.57402; grad/true_mag1_train:  9.17173; grad/pseudo_mag1_train:  22594.93418; grad/true_std1_train:  0.00224; grad/pseudo_std1_train:  5.50534; grad/diff1_train:  22589.35918; grad/cos1_train:  0.60937; grad/true_mag2_train:  9.36169; grad/pseudo_mag2_train:  39650.63398; grad/true_std2_train:  0.00229; grad/pseudo_std2_train:  9.23989; grad/diff2_train:  39647.22383; grad/cos2_train:  0.36019; grad/true_mag3_train:  5.98497; grad/pseudo_mag3_train:  21720.21963; grad/true_std3_train:  0.00146; grad/pseudo_std3_train:  5.29912; grad/diff3_train:  21716.85332; grad/cos3_train:  0.56426; grad/true_mag4_train:  10.77633; grad/pseudo_mag4_train:  20986.08506; grad/true_std4_train:  0.00263; grad/pseudo_std4_train:  5.11764; grad/diff4_train:  20979.58623; grad/cos4_train:  0.61072; grad/true_mag5_train:  11.53840; grad/pseudo_mag5_train:  33076.43242; grad/true_std5_train:  0.00282; grad/pseudo_std5_train:  7.80547; grad/diff5_train:  33072.05742; grad/cos5_train:  0.37493; grad/true_mag6_train:  6.44479; grad/pseudo_mag6_train:  19442.18174; grad/true_std6_train:  0.00157; grad/pseudo_std6_train:  4.74534; grad/diff6_train:  19438.05244; grad/cos6_train:  0.64218; grad/true_mag7_train:  11.93731; grad/pseudo_mag7_train:  19127.89824; grad/true_std7_train:  0.00291; grad/pseudo_std7_train:  4.66841; grad/diff7_train:  19119.55781; grad/cos7_train:  0.69959; grad/true_mag8_train:  14.52705; grad/pseudo_mag8_train:  23299.52305; grad/true_std8_train:  0.00355; grad/pseudo_std8_train:  5.62385; grad/diff8_train:  23291.17305; grad/cos8_train:  0.56618; grad/true_mag9_train:  8.41839; grad/pseudo_mag9_train:  19651.95967; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.79754; grad/diff9_train:  19645.28682; grad/cos9_train:  0.79277; grad/true_mag10_train:  12.11411; grad/pseudo_mag10_train:  19957.26641; grad/true_std10_train:  0.00296; grad/pseudo_std10_train:  4.87175; grad/diff10_train:  19947.52871; grad/cos10_train:  0.80292; grad/true_mag11_train:  15.78320; grad/pseudo_mag11_train:  21222.69238; grad/true_std11_train:  0.00385; grad/pseudo_std11_train:  5.16613; grad/diff11_train:  21210.94033; grad/cos11_train:  0.73971; grad/true_mag12_train:  9.62800; grad/pseudo_mag12_train:  20794.22051; grad/true_std12_train:  0.00235; grad/pseudo_std12_train:  5.07660; grad/diff12_train:  20785.93496; grad/cos12_train:  0.85885; grad/true_mag13_train:  12.05122; grad/pseudo_mag13_train:  20780.63604; grad/true_std13_train:  0.00294; grad/pseudo_std13_train:  5.07315; grad/diff13_train:  20770.30830; grad/cos13_train:  0.85536; grad/true_mag14_train:  14.56202; grad/pseudo_mag14_train:  21933.45332; grad/true_std14_train:  0.00356; grad/pseudo_std14_train:  5.34839; grad/diff14_train:  21921.56982; grad/cos14_train:  0.80925; grad/true_mag15_train:  9.70781; grad/pseudo_mag15_train:  21482.69551; grad/true_std15_train:  0.00237; grad/pseudo_std15_train:  5.24469; grad/diff15_train:  21473.99658; grad/cos15_train:  0.89350; grad/true_mag16_train:  11.26906; grad/pseudo_mag16_train:  21438.38955; grad/true_std16_train:  0.00275; grad/pseudo_std16_train:  5.23385; grad/diff16_train:  21428.40234; grad/cos16_train:  0.88337; grad/true_mag17_train:  13.29584; grad/pseudo_mag17_train:  22750.07861; grad/true_std17_train:  0.00325; grad/pseudo_std17_train:  5.55306; grad/diff17_train:  22738.73066; grad/cos17_train:  0.85039; grad_train:  1113.20483; lr/lr0_train:  0.00004; lr/lr1_train:  0.00004; lr/lr2_train:  0.00009; lr/lr3_train:  0.00003; lr/lr4_train:  0.00003; lr/lr5_train:  0.00007; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00004; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00003
[2025-04-24 22:34:42,193][trainer][INFO] - Step 800:
[2025-04-24 22:34:42,194][trainer][INFO] - loss/edit_val:  4.74018; loss/loc_val:  0.03302; edit/acc_val:  0.08239; edit/log_prob_val: -4.74018; edit/prob_val:  0.30524; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.38929; perplexity/post_val:  80.58293; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10583; loss/total_val:  0.50703; loss/total_edit_val:  0.50703; memory/alloc_max_val:  43100306432.00000; memory/res_max_val:  48173678592.00000; eval_time/elapsed:  17.87281; eval_time/average:  0.17873
[2025-04-24 22:34:42,197][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358
[2025-04-24 22:34:42,197][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-20-17_4805768358/models/Llama-3.2-1B-eos-sft.2025-04-24_22-20-17_4805768358.bk
