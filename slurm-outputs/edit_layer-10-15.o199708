[2025-04-24 22:17:07,926][__main__][INFO] - 

alg: mend
lr: 1.0e-06
edit_lr: 0.0001
seed: 0
debug: false
model_save_pt: 5000
edit_bs: 1
silent: false
max_iters: 1000000
log_interval: 10
val_interval: 100
lr_lr: 0.0001
batch_size: 2
val_batch_size: 5
accumulate_bs: 10
cedit: 0.1
cloc: 1.0
cbase: 1.0
val_steps: 100
device: cuda:0
base_loss: distill
oracle: false
train: true
train_base: false
opt: Adam
single_batch: false
archive: null
grad_clip: 100.0
ref: null
early_stop_patience: 2000
early_stop_key: loss/total_edit_val
dropout: 0.0
tokenizer: null
results_dir: null
no_grad_layers: null
eval_only: false
half: false
save: false
l_e_data: rephrase
edit_loss: p(y|x)
edit_input: question
model:
  pt: null
  name: ${oc.env:PWD}/models/Llama-3.2-1B-eos-sft
  class_name: LlamaForCausalLM
  tokenizer_class: LlamaTokenizer
  tokenizer_name: ${oc.env:SHARE_RES_DIR}/models/llama3/hf/Llama-3.2-1B
  inner_params:
  - model.layers.10.mlp.gate_proj.weight
  - model.layers.10.mlp.up_proj.weight
  - model.layers.10.mlp.down_proj.weight
  - model.layers.11.mlp.gate_proj.weight
  - model.layers.11.mlp.up_proj.weight
  - model.layers.11.mlp.down_proj.weight
  - model.layers.12.mlp.gate_proj.weight
  - model.layers.12.mlp.up_proj.weight
  - model.layers.12.mlp.down_proj.weight
  - model.layers.13.mlp.gate_proj.weight
  - model.layers.13.mlp.up_proj.weight
  - model.layers.13.mlp.down_proj.weight
  - model.layers.14.mlp.gate_proj.weight
  - model.layers.14.mlp.up_proj.weight
  - model.layers.14.mlp.down_proj.weight
  - model.layers.15.mlp.gate_proj.weight
  - model.layers.15.mlp.up_proj.weight
  - model.layers.15.mlp.down_proj.weight
data:
  path: null
  rephrase: true
  musique_propagation_only: false
  zsre_nq: true
  nq_path: ${hydra:runtime.cwd}/data/nq
  wiki_webtext: true
  n_edits: 1
eval:
  verbose: true
  log_interval: 100
  final_eval: true
generation:
  max_new_tokens: 20
  prompt: urial
  save_dir: null
mend:
  one_sided: false
  n_hidden: 1
  hidden_dim: null
  init: id
  norm: true
  combine: true
  x_only: false
  delta_only: false
  act: relu
  rank: 1920
  mlp_class: IDMLP
  shared: false
task: ripple_edits_all
dataset: ripple_edits_all
heavy_outerloop: true
all_propagation_in_outerloop: true
train_set_size: 10000


[2025-04-24 22:17:07,927][__main__][INFO] - Project base directory: /work/09636/zyliu/vista/mend
[2025-04-24 22:17:15,944][models][INFO] - Loading model class <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> with name `/home1/09636/zyliu/work/mend/models/Llama-3.2-1B-eos-sft`
[2025-04-24 22:17:17,518][models][INFO] - Set 0 dropout modules to p=0.0
[2025-04-24 22:17:23,292][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:17:23,359][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:17:23,376][__main__][INFO] - train_set size: 3686
[2025-04-24 22:17:23,376][__main__][INFO] - val_set size: 500
[2025-04-24 22:17:23,736][__main__][INFO] - Loading class MEND from module <module 'algs.mend' from '/work/09636/zyliu/vista/mend/algs/mend.py'>
[2025-04-24 22:17:23,737][algs.mend][INFO] - Hooked 18 modules
[2025-04-24 22:17:23,797][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:23,797][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:24,075][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:24,075][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:24,350][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:24,350][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:24,625][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:24,625][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:24,900][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:24,900][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:25,175][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:25,175][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:25,450][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:25,450][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:25,724][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:25,725][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:25,999][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:26,000][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:26,274][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:26,274][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:26,549][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:26,549][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:26,824][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:26,824][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:27,099][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:27,099][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:27,373][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:27,374][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:27,648][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:27,649][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:27,923][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:27,923][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:28,198][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:28,198][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:28,473][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:17:28,473][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:17:37,744][trainer][INFO] - Building optimizer <class 'torch.optim.adam.Adam'> with lr 1e-06
[2025-04-24 22:17:37,749][trainer][INFO] - Writing wandb run "ripple_edits_all - mend - Llama-3.2-1B-eos-sft - 2025-04-24_22-17-07_8961755309" to /tmp/tmp_yfovuyl
[2025-04-24 22:17:38,706][data_classes.ripple_edits][INFO] - is_eval: False
[2025-04-24 22:17:38,706][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:17:38,719][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:17:38,720][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:17:38,720][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:17:38,720][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:17:38,721][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in Chelsea F.C. is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which CFC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea FC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Blues is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in the country Chelsea F.C. is associated with is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of Chelsea F.C. is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Iași<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea Football Club is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Pensioners is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which Chelsea F.C. is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which the country Chelsea F.C. is associated with is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the founder of Chelsea F.C. is Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the league which Chelsea F.C. plays in is Premier League<|end_of_text|>
[2025-04-24 22:17:38,721][data_classes.ripple_edits][INFO] - Label:  Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Iași<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Premier League<|end_of_text|>
[2025-04-24 22:17:38,722][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:17:38,722][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:17:38,722][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>nq question: what is the setting of things fall apart pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:17:38,722][data_classes.ripple_edits][INFO] - Label:  pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:17:40,769][trainer][INFO] - Step 0:
[2025-04-24 22:17:40,770][trainer][INFO] - loss/edit_train:  25.90942; loss/loc_train:  1.22965; edit/acc_train:  0.00000; edit/log_prob_train: -25.90942; edit/prob_train:  0.23507; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.10675; perplexity/pre_train:  22.34838; nll/post_train:  5.69388; perplexity/post_train:  297.04260; n_tokens/pre_train:  13.00000; n_tokens/post_train:  13.00000; time/edit_train:  0.90731; loss/total_train:  3.82060; loss/total_edit_train:  3.82060; memory/alloc_max_train:  24978241536.00000; memory/res_max_train:  26807894016.00000; grad/true_mag0_train:  6.29345; grad/pseudo_mag0_train:  19572.36328; grad/true_std0_train:  0.00154; grad/pseudo_std0_train:  4.77841; grad/diff0_train:  19568.73633; grad/cos0_train:  0.57634; grad/true_mag1_train:  9.62568; grad/pseudo_mag1_train:  19640.46680; grad/true_std1_train:  0.00235; grad/pseudo_std1_train:  4.79504; grad/diff1_train:  19634.13867; grad/cos1_train:  0.65749; grad/true_mag2_train:  11.14021; grad/pseudo_mag2_train:  19844.89844; grad/true_std2_train:  0.00272; grad/pseudo_std2_train:  4.84495; grad/diff2_train:  19837.25977; grad/cos2_train:  0.68564; grad/true_mag3_train:  6.86370; grad/pseudo_mag3_train:  20034.89062; grad/true_std3_train:  0.00168; grad/pseudo_std3_train:  4.89133; grad/diff3_train:  20030.63477; grad/cos3_train:  0.62024; grad/true_mag4_train:  9.10551; grad/pseudo_mag4_train:  19841.44336; grad/true_std4_train:  0.00222; grad/pseudo_std4_train:  4.84410; grad/diff4_train:  19835.23828; grad/cos4_train:  0.68162; grad/true_mag5_train:  10.85282; grad/pseudo_mag5_train:  20539.23242; grad/true_std5_train:  0.00265; grad/pseudo_std5_train:  5.01446; grad/diff5_train:  20531.73633; grad/cos5_train:  0.69066; grad/true_mag6_train:  6.86825; grad/pseudo_mag6_train:  20620.08203; grad/true_std6_train:  0.00168; grad/pseudo_std6_train:  5.03420; grad/diff6_train:  20615.41797; grad/cos6_train:  0.67929; grad/true_mag7_train:  8.53887; grad/pseudo_mag7_train:  20500.21289; grad/true_std7_train:  0.00208; grad/pseudo_std7_train:  5.00494; grad/diff7_train:  20494.56250; grad/cos7_train:  0.66206; grad/true_mag8_train:  9.81037; grad/pseudo_mag8_train:  21466.03516; grad/true_std8_train:  0.00240; grad/pseudo_std8_train:  5.24073; grad/diff8_train:  21459.15820; grad/cos8_train:  0.70114; grad/true_mag9_train:  6.98715; grad/pseudo_mag9_train:  20860.12500; grad/true_std9_train:  0.00171; grad/pseudo_std9_train:  5.09280; grad/diff9_train:  20855.45508; grad/cos9_train:  0.66829; grad/true_mag10_train:  7.72427; grad/pseudo_mag10_train:  20851.72461; grad/true_std10_train:  0.00189; grad/pseudo_std10_train:  5.09075; grad/diff10_train:  20846.57031; grad/cos10_train:  0.66765; grad/true_mag11_train:  9.25478; grad/pseudo_mag11_train:  20813.23828; grad/true_std11_train:  0.00226; grad/pseudo_std11_train:  5.08136; grad/diff11_train:  20807.03320; grad/cos11_train:  0.67055; grad/true_mag12_train:  6.22865; grad/pseudo_mag12_train:  20718.39453; grad/true_std12_train:  0.00152; grad/pseudo_std12_train:  5.05820; grad/diff12_train:  20714.41992; grad/cos12_train:  0.63837; grad/true_mag13_train:  6.88855; grad/pseudo_mag13_train:  20717.44727; grad/true_std13_train:  0.00168; grad/pseudo_std13_train:  5.05797; grad/diff13_train:  20713.01953; grad/cos13_train:  0.64267; grad/true_mag14_train:  9.94741; grad/pseudo_mag14_train:  20315.78516; grad/true_std14_train:  0.00243; grad/pseudo_std14_train:  4.95991; grad/diff14_train:  20309.72266; grad/cos14_train:  0.60950; grad/true_mag15_train:  6.14456; grad/pseudo_mag15_train:  20125.61719; grad/true_std15_train:  0.00150; grad/pseudo_std15_train:  4.91348; grad/diff15_train:  20121.71289; grad/cos15_train:  0.63558; grad/true_mag16_train:  15.75471; grad/pseudo_mag16_train:  20510.24023; grad/true_std16_train:  0.00385; grad/pseudo_std16_train:  5.00738; grad/diff16_train:  20505.92188; grad/cos16_train:  0.27445; grad/true_mag17_train:  18.95960; grad/pseudo_mag17_train:  18862.78320; grad/true_std17_train:  0.00463; grad/pseudo_std17_train:  4.60517; grad/diff17_train:  18854.45703; grad/cos17_train:  0.43950
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - is_eval: True
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:17:40,773][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>Is Daniel Lewis Lee still alive? no<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The gender of Daniel Lewis Lee is male<|end_of_text|>
@@
<|begin_of_text|>The name of the country of citizenship of Daniel Lewis Lee is United States of America<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The occupation of Daniel Lewis Lee is militant<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The place of birth of Daniel Lewis Lee is Yukon<|end_of_text|>
[2025-04-24 22:17:40,774][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] no<|end_of_text|>
@@
[PAD][PAD][PAD] male<|end_of_text|>
@@
 United States of America<|end_of_text|>
@@
[PAD][PAD][PAD] militant<|end_of_text|>
@@
[PAD][PAD] Yukon<|end_of_text|>
[2025-04-24 22:17:40,774][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:17:40,774][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:17:40,774][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: from which country do most visitors to canada originate United States
@@
[PAD][PAD][PAD]<|begin_of_text|>nq question: who did robin stalk in how i met your mother Paul Shaffer
@@
[PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: who writes the guinness book of world records Ripley Entertainment
@@
<|begin_of_text|>nq question: where was the hallmark movie mistletoe inn filmed Langley, British Columbia
[2025-04-24 22:17:40,774][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] United States
@@
[PAD][PAD] Paul Shaffer
@@
[PAD][PAD] Ripley Entertainment
@@
 Langley, British Columbia
[2025-04-24 22:17:58,678][trainer][INFO] - Step 0:
[2025-04-24 22:17:58,679][trainer][INFO] - loss/edit_val:  23.17619; loss/loc_val:  5.40661; edit/acc_val:  0.00059; edit/log_prob_val: -23.17619; edit/prob_val:  0.09121; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  13.16899; perplexity/post_val:  523867.21875; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10600; loss/total_val:  7.72423; loss/total_edit_val:  7.72423; memory/alloc_max_val:  25432726942.72000; memory/res_max_val:  27650110259.20000; eval_time/elapsed:  17.90406; eval_time/average:  0.17904
[2025-04-24 22:17:58,687][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:18:16,869][trainer][INFO] - Write complete.
[2025-04-24 22:18:20,565][trainer][INFO] - Step 10:
[2025-04-24 22:18:20,565][trainer][INFO] - loss/edit_train:  16.33104; loss/loc_train:  0.88748; edit/acc_train:  0.00000; edit/log_prob_train: -16.33104; edit/prob_train:  0.28266; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.78122; perplexity/pre_train:  119.24989; nll/post_train:  6.81405; perplexity/post_train:  910.54718; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.17706; loss/total_train:  2.52058; loss/total_edit_train:  2.52058; memory/alloc_max_train:  26086742528.00000; memory/res_max_train:  28321408614.40000; grad/true_mag0_train:  8.08191; grad/pseudo_mag0_train:  20749.25078; grad/true_std0_train:  0.00197; grad/pseudo_std0_train:  5.06573; grad/diff0_train:  20743.58203; grad/cos0_train:  0.68996; grad/true_mag1_train:  11.79705; grad/pseudo_mag1_train:  20449.36006; grad/true_std1_train:  0.00288; grad/pseudo_std1_train:  4.99252; grad/diff1_train:  20440.32471; grad/cos1_train:  0.75519; grad/true_mag2_train:  15.42762; grad/pseudo_mag2_train:  20597.86162; grad/true_std2_train:  0.00377; grad/pseudo_std2_train:  5.02877; grad/diff2_train:  20586.25918; grad/cos2_train:  0.74139; grad/true_mag3_train:  9.16598; grad/pseudo_mag3_train:  22231.12656; grad/true_std3_train:  0.00224; grad/pseudo_std3_train:  5.42752; grad/diff3_train:  22224.18857; grad/cos3_train:  0.73895; grad/true_mag4_train:  11.73675; grad/pseudo_mag4_train:  21728.70381; grad/true_std4_train:  0.00287; grad/pseudo_std4_train:  5.30486; grad/diff4_train:  21719.53828; grad/cos4_train:  0.76768; grad/true_mag5_train:  14.26498; grad/pseudo_mag5_train:  22399.01006; grad/true_std5_train:  0.00348; grad/pseudo_std5_train:  5.46851; grad/diff5_train:  22387.64141; grad/cos5_train:  0.78506; grad/true_mag6_train:  9.15294; grad/pseudo_mag6_train:  22609.41143; grad/true_std6_train:  0.00223; grad/pseudo_std6_train:  5.51988; grad/diff6_train:  22602.06729; grad/cos6_train:  0.78735; grad/true_mag7_train:  10.79051; grad/pseudo_mag7_train:  22248.51084; grad/true_std7_train:  0.00263; grad/pseudo_std7_train:  5.43177; grad/diff7_train:  22239.98418; grad/cos7_train:  0.77390; grad/true_mag8_train:  12.86661; grad/pseudo_mag8_train:  23489.75400; grad/true_std8_train:  0.00314; grad/pseudo_std8_train:  5.73480; grad/diff8_train:  23479.44062; grad/cos8_train:  0.78388; grad/true_mag9_train:  8.79771; grad/pseudo_mag9_train:  22448.42344; grad/true_std9_train:  0.00215; grad/pseudo_std9_train:  5.48057; grad/diff9_train:  22441.40693; grad/cos9_train:  0.78063; grad/true_mag10_train:  11.20986; grad/pseudo_mag10_train:  22489.36377; grad/true_std10_train:  0.00274; grad/pseudo_std10_train:  5.49057; grad/diff10_train:  22481.29893; grad/cos10_train:  0.72118; grad/true_mag11_train:  12.38833; grad/pseudo_mag11_train:  22882.99541; grad/true_std11_train:  0.00302; grad/pseudo_std11_train:  5.58667; grad/diff11_train:  22873.52539; grad/cos11_train:  0.74385; grad/true_mag12_train:  8.13058; grad/pseudo_mag12_train:  22615.56777; grad/true_std12_train:  0.00199; grad/pseudo_std12_train:  5.52138; grad/diff12_train:  22609.39687; grad/cos12_train:  0.73530; grad/true_mag13_train:  9.72214; grad/pseudo_mag13_train:  22644.01641; grad/true_std13_train:  0.00237; grad/pseudo_std13_train:  5.52832; grad/diff13_train:  22636.91143; grad/cos13_train:  0.70752; grad/true_mag14_train:  12.26076; grad/pseudo_mag14_train:  21954.79727; grad/true_std14_train:  0.00299; grad/pseudo_std14_train:  5.36006; grad/diff14_train:  21945.95059; grad/cos14_train:  0.70044; grad/true_mag15_train:  7.32831; grad/pseudo_mag15_train:  20950.49961; grad/true_std15_train:  0.00179; grad/pseudo_std15_train:  5.11487; grad/diff15_train:  20945.26738; grad/cos15_train:  0.69682; grad/true_mag16_train:  13.84764; grad/pseudo_mag16_train:  21833.50742; grad/true_std16_train:  0.00338; grad/pseudo_std16_train:  5.33045; grad/diff16_train:  21827.50771; grad/cos16_train:  0.42832; grad/true_mag17_train:  19.73392; grad/pseudo_mag17_train:  18670.45273; grad/true_std17_train:  0.00482; grad/pseudo_std17_train:  4.55822; grad/diff17_train:  18660.44521; grad/cos17_train:  0.50613; grad_train:  14730.30566; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:18:24,167][trainer][INFO] - Step 20:
[2025-04-24 22:18:24,167][trainer][INFO] - loss/edit_train:  16.49475; loss/loc_train:  0.69196; edit/acc_train:  0.00769; edit/log_prob_train: -16.49475; edit/prob_train:  0.28368; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  3.83132; perplexity/pre_train:  46.12337; nll/post_train:  5.39615; perplexity/post_train:  220.55499; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.22282; loss/total_train:  2.34143; loss/total_edit_train:  2.34143; memory/alloc_max_train:  37195661312.00000; memory/res_max_train:  42647683072.00000; grad/true_mag0_train:  7.60280; grad/pseudo_mag0_train:  18677.97607; grad/true_std0_train:  0.00186; grad/pseudo_std0_train:  4.56005; grad/diff0_train:  18672.09854; grad/cos0_train:  0.76873; grad/true_mag1_train:  11.18530; grad/pseudo_mag1_train:  18391.09346; grad/true_std1_train:  0.00273; grad/pseudo_std1_train:  4.49001; grad/diff1_train:  18382.10830; grad/cos1_train:  0.79852; grad/true_mag2_train:  14.07427; grad/pseudo_mag2_train:  18265.56670; grad/true_std2_train:  0.00344; grad/pseudo_std2_train:  4.45937; grad/diff2_train:  18254.28916; grad/cos2_train:  0.79653; grad/true_mag3_train:  8.57891; grad/pseudo_mag3_train:  19573.27285; grad/true_std3_train:  0.00209; grad/pseudo_std3_train:  4.77863; grad/diff3_train:  19566.22422; grad/cos3_train:  0.81549; grad/true_mag4_train:  10.72907; grad/pseudo_mag4_train:  19222.31914; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.69295; grad/diff4_train:  19213.26885; grad/cos4_train:  0.83983; grad/true_mag5_train:  13.46380; grad/pseudo_mag5_train:  19740.98154; grad/true_std5_train:  0.00329; grad/pseudo_std5_train:  4.81958; grad/diff5_train:  19729.82158; grad/cos5_train:  0.82398; grad/true_mag6_train:  8.74483; grad/pseudo_mag6_train:  20254.20830; grad/true_std6_train:  0.00213; grad/pseudo_std6_train:  4.94488; grad/diff6_train:  20246.65527; grad/cos6_train:  0.85930; grad/true_mag7_train:  10.18722; grad/pseudo_mag7_train:  20083.59023; grad/true_std7_train:  0.00249; grad/pseudo_std7_train:  4.90322; grad/diff7_train:  20074.89434; grad/cos7_train:  0.84967; grad/true_mag8_train:  12.49751; grad/pseudo_mag8_train:  21251.39160; grad/true_std8_train:  0.00305; grad/pseudo_std8_train:  5.18833; grad/diff8_train:  21240.98730; grad/cos8_train:  0.83931; grad/true_mag9_train:  8.44036; grad/pseudo_mag9_train:  20358.71260; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.97039; grad/diff9_train:  20351.39199; grad/cos9_train:  0.85941; grad/true_mag10_train:  11.34952; grad/pseudo_mag10_train:  20434.02402; grad/true_std10_train:  0.00277; grad/pseudo_std10_train:  4.98878; grad/diff10_train:  20425.44629; grad/cos10_train:  0.80801; grad/true_mag11_train:  11.71225; grad/pseudo_mag11_train:  20531.85645; grad/true_std11_train:  0.00286; grad/pseudo_std11_train:  5.01266; grad/diff11_train:  20522.34580; grad/cos11_train:  0.80793; grad/true_mag12_train:  8.07712; grad/pseudo_mag12_train:  20587.23032; grad/true_std12_train:  0.00197; grad/pseudo_std12_train:  5.02618; grad/diff12_train:  20580.56973; grad/cos12_train:  0.81379; grad/true_mag13_train:  9.50381; grad/pseudo_mag13_train:  20725.02480; grad/true_std13_train:  0.00232; grad/pseudo_std13_train:  5.05982; grad/diff13_train:  20717.32368; grad/cos13_train:  0.80442; grad/true_mag14_train:  11.94697; grad/pseudo_mag14_train:  20140.36240; grad/true_std14_train:  0.00292; grad/pseudo_std14_train:  4.91708; grad/diff14_train:  20131.31064; grad/cos14_train:  0.75192; grad/true_mag15_train:  7.54134; grad/pseudo_mag15_train:  20083.49858; grad/true_std15_train:  0.00184; grad/pseudo_std15_train:  4.90320; grad/diff15_train:  20077.59072; grad/cos15_train:  0.77382; grad/true_mag16_train:  15.02032; grad/pseudo_mag16_train:  20650.35620; grad/true_std16_train:  0.00367; grad/pseudo_std16_train:  5.04159; grad/diff16_train:  20643.54238; grad/cos16_train:  0.44918; grad/true_mag17_train:  20.80985; grad/pseudo_mag17_train:  18026.41006; grad/true_std17_train:  0.00508; grad/pseudo_std17_train:  4.40098; grad/diff17_train:  18015.41455; grad/cos17_train:  0.52725; grad_train:  10183.84473; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:18:27,387][trainer][INFO] - Step 30:
[2025-04-24 22:18:27,387][trainer][INFO] - loss/edit_train:  25.64450; loss/loc_train:  0.76186; edit/acc_train:  0.01111; edit/log_prob_train: -25.64450; edit/prob_train:  0.18827; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.00649; perplexity/pre_train:  54.95350; nll/post_train:  6.08218; perplexity/post_train:  437.98331; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.18643; loss/total_train:  3.32631; loss/total_edit_train:  3.32631; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42647683072.00000; grad/true_mag0_train:  8.08424; grad/pseudo_mag0_train:  18890.82168; grad/true_std0_train:  0.00197; grad/pseudo_std0_train:  4.61202; grad/diff0_train:  18884.53789; grad/cos0_train:  0.77533; grad/true_mag1_train:  11.61650; grad/pseudo_mag1_train:  18714.63945; grad/true_std1_train:  0.00284; grad/pseudo_std1_train:  4.56900; grad/diff1_train:  18705.25000; grad/cos1_train:  0.80506; grad/true_mag2_train:  14.99068; grad/pseudo_mag2_train:  18666.35645; grad/true_std2_train:  0.00366; grad/pseudo_std2_train:  4.55721; grad/diff2_train:  18654.31016; grad/cos2_train:  0.79917; grad/true_mag3_train:  9.22514; grad/pseudo_mag3_train:  20347.61348; grad/true_std3_train:  0.00225; grad/pseudo_std3_train:  4.96768; grad/diff3_train:  20339.86348; grad/cos3_train:  0.83659; grad/true_mag4_train:  11.57493; grad/pseudo_mag4_train:  19994.06309; grad/true_std4_train:  0.00283; grad/pseudo_std4_train:  4.88136; grad/diff4_train:  19984.28164; grad/cos4_train:  0.84369; grad/true_mag5_train:  13.98953; grad/pseudo_mag5_train:  20368.69033; grad/true_std5_train:  0.00342; grad/pseudo_std5_train:  4.97282; grad/diff5_train:  20356.86807; grad/cos5_train:  0.84077; grad/true_mag6_train:  9.46456; grad/pseudo_mag6_train:  21270.75283; grad/true_std6_train:  0.00231; grad/pseudo_std6_train:  5.19305; grad/diff6_train:  21262.41074; grad/cos6_train:  0.88017; grad/true_mag7_train:  10.92117; grad/pseudo_mag7_train:  21178.95400; grad/true_std7_train:  0.00267; grad/pseudo_std7_train:  5.17064; grad/diff7_train:  21169.44619; grad/cos7_train:  0.86727; grad/true_mag8_train:  12.38729; grad/pseudo_mag8_train:  21948.82471; grad/true_std8_train:  0.00302; grad/pseudo_std8_train:  5.35860; grad/diff8_train:  21937.89980; grad/cos8_train:  0.87654; grad/true_mag9_train:  9.24106; grad/pseudo_mag9_train:  21592.01816; grad/true_std9_train:  0.00226; grad/pseudo_std9_train:  5.27149; grad/diff9_train:  21583.86074; grad/cos9_train:  0.88012; grad/true_mag10_train:  10.60097; grad/pseudo_mag10_train:  21516.48818; grad/true_std10_train:  0.00259; grad/pseudo_std10_train:  5.25305; grad/diff10_train:  21507.33535; grad/cos10_train:  0.86420; grad/true_mag11_train:  12.20226; grad/pseudo_mag11_train:  21646.38701; grad/true_std11_train:  0.00298; grad/pseudo_std11_train:  5.28476; grad/diff11_train:  21636.28740; grad/cos11_train:  0.82406; grad/true_mag12_train:  8.46414; grad/pseudo_mag12_train:  21453.36650; grad/true_std12_train:  0.00207; grad/pseudo_std12_train:  5.23764; grad/diff12_train:  21446.24346; grad/cos12_train:  0.83720; grad/true_mag13_train:  9.54964; grad/pseudo_mag13_train:  21479.06357; grad/true_std13_train:  0.00233; grad/pseudo_std13_train:  5.24391; grad/diff13_train:  21470.98350; grad/cos13_train:  0.84129; grad/true_mag14_train:  12.04093; grad/pseudo_mag14_train:  20825.81523; grad/true_std14_train:  0.00294; grad/pseudo_std14_train:  5.08442; grad/diff14_train:  20816.48730; grad/cos14_train:  0.77023; grad/true_mag15_train:  7.47962; grad/pseudo_mag15_train:  20652.31680; grad/true_std15_train:  0.00183; grad/pseudo_std15_train:  5.04207; grad/diff15_train:  20646.28896; grad/cos15_train:  0.80333; grad/true_mag16_train:  14.53331; grad/pseudo_mag16_train:  21242.99658; grad/true_std16_train:  0.00355; grad/pseudo_std16_train:  5.18628; grad/diff16_train:  21235.94658; grad/cos16_train:  0.48933; grad/true_mag17_train:  20.11132; grad/pseudo_mag17_train:  18150.70537; grad/true_std17_train:  0.00491; grad/pseudo_std17_train:  4.43130; grad/diff17_train:  18140.18066; grad/cos17_train:  0.52126; grad_train:  7825.12646; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:18:30,590][trainer][INFO] - Step 40:
[2025-04-24 22:18:30,590][trainer][INFO] - loss/edit_train:  21.02429; loss/loc_train:  0.63009; edit/acc_train:  0.00000; edit/log_prob_train: -21.02429; edit/prob_train:  0.22707; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.42987; perplexity/pre_train:  30.87273; nll/post_train:  4.04723; perplexity/post_train:  57.23891; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.17767; loss/total_train:  2.73252; loss/total_edit_train:  2.73252; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42647683072.00000; grad/true_mag0_train:  7.12843; grad/pseudo_mag0_train:  17498.18018; grad/true_std0_train:  0.00174; grad/pseudo_std0_train:  4.27202; grad/diff0_train:  17492.56055; grad/cos0_train:  0.78573; grad/true_mag1_train:  10.52046; grad/pseudo_mag1_train:  17447.49893; grad/true_std1_train:  0.00257; grad/pseudo_std1_train:  4.25964; grad/diff1_train:  17438.96016; grad/cos1_train:  0.80919; grad/true_mag2_train:  13.30202; grad/pseudo_mag2_train:  17450.24385; grad/true_std2_train:  0.00325; grad/pseudo_std2_train:  4.26031; grad/diff2_train:  17439.46563; grad/cos2_train:  0.80808; grad/true_mag3_train:  8.20670; grad/pseudo_mag3_train:  18701.48047; grad/true_std3_train:  0.00200; grad/pseudo_std3_train:  4.56579; grad/diff3_train:  18694.53008; grad/cos3_train:  0.84171; grad/true_mag4_train:  10.33887; grad/pseudo_mag4_train:  18645.17344; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.55204; grad/diff4_train:  18636.32998; grad/cos4_train:  0.85057; grad/true_mag5_train:  12.60257; grad/pseudo_mag5_train:  18984.35322; grad/true_std5_train:  0.00308; grad/pseudo_std5_train:  4.63485; grad/diff5_train:  18973.70508; grad/cos5_train:  0.83718; grad/true_mag6_train:  8.40584; grad/pseudo_mag6_train:  19640.92344; grad/true_std6_train:  0.00205; grad/pseudo_std6_train:  4.79515; grad/diff6_train:  19633.47695; grad/cos6_train:  0.88231; grad/true_mag7_train:  9.80506; grad/pseudo_mag7_train:  19610.94258; grad/true_std7_train:  0.00239; grad/pseudo_std7_train:  4.78783; grad/diff7_train:  19602.35830; grad/cos7_train:  0.86937; grad/true_mag8_train:  11.36310; grad/pseudo_mag8_train:  20804.57734; grad/true_std8_train:  0.00277; grad/pseudo_std8_train:  5.07924; grad/diff8_train:  20794.51523; grad/cos8_train:  0.87822; grad/true_mag9_train:  8.40970; grad/pseudo_mag9_train:  20267.37832; grad/true_std9_train:  0.00205; grad/pseudo_std9_train:  4.94809; grad/diff9_train:  20259.90420; grad/cos9_train:  0.88501; grad/true_mag10_train:  9.83432; grad/pseudo_mag10_train:  20298.56885; grad/true_std10_train:  0.00240; grad/pseudo_std10_train:  4.95570; grad/diff10_train:  20290.08926; grad/cos10_train:  0.85718; grad/true_mag11_train:  11.43942; grad/pseudo_mag11_train:  21114.73398; grad/true_std11_train:  0.00279; grad/pseudo_std11_train:  5.15496; grad/diff11_train:  21105.14209; grad/cos11_train:  0.82932; grad/true_mag12_train:  7.85004; grad/pseudo_mag12_train:  20801.02432; grad/true_std12_train:  0.00192; grad/pseudo_std12_train:  5.07837; grad/diff12_train:  20794.32422; grad/cos12_train:  0.84651; grad/true_mag13_train:  9.05549; grad/pseudo_mag13_train:  20957.39756; grad/true_std13_train:  0.00221; grad/pseudo_std13_train:  5.11655; grad/diff13_train:  20949.71006; grad/cos13_train:  0.84195; grad/true_mag14_train:  11.65484; grad/pseudo_mag14_train:  21067.56484; grad/true_std14_train:  0.00285; grad/pseudo_std14_train:  5.14344; grad/diff14_train:  21058.44902; grad/cos14_train:  0.77385; grad/true_mag15_train:  7.53402; grad/pseudo_mag15_train:  21247.13555; grad/true_std15_train:  0.00184; grad/pseudo_std15_train:  5.18729; grad/diff15_train:  21241.02910; grad/cos15_train:  0.80323; grad/true_mag16_train:  14.03705; grad/pseudo_mag16_train:  21798.83594; grad/true_std16_train:  0.00343; grad/pseudo_std16_train:  5.32198; grad/diff16_train:  21791.74521; grad/cos16_train:  0.51143; grad/true_mag17_train:  19.65917; grad/pseudo_mag17_train:  19366.86758; grad/true_std17_train:  0.00480; grad/pseudo_std17_train:  4.72814; grad/diff17_train:  19356.18271; grad/cos17_train:  0.54060; grad_train:  8230.51758; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:18:34,176][trainer][INFO] - Step 50:
[2025-04-24 22:18:34,177][trainer][INFO] - loss/edit_train:  21.08091; loss/loc_train:  0.44510; edit/acc_train:  0.00000; edit/log_prob_train: -21.08091; edit/prob_train:  0.20287; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.52281; perplexity/pre_train:  33.87955; nll/post_train:  4.22555; perplexity/post_train:  68.41238; n_tokens/pre_train:  8.60000; n_tokens/post_train:  8.60000; time/edit_train:  0.17414; loss/total_train:  2.55319; loss/total_edit_train:  2.55319; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42664670003.20000; grad/true_mag0_train:  8.41930; grad/pseudo_mag0_train:  20345.58730; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.96718; grad/diff0_train:  20338.98457; grad/cos0_train:  0.77904; grad/true_mag1_train:  12.04394; grad/pseudo_mag1_train:  20234.52139; grad/true_std1_train:  0.00294; grad/pseudo_std1_train:  4.94006; grad/diff1_train:  20224.68350; grad/cos1_train:  0.80991; grad/true_mag2_train:  15.64169; grad/pseudo_mag2_train:  20276.85576; grad/true_std2_train:  0.00382; grad/pseudo_std2_train:  4.95039; grad/diff2_train:  20264.23760; grad/cos2_train:  0.79349; grad/true_mag3_train:  9.29293; grad/pseudo_mag3_train:  21129.75928; grad/true_std3_train:  0.00227; grad/pseudo_std3_train:  5.15863; grad/diff3_train:  21121.89814; grad/cos3_train:  0.84016; grad/true_mag4_train:  11.97698; grad/pseudo_mag4_train:  21277.66309; grad/true_std4_train:  0.00292; grad/pseudo_std4_train:  5.19474; grad/diff4_train:  21267.52480; grad/cos4_train:  0.84087; grad/true_mag5_train:  14.52284; grad/pseudo_mag5_train:  21534.48594; grad/true_std5_train:  0.00355; grad/pseudo_std5_train:  5.25743; grad/diff5_train:  21522.28320; grad/cos5_train:  0.82855; grad/true_mag6_train:  9.31921; grad/pseudo_mag6_train:  21714.02832; grad/true_std6_train:  0.00228; grad/pseudo_std6_train:  5.30128; grad/diff6_train:  21705.74141; grad/cos6_train:  0.88395; grad/true_mag7_train:  11.07040; grad/pseudo_mag7_train:  21811.61182; grad/true_std7_train:  0.00270; grad/pseudo_std7_train:  5.32510; grad/diff7_train:  21801.95684; grad/cos7_train:  0.86324; grad/true_mag8_train:  12.88594; grad/pseudo_mag8_train:  22831.95449; grad/true_std8_train:  0.00315; grad/pseudo_std8_train:  5.57421; grad/diff8_train:  22820.73623; grad/cos8_train:  0.85897; grad/true_mag9_train:  9.42121; grad/pseudo_mag9_train:  22349.33486; grad/true_std9_train:  0.00230; grad/pseudo_std9_train:  5.45638; grad/diff9_train:  22340.97061; grad/cos9_train:  0.88177; grad/true_mag10_train:  10.82627; grad/pseudo_mag10_train:  22313.27080; grad/true_std10_train:  0.00264; grad/pseudo_std10_train:  5.44757; grad/diff10_train:  22303.81631; grad/cos10_train:  0.86637; grad/true_mag11_train:  12.66861; grad/pseudo_mag11_train:  22847.09678; grad/true_std11_train:  0.00309; grad/pseudo_std11_train:  5.57790; grad/diff11_train:  22836.57334; grad/cos11_train:  0.81993; grad/true_mag12_train:  8.68732; grad/pseudo_mag12_train:  22409.93037; grad/true_std12_train:  0.00212; grad/pseudo_std12_train:  5.47117; grad/diff12_train:  22402.55938; grad/cos12_train:  0.83862; grad/true_mag13_train:  10.30057; grad/pseudo_mag13_train:  22689.01045; grad/true_std13_train:  0.00251; grad/pseudo_std13_train:  5.53931; grad/diff13_train:  22680.37646; grad/cos13_train:  0.82984; grad/true_mag14_train:  12.90394; grad/pseudo_mag14_train:  22647.93887; grad/true_std14_train:  0.00315; grad/pseudo_std14_train:  5.52927; grad/diff14_train:  22637.93066; grad/cos14_train:  0.76566; grad/true_mag15_train:  8.00468; grad/pseudo_mag15_train:  21903.68223; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  5.34758; grad/diff15_train:  21897.24922; grad/cos15_train:  0.79545; grad/true_mag16_train:  15.11227; grad/pseudo_mag16_train:  22477.11230; grad/true_std16_train:  0.00369; grad/pseudo_std16_train:  5.48757; grad/diff16_train:  22469.54102; grad/cos16_train:  0.50197; grad/true_mag17_train:  21.32825; grad/pseudo_mag17_train:  20401.03955; grad/true_std17_train:  0.00521; grad/pseudo_std17_train:  4.98053; grad/diff17_train:  20389.64395; grad/cos17_train:  0.52955; grad_train:  7977.87256; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00009; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:18:37,545][trainer][INFO] - Step 60:
[2025-04-24 22:18:37,545][trainer][INFO] - loss/edit_train:  17.11533; loss/loc_train:  0.45235; edit/acc_train:  0.00000; edit/log_prob_train: -17.11533; edit/prob_train:  0.22636; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.67617; perplexity/pre_train:  107.35838; nll/post_train:  5.40355; perplexity/post_train:  222.19485; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18199; loss/total_train:  2.16388; loss/total_edit_train:  2.16388; memory/alloc_max_train:  38905580236.80000; memory/res_max_train:  43614050713.60000; grad/true_mag0_train:  8.30513; grad/pseudo_mag0_train:  20129.74824; grad/true_std0_train:  0.00203; grad/pseudo_std0_train:  4.91449; grad/diff0_train:  20123.17656; grad/cos0_train:  0.79126; grad/true_mag1_train:  11.93655; grad/pseudo_mag1_train:  20131.79580; grad/true_std1_train:  0.00291; grad/pseudo_std1_train:  4.91498; grad/diff1_train:  20121.97197; grad/cos1_train:  0.82251; grad/true_mag2_train:  15.44799; grad/pseudo_mag2_train:  19928.79990; grad/true_std2_train:  0.00377; grad/pseudo_std2_train:  4.86539; grad/diff2_train:  19916.24902; grad/cos2_train:  0.81173; grad/true_mag3_train:  9.49216; grad/pseudo_mag3_train:  21631.94375; grad/true_std3_train:  0.00232; grad/pseudo_std3_train:  5.28123; grad/diff3_train:  21623.73008; grad/cos3_train:  0.86424; grad/true_mag4_train:  11.99612; grad/pseudo_mag4_train:  21647.77266; grad/true_std4_train:  0.00293; grad/pseudo_std4_train:  5.28510; grad/diff4_train:  21637.35508; grad/cos4_train:  0.86769; grad/true_mag5_train:  14.75960; grad/pseudo_mag5_train:  21930.48633; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  5.35410; grad/diff5_train:  21917.82754; grad/cos5_train:  0.85666; grad/true_mag6_train:  9.93243; grad/pseudo_mag6_train:  22844.92891; grad/true_std6_train:  0.00242; grad/pseudo_std6_train:  5.57737; grad/diff6_train:  22835.99648; grad/cos6_train:  0.89896; grad/true_mag7_train:  11.46877; grad/pseudo_mag7_train:  22816.37832; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  5.57040; grad/diff7_train:  22806.18496; grad/cos7_train:  0.88837; grad/true_mag8_train:  13.13639; grad/pseudo_mag8_train:  23496.09473; grad/true_std8_train:  0.00321; grad/pseudo_std8_train:  5.73635; grad/diff8_train:  23484.44121; grad/cos8_train:  0.88649; grad/true_mag9_train:  9.94046; grad/pseudo_mag9_train:  23146.58145; grad/true_std9_train:  0.00243; grad/pseudo_std9_train:  5.65102; grad/diff9_train:  23137.68926; grad/cos9_train:  0.89428; grad/true_mag10_train:  11.10375; grad/pseudo_mag10_train:  23005.30586; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  5.61653; grad/diff10_train:  22995.44180; grad/cos10_train:  0.88757; grad/true_mag11_train:  12.98357; grad/pseudo_mag11_train:  23296.61133; grad/true_std11_train:  0.00317; grad/pseudo_std11_train:  5.68764; grad/diff11_train:  23285.76172; grad/cos11_train:  0.83461; grad/true_mag12_train:  8.93885; grad/pseudo_mag12_train:  23116.32734; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.64363; grad/diff12_train:  23108.58574; grad/cos12_train:  0.86531; grad/true_mag13_train:  10.07053; grad/pseudo_mag13_train:  22745.50723; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  5.55310; grad/diff13_train:  22736.82949; grad/cos13_train:  0.86091; grad/true_mag14_train:  12.96253; grad/pseudo_mag14_train:  22754.02988; grad/true_std14_train:  0.00316; grad/pseudo_std14_train:  5.55516; grad/diff14_train:  22743.90273; grad/cos14_train:  0.78045; grad/true_mag15_train:  7.94068; grad/pseudo_mag15_train:  22042.81914; grad/true_std15_train:  0.00194; grad/pseudo_std15_train:  5.38154; grad/diff15_train:  22036.26660; grad/cos15_train:  0.82485; grad/true_mag16_train:  14.46742; grad/pseudo_mag16_train:  22315.55986; grad/true_std16_train:  0.00353; grad/pseudo_std16_train:  5.44813; grad/diff16_train:  22308.03340; grad/cos16_train:  0.52430; grad/true_mag17_train:  20.58304; grad/pseudo_mag17_train:  20191.14902; grad/true_std17_train:  0.00503; grad/pseudo_std17_train:  4.92901; grad/diff17_train:  20179.89795; grad/cos17_train:  0.54754; grad_train:  6765.08643; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00010; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:18:40,817][trainer][INFO] - Step 70:
[2025-04-24 22:18:40,817][trainer][INFO] - loss/edit_train:  16.22166; loss/loc_train:  0.60123; edit/acc_train:  0.00000; edit/log_prob_train: -16.22166; edit/prob_train:  0.15601; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.53009; perplexity/pre_train:  252.16556; nll/post_train:  6.78908; perplexity/post_train:  888.09186; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18149; loss/total_train:  2.22340; loss/total_edit_train:  2.22340; memory/alloc_max_train:  39099321856.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  8.41299; grad/pseudo_mag0_train:  20457.52793; grad/true_std0_train:  0.00205; grad/pseudo_std0_train:  4.99451; grad/diff0_train:  20450.78584; grad/cos0_train:  0.79949; grad/true_mag1_train:  11.99439; grad/pseudo_mag1_train:  20192.49062; grad/true_std1_train:  0.00293; grad/pseudo_std1_train:  4.92980; grad/diff1_train:  20182.55557; grad/cos1_train:  0.82555; grad/true_mag2_train:  15.00739; grad/pseudo_mag2_train:  19917.38359; grad/true_std2_train:  0.00366; grad/pseudo_std2_train:  4.86261; grad/diff2_train:  19904.93252; grad/cos2_train:  0.82625; grad/true_mag3_train:  9.49451; grad/pseudo_mag3_train:  21507.07178; grad/true_std3_train:  0.00232; grad/pseudo_std3_train:  5.25075; grad/diff3_train:  21498.86797; grad/cos3_train:  0.86194; grad/true_mag4_train:  11.98322; grad/pseudo_mag4_train:  21327.14609; grad/true_std4_train:  0.00293; grad/pseudo_std4_train:  5.20682; grad/diff4_train:  21316.74453; grad/cos4_train:  0.86569; grad/true_mag5_train:  14.49770; grad/pseudo_mag5_train:  21787.22959; grad/true_std5_train:  0.00354; grad/pseudo_std5_train:  5.31913; grad/diff5_train:  21774.66279; grad/cos5_train:  0.86103; grad/true_mag6_train:  9.82780; grad/pseudo_mag6_train:  22424.78828; grad/true_std6_train:  0.00240; grad/pseudo_std6_train:  5.47480; grad/diff6_train:  22415.94199; grad/cos6_train:  0.89766; grad/true_mag7_train:  11.48742; grad/pseudo_mag7_train:  22222.32988; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  5.42537; grad/diff7_train:  22212.15391; grad/cos7_train:  0.88426; grad/true_mag8_train:  12.98943; grad/pseudo_mag8_train:  23127.44551; grad/true_std8_train:  0.00317; grad/pseudo_std8_train:  5.64634; grad/diff8_train:  23115.77051; grad/cos8_train:  0.89482; grad/true_mag9_train:  9.67661; grad/pseudo_mag9_train:  22500.40869; grad/true_std9_train:  0.00236; grad/pseudo_std9_train:  5.49326; grad/diff9_train:  22491.71172; grad/cos9_train:  0.89566; grad/true_mag10_train:  11.23703; grad/pseudo_mag10_train:  22546.27539; grad/true_std10_train:  0.00274; grad/pseudo_std10_train:  5.50446; grad/diff10_train:  22536.43281; grad/cos10_train:  0.87545; grad/true_mag11_train:  12.64882; grad/pseudo_mag11_train:  22717.35410; grad/true_std11_train:  0.00309; grad/pseudo_std11_train:  5.54622; grad/diff11_train:  22706.55371; grad/cos11_train:  0.84870; grad/true_mag12_train:  8.72269; grad/pseudo_mag12_train:  22356.81133; grad/true_std12_train:  0.00213; grad/pseudo_std12_train:  5.45820; grad/diff12_train:  22349.26143; grad/cos12_train:  0.86124; grad/true_mag13_train:  9.88570; grad/pseudo_mag13_train:  22118.82695; grad/true_std13_train:  0.00241; grad/pseudo_std13_train:  5.40010; grad/diff13_train:  22110.32832; grad/cos13_train:  0.85584; grad/true_mag14_train:  12.35220; grad/pseudo_mag14_train:  21546.38076; grad/true_std14_train:  0.00302; grad/pseudo_std14_train:  5.26032; grad/diff14_train:  21536.66631; grad/cos14_train:  0.78089; grad/true_mag15_train:  7.80121; grad/pseudo_mag15_train:  21346.37725; grad/true_std15_train:  0.00190; grad/pseudo_std15_train:  5.21151; grad/diff15_train:  21339.98096; grad/cos15_train:  0.81691; grad/true_mag16_train:  13.93743; grad/pseudo_mag16_train:  21471.95928; grad/true_std16_train:  0.00340; grad/pseudo_std16_train:  5.24217; grad/diff16_train:  21464.63496; grad/cos16_train:  0.54131; grad/true_mag17_train:  19.14893; grad/pseudo_mag17_train:  18978.03662; grad/true_std17_train:  0.00468; grad/pseudo_std17_train:  4.63262; grad/diff17_train:  18967.57627; grad/cos17_train:  0.54724; grad_train:  6047.60400; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00010; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:18:44,517][trainer][INFO] - Step 80:
[2025-04-24 22:18:44,517][trainer][INFO] - loss/edit_train:  16.21589; loss/loc_train:  0.40824; edit/acc_train:  0.02019; edit/log_prob_train: -16.21589; edit/prob_train:  0.24991; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.14435; perplexity/pre_train:  63.07663; nll/post_train:  5.31940; perplexity/post_train:  204.26093; n_tokens/pre_train:  6.10000; n_tokens/post_train:  6.10000; time/edit_train:  0.22674; loss/total_train:  2.02983; loss/total_edit_train:  2.02983; memory/alloc_max_train:  39099321856.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  8.44662; grad/pseudo_mag0_train:  19901.77539; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.85882; grad/diff0_train:  19894.98115; grad/cos0_train:  0.79969; grad/true_mag1_train:  12.08277; grad/pseudo_mag1_train:  19748.66543; grad/true_std1_train:  0.00295; grad/pseudo_std1_train:  4.82144; grad/diff1_train:  19738.71445; grad/cos1_train:  0.81932; grad/true_mag2_train:  15.50622; grad/pseudo_mag2_train:  19957.65039; grad/true_std2_train:  0.00379; grad/pseudo_std2_train:  4.87237; grad/diff2_train:  19944.84102; grad/cos2_train:  0.81844; grad/true_mag3_train:  9.54824; grad/pseudo_mag3_train:  20899.85947; grad/true_std3_train:  0.00233; grad/pseudo_std3_train:  5.10250; grad/diff3_train:  20891.63472; grad/cos3_train:  0.85494; grad/true_mag4_train:  11.82554; grad/pseudo_mag4_train:  20614.75078; grad/true_std4_train:  0.00289; grad/pseudo_std4_train:  5.03289; grad/diff4_train:  20604.44990; grad/cos4_train:  0.86477; grad/true_mag5_train:  14.37261; grad/pseudo_mag5_train:  21080.55342; grad/true_std5_train:  0.00351; grad/pseudo_std5_train:  5.14657; grad/diff5_train:  21068.24326; grad/cos5_train:  0.84597; grad/true_mag6_train:  9.59760; grad/pseudo_mag6_train:  21371.52080; grad/true_std6_train:  0.00234; grad/pseudo_std6_train:  5.21765; grad/diff6_train:  21362.87993; grad/cos6_train:  0.89389; grad/true_mag7_train:  11.19550; grad/pseudo_mag7_train:  21356.82329; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  5.21407; grad/diff7_train:  21346.88174; grad/cos7_train:  0.88033; grad/true_mag8_train:  12.83019; grad/pseudo_mag8_train:  22501.37891; grad/true_std8_train:  0.00313; grad/pseudo_std8_train:  5.49349; grad/diff8_train:  22489.93086; grad/cos8_train:  0.87950; grad/true_mag9_train:  9.55544; grad/pseudo_mag9_train:  21683.82114; grad/true_std9_train:  0.00233; grad/pseudo_std9_train:  5.29390; grad/diff9_train:  21675.24272; grad/cos9_train:  0.88968; grad/true_mag10_train:  10.99986; grad/pseudo_mag10_train:  21790.94819; grad/true_std10_train:  0.00269; grad/pseudo_std10_train:  5.32005; grad/diff10_train:  21781.20889; grad/cos10_train:  0.87844; grad/true_mag11_train:  12.75795; grad/pseudo_mag11_train:  22194.52207; grad/true_std11_train:  0.00311; grad/pseudo_std11_train:  5.41857; grad/diff11_train:  22183.79971; grad/cos11_train:  0.82991; grad/true_mag12_train:  8.63944; grad/pseudo_mag12_train:  21590.91802; grad/true_std12_train:  0.00211; grad/pseudo_std12_train:  5.27122; grad/diff12_train:  21583.46548; grad/cos12_train:  0.85234; grad/true_mag13_train:  10.06252; grad/pseudo_mag13_train:  21786.66895; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  5.31901; grad/diff13_train:  21778.04468; grad/cos13_train:  0.84818; grad/true_mag14_train:  12.61364; grad/pseudo_mag14_train:  21461.61279; grad/true_std14_train:  0.00308; grad/pseudo_std14_train:  5.23961; grad/diff14_train:  21451.81035; grad/cos14_train:  0.76681; grad/true_mag15_train:  7.78613; grad/pseudo_mag15_train:  20693.08877; grad/true_std15_train:  0.00190; grad/pseudo_std15_train:  5.05201; grad/diff15_train:  20686.77451; grad/cos15_train:  0.80371; grad/true_mag16_train:  15.60554; grad/pseudo_mag16_train:  20920.84912; grad/true_std16_train:  0.00381; grad/pseudo_std16_train:  5.10762; grad/diff16_train:  20913.52578; grad/cos16_train:  0.47407; grad/true_mag17_train:  20.33899; grad/pseudo_mag17_train:  18660.55059; grad/true_std17_train:  0.00497; grad/pseudo_std17_train:  4.55484; grad/diff17_train:  18649.78701; grad/cos17_train:  0.52781; grad_train:  6663.05713; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00010; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:18:47,686][trainer][INFO] - Step 90:
[2025-04-24 22:18:47,687][trainer][INFO] - loss/edit_train:  15.18242; loss/loc_train:  0.42716; edit/acc_train:  0.02854; edit/log_prob_train: -15.18242; edit/prob_train:  0.24326; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.30322; perplexity/pre_train:  73.93774; nll/post_train:  4.39451; perplexity/post_train:  81.00494; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.17457; loss/total_train:  1.94540; loss/total_edit_train:  1.94540; memory/alloc_max_train:  39099321856.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  7.92502; grad/pseudo_mag0_train:  17346.56133; grad/true_std0_train:  0.00193; grad/pseudo_std0_train:  4.23498; grad/diff0_train:  17340.32207; grad/cos0_train:  0.78472; grad/true_mag1_train:  11.46195; grad/pseudo_mag1_train:  17793.82354; grad/true_std1_train:  0.00280; grad/pseudo_std1_train:  4.34417; grad/diff1_train:  17784.51455; grad/cos1_train:  0.80764; grad/true_mag2_train:  14.73349; grad/pseudo_mag2_train:  18030.22373; grad/true_std2_train:  0.00360; grad/pseudo_std2_train:  4.40177; grad/diff2_train:  18018.19580; grad/cos2_train:  0.80908; grad/true_mag3_train:  8.79260; grad/pseudo_mag3_train:  18621.60479; grad/true_std3_train:  0.00215; grad/pseudo_std3_train:  4.54629; grad/diff3_train:  18614.06602; grad/cos3_train:  0.85193; grad/true_mag4_train:  11.46164; grad/pseudo_mag4_train:  18886.77002; grad/true_std4_train:  0.00280; grad/pseudo_std4_train:  4.61102; grad/diff4_train:  18877.04961; grad/cos4_train:  0.84202; grad/true_mag5_train:  13.79511; grad/pseudo_mag5_train:  19433.54707; grad/true_std5_train:  0.00337; grad/pseudo_std5_train:  4.74444; grad/diff5_train:  19421.98828; grad/cos5_train:  0.82511; grad/true_mag6_train:  8.94687; grad/pseudo_mag6_train:  19260.12539; grad/true_std6_train:  0.00218; grad/pseudo_std6_train:  4.70218; grad/diff6_train:  19252.14932; grad/cos6_train:  0.88725; grad/true_mag7_train:  10.70239; grad/pseudo_mag7_train:  19392.94941; grad/true_std7_train:  0.00261; grad/pseudo_std7_train:  4.73460; grad/diff7_train:  19383.62217; grad/cos7_train:  0.86376; grad/true_mag8_train:  12.44297; grad/pseudo_mag8_train:  20546.06650; grad/true_std8_train:  0.00304; grad/pseudo_std8_train:  5.01612; grad/diff8_train:  20535.24609; grad/cos8_train:  0.85798; grad/true_mag9_train:  8.92456; grad/pseudo_mag9_train:  19768.40996; grad/true_std9_train:  0.00218; grad/pseudo_std9_train:  4.82627; grad/diff9_train:  19760.43975; grad/cos9_train:  0.88619; grad/true_mag10_train:  10.32364; grad/pseudo_mag10_train:  20008.78369; grad/true_std10_train:  0.00252; grad/pseudo_std10_train:  4.88495; grad/diff10_train:  19999.68311; grad/cos10_train:  0.87413; grad/true_mag11_train:  12.46134; grad/pseudo_mag11_train:  20566.04668; grad/true_std11_train:  0.00304; grad/pseudo_std11_train:  5.02099; grad/diff11_train:  20555.91328; grad/cos11_train:  0.79920; grad/true_mag12_train:  8.24398; grad/pseudo_mag12_train:  19894.25088; grad/true_std12_train:  0.00201; grad/pseudo_std12_train:  4.85699; grad/diff12_train:  19887.27441; grad/cos12_train:  0.83582; grad/true_mag13_train:  9.49831; grad/pseudo_mag13_train:  20150.50605; grad/true_std13_train:  0.00232; grad/pseudo_std13_train:  4.91955; grad/diff13_train:  20142.43623; grad/cos13_train:  0.84017; grad/true_mag14_train:  12.66378; grad/pseudo_mag14_train:  20457.03086; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  4.99434; grad/diff14_train:  20447.50479; grad/cos14_train:  0.74029; grad/true_mag15_train:  7.95573; grad/pseudo_mag15_train:  20435.76367; grad/true_std15_train:  0.00194; grad/pseudo_std15_train:  4.98919; grad/diff15_train:  20429.37627; grad/cos15_train:  0.79812; grad/true_mag16_train:  16.56469; grad/pseudo_mag16_train:  20655.57246; grad/true_std16_train:  0.00404; grad/pseudo_std16_train:  5.04285; grad/diff16_train:  20648.17412; grad/cos16_train:  0.45276; grad/true_mag17_train:  21.75055; grad/pseudo_mag17_train:  19230.73838; grad/true_std17_train:  0.00531; grad/pseudo_std17_train:  4.69374; grad/diff17_train:  19219.92490; grad/cos17_train:  0.49314; grad_train:  6353.55469; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:18:50,872][trainer][INFO] - Step 100:
[2025-04-24 22:18:50,872][trainer][INFO] - loss/edit_train:  11.16229; loss/loc_train:  0.42751; edit/acc_train:  0.07588; edit/log_prob_train: -11.16229; edit/prob_train:  0.31592; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.17212; perplexity/pre_train:  64.85285; nll/post_train:  5.01768; perplexity/post_train:  151.06029; n_tokens/pre_train:  4.40000; n_tokens/post_train:  4.40000; time/edit_train:  0.17970; loss/total_train:  1.54374; loss/total_edit_train:  1.54374; memory/alloc_max_train:  40011553689.60000; memory/res_max_train:  44666821017.60000; grad/true_mag0_train:  8.19564; grad/pseudo_mag0_train:  19540.35254; grad/true_std0_train:  0.00200; grad/pseudo_std0_train:  4.77058; grad/diff0_train:  19533.75430; grad/cos0_train:  0.80210; grad/true_mag1_train:  11.72115; grad/pseudo_mag1_train:  19164.17725; grad/true_std1_train:  0.00286; grad/pseudo_std1_train:  4.67874; grad/diff1_train:  19154.53574; grad/cos1_train:  0.82033; grad/true_mag2_train:  15.30408; grad/pseudo_mag2_train:  19386.76426; grad/true_std2_train:  0.00374; grad/pseudo_std2_train:  4.73294; grad/diff2_train:  19374.26416; grad/cos2_train:  0.81532; grad/true_mag3_train:  9.28177; grad/pseudo_mag3_train:  20777.42520; grad/true_std3_train:  0.00227; grad/pseudo_std3_train:  5.07261; grad/diff3_train:  20769.35518; grad/cos3_train:  0.86637; grad/true_mag4_train:  11.51739; grad/pseudo_mag4_train:  20270.54727; grad/true_std4_train:  0.00281; grad/pseudo_std4_train:  4.94886; grad/diff4_train:  20260.52852; grad/cos4_train:  0.86721; grad/true_mag5_train:  13.83086; grad/pseudo_mag5_train:  20752.28799; grad/true_std5_train:  0.00338; grad/pseudo_std5_train:  5.06639; grad/diff5_train:  20740.27920; grad/cos5_train:  0.86339; grad/true_mag6_train:  9.21072; grad/pseudo_mag6_train:  20885.37803; grad/true_std6_train:  0.00225; grad/pseudo_std6_train:  5.09897; grad/diff6_train:  20877.05557; grad/cos6_train:  0.90173; grad/true_mag7_train:  10.72946; grad/pseudo_mag7_train:  20803.20273; grad/true_std7_train:  0.00262; grad/pseudo_std7_train:  5.07890; grad/diff7_train:  20793.63154; grad/cos7_train:  0.88914; grad/true_mag8_train:  12.40243; grad/pseudo_mag8_train:  21594.95918; grad/true_std8_train:  0.00303; grad/pseudo_std8_train:  5.27219; grad/diff8_train:  21583.87812; grad/cos8_train:  0.88947; grad/true_mag9_train:  8.89921; grad/pseudo_mag9_train:  20610.37793; grad/true_std9_train:  0.00217; grad/pseudo_std9_train:  5.03183; grad/diff9_train:  20602.34678; grad/cos9_train:  0.89904; grad/true_mag10_train:  10.15678; grad/pseudo_mag10_train:  20585.51572; grad/true_std10_train:  0.00248; grad/pseudo_std10_train:  5.02576; grad/diff10_train:  20576.43027; grad/cos10_train:  0.89083; grad/true_mag11_train:  12.11738; grad/pseudo_mag11_train:  21166.74951; grad/true_std11_train:  0.00296; grad/pseudo_std11_train:  5.16764; grad/diff11_train:  21156.52314; grad/cos11_train:  0.83755; grad/true_mag12_train:  8.12529; grad/pseudo_mag12_train:  20733.00664; grad/true_std12_train:  0.00198; grad/pseudo_std12_train:  5.06177; grad/diff12_train:  20725.98467; grad/cos12_train:  0.85734; grad/true_mag13_train:  9.38644; grad/pseudo_mag13_train:  20824.73799; grad/true_std13_train:  0.00229; grad/pseudo_std13_train:  5.08416; grad/diff13_train:  20816.62383; grad/cos13_train:  0.85861; grad/true_mag14_train:  11.76892; grad/pseudo_mag14_train:  20322.90391; grad/true_std14_train:  0.00287; grad/pseudo_std14_train:  4.96159; grad/diff14_train:  20313.67061; grad/cos14_train:  0.77822; grad/true_mag15_train:  7.45810; grad/pseudo_mag15_train:  20097.73418; grad/true_std15_train:  0.00182; grad/pseudo_std15_train:  4.90666; grad/diff15_train:  20091.60439; grad/cos15_train:  0.81673; grad/true_mag16_train:  13.43607; grad/pseudo_mag16_train:  20276.72949; grad/true_std16_train:  0.00328; grad/pseudo_std16_train:  4.95036; grad/diff16_train:  20269.78447; grad/cos16_train:  0.53243; grad/true_mag17_train:  19.32713; grad/pseudo_mag17_train:  17870.41758; grad/true_std17_train:  0.00472; grad/pseudo_std17_train:  4.36152; grad/diff17_train:  17860.32412; grad/cos17_train:  0.52567; grad_train:  5032.11572; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:19:09,335][trainer][INFO] - Step 100:
[2025-04-24 22:19:09,335][trainer][INFO] - loss/edit_val:  16.88392; loss/loc_val:  0.52441; edit/acc_val:  0.01928; edit/log_prob_val: -16.88392; edit/prob_val:  0.21816; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.99985; perplexity/post_val:  148.39142; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11099; loss/total_val:  2.21280; loss/total_edit_val:  2.21280; memory/alloc_max_val:  41020523008.00000; memory/res_max_val:  44772098048.00000; eval_time/elapsed:  18.45797; eval_time/average:  0.18458
[2025-04-24 22:19:09,339][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:19:09,339][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:20:03,608][trainer][INFO] - Write complete.
[2025-04-24 22:20:06,866][trainer][INFO] - Step 110:
[2025-04-24 22:20:06,867][trainer][INFO] - loss/edit_train:  19.79269; loss/loc_train:  0.15646; edit/acc_train:  0.06111; edit/log_prob_train: -19.79269; edit/prob_train:  0.24962; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.55557; perplexity/pre_train:  258.67560; nll/post_train:  5.82106; perplexity/post_train:  337.32831; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.19423; loss/total_train:  2.13573; loss/total_edit_train:  2.13573; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44772098048.00000; grad/true_mag0_train:  6.86231; grad/pseudo_mag0_train:  16287.35098; grad/true_std0_train:  0.00168; grad/pseudo_std0_train:  3.97639; grad/diff0_train:  16281.91787; grad/cos0_train:  0.78860; grad/true_mag1_train:  10.14312; grad/pseudo_mag1_train:  16865.08369; grad/true_std1_train:  0.00248; grad/pseudo_std1_train:  4.11743; grad/diff1_train:  16856.86006; grad/cos1_train:  0.80722; grad/true_mag2_train:  12.64728; grad/pseudo_mag2_train:  16543.78984; grad/true_std2_train:  0.00309; grad/pseudo_std2_train:  4.03876; grad/diff2_train:  16533.65156; grad/cos2_train:  0.79604; grad/true_mag3_train:  7.56835; grad/pseudo_mag3_train:  16910.51123; grad/true_std3_train:  0.00185; grad/pseudo_std3_train:  4.12854; grad/diff3_train:  16904.01582; grad/cos3_train:  0.85418; grad/true_mag4_train:  9.91042; grad/pseudo_mag4_train:  17125.18135; grad/true_std4_train:  0.00242; grad/pseudo_std4_train:  4.18095; grad/diff4_train:  17116.77129; grad/cos4_train:  0.84585; grad/true_mag5_train:  12.27957; grad/pseudo_mag5_train:  17473.36914; grad/true_std5_train:  0.00300; grad/pseudo_std5_train:  4.26584; grad/diff5_train:  17463.31631; grad/cos5_train:  0.81258; grad/true_mag6_train:  7.66842; grad/pseudo_mag6_train:  17482.09365; grad/true_std6_train:  0.00187; grad/pseudo_std6_train:  4.26808; grad/diff6_train:  17475.23965; grad/cos6_train:  0.89040; grad/true_mag7_train:  9.07072; grad/pseudo_mag7_train:  17517.02891; grad/true_std7_train:  0.00221; grad/pseudo_std7_train:  4.27661; grad/diff7_train:  17509.07109; grad/cos7_train:  0.87353; grad/true_mag8_train:  10.51039; grad/pseudo_mag8_train:  18314.39395; grad/true_std8_train:  0.00257; grad/pseudo_std8_train:  4.47126; grad/diff8_train:  18305.27080; grad/cos8_train:  0.86165; grad/true_mag9_train:  7.67656; grad/pseudo_mag9_train:  17950.49541; grad/true_std9_train:  0.00187; grad/pseudo_std9_train:  4.38244; grad/diff9_train:  17943.64443; grad/cos9_train:  0.88837; grad/true_mag10_train:  8.84727; grad/pseudo_mag10_train:  17982.09199; grad/true_std10_train:  0.00216; grad/pseudo_std10_train:  4.39015; grad/diff10_train:  17974.27813; grad/cos10_train:  0.87921; grad/true_mag11_train:  10.77061; grad/pseudo_mag11_train:  18690.16289; grad/true_std11_train:  0.00263; grad/pseudo_std11_train:  4.56299; grad/diff11_train:  18681.34521; grad/cos11_train:  0.81496; grad/true_mag12_train:  7.18052; grad/pseudo_mag12_train:  18615.91553; grad/true_std12_train:  0.00175; grad/pseudo_std12_train:  4.54490; grad/diff12_train:  18609.76572; grad/cos12_train:  0.85249; grad/true_mag13_train:  8.52644; grad/pseudo_mag13_train:  19085.55586; grad/true_std13_train:  0.00208; grad/pseudo_std13_train:  4.65955; grad/diff13_train:  19078.20947; grad/cos13_train:  0.85720; grad/true_mag14_train:  10.90326; grad/pseudo_mag14_train:  18728.16006; grad/true_std14_train:  0.00266; grad/pseudo_std14_train:  4.57221; grad/diff14_train:  18719.80088; grad/cos14_train:  0.76151; grad/true_mag15_train:  6.85893; grad/pseudo_mag15_train:  18656.61924; grad/true_std15_train:  0.00167; grad/pseudo_std15_train:  4.55481; grad/diff15_train:  18651.09033; grad/cos15_train:  0.80249; grad/true_mag16_train:  13.99304; grad/pseudo_mag16_train:  19351.89355; grad/true_std16_train:  0.00342; grad/pseudo_std16_train:  4.72457; grad/diff16_train:  19345.29033; grad/cos16_train:  0.47715; grad/true_mag17_train:  18.68730; grad/pseudo_mag17_train:  16679.12734; grad/true_std17_train:  0.00456; grad/pseudo_std17_train:  4.07036; grad/diff17_train:  16669.97754; grad/cos17_train:  0.48649; grad_train:  4566.26270; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:20:10,042][trainer][INFO] - Step 120:
[2025-04-24 22:20:10,043][trainer][INFO] - loss/edit_train:  16.79841; loss/loc_train:  0.23669; edit/acc_train:  0.03250; edit/log_prob_train: -16.79841; edit/prob_train:  0.26244; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.45123; perplexity/pre_train:  85.73236; nll/post_train:  5.47353; perplexity/post_train:  238.30005; n_tokens/pre_train:  6.80000; n_tokens/post_train:  6.80000; time/edit_train:  0.18072; loss/total_train:  1.91653; loss/total_edit_train:  1.91653; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44772098048.00000; grad/true_mag0_train:  7.35684; grad/pseudo_mag0_train:  17752.02070; grad/true_std0_train:  0.00180; grad/pseudo_std0_train:  4.33396; grad/diff0_train:  17746.13418; grad/cos0_train:  0.79477; grad/true_mag1_train:  10.49791; grad/pseudo_mag1_train:  17432.70518; grad/true_std1_train:  0.00256; grad/pseudo_std1_train:  4.25600; grad/diff1_train:  17424.12676; grad/cos1_train:  0.81097; grad/true_mag2_train:  13.27990; grad/pseudo_mag2_train:  17369.76201; grad/true_std2_train:  0.00324; grad/pseudo_std2_train:  4.24040; grad/diff2_train:  17358.98164; grad/cos2_train:  0.80395; grad/true_mag3_train:  8.16061; grad/pseudo_mag3_train:  18241.22773; grad/true_std3_train:  0.00199; grad/pseudo_std3_train:  4.45342; grad/diff3_train:  18234.24248; grad/cos3_train:  0.84811; grad/true_mag4_train:  10.31805; grad/pseudo_mag4_train:  18257.43564; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.45737; grad/diff4_train:  18248.53389; grad/cos4_train:  0.85455; grad/true_mag5_train:  12.27906; grad/pseudo_mag5_train:  18427.64531; grad/true_std5_train:  0.00300; grad/pseudo_std5_train:  4.49880; grad/diff5_train:  18417.30020; grad/cos5_train:  0.82962; grad/true_mag6_train:  7.98304; grad/pseudo_mag6_train:  18338.56074; grad/true_std6_train:  0.00195; grad/pseudo_std6_train:  4.47718; grad/diff6_train:  18331.44277; grad/cos6_train:  0.88401; grad/true_mag7_train:  9.56452; grad/pseudo_mag7_train:  18360.06719; grad/true_std7_train:  0.00234; grad/pseudo_std7_train:  4.48243; grad/diff7_train:  18351.72065; grad/cos7_train:  0.86186; grad/true_mag8_train:  10.89804; grad/pseudo_mag8_train:  19203.07358; grad/true_std8_train:  0.00266; grad/pseudo_std8_train:  4.68822; grad/diff8_train:  19193.52993; grad/cos8_train:  0.86232; grad/true_mag9_train:  7.84536; grad/pseudo_mag9_train:  18457.74668; grad/true_std9_train:  0.00192; grad/pseudo_std9_train:  4.50628; grad/diff9_train:  18450.74312; grad/cos9_train:  0.88237; grad/true_mag10_train:  9.15406; grad/pseudo_mag10_train:  18502.53857; grad/true_std10_train:  0.00223; grad/pseudo_std10_train:  4.51722; grad/diff10_train:  18494.47534; grad/cos10_train:  0.86958; grad/true_mag11_train:  11.02683; grad/pseudo_mag11_train:  19103.93081; grad/true_std11_train:  0.00269; grad/pseudo_std11_train:  4.66401; grad/diff11_train:  19094.91011; grad/cos11_train:  0.80045; grad/true_mag12_train:  7.59035; grad/pseudo_mag12_train:  19248.26060; grad/true_std12_train:  0.00185; grad/pseudo_std12_train:  4.69928; grad/diff12_train:  19241.83403; grad/cos12_train:  0.83143; grad/true_mag13_train:  8.84188; grad/pseudo_mag13_train:  19443.65962; grad/true_std13_train:  0.00216; grad/pseudo_std13_train:  4.74698; grad/diff13_train:  19436.13774; grad/cos13_train:  0.83902; grad/true_mag14_train:  11.43965; grad/pseudo_mag14_train:  19248.57222; grad/true_std14_train:  0.00279; grad/pseudo_std14_train:  4.69926; grad/diff14_train:  19239.97251; grad/cos14_train:  0.73432; grad/true_mag15_train:  7.43042; grad/pseudo_mag15_train:  19761.04072; grad/true_std15_train:  0.00181; grad/pseudo_std15_train:  4.82446; grad/diff15_train:  19755.06533; grad/cos15_train:  0.79051; grad/true_mag16_train:  15.20947; grad/pseudo_mag16_train:  20324.57129; grad/true_std16_train:  0.00371; grad/pseudo_std16_train:  4.96204; grad/diff16_train:  20317.49551; grad/cos16_train:  0.47010; grad/true_mag17_train:  20.64451; grad/pseudo_mag17_train:  18008.44160; grad/true_std17_train:  0.00504; grad/pseudo_std17_train:  4.39440; grad/diff17_train:  17998.18555; grad/cos17_train:  0.49399; grad_train:  3893.43945; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:20:13,778][trainer][INFO] - Step 130:
[2025-04-24 22:20:13,778][trainer][INFO] - loss/edit_train:  13.52688; loss/loc_train:  0.34717; edit/acc_train:  0.04034; edit/log_prob_train: -13.52688; edit/prob_train:  0.26508; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.42674; perplexity/pre_train:  83.65853; nll/post_train:  5.25279; perplexity/post_train:  191.09848; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.22852; loss/total_train:  1.69986; loss/total_edit_train:  1.69986; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44772098048.00000; grad/true_mag0_train:  8.23570; grad/pseudo_mag0_train:  19943.47314; grad/true_std0_train:  0.00201; grad/pseudo_std0_train:  4.86899; grad/diff0_train:  19936.89102; grad/cos0_train:  0.79430; grad/true_mag1_train:  12.01429; grad/pseudo_mag1_train:  19741.27246; grad/true_std1_train:  0.00293; grad/pseudo_std1_train:  4.81961; grad/diff1_train:  19731.48193; grad/cos1_train:  0.80987; grad/true_mag2_train:  15.26498; grad/pseudo_mag2_train:  19720.33994; grad/true_std2_train:  0.00373; grad/pseudo_std2_train:  4.81421; grad/diff2_train:  19707.97139; grad/cos2_train:  0.80260; grad/true_mag3_train:  9.28440; grad/pseudo_mag3_train:  20970.87842; grad/true_std3_train:  0.00227; grad/pseudo_std3_train:  5.11983; grad/diff3_train:  20962.91924; grad/cos3_train:  0.85276; grad/true_mag4_train:  11.47576; grad/pseudo_mag4_train:  20604.01162; grad/true_std4_train:  0.00280; grad/pseudo_std4_train:  5.03026; grad/diff4_train:  20594.06123; grad/cos4_train:  0.86095; grad/true_mag5_train:  13.72911; grad/pseudo_mag5_train:  21159.24805; grad/true_std5_train:  0.00335; grad/pseudo_std5_train:  5.16567; grad/diff5_train:  21147.47168; grad/cos5_train:  0.84723; grad/true_mag6_train:  9.12328; grad/pseudo_mag6_train:  21225.43867; grad/true_std6_train:  0.00223; grad/pseudo_std6_train:  5.18199; grad/diff6_train:  21217.24062; grad/cos6_train:  0.89448; grad/true_mag7_train:  10.63721; grad/pseudo_mag7_train:  20884.62314; grad/true_std7_train:  0.00260; grad/pseudo_std7_train:  5.09878; grad/diff7_train:  20875.25400; grad/cos7_train:  0.87497; grad/true_mag8_train:  12.35319; grad/pseudo_mag8_train:  22025.81396; grad/true_std8_train:  0.00302; grad/pseudo_std8_train:  5.37736; grad/diff8_train:  22014.96260; grad/cos8_train:  0.86862; grad/true_mag9_train:  8.92337; grad/pseudo_mag9_train:  21188.76182; grad/true_std9_train:  0.00218; grad/pseudo_std9_train:  5.17303; grad/diff9_train:  21180.74150; grad/cos9_train:  0.89263; grad/true_mag10_train:  10.24744; grad/pseudo_mag10_train:  21168.04707; grad/true_std10_train:  0.00250; grad/pseudo_std10_train:  5.16797; grad/diff10_train:  21158.94980; grad/cos10_train:  0.88053; grad/true_mag11_train:  12.31908; grad/pseudo_mag11_train:  21680.37725; grad/true_std11_train:  0.00301; grad/pseudo_std11_train:  5.29301; grad/diff11_train:  21670.18105; grad/cos11_train:  0.81735; grad/true_mag12_train:  8.35049; grad/pseudo_mag12_train:  21798.52090; grad/true_std12_train:  0.00204; grad/pseudo_std12_train:  5.32190; grad/diff12_train:  21791.28896; grad/cos12_train:  0.85800; grad/true_mag13_train:  9.56484; grad/pseudo_mag13_train:  21774.70937; grad/true_std13_train:  0.00234; grad/pseudo_std13_train:  5.31609; grad/diff13_train:  21766.42617; grad/cos13_train:  0.85735; grad/true_mag14_train:  12.21440; grad/pseudo_mag14_train:  21474.01992; grad/true_std14_train:  0.00298; grad/pseudo_std14_train:  5.24257; grad/diff14_train:  21464.51797; grad/cos14_train:  0.76520; grad/true_mag15_train:  7.57187; grad/pseudo_mag15_train:  20808.07178; grad/true_std15_train:  0.00185; grad/pseudo_std15_train:  5.08008; grad/diff15_train:  20801.87148; grad/cos15_train:  0.80724; grad/true_mag16_train:  13.55408; grad/pseudo_mag16_train:  21067.35234; grad/true_std16_train:  0.00331; grad/pseudo_std16_train:  5.14338; grad/diff16_train:  21060.21572; grad/cos16_train:  0.52558; grad/true_mag17_train:  19.83831; grad/pseudo_mag17_train:  18526.33350; grad/true_std17_train:  0.00484; grad/pseudo_std17_train:  4.52071; grad/diff17_train:  18516.12930; grad/cos17_train:  0.51070; grad_train:  5514.47119; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:20:17,079][trainer][INFO] - Step 140:
[2025-04-24 22:20:17,079][trainer][INFO] - loss/edit_train:  11.39132; loss/loc_train:  0.16751; edit/acc_train:  0.10762; edit/log_prob_train: -11.39132; edit/prob_train:  0.27389; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.45981; perplexity/pre_train:  31.81095; nll/post_train:  3.57804; perplexity/post_train:  35.80345; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.19169; loss/total_train:  1.30665; loss/total_edit_train:  1.30665; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44782164377.60000; grad/true_mag0_train:  7.71933; grad/pseudo_mag0_train:  19208.96660; grad/true_std0_train:  0.00188; grad/pseudo_std0_train:  4.68967; grad/diff0_train:  19202.75986; grad/cos0_train:  0.80179; grad/true_mag1_train:  11.28410; grad/pseudo_mag1_train:  19253.95703; grad/true_std1_train:  0.00275; grad/pseudo_std1_train:  4.70065; grad/diff1_train:  19244.65527; grad/cos1_train:  0.82127; grad/true_mag2_train:  14.86397; grad/pseudo_mag2_train:  19305.62451; grad/true_std2_train:  0.00363; grad/pseudo_std2_train:  4.71292; grad/diff2_train:  19293.65996; grad/cos2_train:  0.80301; grad/true_mag3_train:  9.21601; grad/pseudo_mag3_train:  21545.08076; grad/true_std3_train:  0.00225; grad/pseudo_std3_train:  5.26002; grad/diff3_train:  21537.05938; grad/cos3_train:  0.86663; grad/true_mag4_train:  11.42750; grad/pseudo_mag4_train:  21169.76572; grad/true_std4_train:  0.00279; grad/pseudo_std4_train:  5.16839; grad/diff4_train:  21159.75889; grad/cos4_train:  0.87096; grad/true_mag5_train:  13.72247; grad/pseudo_mag5_train:  21663.17441; grad/true_std5_train:  0.00335; grad/pseudo_std5_train:  5.28867; grad/diff5_train:  21651.27783; grad/cos5_train:  0.85953; grad/true_mag6_train:  9.41083; grad/pseudo_mag6_train:  22149.50430; grad/true_std6_train:  0.00230; grad/pseudo_std6_train:  5.40759; grad/diff6_train:  22141.00322; grad/cos6_train:  0.89964; grad/true_mag7_train:  10.95621; grad/pseudo_mag7_train:  22135.86064; grad/true_std7_train:  0.00267; grad/pseudo_std7_train:  5.40426; grad/diff7_train:  22126.05020; grad/cos7_train:  0.89064; grad/true_mag8_train:  12.39504; grad/pseudo_mag8_train:  22722.10752; grad/true_std8_train:  0.00303; grad/pseudo_std8_train:  5.54736; grad/diff8_train:  22711.00000; grad/cos8_train:  0.88827; grad/true_mag9_train:  9.13789; grad/pseudo_mag9_train:  21995.02002; grad/true_std9_train:  0.00223; grad/pseudo_std9_train:  5.36987; grad/diff9_train:  21986.76416; grad/cos9_train:  0.89907; grad/true_mag10_train:  10.49205; grad/pseudo_mag10_train:  22144.10566; grad/true_std10_train:  0.00256; grad/pseudo_std10_train:  5.40627; grad/diff10_train:  22134.67314; grad/cos10_train:  0.89288; grad/true_mag11_train:  12.19479; grad/pseudo_mag11_train:  22301.22510; grad/true_std11_train:  0.00298; grad/pseudo_std11_train:  5.44457; grad/diff11_train:  22290.93936; grad/cos11_train:  0.83493; grad/true_mag12_train:  8.45029; grad/pseudo_mag12_train:  22340.10889; grad/true_std12_train:  0.00206; grad/pseudo_std12_train:  5.45412; grad/diff12_train:  22332.76816; grad/cos12_train:  0.86217; grad/true_mag13_train:  9.63195; grad/pseudo_mag13_train:  22422.63535; grad/true_std13_train:  0.00235; grad/pseudo_std13_train:  5.47427; grad/diff13_train:  22414.20791; grad/cos13_train:  0.86773; grad/true_mag14_train:  12.12139; grad/pseudo_mag14_train:  21927.84004; grad/true_std14_train:  0.00296; grad/pseudo_std14_train:  5.35334; grad/diff14_train:  21918.33486; grad/cos14_train:  0.77411; grad/true_mag15_train:  7.59268; grad/pseudo_mag15_train:  21303.48896; grad/true_std15_train:  0.00185; grad/pseudo_std15_train:  5.20103; grad/diff15_train:  21297.24775; grad/cos15_train:  0.81632; grad/true_mag16_train:  14.50748; grad/pseudo_mag16_train:  21820.44600; grad/true_std16_train:  0.00354; grad/pseudo_std16_train:  5.32724; grad/diff16_train:  21813.18525; grad/cos16_train:  0.50501; grad/true_mag17_train:  19.16288; grad/pseudo_mag17_train:  19104.60928; grad/true_std17_train:  0.00468; grad/pseudo_std17_train:  4.66105; grad/diff17_train:  19094.61250; grad/cos17_train:  0.51569; grad_train:  3381.07104; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:20:20,687][trainer][INFO] - Step 150:
[2025-04-24 22:20:20,687][trainer][INFO] - loss/edit_train:  9.56599; loss/loc_train:  0.18334; edit/acc_train:  0.01667; edit/log_prob_train: -9.56599; edit/prob_train:  0.30651; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.70109; perplexity/pre_train:  110.06695; nll/post_train:  5.05344; perplexity/post_train:  156.55965; n_tokens/pre_train:  7.60000; n_tokens/post_train:  7.60000; time/edit_train:  0.22290; loss/total_train:  1.13994; loss/total_edit_train:  1.13994; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.38605; grad/pseudo_mag0_train:  20748.59629; grad/true_std0_train:  0.00205; grad/pseudo_std0_train:  5.06555; grad/diff0_train:  20741.78545; grad/cos0_train:  0.81204; grad/true_mag1_train:  11.96930; grad/pseudo_mag1_train:  20464.14229; grad/true_std1_train:  0.00292; grad/pseudo_std1_train:  4.99610; grad/diff1_train:  20454.17158; grad/cos1_train:  0.83187; grad/true_mag2_train:  15.55211; grad/pseudo_mag2_train:  20795.43164; grad/true_std2_train:  0.00380; grad/pseudo_std2_train:  5.07676; grad/diff2_train:  20782.47744; grad/cos2_train:  0.83185; grad/true_mag3_train:  9.64030; grad/pseudo_mag3_train:  22130.93613; grad/true_std3_train:  0.00235; grad/pseudo_std3_train:  5.40306; grad/diff3_train:  22122.50977; grad/cos3_train:  0.87346; grad/true_mag4_train:  11.81297; grad/pseudo_mag4_train:  21691.61719; grad/true_std4_train:  0.00288; grad/pseudo_std4_train:  5.29579; grad/diff4_train:  21681.22119; grad/cos4_train:  0.87813; grad/true_mag5_train:  14.50460; grad/pseudo_mag5_train:  22445.20557; grad/true_std5_train:  0.00354; grad/pseudo_std5_train:  5.47964; grad/diff5_train:  22432.60488; grad/cos5_train:  0.86524; grad/true_mag6_train:  9.87161; grad/pseudo_mag6_train:  22951.57559; grad/true_std6_train:  0.00241; grad/pseudo_std6_train:  5.60341; grad/diff6_train:  22942.62764; grad/cos6_train:  0.90524; grad/true_mag7_train:  11.37455; grad/pseudo_mag7_train:  22846.52988; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  5.57776; grad/diff7_train:  22836.32461; grad/cos7_train:  0.89566; grad/true_mag8_train:  13.09100; grad/pseudo_mag8_train:  23757.86230; grad/true_std8_train:  0.00320; grad/pseudo_std8_train:  5.80023; grad/diff8_train:  23746.12305; grad/cos8_train:  0.89391; grad/true_mag9_train:  9.71919; grad/pseudo_mag9_train:  22976.41787; grad/true_std9_train:  0.00237; grad/pseudo_std9_train:  5.60947; grad/diff9_train:  22967.61123; grad/cos9_train:  0.90420; grad/true_mag10_train:  10.93614; grad/pseudo_mag10_train:  22870.45703; grad/true_std10_train:  0.00267; grad/pseudo_std10_train:  5.58360; grad/diff10_train:  22860.62305; grad/cos10_train:  0.89762; grad/true_mag11_train:  12.82999; grad/pseudo_mag11_train:  23230.80957; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  5.67154; grad/diff11_train:  23219.92646; grad/cos11_train:  0.84481; grad/true_mag12_train:  9.02404; grad/pseudo_mag12_train:  23511.63770; grad/true_std12_train:  0.00220; grad/pseudo_std12_train:  5.74014; grad/diff12_train:  23503.73906; grad/cos12_train:  0.87138; grad/true_mag13_train:  10.52955; grad/pseudo_mag13_train:  23496.92324; grad/true_std13_train:  0.00257; grad/pseudo_std13_train:  5.73655; grad/diff13_train:  23487.77822; grad/cos13_train:  0.86373; grad/true_mag14_train:  12.77747; grad/pseudo_mag14_train:  22714.55918; grad/true_std14_train:  0.00312; grad/pseudo_std14_train:  5.54541; grad/diff14_train:  22704.51758; grad/cos14_train:  0.77647; grad/true_mag15_train:  8.19474; grad/pseudo_mag15_train:  22775.80977; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  5.56048; grad/diff15_train:  22769.01240; grad/cos15_train:  0.82384; grad/true_mag16_train:  14.64178; grad/pseudo_mag16_train:  23099.20088; grad/true_std16_train:  0.00357; grad/pseudo_std16_train:  5.63943; grad/diff16_train:  23091.31777; grad/cos16_train:  0.53893; grad/true_mag17_train:  20.13290; grad/pseudo_mag17_train:  20180.77871; grad/true_std17_train:  0.00492; grad/pseudo_std17_train:  4.92350; grad/diff17_train:  20169.82783; grad/cos17_train:  0.53876; grad_train:  3075.08105; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00008; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:20:24,075][trainer][INFO] - Step 160:
[2025-04-24 22:20:24,075][trainer][INFO] - loss/edit_train:  14.79378; loss/loc_train:  0.39352; edit/acc_train:  0.03750; edit/log_prob_train: -14.79378; edit/prob_train:  0.24528; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79478; perplexity/pre_train:  44.46848; nll/post_train:  4.56246; perplexity/post_train:  95.81847; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.20109; loss/total_train:  1.87289; loss/total_edit_train:  1.87289; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  6.93351; grad/pseudo_mag0_train:  16934.82061; grad/true_std0_train:  0.00169; grad/pseudo_std0_train:  4.13445; grad/diff0_train:  16929.29463; grad/cos0_train:  0.79422; grad/true_mag1_train:  10.36406; grad/pseudo_mag1_train:  17417.70137; grad/true_std1_train:  0.00253; grad/pseudo_std1_train:  4.25232; grad/diff1_train:  17409.26338; grad/cos1_train:  0.80988; grad/true_mag2_train:  13.20235; grad/pseudo_mag2_train:  17455.98613; grad/true_std2_train:  0.00322; grad/pseudo_std2_train:  4.26110; grad/diff2_train:  17445.56807; grad/cos2_train:  0.77780; grad/true_mag3_train:  7.82369; grad/pseudo_mag3_train:  17669.55801; grad/true_std3_train:  0.00191; grad/pseudo_std3_train:  4.31385; grad/diff3_train:  17662.81465; grad/cos3_train:  0.85716; grad/true_mag4_train:  10.01983; grad/pseudo_mag4_train:  18002.49600; grad/true_std4_train:  0.00245; grad/pseudo_std4_train:  4.39512; grad/diff4_train:  17993.81709; grad/cos4_train:  0.86145; grad/true_mag5_train:  12.39931; grad/pseudo_mag5_train:  18437.36543; grad/true_std5_train:  0.00303; grad/pseudo_std5_train:  4.50096; grad/diff5_train:  18427.06064; grad/cos5_train:  0.82081; grad/true_mag6_train:  8.15880; grad/pseudo_mag6_train:  18843.64697; grad/true_std6_train:  0.00199; grad/pseudo_std6_train:  4.60049; grad/diff6_train:  18836.34365; grad/cos6_train:  0.89100; grad/true_mag7_train:  9.53322; grad/pseudo_mag7_train:  18687.12295; grad/true_std7_train:  0.00233; grad/pseudo_std7_train:  4.56228; grad/diff7_train:  18678.71709; grad/cos7_train:  0.87602; grad/true_mag8_train:  10.97910; grad/pseudo_mag8_train:  19572.89033; grad/true_std8_train:  0.00268; grad/pseudo_std8_train:  4.77846; grad/diff8_train:  19563.33525; grad/cos8_train:  0.86174; grad/true_mag9_train:  8.10669; grad/pseudo_mag9_train:  19102.02012; grad/true_std9_train:  0.00198; grad/pseudo_std9_train:  4.66357; grad/diff9_train:  19094.79141; grad/cos9_train:  0.88722; grad/true_mag10_train:  9.33102; grad/pseudo_mag10_train:  19098.67734; grad/true_std10_train:  0.00228; grad/pseudo_std10_train:  4.66275; grad/diff10_train:  19090.42803; grad/cos10_train:  0.87964; grad/true_mag11_train:  11.27469; grad/pseudo_mag11_train:  19910.34531; grad/true_std11_train:  0.00275; grad/pseudo_std11_train:  4.86084; grad/diff11_train:  19901.12822; grad/cos11_train:  0.81098; grad/true_mag12_train:  7.68532; grad/pseudo_mag12_train:  19853.24814; grad/true_std12_train:  0.00188; grad/pseudo_std12_train:  4.84698; grad/diff12_train:  19846.72676; grad/cos12_train:  0.84241; grad/true_mag13_train:  8.94256; grad/pseudo_mag13_train:  19946.85166; grad/true_std13_train:  0.00218; grad/pseudo_std13_train:  4.86983; grad/diff13_train:  19939.18916; grad/cos13_train:  0.85027; grad/true_mag14_train:  11.46950; grad/pseudo_mag14_train:  20179.58027; grad/true_std14_train:  0.00280; grad/pseudo_std14_train:  4.92648; grad/diff14_train:  20170.78174; grad/cos14_train:  0.75914; grad/true_mag15_train:  7.27813; grad/pseudo_mag15_train:  20196.54707; grad/true_std15_train:  0.00178; grad/pseudo_std15_train:  4.93078; grad/diff15_train:  20190.62129; grad/cos15_train:  0.80721; grad/true_mag16_train:  14.68774; grad/pseudo_mag16_train:  20946.56943; grad/true_std16_train:  0.00359; grad/pseudo_std16_train:  5.11389; grad/diff16_train:  20939.48662; grad/cos16_train:  0.49963; grad/true_mag17_train:  18.61549; grad/pseudo_mag17_train:  18514.73057; grad/true_std17_train:  0.00454; grad/pseudo_std17_train:  4.51734; grad/diff17_train:  18504.84033; grad/cos17_train:  0.52487; grad_train:  4317.28467; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:20:27,266][trainer][INFO] - Step 170:
[2025-04-24 22:20:27,267][trainer][INFO] - loss/edit_train:  14.51528; loss/loc_train:  0.75442; edit/acc_train:  0.01833; edit/log_prob_train: -14.51528; edit/prob_train:  0.30433; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.34262; perplexity/pre_train:  76.90887; nll/post_train:  6.80823; perplexity/post_train:  905.26941; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.17774; loss/total_train:  2.20594; loss/total_edit_train:  2.20594; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.08239; grad/pseudo_mag0_train:  19586.34580; grad/true_std0_train:  0.00197; grad/pseudo_std0_train:  4.78179; grad/diff0_train:  19579.88291; grad/cos0_train:  0.79495; grad/true_mag1_train:  11.78292; grad/pseudo_mag1_train:  19639.73340; grad/true_std1_train:  0.00288; grad/pseudo_std1_train:  4.79479; grad/diff1_train:  19630.07168; grad/cos1_train:  0.81446; grad/true_mag2_train:  15.37951; grad/pseudo_mag2_train:  19934.40615; grad/true_std2_train:  0.00375; grad/pseudo_std2_train:  4.86627; grad/diff2_train:  19921.82812; grad/cos2_train:  0.80806; grad/true_mag3_train:  9.28685; grad/pseudo_mag3_train:  20944.07192; grad/true_std3_train:  0.00227; grad/pseudo_std3_train:  5.11329; grad/diff3_train:  20936.08481; grad/cos3_train:  0.85079; grad/true_mag4_train:  11.65753; grad/pseudo_mag4_train:  20952.42070; grad/true_std4_train:  0.00285; grad/pseudo_std4_train:  5.11532; grad/diff4_train:  20942.26689; grad/cos4_train:  0.86135; grad/true_mag5_train:  14.10702; grad/pseudo_mag5_train:  21438.09297; grad/true_std5_train:  0.00344; grad/pseudo_std5_train:  5.23366; grad/diff5_train:  21425.97734; grad/cos5_train:  0.84369; grad/true_mag6_train:  9.17216; grad/pseudo_mag6_train:  21205.65889; grad/true_std6_train:  0.00224; grad/pseudo_std6_train:  5.17715; grad/diff6_train:  21197.42842; grad/cos6_train:  0.88780; grad/true_mag7_train:  10.82459; grad/pseudo_mag7_train:  21144.01436; grad/true_std7_train:  0.00264; grad/pseudo_std7_train:  5.16210; grad/diff7_train:  21134.43521; grad/cos7_train:  0.87229; grad/true_mag8_train:  12.85327; grad/pseudo_mag8_train:  22179.64536; grad/true_std8_train:  0.00314; grad/pseudo_std8_train:  5.41490; grad/diff8_train:  22168.48281; grad/cos8_train:  0.85615; grad/true_mag9_train:  8.98979; grad/pseudo_mag9_train:  21233.64565; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  5.18399; grad/diff9_train:  21225.60215; grad/cos9_train:  0.88078; grad/true_mag10_train:  10.97198; grad/pseudo_mag10_train:  21027.35400; grad/true_std10_train:  0.00268; grad/pseudo_std10_train:  5.13362; grad/diff10_train:  21018.12632; grad/cos10_train:  0.84631; grad/true_mag11_train:  12.55529; grad/pseudo_mag11_train:  21618.92324; grad/true_std11_train:  0.00307; grad/pseudo_std11_train:  5.27799; grad/diff11_train:  21608.58398; grad/cos11_train:  0.80507; grad/true_mag12_train:  8.77115; grad/pseudo_mag12_train:  21984.27109; grad/true_std12_train:  0.00214; grad/pseudo_std12_train:  5.36724; grad/diff12_train:  21976.83760; grad/cos12_train:  0.82618; grad/true_mag13_train:  10.04968; grad/pseudo_mag13_train:  21960.03462; grad/true_std13_train:  0.00245; grad/pseudo_std13_train:  5.36133; grad/diff13_train:  21951.45708; grad/cos13_train:  0.83779; grad/true_mag14_train:  12.74964; grad/pseudo_mag14_train:  21749.13525; grad/true_std14_train:  0.00311; grad/pseudo_std14_train:  5.30969; grad/diff14_train:  21739.33760; grad/cos14_train:  0.75046; grad/true_mag15_train:  8.21396; grad/pseudo_mag15_train:  21350.62168; grad/true_std15_train:  0.00201; grad/pseudo_std15_train:  5.21252; grad/diff15_train:  21344.11455; grad/cos15_train:  0.77845; grad/true_mag16_train:  18.20640; grad/pseudo_mag16_train:  21447.43604; grad/true_std16_train:  0.00444; grad/pseudo_std16_train:  5.23616; grad/diff16_train:  21439.74263; grad/cos16_train:  0.44205; grad/true_mag17_train:  22.55421; grad/pseudo_mag17_train:  19747.49502; grad/true_std17_train:  0.00551; grad/pseudo_std17_train:  4.81774; grad/diff17_train:  19736.19727; grad/cos17_train:  0.49991; grad_train:  5006.79541; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:20:30,975][trainer][INFO] - Step 180:
[2025-04-24 22:20:30,976][trainer][INFO] - loss/edit_train:  14.23629; loss/loc_train:  0.16080; edit/acc_train:  0.03417; edit/log_prob_train: -14.23629; edit/prob_train:  0.28077; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.22301; perplexity/pre_train:  68.23840; nll/post_train:  4.49568; perplexity/post_train:  89.62950; n_tokens/pre_train:  7.10000; n_tokens/post_train:  7.10000; time/edit_train:  0.22641; loss/total_train:  1.58443; loss/total_edit_train:  1.58443; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  7.70395; grad/pseudo_mag0_train:  18159.77695; grad/true_std0_train:  0.00188; grad/pseudo_std0_train:  4.43351; grad/diff0_train:  18153.60664; grad/cos0_train:  0.79875; grad/true_mag1_train:  11.01037; grad/pseudo_mag1_train:  18521.18223; grad/true_std1_train:  0.00269; grad/pseudo_std1_train:  4.52172; grad/diff1_train:  18512.12383; grad/cos1_train:  0.81889; grad/true_mag2_train:  14.08074; grad/pseudo_mag2_train:  18890.64795; grad/true_std2_train:  0.00344; grad/pseudo_std2_train:  4.61138; grad/diff2_train:  18879.05654; grad/cos2_train:  0.81675; grad/true_mag3_train:  8.68564; grad/pseudo_mag3_train:  19757.66514; grad/true_std3_train:  0.00212; grad/pseudo_std3_train:  4.82364; grad/diff3_train:  19750.11826; grad/cos3_train:  0.86550; grad/true_mag4_train:  10.89773; grad/pseudo_mag4_train:  19616.33965; grad/true_std4_train:  0.00266; grad/pseudo_std4_train:  4.78913; grad/diff4_train:  19606.86973; grad/cos4_train:  0.86594; grad/true_mag5_train:  13.34807; grad/pseudo_mag5_train:  20432.13438; grad/true_std5_train:  0.00326; grad/pseudo_std5_train:  4.98800; grad/diff5_train:  20420.76406; grad/cos5_train:  0.84524; grad/true_mag6_train:  8.82735; grad/pseudo_mag6_train:  20462.14199; grad/true_std6_train:  0.00216; grad/pseudo_std6_train:  4.99563; grad/diff6_train:  20454.18135; grad/cos6_train:  0.89949; grad/true_mag7_train:  10.33061; grad/pseudo_mag7_train:  20414.01582; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  4.98388; grad/diff7_train:  20404.81631; grad/cos7_train:  0.88707; grad/true_mag8_train:  11.84069; grad/pseudo_mag8_train:  21377.85039; grad/true_std8_train:  0.00289; grad/pseudo_std8_train:  5.21913; grad/diff8_train:  21367.31592; grad/cos8_train:  0.88324; grad/true_mag9_train:  8.64821; grad/pseudo_mag9_train:  20384.79648; grad/true_std9_train:  0.00211; grad/pseudo_std9_train:  4.97675; grad/diff9_train:  20377.02549; grad/cos9_train:  0.89563; grad/true_mag10_train:  9.85423; grad/pseudo_mag10_train:  20236.77891; grad/true_std10_train:  0.00241; grad/pseudo_std10_train:  4.94061; grad/diff10_train:  20227.99180; grad/cos10_train:  0.88828; grad/true_mag11_train:  11.87195; grad/pseudo_mag11_train:  21100.72383; grad/true_std11_train:  0.00290; grad/pseudo_std11_train:  5.15145; grad/diff11_train:  21090.87354; grad/cos11_train:  0.82253; grad/true_mag12_train:  8.15850; grad/pseudo_mag12_train:  20852.77500; grad/true_std12_train:  0.00199; grad/pseudo_std12_train:  5.09100; grad/diff12_train:  20845.74541; grad/cos12_train:  0.85591; grad/true_mag13_train:  9.50857; grad/pseudo_mag13_train:  21207.74727; grad/true_std13_train:  0.00232; grad/pseudo_std13_train:  5.17766; grad/diff13_train:  21199.49736; grad/cos13_train:  0.86259; grad/true_mag14_train:  11.99502; grad/pseudo_mag14_train:  21167.09248; grad/true_std14_train:  0.00293; grad/pseudo_std14_train:  5.16749; grad/diff14_train:  21157.78613; grad/cos14_train:  0.76670; grad/true_mag15_train:  7.56224; grad/pseudo_mag15_train:  20687.00791; grad/true_std15_train:  0.00185; grad/pseudo_std15_train:  5.05050; grad/diff15_train:  20680.78711; grad/cos15_train:  0.81781; grad/true_mag16_train:  14.46327; grad/pseudo_mag16_train:  21144.22207; grad/true_std16_train:  0.00353; grad/pseudo_std16_train:  5.16212; grad/diff16_train:  21136.90898; grad/cos16_train:  0.50413; grad/true_mag17_train:  19.74844; grad/pseudo_mag17_train:  19184.40557; grad/true_std17_train:  0.00482; grad/pseudo_std17_train:  4.67810; grad/diff17_train:  19174.15371; grad/cos17_train:  0.51251; grad_train:  3220.33081; lr/lr0_train:  0.00009; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:20:34,145][trainer][INFO] - Step 190:
[2025-04-24 22:20:34,145][trainer][INFO] - loss/edit_train:  7.85270; loss/loc_train:  0.11252; edit/acc_train:  0.09345; edit/log_prob_train: -7.85270; edit/prob_train:  0.32712; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.16827; perplexity/pre_train:  64.60344; nll/post_train:  4.73707; perplexity/post_train:  114.09956; n_tokens/pre_train:  6.90000; n_tokens/post_train:  6.90000; time/edit_train:  0.17800; loss/total_train:  0.89779; loss/total_edit_train:  0.89779; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.79816; grad/pseudo_mag0_train:  21395.84980; grad/true_std0_train:  0.00215; grad/pseudo_std0_train:  5.22352; grad/diff0_train:  21388.78574; grad/cos0_train:  0.79900; grad/true_mag1_train:  12.70318; grad/pseudo_mag1_train:  20850.36230; grad/true_std1_train:  0.00310; grad/pseudo_std1_train:  5.09033; grad/diff1_train:  20840.05117; grad/cos1_train:  0.81191; grad/true_mag2_train:  16.20142; grad/pseudo_mag2_train:  21269.92246; grad/true_std2_train:  0.00396; grad/pseudo_std2_train:  5.19222; grad/diff2_train:  21256.64814; grad/cos2_train:  0.81464; grad/true_mag3_train:  10.23708; grad/pseudo_mag3_train:  23339.75273; grad/true_std3_train:  0.00250; grad/pseudo_std3_train:  5.69816; grad/diff3_train:  23330.83232; grad/cos3_train:  0.86757; grad/true_mag4_train:  12.50515; grad/pseudo_mag4_train:  22623.34756; grad/true_std4_train:  0.00305; grad/pseudo_std4_train:  5.52324; grad/diff4_train:  22612.41094; grad/cos4_train:  0.87027; grad/true_mag5_train:  14.74681; grad/pseudo_mag5_train:  23186.65996; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  5.66046; grad/diff5_train:  23173.80088; grad/cos5_train:  0.86574; grad/true_mag6_train:  10.18283; grad/pseudo_mag6_train:  23479.96055; grad/true_std6_train:  0.00249; grad/pseudo_std6_train:  5.73240; grad/diff6_train:  23470.73701; grad/cos6_train:  0.90303; grad/true_mag7_train:  11.81924; grad/pseudo_mag7_train:  23390.05273; grad/true_std7_train:  0.00289; grad/pseudo_std7_train:  5.71044; grad/diff7_train:  23379.47451; grad/cos7_train:  0.89104; grad/true_mag8_train:  13.30952; grad/pseudo_mag8_train:  24120.62148; grad/true_std8_train:  0.00325; grad/pseudo_std8_train:  5.88875; grad/diff8_train:  24108.74707; grad/cos8_train:  0.88843; grad/true_mag9_train:  9.72906; grad/pseudo_mag9_train:  23052.81914; grad/true_std9_train:  0.00238; grad/pseudo_std9_train:  5.62811; grad/diff9_train:  23043.99775; grad/cos9_train:  0.90392; grad/true_mag10_train:  11.58122; grad/pseudo_mag10_train:  23097.65918; grad/true_std10_train:  0.00283; grad/pseudo_std10_train:  5.63906; grad/diff10_train:  23087.62021; grad/cos10_train:  0.87395; grad/true_mag11_train:  13.04665; grad/pseudo_mag11_train:  23439.82061; grad/true_std11_train:  0.00319; grad/pseudo_std11_train:  5.72251; grad/diff11_train:  23428.80098; grad/cos11_train:  0.83878; grad/true_mag12_train:  8.92347; grad/pseudo_mag12_train:  22976.16260; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.60940; grad/diff12_train:  22968.42852; grad/cos12_train:  0.86372; grad/true_mag13_train:  10.31847; grad/pseudo_mag13_train:  23230.76748; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  5.67155; grad/diff13_train:  23221.79814; grad/cos13_train:  0.86628; grad/true_mag14_train:  12.80534; grad/pseudo_mag14_train:  22767.17646; grad/true_std14_train:  0.00313; grad/pseudo_std14_train:  5.55816; grad/diff14_train:  22757.03018; grad/cos14_train:  0.78586; grad/true_mag15_train:  7.85647; grad/pseudo_mag15_train:  21423.05537; grad/true_std15_train:  0.00192; grad/pseudo_std15_train:  5.23020; grad/diff15_train:  21416.54727; grad/cos15_train:  0.82655; grad/true_mag16_train:  14.57995; grad/pseudo_mag16_train:  22081.29668; grad/true_std16_train:  0.00356; grad/pseudo_std16_train:  5.39090; grad/diff16_train:  22073.50020; grad/cos16_train:  0.54316; grad/true_mag17_train:  19.81638; grad/pseudo_mag17_train:  19213.09199; grad/true_std17_train:  0.00484; grad/pseudo_std17_train:  4.68605; grad/diff17_train:  19202.59619; grad/cos17_train:  0.53048; grad_train:  2097.02466; lr/lr0_train:  0.00009; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:20:37,350][trainer][INFO] - Step 200:
[2025-04-24 22:20:37,351][trainer][INFO] - loss/edit_train:  18.82910; loss/loc_train:  0.15367; edit/acc_train:  0.06623; edit/log_prob_train: -18.82910; edit/prob_train:  0.21615; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.62263; perplexity/pre_train:  101.76141; nll/post_train:  4.81755; perplexity/post_train:  123.66205; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.18390; loss/total_train:  2.03658; loss/total_edit_train:  2.03658; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.96374; grad/pseudo_mag0_train:  21433.96230; grad/true_std0_train:  0.00219; grad/pseudo_std0_train:  5.23285; grad/diff0_train:  21426.72236; grad/cos0_train:  0.80527; grad/true_mag1_train:  12.78289; grad/pseudo_mag1_train:  21496.62021; grad/true_std1_train:  0.00312; grad/pseudo_std1_train:  5.24812; grad/diff1_train:  21486.10342; grad/cos1_train:  0.81967; grad/true_mag2_train:  16.19032; grad/pseudo_mag2_train:  21686.48848; grad/true_std2_train:  0.00395; grad/pseudo_std2_train:  5.29377; grad/diff2_train:  21673.25107; grad/cos2_train:  0.81003; grad/true_mag3_train:  10.31566; grad/pseudo_mag3_train:  23116.70264; grad/true_std3_train:  0.00252; grad/pseudo_std3_train:  5.64371; grad/diff3_train:  23107.67422; grad/cos3_train:  0.87198; grad/true_mag4_train:  12.69517; grad/pseudo_mag4_train:  22697.15127; grad/true_std4_train:  0.00310; grad/pseudo_std4_train:  5.54127; grad/diff4_train:  22686.05986; grad/cos4_train:  0.86979; grad/true_mag5_train:  15.36802; grad/pseudo_mag5_train:  23428.29141; grad/true_std5_train:  0.00375; grad/pseudo_std5_train:  5.71939; grad/diff5_train:  23415.06094; grad/cos5_train:  0.85315; grad/true_mag6_train:  10.36859; grad/pseudo_mag6_train:  23690.46152; grad/true_std6_train:  0.00253; grad/pseudo_std6_train:  5.78379; grad/diff6_train:  23681.07129; grad/cos6_train:  0.90335; grad/true_mag7_train:  11.90988; grad/pseudo_mag7_train:  23493.56562; grad/true_std7_train:  0.00291; grad/pseudo_std7_train:  5.73572; grad/diff7_train:  23482.90537; grad/cos7_train:  0.89119; grad/true_mag8_train:  13.48483; grad/pseudo_mag8_train:  24293.33018; grad/true_std8_train:  0.00329; grad/pseudo_std8_train:  5.93089; grad/diff8_train:  24281.29463; grad/cos8_train:  0.88503; grad/true_mag9_train:  10.06371; grad/pseudo_mag9_train:  23643.15781; grad/true_std9_train:  0.00246; grad/pseudo_std9_train:  5.77224; grad/diff9_train:  23634.01523; grad/cos9_train:  0.90598; grad/true_mag10_train:  11.32580; grad/pseudo_mag10_train:  23403.54336; grad/true_std10_train:  0.00277; grad/pseudo_std10_train:  5.71374; grad/diff10_train:  23393.34414; grad/cos10_train:  0.89764; grad/true_mag11_train:  13.04965; grad/pseudo_mag11_train:  23439.40273; grad/true_std11_train:  0.00319; grad/pseudo_std11_train:  5.72239; grad/diff11_train:  23428.41699; grad/cos11_train:  0.83536; grad/true_mag12_train:  9.02621; grad/pseudo_mag12_train:  22842.75635; grad/true_std12_train:  0.00220; grad/pseudo_std12_train:  5.57683; grad/diff12_train:  22834.93125; grad/cos12_train:  0.86498; grad/true_mag13_train:  10.43002; grad/pseudo_mag13_train:  23046.05234; grad/true_std13_train:  0.00255; grad/pseudo_std13_train:  5.62645; grad/diff13_train:  23036.99023; grad/cos13_train:  0.86709; grad/true_mag14_train:  12.76062; grad/pseudo_mag14_train:  22923.77734; grad/true_std14_train:  0.00312; grad/pseudo_std14_train:  5.59634; grad/diff14_train:  22913.64512; grad/cos14_train:  0.78587; grad/true_mag15_train:  7.98926; grad/pseudo_mag15_train:  22243.24746; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  5.43042; grad/diff15_train:  22236.54434; grad/cos15_train:  0.83567; grad/true_mag16_train:  13.49042; grad/pseudo_mag16_train:  23075.95820; grad/true_std16_train:  0.00329; grad/pseudo_std16_train:  5.63372; grad/diff16_train:  23067.95059; grad/cos16_train:  0.59653; grad/true_mag17_train:  19.36987; grad/pseudo_mag17_train:  19924.42520; grad/true_std17_train:  0.00473; grad/pseudo_std17_train:  4.85953; grad/diff17_train:  19913.65146; grad/cos17_train:  0.55206; grad_train:  4243.61426; lr/lr0_train:  0.00009; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:20:55,711][trainer][INFO] - Step 200:
[2025-04-24 22:20:55,712][trainer][INFO] - loss/edit_val:  15.05197; loss/loc_val:  0.33849; edit/acc_val:  0.02637; edit/log_prob_val: -15.05197; edit/prob_val:  0.24197; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.94397; perplexity/post_val:  140.32611; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11066; loss/total_val:  1.84369; loss/total_edit_val:  1.84369; memory/alloc_max_val:  41020523008.00000; memory/res_max_val:  44805652480.00000; eval_time/elapsed:  18.35570; eval_time/average:  0.18356
[2025-04-24 22:20:55,714][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:20:55,715][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:21:50,114][trainer][INFO] - Write complete.
[2025-04-24 22:21:53,253][trainer][INFO] - Step 210:
[2025-04-24 22:21:53,253][trainer][INFO] - loss/edit_train:  17.18579; loss/loc_train:  0.09998; edit/acc_train:  0.01250; edit/log_prob_train: -17.18579; edit/prob_train:  0.15909; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.70241; perplexity/pre_train:  110.21284; nll/post_train:  4.75693; perplexity/post_train:  116.38787; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.17897; loss/total_train:  1.81856; loss/total_edit_train:  1.81856; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  7.74734; grad/pseudo_mag0_train:  18244.56709; grad/true_std0_train:  0.00189; grad/pseudo_std0_train:  4.45420; grad/diff0_train:  18238.37139; grad/cos0_train:  0.79774; grad/true_mag1_train:  11.25460; grad/pseudo_mag1_train:  18659.12627; grad/true_std1_train:  0.00275; grad/pseudo_std1_train:  4.55538; grad/diff1_train:  18649.92236; grad/cos1_train:  0.81484; grad/true_mag2_train:  14.42426; grad/pseudo_mag2_train:  18829.10381; grad/true_std2_train:  0.00352; grad/pseudo_std2_train:  4.59578; grad/diff2_train:  18817.53115; grad/cos2_train:  0.79655; grad/true_mag3_train:  8.70266; grad/pseudo_mag3_train:  19221.03115; grad/true_std3_train:  0.00212; grad/pseudo_std3_train:  4.69263; grad/diff3_train:  19213.50547; grad/cos3_train:  0.86178; grad/true_mag4_train:  10.89781; grad/pseudo_mag4_train:  19106.12119; grad/true_std4_train:  0.00266; grad/pseudo_std4_train:  4.66457; grad/diff4_train:  19096.69570; grad/cos4_train:  0.86137; grad/true_mag5_train:  13.39902; grad/pseudo_mag5_train:  19851.04658; grad/true_std5_train:  0.00327; grad/pseudo_std5_train:  4.84589; grad/diff5_train:  19839.74355; grad/cos5_train:  0.83800; grad/true_mag6_train:  8.84413; grad/pseudo_mag6_train:  20248.11553; grad/true_std6_train:  0.00216; grad/pseudo_std6_train:  4.94338; grad/diff6_train:  20240.13721; grad/cos6_train:  0.89966; grad/true_mag7_train:  10.33805; grad/pseudo_mag7_train:  20165.61299; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  4.92324; grad/diff7_train:  20156.46719; grad/cos7_train:  0.88080; grad/true_mag8_train:  11.94396; grad/pseudo_mag8_train:  21312.69521; grad/true_std8_train:  0.00292; grad/pseudo_std8_train:  5.20320; grad/diff8_train:  21302.12129; grad/cos8_train:  0.87982; grad/true_mag9_train:  8.72160; grad/pseudo_mag9_train:  20610.74648; grad/true_std9_train:  0.00213; grad/pseudo_std9_train:  5.03192; grad/diff9_train:  20602.87393; grad/cos9_train:  0.89960; grad/true_mag10_train:  10.08565; grad/pseudo_mag10_train:  20680.69258; grad/true_std10_train:  0.00246; grad/pseudo_std10_train:  5.04899; grad/diff10_train:  20671.67324; grad/cos10_train:  0.89071; grad/true_mag11_train:  11.79482; grad/pseudo_mag11_train:  21208.96953; grad/true_std11_train:  0.00288; grad/pseudo_std11_train:  5.17786; grad/diff11_train:  21199.07744; grad/cos11_train:  0.83376; grad/true_mag12_train:  8.19662; grad/pseudo_mag12_train:  21064.01211; grad/true_std12_train:  0.00200; grad/pseudo_std12_train:  5.14257; grad/diff12_train:  21056.91621; grad/cos12_train:  0.85977; grad/true_mag13_train:  9.49552; grad/pseudo_mag13_train:  21324.15908; grad/true_std13_train:  0.00232; grad/pseudo_std13_train:  5.20608; grad/diff13_train:  21315.87197; grad/cos13_train:  0.86812; grad/true_mag14_train:  12.05557; grad/pseudo_mag14_train:  21072.20693; grad/true_std14_train:  0.00294; grad/pseudo_std14_train:  5.14432; grad/diff14_train:  21062.81279; grad/cos14_train:  0.77224; grad/true_mag15_train:  7.60373; grad/pseudo_mag15_train:  20738.63525; grad/true_std15_train:  0.00186; grad/pseudo_std15_train:  5.06310; grad/diff15_train:  20732.37549; grad/cos15_train:  0.81778; grad/true_mag16_train:  13.96307; grad/pseudo_mag16_train:  21200.77676; grad/true_std16_train:  0.00341; grad/pseudo_std16_train:  5.17593; grad/diff16_train:  21193.38545; grad/cos16_train:  0.53095; grad/true_mag17_train:  20.02982; grad/pseudo_mag17_train:  18396.65664; grad/true_std17_train:  0.00489; grad/pseudo_std17_train:  4.48702; grad/diff17_train:  18386.39209; grad/cos17_train:  0.51116; grad_train:  4888.83154; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:21:56,419][trainer][INFO] - Step 220:
[2025-04-24 22:21:56,419][trainer][INFO] - loss/edit_train:  15.90061; loss/loc_train:  0.57869; edit/acc_train:  0.11333; edit/log_prob_train: -15.90061; edit/prob_train:  0.26134; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.38268; perplexity/pre_train:  217.60442; nll/post_train:  6.99822; perplexity/post_train:  1094.67847; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.18230; loss/total_train:  2.16875; loss/total_edit_train:  2.16875; memory/alloc_max_train:  41020523008.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.33094; grad/pseudo_mag0_train:  20064.44062; grad/true_std0_train:  0.00203; grad/pseudo_std0_train:  4.89847; grad/diff0_train:  20057.74990; grad/cos0_train:  0.79962; grad/true_mag1_train:  11.92918; grad/pseudo_mag1_train:  20017.73447; grad/true_std1_train:  0.00291; grad/pseudo_std1_train:  4.88703; grad/diff1_train:  20007.93516; grad/cos1_train:  0.81663; grad/true_mag2_train:  15.28921; grad/pseudo_mag2_train:  20525.66309; grad/true_std2_train:  0.00373; grad/pseudo_std2_train:  5.01007; grad/diff2_train:  20513.19082; grad/cos2_train:  0.80424; grad/true_mag3_train:  9.65167; grad/pseudo_mag3_train:  21671.76797; grad/true_std3_train:  0.00236; grad/pseudo_std3_train:  5.29094; grad/diff3_train:  21663.39639; grad/cos3_train:  0.86337; grad/true_mag4_train:  11.90792; grad/pseudo_mag4_train:  21255.65400; grad/true_std4_train:  0.00291; grad/pseudo_std4_train:  5.18934; grad/diff4_train:  21245.28594; grad/cos4_train:  0.86532; grad/true_mag5_train:  14.35087; grad/pseudo_mag5_train:  22085.36543; grad/true_std5_train:  0.00350; grad/pseudo_std5_train:  5.39137; grad/diff5_train:  22073.13428; grad/cos5_train:  0.83957; grad/true_mag6_train:  9.67734; grad/pseudo_mag6_train:  22239.74971; grad/true_std6_train:  0.00236; grad/pseudo_std6_train:  5.42962; grad/diff6_train:  22231.02471; grad/cos6_train:  0.89678; grad/true_mag7_train:  11.17467; grad/pseudo_mag7_train:  21963.01738; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  5.36205; grad/diff7_train:  21953.06621; grad/cos7_train:  0.88443; grad/true_mag8_train:  12.82372; grad/pseudo_mag8_train:  23033.71641; grad/true_std8_train:  0.00313; grad/pseudo_std8_train:  5.62332; grad/diff8_train:  23022.44014; grad/cos8_train:  0.86578; grad/true_mag9_train:  9.36954; grad/pseudo_mag9_train:  22050.34707; grad/true_std9_train:  0.00229; grad/pseudo_std9_train:  5.38337; grad/diff9_train:  22041.90044; grad/cos9_train:  0.89415; grad/true_mag10_train:  10.77118; grad/pseudo_mag10_train:  21956.15410; grad/true_std10_train:  0.00263; grad/pseudo_std10_train:  5.36037; grad/diff10_train:  21946.56831; grad/cos10_train:  0.88190; grad/true_mag11_train:  12.63338; grad/pseudo_mag11_train:  22664.04004; grad/true_std11_train:  0.00308; grad/pseudo_std11_train:  5.53305; grad/diff11_train:  22653.59453; grad/cos11_train:  0.81336; grad/true_mag12_train:  8.60181; grad/pseudo_mag12_train:  22104.85322; grad/true_std12_train:  0.00210; grad/pseudo_std12_train:  5.39668; grad/diff12_train:  22097.41563; grad/cos12_train:  0.85455; grad/true_mag13_train:  9.95119; grad/pseudo_mag13_train:  22046.92461; grad/true_std13_train:  0.00243; grad/pseudo_std13_train:  5.38253; grad/diff13_train:  22038.32930; grad/cos13_train:  0.85399; grad/true_mag14_train:  12.37707; grad/pseudo_mag14_train:  21706.23594; grad/true_std14_train:  0.00302; grad/pseudo_std14_train:  5.29902; grad/diff14_train:  21696.75459; grad/cos14_train:  0.75273; grad/true_mag15_train:  7.93571; grad/pseudo_mag15_train:  21870.87939; grad/true_std15_train:  0.00194; grad/pseudo_std15_train:  5.33952; grad/diff15_train:  21864.32871; grad/cos15_train:  0.81563; grad/true_mag16_train:  14.43391; grad/pseudo_mag16_train:  22030.04053; grad/true_std16_train:  0.00352; grad/pseudo_std16_train:  5.37838; grad/diff16_train:  22022.36797; grad/cos16_train:  0.53754; grad/true_mag17_train:  19.84751; grad/pseudo_mag17_train:  18763.99609; grad/true_std17_train:  0.00485; grad/pseudo_std17_train:  4.57587; grad/diff17_train:  18753.64775; grad/cos17_train:  0.51699; grad_train:  6773.19238; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00011; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:22:00,106][trainer][INFO] - Step 230:
[2025-04-24 22:22:00,106][trainer][INFO] - loss/edit_train:  11.03600; loss/loc_train:  0.39511; edit/acc_train:  0.02000; edit/log_prob_train: -11.03600; edit/prob_train:  0.29027; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.22358; perplexity/pre_train:  68.27773; nll/post_train:  4.63871; perplexity/post_train:  103.41041; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.23245; loss/total_train:  1.49871; loss/total_edit_train:  1.49871; memory/alloc_max_train:  41026850918.40000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  7.32653; grad/pseudo_mag0_train:  17618.22900; grad/true_std0_train:  0.00179; grad/pseudo_std0_train:  4.30128; grad/diff0_train:  17612.37324; grad/cos0_train:  0.79506; grad/true_mag1_train:  11.01759; grad/pseudo_mag1_train:  18258.42021; grad/true_std1_train:  0.00269; grad/pseudo_std1_train:  4.45755; grad/diff1_train:  18249.44580; grad/cos1_train:  0.81001; grad/true_mag2_train:  14.50268; grad/pseudo_mag2_train:  18942.54414; grad/true_std2_train:  0.00354; grad/pseudo_std2_train:  4.62352; grad/diff2_train:  18930.98496; grad/cos2_train:  0.78842; grad/true_mag3_train:  8.53104; grad/pseudo_mag3_train:  18726.48613; grad/true_std3_train:  0.00208; grad/pseudo_std3_train:  4.57189; grad/diff3_train:  18719.10840; grad/cos3_train:  0.86060; grad/true_mag4_train:  10.71818; grad/pseudo_mag4_train:  18774.63086; grad/true_std4_train:  0.00262; grad/pseudo_std4_train:  4.58363; grad/diff4_train:  18765.39199; grad/cos4_train:  0.85807; grad/true_mag5_train:  13.63234; grad/pseudo_mag5_train:  20342.76162; grad/true_std5_train:  0.00333; grad/pseudo_std5_train:  4.96592; grad/diff5_train:  20331.27656; grad/cos5_train:  0.83287; grad/true_mag6_train:  8.44325; grad/pseudo_mag6_train:  19180.94141; grad/true_std6_train:  0.00206; grad/pseudo_std6_train:  4.68284; grad/diff6_train:  19173.37344; grad/cos6_train:  0.89298; grad/true_mag7_train:  10.01768; grad/pseudo_mag7_train:  19410.54072; grad/true_std7_train:  0.00245; grad/pseudo_std7_train:  4.73889; grad/diff7_train:  19401.68340; grad/cos7_train:  0.87940; grad/true_mag8_train:  12.79041; grad/pseudo_mag8_train:  21557.80381; grad/true_std8_train:  0.00312; grad/pseudo_std8_train:  5.26300; grad/diff8_train:  21546.74365; grad/cos8_train:  0.86310; grad/true_mag9_train:  7.95848; grad/pseudo_mag9_train:  18489.60000; grad/true_std9_train:  0.00194; grad/pseudo_std9_train:  4.51405; grad/diff9_train:  18482.52881; grad/cos9_train:  0.88406; grad/true_mag10_train:  10.91601; grad/pseudo_mag10_train:  18582.88203; grad/true_std10_train:  0.00267; grad/pseudo_std10_train:  4.53682; grad/diff10_train:  18574.36445; grad/cos10_train:  0.83600; grad/true_mag11_train:  11.68182; grad/pseudo_mag11_train:  20349.62822; grad/true_std11_train:  0.00285; grad/pseudo_std11_train:  4.96799; grad/diff11_train:  20340.10762; grad/cos11_train:  0.80808; grad/true_mag12_train:  7.44901; grad/pseudo_mag12_train:  18465.85791; grad/true_std12_train:  0.00182; grad/pseudo_std12_train:  4.50825; grad/diff12_train:  18459.62002; grad/cos12_train:  0.82922; grad/true_mag13_train:  8.80663; grad/pseudo_mag13_train:  18448.74688; grad/true_std13_train:  0.00215; grad/pseudo_std13_train:  4.50407; grad/diff13_train:  18441.35693; grad/cos13_train:  0.83398; grad/true_mag14_train:  11.41654; grad/pseudo_mag14_train:  18984.35957; grad/true_std14_train:  0.00279; grad/pseudo_std14_train:  4.63448; grad/diff14_train:  18975.91689; grad/cos14_train:  0.73395; grad/true_mag15_train:  7.16052; grad/pseudo_mag15_train:  18263.21660; grad/true_std15_train:  0.00175; grad/pseudo_std15_train:  4.45874; grad/diff15_train:  18257.58086; grad/cos15_train:  0.78382; grad/true_mag16_train:  14.41961; grad/pseudo_mag16_train:  18457.15996; grad/true_std16_train:  0.00352; grad/pseudo_std16_train:  4.50609; grad/diff16_train:  18450.35225; grad/cos16_train:  0.48690; grad/true_mag17_train:  19.91846; grad/pseudo_mag17_train:  17226.94189; grad/true_std17_train:  0.00486; grad/pseudo_std17_train:  4.19881; grad/diff17_train:  17217.45781; grad/cos17_train:  0.47773; grad_train:  4592.59277; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00011; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:22:03,309][trainer][INFO] - Step 240:
[2025-04-24 22:22:03,309][trainer][INFO] - loss/edit_train:  13.54210; loss/loc_train:  0.15832; edit/acc_train:  0.03250; edit/log_prob_train: -13.54210; edit/prob_train:  0.30063; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.93170; perplexity/pre_train:  50.99347; nll/post_train:  4.21065; perplexity/post_train:  67.40007; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.18075; loss/total_train:  1.51253; loss/total_edit_train:  1.51253; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  9.26485; grad/pseudo_mag0_train:  22728.02871; grad/true_std0_train:  0.00226; grad/pseudo_std0_train:  5.54877; grad/diff0_train:  22720.56758; grad/cos0_train:  0.79901; grad/true_mag1_train:  13.10627; grad/pseudo_mag1_train:  22325.10859; grad/true_std1_train:  0.00320; grad/pseudo_std1_train:  5.45037; grad/diff1_train:  22314.24414; grad/cos1_train:  0.82048; grad/true_mag2_train:  16.94592; grad/pseudo_mag2_train:  22458.57959; grad/true_std2_train:  0.00414; grad/pseudo_std2_train:  5.48161; grad/diff2_train:  22444.92656; grad/cos2_train:  0.79201; grad/true_mag3_train:  10.76382; grad/pseudo_mag3_train:  24072.26387; grad/true_std3_train:  0.00263; grad/pseudo_std3_train:  5.87699; grad/diff3_train:  24062.91006; grad/cos3_train:  0.86043; grad/true_mag4_train:  13.40067; grad/pseudo_mag4_train:  24033.40449; grad/true_std4_train:  0.00327; grad/pseudo_std4_train:  5.86749; grad/diff4_train:  24021.66074; grad/cos4_train:  0.86698; grad/true_mag5_train:  16.20981; grad/pseudo_mag5_train:  24291.45693; grad/true_std5_train:  0.00396; grad/pseudo_std5_train:  5.92980; grad/diff5_train:  24277.59873; grad/cos5_train:  0.83997; grad/true_mag6_train:  10.89756; grad/pseudo_mag6_train:  24835.24492; grad/true_std6_train:  0.00266; grad/pseudo_std6_train:  6.06328; grad/diff6_train:  24825.37568; grad/cos6_train:  0.89878; grad/true_mag7_train:  12.52890; grad/pseudo_mag7_train:  24708.65400; grad/true_std7_train:  0.00306; grad/pseudo_std7_train:  6.03236; grad/diff7_train:  24697.44111; grad/cos7_train:  0.88354; grad/true_mag8_train:  14.18962; grad/pseudo_mag8_train:  25551.96162; grad/true_std8_train:  0.00346; grad/pseudo_std8_train:  6.23811; grad/diff8_train:  25539.28701; grad/cos8_train:  0.87765; grad/true_mag9_train:  10.53323; grad/pseudo_mag9_train:  24751.69834; grad/true_std9_train:  0.00257; grad/pseudo_std9_train:  6.04288; grad/diff9_train:  24742.16738; grad/cos9_train:  0.89695; grad/true_mag10_train:  12.05927; grad/pseudo_mag10_train:  24866.05459; grad/true_std10_train:  0.00294; grad/pseudo_std10_train:  6.07079; grad/diff10_train:  24855.23564; grad/cos10_train:  0.88565; grad/true_mag11_train:  13.80883; grad/pseudo_mag11_train:  25032.21504; grad/true_std11_train:  0.00337; grad/pseudo_std11_train:  6.11122; grad/diff11_train:  25020.49629; grad/cos11_train:  0.82823; grad/true_mag12_train:  9.52413; grad/pseudo_mag12_train:  24418.05908; grad/true_std12_train:  0.00233; grad/pseudo_std12_train:  5.96142; grad/diff12_train:  24409.80537; grad/cos12_train:  0.85027; grad/true_mag13_train:  10.93682; grad/pseudo_mag13_train:  24305.29785; grad/true_std13_train:  0.00267; grad/pseudo_std13_train:  5.93389; grad/diff13_train:  24295.81611; grad/cos13_train:  0.85321; grad/true_mag14_train:  13.39900; grad/pseudo_mag14_train:  23546.15850; grad/true_std14_train:  0.00327; grad/pseudo_std14_train:  5.74818; grad/diff14_train:  23535.71719; grad/cos14_train:  0.76007; grad/true_mag15_train:  8.44297; grad/pseudo_mag15_train:  22734.81006; grad/true_std15_train:  0.00206; grad/pseudo_std15_train:  5.55043; grad/diff15_train:  22727.91689; grad/cos15_train:  0.80202; grad/true_mag16_train:  16.08046; grad/pseudo_mag16_train:  22715.56230; grad/true_std16_train:  0.00393; grad/pseudo_std16_train:  5.54571; grad/diff16_train:  22707.71660; grad/cos16_train:  0.49064; grad/true_mag17_train:  21.25013; grad/pseudo_mag17_train:  19718.58750; grad/true_std17_train:  0.00519; grad/pseudo_std17_train:  4.80666; grad/diff17_train:  19707.76240; grad/cos17_train:  0.50534; grad_train:  3009.57349; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00011; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00008; lr/lr13_train:  0.00008; lr/lr14_train:  0.00008; lr/lr15_train:  0.00008; lr/lr16_train:  0.00008; lr/lr17_train:  0.00008
[2025-04-24 22:22:06,559][trainer][INFO] - Step 250:
[2025-04-24 22:22:06,559][trainer][INFO] - loss/edit_train:  13.16243; loss/loc_train:  0.20827; edit/acc_train:  0.09429; edit/log_prob_train: -13.16243; edit/prob_train:  0.27649; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.72930; perplexity/pre_train:  113.21600; nll/post_train:  4.74739; perplexity/post_train:  115.28329; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.18258; loss/total_train:  1.52451; loss/total_edit_train:  1.52451; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.19771; grad/pseudo_mag0_train:  19435.95049; grad/true_std0_train:  0.00200; grad/pseudo_std0_train:  4.74497; grad/diff0_train:  19429.37461; grad/cos0_train:  0.79738; grad/true_mag1_train:  11.87432; grad/pseudo_mag1_train:  19344.68828; grad/true_std1_train:  0.00290; grad/pseudo_std1_train:  4.72264; grad/diff1_train:  19335.04189; grad/cos1_train:  0.80797; grad/true_mag2_train:  14.62465; grad/pseudo_mag2_train:  19841.12490; grad/true_std2_train:  0.00357; grad/pseudo_std2_train:  4.84232; grad/diff2_train:  19829.41494; grad/cos2_train:  0.79111; grad/true_mag3_train:  9.23774; grad/pseudo_mag3_train:  20017.05889; grad/true_std3_train:  0.00226; grad/pseudo_std3_train:  4.88693; grad/diff3_train:  20009.13154; grad/cos3_train:  0.85269; grad/true_mag4_train:  11.55704; grad/pseudo_mag4_train:  20006.67705; grad/true_std4_train:  0.00282; grad/pseudo_std4_train:  4.88437; grad/diff4_train:  19996.73359; grad/cos4_train:  0.85505; grad/true_mag5_train:  13.85254; grad/pseudo_mag5_train:  20704.75527; grad/true_std5_train:  0.00338; grad/pseudo_std5_train:  5.05395; grad/diff5_train:  20693.19502; grad/cos5_train:  0.82367; grad/true_mag6_train:  9.27060; grad/pseudo_mag6_train:  20841.96802; grad/true_std6_train:  0.00226; grad/pseudo_std6_train:  5.08834; grad/diff6_train:  20833.65381; grad/cos6_train:  0.89170; grad/true_mag7_train:  10.82908; grad/pseudo_mag7_train:  20737.42031; grad/true_std7_train:  0.00264; grad/pseudo_std7_train:  5.06282; grad/diff7_train:  20727.86494; grad/cos7_train:  0.87474; grad/true_mag8_train:  12.43826; grad/pseudo_mag8_train:  21754.10801; grad/true_std8_train:  0.00304; grad/pseudo_std8_train:  5.31089; grad/diff8_train:  21743.25957; grad/cos8_train:  0.86062; grad/true_mag9_train:  8.91647; grad/pseudo_mag9_train:  20551.23447; grad/true_std9_train:  0.00218; grad/pseudo_std9_train:  5.01737; grad/diff9_train:  20543.24443; grad/cos9_train:  0.89018; grad/true_mag10_train:  10.34739; grad/pseudo_mag10_train:  20601.30400; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  5.02959; grad/diff10_train:  20592.17305; grad/cos10_train:  0.87511; grad/true_mag11_train:  12.48549; grad/pseudo_mag11_train:  21548.75078; grad/true_std11_train:  0.00305; grad/pseudo_std11_train:  5.26068; grad/diff11_train:  21538.59863; grad/cos11_train:  0.80004; grad/true_mag12_train:  8.17480; grad/pseudo_mag12_train:  20559.21475; grad/true_std12_train:  0.00200; grad/pseudo_std12_train:  5.01932; grad/diff12_train:  20552.21270; grad/cos12_train:  0.85006; grad/true_mag13_train:  9.54491; grad/pseudo_mag13_train:  20543.60186; grad/true_std13_train:  0.00233; grad/pseudo_std13_train:  5.01550; grad/diff13_train:  20535.49414; grad/cos13_train:  0.84148; grad/true_mag14_train:  12.31127; grad/pseudo_mag14_train:  20798.01133; grad/true_std14_train:  0.00301; grad/pseudo_std14_train:  5.07705; grad/diff14_train:  20788.81562; grad/cos14_train:  0.73549; grad/true_mag15_train:  7.73645; grad/pseudo_mag15_train:  20362.78516; grad/true_std15_train:  0.00189; grad/pseudo_std15_train:  4.97131; grad/diff15_train:  20356.54912; grad/cos15_train:  0.79908; grad/true_mag16_train:  15.17742; grad/pseudo_mag16_train:  20918.52627; grad/true_std16_train:  0.00371; grad/pseudo_std16_train:  5.10697; grad/diff16_train:  20911.04521; grad/cos16_train:  0.49528; grad/true_mag17_train:  20.61127; grad/pseudo_mag17_train:  19241.08086; grad/true_std17_train:  0.00503; grad/pseudo_std17_train:  4.68841; grad/diff17_train:  19230.72715; grad/cos17_train:  0.49848; grad_train:  4005.36401; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00011; lr/lr6_train:  0.00009; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00008
[2025-04-24 22:22:10,140][trainer][INFO] - Step 260:
[2025-04-24 22:22:10,140][trainer][INFO] - loss/edit_train:  14.23852; loss/loc_train:  0.26335; edit/acc_train:  0.00000; edit/log_prob_train: -14.23852; edit/prob_train:  0.27636; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.90977; perplexity/pre_train:  49.88722; nll/post_train:  4.01577; perplexity/post_train:  55.46619; n_tokens/pre_train:  4.80000; n_tokens/post_train:  4.80000; time/edit_train:  0.22080; loss/total_train:  1.68720; loss/total_edit_train:  1.68720; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  10.14402; grad/pseudo_mag0_train:  24447.40732; grad/true_std0_train:  0.00248; grad/pseudo_std0_train:  5.96851; grad/diff0_train:  24439.18516; grad/cos0_train:  0.80788; grad/true_mag1_train:  14.23114; grad/pseudo_mag1_train:  23887.00264; grad/true_std1_train:  0.00347; grad/pseudo_std1_train:  5.83166; grad/diff1_train:  23875.24121; grad/cos1_train:  0.82241; grad/true_mag2_train:  18.58923; grad/pseudo_mag2_train:  24784.91904; grad/true_std2_train:  0.00454; grad/pseudo_std2_train:  6.04969; grad/diff2_train:  24769.72910; grad/cos2_train:  0.81440; grad/true_mag3_train:  11.63443; grad/pseudo_mag3_train:  26035.21064; grad/true_std3_train:  0.00284; grad/pseudo_std3_train:  6.35621; grad/diff3_train:  26025.06318; grad/cos3_train:  0.86844; grad/true_mag4_train:  14.49655; grad/pseudo_mag4_train:  25698.23252; grad/true_std4_train:  0.00354; grad/pseudo_std4_train:  6.27393; grad/diff4_train:  25685.57520; grad/cos4_train:  0.87000; grad/true_mag5_train:  17.50789; grad/pseudo_mag5_train:  26789.11250; grad/true_std5_train:  0.00427; grad/pseudo_std5_train:  6.53962; grad/diff5_train:  26773.94990; grad/cos5_train:  0.85249; grad/true_mag6_train:  11.74362; grad/pseudo_mag6_train:  26630.12578; grad/true_std6_train:  0.00287; grad/pseudo_std6_train:  6.50147; grad/diff6_train:  26619.50283; grad/cos6_train:  0.90202; grad/true_mag7_train:  13.55310; grad/pseudo_mag7_train:  26561.73301; grad/true_std7_train:  0.00331; grad/pseudo_std7_train:  6.48477; grad/diff7_train:  26549.57324; grad/cos7_train:  0.89261; grad/true_mag8_train:  15.72111; grad/pseudo_mag8_train:  28202.12256; grad/true_std8_train:  0.00384; grad/pseudo_std8_train:  6.88514; grad/diff8_train:  28188.08564; grad/cos8_train:  0.88495; grad/true_mag9_train:  11.28240; grad/pseudo_mag9_train:  26318.68340; grad/true_std9_train:  0.00275; grad/pseudo_std9_train:  6.42544; grad/diff9_train:  26308.42305; grad/cos9_train:  0.90512; grad/true_mag10_train:  13.15069; grad/pseudo_mag10_train:  26215.47490; grad/true_std10_train:  0.00321; grad/pseudo_std10_train:  6.40024; grad/diff10_train:  26203.91943; grad/cos10_train:  0.88187; grad/true_mag11_train:  14.89026; grad/pseudo_mag11_train:  27251.65518; grad/true_std11_train:  0.00364; grad/pseudo_std11_train:  6.65305; grad/diff11_train:  27238.88955; grad/cos11_train:  0.84481; grad/true_mag12_train:  10.34847; grad/pseudo_mag12_train:  26519.50244; grad/true_std12_train:  0.00253; grad/pseudo_std12_train:  6.47445; grad/diff12_train:  26510.43779; grad/cos12_train:  0.86869; grad/true_mag13_train:  11.95471; grad/pseudo_mag13_train:  26329.39961; grad/true_std13_train:  0.00292; grad/pseudo_std13_train:  6.42804; grad/diff13_train:  26319.01318; grad/cos13_train:  0.86564; grad/true_mag14_train:  14.49636; grad/pseudo_mag14_train:  26255.89980; grad/true_std14_train:  0.00354; grad/pseudo_std14_train:  6.40973; grad/diff14_train:  26244.35234; grad/cos14_train:  0.78684; grad/true_mag15_train:  8.89448; grad/pseudo_mag15_train:  24271.47705; grad/true_std15_train:  0.00217; grad/pseudo_std15_train:  5.92558; grad/diff15_train:  24264.12139; grad/cos15_train:  0.81984; grad/true_mag16_train:  15.51400; grad/pseudo_mag16_train:  25007.96582; grad/true_std16_train:  0.00379; grad/pseudo_std16_train:  6.10539; grad/diff16_train:  24999.37207; grad/cos16_train:  0.55460; grad/true_mag17_train:  21.68682; grad/pseudo_mag17_train:  21883.32129; grad/true_std17_train:  0.00529; grad/pseudo_std17_train:  5.33477; grad/diff17_train:  21871.56475; grad/cos17_train:  0.53809; grad_train:  4055.74414; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00008; lr/lr11_train:  0.00008; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:22:13,449][trainer][INFO] - Step 270:
[2025-04-24 22:22:13,449][trainer][INFO] - loss/edit_train:  9.38339; loss/loc_train:  0.15331; edit/acc_train:  0.15033; edit/log_prob_train: -9.38339; edit/prob_train:  0.37026; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.65932; perplexity/pre_train:  38.83504; nll/post_train:  3.93881; perplexity/post_train:  51.35736; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.18667; loss/total_train:  1.09165; loss/total_edit_train:  1.09165; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.76378; grad/pseudo_mag0_train:  20464.01836; grad/true_std0_train:  0.00214; grad/pseudo_std0_train:  4.99599; grad/diff0_train:  20457.04238; grad/cos0_train:  0.79147; grad/true_mag1_train:  12.47082; grad/pseudo_mag1_train:  20528.15127; grad/true_std1_train:  0.00304; grad/pseudo_std1_train:  5.01164; grad/diff1_train:  20517.99307; grad/cos1_train:  0.80926; grad/true_mag2_train:  16.16492; grad/pseudo_mag2_train:  21175.12520; grad/true_std2_train:  0.00395; grad/pseudo_std2_train:  5.16782; grad/diff2_train:  21162.27061; grad/cos2_train:  0.78282; grad/true_mag3_train:  10.10915; grad/pseudo_mag3_train:  22358.02539; grad/true_std3_train:  0.00247; grad/pseudo_std3_train:  5.45847; grad/diff3_train:  22349.23926; grad/cos3_train:  0.86465; grad/true_mag4_train:  12.32922; grad/pseudo_mag4_train:  21910.17393; grad/true_std4_train:  0.00301; grad/pseudo_std4_train:  5.34912; grad/diff4_train:  21899.41719; grad/cos4_train:  0.86705; grad/true_mag5_train:  14.74570; grad/pseudo_mag5_train:  22720.04678; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  5.54584; grad/diff5_train:  22707.47998; grad/cos5_train:  0.83983; grad/true_mag6_train:  10.27532; grad/pseudo_mag6_train:  23146.23516; grad/true_std6_train:  0.00251; grad/pseudo_std6_train:  5.65093; grad/diff6_train:  23136.94463; grad/cos6_train:  0.90189; grad/true_mag7_train:  11.84954; grad/pseudo_mag7_train:  22986.83555; grad/true_std7_train:  0.00289; grad/pseudo_std7_train:  5.61201; grad/diff7_train:  22976.26074; grad/cos7_train:  0.88788; grad/true_mag8_train:  13.37767; grad/pseudo_mag8_train:  23864.20762; grad/true_std8_train:  0.00327; grad/pseudo_std8_train:  5.82603; grad/diff8_train:  23852.36182; grad/cos8_train:  0.87668; grad/true_mag9_train:  9.92957; grad/pseudo_mag9_train:  23058.87227; grad/true_std9_train:  0.00242; grad/pseudo_std9_train:  5.62960; grad/diff9_train:  23049.85986; grad/cos9_train:  0.90396; grad/true_mag10_train:  11.35918; grad/pseudo_mag10_train:  23043.47998; grad/true_std10_train:  0.00277; grad/pseudo_std10_train:  5.62584; grad/diff10_train:  23033.31221; grad/cos10_train:  0.89032; grad/true_mag11_train:  13.12187; grad/pseudo_mag11_train:  23532.68848; grad/true_std11_train:  0.00320; grad/pseudo_std11_train:  5.74501; grad/diff11_train:  23521.76377; grad/cos11_train:  0.82209; grad/true_mag12_train:  9.24623; grad/pseudo_mag12_train:  23564.19785; grad/true_std12_train:  0.00226; grad/pseudo_std12_train:  5.75297; grad/diff12_train:  23556.12656; grad/cos12_train:  0.86316; grad/true_mag13_train:  10.73107; grad/pseudo_mag13_train:  23888.76826; grad/true_std13_train:  0.00262; grad/pseudo_std13_train:  5.83220; grad/diff13_train:  23879.37275; grad/cos13_train:  0.86754; grad/true_mag14_train:  12.89383; grad/pseudo_mag14_train:  23680.92471; grad/true_std14_train:  0.00315; grad/pseudo_std14_train:  5.78085; grad/diff14_train:  23670.76270; grad/cos14_train:  0.77219; grad/true_mag15_train:  8.21706; grad/pseudo_mag15_train:  22309.76641; grad/true_std15_train:  0.00201; grad/pseudo_std15_train:  5.44667; grad/diff15_train:  22302.98779; grad/cos15_train:  0.81424; grad/true_mag16_train:  15.05209; grad/pseudo_mag16_train:  23213.17051; grad/true_std16_train:  0.00367; grad/pseudo_std16_train:  5.66723; grad/diff16_train:  23205.20469; grad/cos16_train:  0.51939; grad/true_mag17_train:  20.18181; grad/pseudo_mag17_train:  20181.76055; grad/true_std17_train:  0.00493; grad/pseudo_std17_train:  4.91683; grad/diff17_train:  20171.42139; grad/cos17_train:  0.50185; grad_train:  2474.22974; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00008; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:22:16,744][trainer][INFO] - Step 280:
[2025-04-24 22:22:16,744][trainer][INFO] - loss/edit_train:  13.70692; loss/loc_train:  0.21153; edit/acc_train:  0.03571; edit/log_prob_train: -13.70692; edit/prob_train:  0.24065; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.85321; perplexity/pre_train:  47.14412; nll/post_train:  4.08381; perplexity/post_train:  59.37126; n_tokens/pre_train:  6.30000; n_tokens/post_train:  6.30000; time/edit_train:  0.18654; loss/total_train:  1.58222; loss/total_edit_train:  1.58222; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  7.69266; grad/pseudo_mag0_train:  18586.74844; grad/true_std0_train:  0.00188; grad/pseudo_std0_train:  4.53771; grad/diff0_train:  18580.55527; grad/cos0_train:  0.80267; grad/true_mag1_train:  11.10002; grad/pseudo_mag1_train:  18416.34785; grad/true_std1_train:  0.00271; grad/pseudo_std1_train:  4.49604; grad/diff1_train:  18407.26562; grad/cos1_train:  0.81538; grad/true_mag2_train:  13.77494; grad/pseudo_mag2_train:  18917.59570; grad/true_std2_train:  0.00336; grad/pseudo_std2_train:  4.61629; grad/diff2_train:  18906.64258; grad/cos2_train:  0.78975; grad/true_mag3_train:  8.71955; grad/pseudo_mag3_train:  19023.74580; grad/true_std3_train:  0.00213; grad/pseudo_std3_train:  4.64445; grad/diff3_train:  19016.21162; grad/cos3_train:  0.86119; grad/true_mag4_train:  10.89599; grad/pseudo_mag4_train:  18929.80967; grad/true_std4_train:  0.00266; grad/pseudo_std4_train:  4.62149; grad/diff4_train:  18920.34658; grad/cos4_train:  0.86499; grad/true_mag5_train:  13.15840; grad/pseudo_mag5_train:  19863.14902; grad/true_std5_train:  0.00321; grad/pseudo_std5_train:  4.84813; grad/diff5_train:  19852.10938; grad/cos5_train:  0.83267; grad/true_mag6_train:  8.76994; grad/pseudo_mag6_train:  19527.07480; grad/true_std6_train:  0.00214; grad/pseudo_std6_train:  4.76734; grad/diff6_train:  19519.18965; grad/cos6_train:  0.89705; grad/true_mag7_train:  10.13902; grad/pseudo_mag7_train:  19428.06172; grad/true_std7_train:  0.00248; grad/pseudo_std7_train:  4.74316; grad/diff7_train:  19419.06006; grad/cos7_train:  0.88389; grad/true_mag8_train:  11.74599; grad/pseudo_mag8_train:  20496.59492; grad/true_std8_train:  0.00287; grad/pseudo_std8_train:  5.00382; grad/diff8_train:  20486.31348; grad/cos8_train:  0.86858; grad/true_mag9_train:  8.39964; grad/pseudo_mag9_train:  19403.74092; grad/true_std9_train:  0.00205; grad/pseudo_std9_train:  4.73723; grad/diff9_train:  19396.18154; grad/cos9_train:  0.89715; grad/true_mag10_train:  9.79321; grad/pseudo_mag10_train:  19308.11543; grad/true_std10_train:  0.00239; grad/pseudo_std10_train:  4.71387; grad/diff10_train:  19299.50859; grad/cos10_train:  0.87730; grad/true_mag11_train:  11.56845; grad/pseudo_mag11_train:  20401.41143; grad/true_std11_train:  0.00282; grad/pseudo_std11_train:  4.98056; grad/diff11_train:  20391.85645; grad/cos11_train:  0.81864; grad/true_mag12_train:  8.00090; grad/pseudo_mag12_train:  20123.70020; grad/true_std12_train:  0.00195; grad/pseudo_std12_train:  4.91299; grad/diff12_train:  20116.82559; grad/cos12_train:  0.85424; grad/true_mag13_train:  8.98191; grad/pseudo_mag13_train:  19844.62500; grad/true_std13_train:  0.00219; grad/pseudo_std13_train:  4.84486; grad/diff13_train:  19836.86631; grad/cos13_train:  0.85859; grad/true_mag14_train:  11.68328; grad/pseudo_mag14_train:  20320.18369; grad/true_std14_train:  0.00285; grad/pseudo_std14_train:  4.96032; grad/diff14_train:  20311.26143; grad/cos14_train:  0.75813; grad/true_mag15_train:  7.49510; grad/pseudo_mag15_train:  20482.23115; grad/true_std15_train:  0.00183; grad/pseudo_std15_train:  5.00047; grad/diff15_train:  20476.05059; grad/cos15_train:  0.81946; grad/true_mag16_train:  14.03735; grad/pseudo_mag16_train:  20336.33770; grad/true_std16_train:  0.00343; grad/pseudo_std16_train:  4.96486; grad/diff16_train:  20329.31523; grad/cos16_train:  0.50197; grad/true_mag17_train:  19.46425; grad/pseudo_mag17_train:  18316.93691; grad/true_std17_train:  0.00475; grad/pseudo_std17_train:  4.46213; grad/diff17_train:  18307.19551; grad/cos17_train:  0.50041; grad_train:  3395.10962; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:22:20,339][trainer][INFO] - Step 290:
[2025-04-24 22:22:20,340][trainer][INFO] - loss/edit_train:  10.06698; loss/loc_train:  0.10432; edit/acc_train:  0.07012; edit/log_prob_train: -10.06698; edit/prob_train:  0.37547; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.59004; perplexity/pre_train:  36.23550; nll/post_train:  3.80047; perplexity/post_train:  44.72210; n_tokens/pre_train:  8.40000; n_tokens/post_train:  8.40000; time/edit_train:  0.21931; loss/total_train:  1.11102; loss/total_edit_train:  1.11102; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  9.88516; grad/pseudo_mag0_train:  23038.80273; grad/true_std0_train:  0.00241; grad/pseudo_std0_train:  5.62460; grad/diff0_train:  23030.91934; grad/cos0_train:  0.79851; grad/true_mag1_train:  13.45402; grad/pseudo_mag1_train:  22377.45322; grad/true_std1_train:  0.00328; grad/pseudo_std1_train:  5.46312; grad/diff1_train:  22366.32793; grad/cos1_train:  0.82336; grad/true_mag2_train:  17.43603; grad/pseudo_mag2_train:  22957.22871; grad/true_std2_train:  0.00426; grad/pseudo_std2_train:  5.60268; grad/diff2_train:  22943.04688; grad/cos2_train:  0.80716; grad/true_mag3_train:  10.88740; grad/pseudo_mag3_train:  24150.03770; grad/true_std3_train:  0.00266; grad/pseudo_std3_train:  5.89597; grad/diff3_train:  24140.54434; grad/cos3_train:  0.87001; grad/true_mag4_train:  13.24371; grad/pseudo_mag4_train:  23507.67695; grad/true_std4_train:  0.00323; grad/pseudo_std4_train:  5.73913; grad/diff4_train:  23496.06250; grad/cos4_train:  0.87388; grad/true_mag5_train:  15.91787; grad/pseudo_mag5_train:  24310.04854; grad/true_std5_train:  0.00389; grad/pseudo_std5_train:  5.93398; grad/diff5_train:  24296.39121; grad/cos5_train:  0.85085; grad/true_mag6_train:  11.04971; grad/pseudo_mag6_train:  24889.99766; grad/true_std6_train:  0.00270; grad/pseudo_std6_train:  6.07663; grad/diff6_train:  24880.02754; grad/cos6_train:  0.90186; grad/true_mag7_train:  12.67554; grad/pseudo_mag7_train:  24559.83340; grad/true_std7_train:  0.00309; grad/pseudo_std7_train:  5.99601; grad/diff7_train:  24548.51309; grad/cos7_train:  0.89175; grad/true_mag8_train:  14.35674; grad/pseudo_mag8_train:  25880.90684; grad/true_std8_train:  0.00351; grad/pseudo_std8_train:  6.31840; grad/diff8_train:  25868.03340; grad/cos8_train:  0.88934; grad/true_mag9_train:  10.78639; grad/pseudo_mag9_train:  25004.93711; grad/true_std9_train:  0.00263; grad/pseudo_std9_train:  6.10469; grad/diff9_train:  24995.13398; grad/cos9_train:  0.90807; grad/true_mag10_train:  12.31192; grad/pseudo_mag10_train:  25129.76465; grad/true_std10_train:  0.00301; grad/pseudo_std10_train:  6.13517; grad/diff10_train:  25118.67637; grad/cos10_train:  0.89870; grad/true_mag11_train:  14.20285; grad/pseudo_mag11_train:  25868.74727; grad/true_std11_train:  0.00347; grad/pseudo_std11_train:  6.31539; grad/diff11_train:  25856.63184; grad/cos11_train:  0.84634; grad/true_mag12_train:  9.92457; grad/pseudo_mag12_train:  25048.02305; grad/true_std12_train:  0.00242; grad/pseudo_std12_train:  6.11520; grad/diff12_train:  25039.36016; grad/cos12_train:  0.87112; grad/true_mag13_train:  11.54542; grad/pseudo_mag13_train:  25413.22813; grad/true_std13_train:  0.00282; grad/pseudo_std13_train:  6.20434; grad/diff13_train:  25403.14805; grad/cos13_train:  0.87212; grad/true_mag14_train:  13.68094; grad/pseudo_mag14_train:  24845.67676; grad/true_std14_train:  0.00334; grad/pseudo_std14_train:  6.06531; grad/diff14_train:  24834.74805; grad/cos14_train:  0.79287; grad/true_mag15_train:  8.64614; grad/pseudo_mag15_train:  23678.86309; grad/true_std15_train:  0.00211; grad/pseudo_std15_train:  5.78086; grad/diff15_train:  23671.62246; grad/cos15_train:  0.83673; grad/true_mag16_train:  15.03206; grad/pseudo_mag16_train:  24346.96133; grad/true_std16_train:  0.00367; grad/pseudo_std16_train:  5.94398; grad/diff16_train:  24338.57715; grad/cos16_train:  0.55922; grad/true_mag17_train:  21.20273; grad/pseudo_mag17_train:  21168.67480; grad/true_std17_train:  0.00518; grad/pseudo_std17_train:  5.15902; grad/diff17_train:  21157.52891; grad/cos17_train:  0.52176; grad_train:  1979.12036; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00008; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:22:23,498][trainer][INFO] - Step 300:
[2025-04-24 22:22:23,498][trainer][INFO] - loss/edit_train:  10.66863; loss/loc_train:  0.16131; edit/acc_train:  0.05128; edit/log_prob_train: -10.66863; edit/prob_train:  0.25743; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  1.96768; perplexity/pre_train:  7.15409; nll/post_train:  2.46278; perplexity/post_train:  11.73740; n_tokens/pre_train:  15.70000; n_tokens/post_train:  15.70000; time/edit_train:  0.17583; loss/total_train:  1.22818; loss/total_edit_train:  1.22818; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.48301; grad/pseudo_mag0_train:  20276.29277; grad/true_std0_train:  0.00207; grad/pseudo_std0_train:  4.95017; grad/diff0_train:  20269.48291; grad/cos0_train:  0.80038; grad/true_mag1_train:  12.23991; grad/pseudo_mag1_train:  20295.22559; grad/true_std1_train:  0.00299; grad/pseudo_std1_train:  4.95472; grad/diff1_train:  20285.17021; grad/cos1_train:  0.81689; grad/true_mag2_train:  15.69280; grad/pseudo_mag2_train:  20858.30449; grad/true_std2_train:  0.00383; grad/pseudo_std2_train:  5.09013; grad/diff2_train:  20845.71553; grad/cos2_train:  0.79826; grad/true_mag3_train:  9.74971; grad/pseudo_mag3_train:  20960.58662; grad/true_std3_train:  0.00238; grad/pseudo_std3_train:  5.11731; grad/diff3_train:  20952.16934; grad/cos3_train:  0.85910; grad/true_mag4_train:  12.29882; grad/pseudo_mag4_train:  20969.14824; grad/true_std4_train:  0.00300; grad/pseudo_std4_train:  5.11937; grad/diff4_train:  20958.51025; grad/cos4_train:  0.86195; grad/true_mag5_train:  14.98875; grad/pseudo_mag5_train:  22137.80967; grad/true_std5_train:  0.00366; grad/pseudo_std5_train:  5.40358; grad/diff5_train:  22125.26387; grad/cos5_train:  0.83214; grad/true_mag6_train:  9.75445; grad/pseudo_mag6_train:  21405.53682; grad/true_std6_train:  0.00238; grad/pseudo_std6_train:  5.22593; grad/diff6_train:  21396.82627; grad/cos6_train:  0.89024; grad/true_mag7_train:  11.35460; grad/pseudo_mag7_train:  21365.35283; grad/true_std7_train:  0.00277; grad/pseudo_std7_train:  5.21612; grad/diff7_train:  21355.28066; grad/cos7_train:  0.88371; grad/true_mag8_train:  14.27768; grad/pseudo_mag8_train:  23043.35586; grad/true_std8_train:  0.00349; grad/pseudo_std8_train:  5.62558; grad/diff8_train:  23031.44111; grad/cos8_train:  0.85269; grad/true_mag9_train:  9.66068; grad/pseudo_mag9_train:  21948.91787; grad/true_std9_train:  0.00236; grad/pseudo_std9_train:  5.35861; grad/diff9_train:  21940.25254; grad/cos9_train:  0.89113; grad/true_mag10_train:  12.90279; grad/pseudo_mag10_train:  21795.51475; grad/true_std10_train:  0.00315; grad/pseudo_std10_train:  5.32115; grad/diff10_train:  21785.31562; grad/cos10_train:  0.84536; grad/true_mag11_train:  13.05621; grad/pseudo_mag11_train:  22733.27617; grad/true_std11_train:  0.00319; grad/pseudo_std11_train:  5.54986; grad/diff11_train:  22722.37705; grad/cos11_train:  0.82856; grad/true_mag12_train:  8.77120; grad/pseudo_mag12_train:  21594.05996; grad/true_std12_train:  0.00214; grad/pseudo_std12_train:  5.27197; grad/diff12_train:  21586.56016; grad/cos12_train:  0.84748; grad/true_mag13_train:  10.53608; grad/pseudo_mag13_train:  21623.35732; grad/true_std13_train:  0.00257; grad/pseudo_std13_train:  5.27912; grad/diff13_train:  21614.46963; grad/cos13_train:  0.84194; grad/true_mag14_train:  12.78847; grad/pseudo_mag14_train:  21885.15781; grad/true_std14_train:  0.00312; grad/pseudo_std14_train:  5.34245; grad/diff14_train:  21875.28594; grad/cos14_train:  0.76447; grad/true_mag15_train:  8.07950; grad/pseudo_mag15_train:  21157.46338; grad/true_std15_train:  0.00197; grad/pseudo_std15_train:  5.16533; grad/diff15_train:  21150.85400; grad/cos15_train:  0.81222; grad/true_mag16_train:  14.51747; grad/pseudo_mag16_train:  21346.32695; grad/true_std16_train:  0.00354; grad/pseudo_std16_train:  5.21144; grad/diff16_train:  21338.63301; grad/cos16_train:  0.53920; grad/true_mag17_train:  20.59450; grad/pseudo_mag17_train:  19328.98242; grad/true_std17_train:  0.00503; grad/pseudo_std17_train:  4.70952; grad/diff17_train:  19318.55146; grad/cos17_train:  0.50595; grad_train:  2406.48267; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:22:41,601][trainer][INFO] - Step 300:
[2025-04-24 22:22:41,602][trainer][INFO] - loss/edit_val:  12.72714; loss/loc_val:  0.22239; edit/acc_val:  0.03525; edit/log_prob_val: -12.72714; edit/prob_val:  0.25790; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.68175; perplexity/post_val:  107.95927; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10785; loss/total_val:  1.49511; loss/total_edit_val:  1.49511; memory/alloc_max_val:  41028432896.00000; memory/res_max_val:  44805652480.00000; eval_time/elapsed:  18.09889; eval_time/average:  0.18099
[2025-04-24 22:22:41,605][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:22:41,606][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:23:35,795][trainer][INFO] - Write complete.
[2025-04-24 22:23:39,375][trainer][INFO] - Step 310:
[2025-04-24 22:23:39,375][trainer][INFO] - loss/edit_train:  13.56840; loss/loc_train:  0.19543; edit/acc_train:  0.02527; edit/log_prob_train: -13.56840; edit/prob_train:  0.31165; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.71508; perplexity/pre_train:  41.06169; nll/post_train:  4.03813; perplexity/post_train:  56.72005; n_tokens/pre_train:  5.90000; n_tokens/post_train:  5.90000; time/edit_train:  0.21573; loss/total_train:  1.55227; loss/total_edit_train:  1.55227; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  8.28060; grad/pseudo_mag0_train:  19152.29326; grad/true_std0_train:  0.00202; grad/pseudo_std0_train:  4.67580; grad/diff0_train:  19145.59561; grad/cos0_train:  0.80806; grad/true_mag1_train:  12.23159; grad/pseudo_mag1_train:  19397.52695; grad/true_std1_train:  0.00299; grad/pseudo_std1_train:  4.73562; grad/diff1_train:  19387.51953; grad/cos1_train:  0.81794; grad/true_mag2_train:  15.75388; grad/pseudo_mag2_train:  20056.57031; grad/true_std2_train:  0.00385; grad/pseudo_std2_train:  4.89483; grad/diff2_train:  20043.95762; grad/cos2_train:  0.79952; grad/true_mag3_train:  9.73462; grad/pseudo_mag3_train:  20843.03887; grad/true_std3_train:  0.00238; grad/pseudo_std3_train:  5.08861; grad/diff3_train:  20834.59063; grad/cos3_train:  0.86756; grad/true_mag4_train:  11.96861; grad/pseudo_mag4_train:  20592.86641; grad/true_std4_train:  0.00292; grad/pseudo_std4_train:  5.02753; grad/diff4_train:  20582.40996; grad/cos4_train:  0.87302; grad/true_mag5_train:  14.49303; grad/pseudo_mag5_train:  21545.77305; grad/true_std5_train:  0.00354; grad/pseudo_std5_train:  5.25920; grad/diff5_train:  21533.43809; grad/cos5_train:  0.84990; grad/true_mag6_train:  10.00249; grad/pseudo_mag6_train:  22085.02813; grad/true_std6_train:  0.00244; grad/pseudo_std6_train:  5.39183; grad/diff6_train:  22075.98652; grad/cos6_train:  0.90339; grad/true_mag7_train:  11.54575; grad/pseudo_mag7_train:  21910.10547; grad/true_std7_train:  0.00282; grad/pseudo_std7_train:  5.34912; grad/diff7_train:  21899.79316; grad/cos7_train:  0.89282; grad/true_mag8_train:  13.28756; grad/pseudo_mag8_train:  23104.87500; grad/true_std8_train:  0.00324; grad/pseudo_std8_train:  5.64064; grad/diff8_train:  23093.05137; grad/cos8_train:  0.88860; grad/true_mag9_train:  10.00238; grad/pseudo_mag9_train:  22720.07051; grad/true_std9_train:  0.00244; grad/pseudo_std9_train:  5.54687; grad/diff9_train:  22711.00547; grad/cos9_train:  0.90576; grad/true_mag10_train:  11.38481; grad/pseudo_mag10_train:  22567.10957; grad/true_std10_train:  0.00278; grad/pseudo_std10_train:  5.50952; grad/diff10_train:  22556.89434; grad/cos10_train:  0.89687; grad/true_mag11_train:  13.45459; grad/pseudo_mag11_train:  23445.54238; grad/true_std11_train:  0.00328; grad/pseudo_std11_train:  5.72380; grad/diff11_train:  23434.26230; grad/cos11_train:  0.83660; grad/true_mag12_train:  9.36068; grad/pseudo_mag12_train:  23623.20820; grad/true_std12_train:  0.00229; grad/pseudo_std12_train:  5.76736; grad/diff12_train:  23615.02441; grad/cos12_train:  0.87276; grad/true_mag13_train:  10.84518; grad/pseudo_mag13_train:  23430.34375; grad/true_std13_train:  0.00265; grad/pseudo_std13_train:  5.72027; grad/diff13_train:  23420.93281; grad/cos13_train:  0.86669; grad/true_mag14_train:  13.36771; grad/pseudo_mag14_train:  23237.41328; grad/true_std14_train:  0.00326; grad/pseudo_std14_train:  5.67266; grad/diff14_train:  23226.92109; grad/cos14_train:  0.78364; grad/true_mag15_train:  8.60089; grad/pseudo_mag15_train:  23451.48223; grad/true_std15_train:  0.00210; grad/pseudo_std15_train:  5.72540; grad/diff15_train:  23444.24902; grad/cos15_train:  0.84026; grad/true_mag16_train:  14.62354; grad/pseudo_mag16_train:  24082.64648; grad/true_std16_train:  0.00357; grad/pseudo_std16_train:  5.87948; grad/diff16_train:  24073.98184; grad/cos16_train:  0.59544; grad/true_mag17_train:  21.08871; grad/pseudo_mag17_train:  20973.79063; grad/true_std17_train:  0.00515; grad/pseudo_std17_train:  5.11273; grad/diff17_train:  20962.29258; grad/cos17_train:  0.54491; grad_train:  3130.81421; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:23:42,444][trainer][INFO] - Step 320:
[2025-04-24 22:23:42,444][trainer][INFO] - loss/edit_train:  14.30869; loss/loc_train:  0.12693; edit/acc_train:  0.07050; edit/log_prob_train: -14.30869; edit/prob_train:  0.31820; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.56819; perplexity/pre_train:  96.36956; nll/post_train:  4.78004; perplexity/post_train:  119.10851; n_tokens/pre_train:  6.40000; n_tokens/post_train:  6.40000; time/edit_train:  0.16426; loss/total_train:  1.55780; loss/total_edit_train:  1.55780; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  7.43392; grad/pseudo_mag0_train:  17519.96758; grad/true_std0_train:  0.00181; grad/pseudo_std0_train:  4.27718; grad/diff0_train:  17514.06982; grad/cos0_train:  0.79078; grad/true_mag1_train:  11.06202; grad/pseudo_mag1_train:  17607.67324; grad/true_std1_train:  0.00270; grad/pseudo_std1_train:  4.29852; grad/diff1_train:  17598.78066; grad/cos1_train:  0.80186; grad/true_mag2_train:  14.03132; grad/pseudo_mag2_train:  18019.49854; grad/true_std2_train:  0.00343; grad/pseudo_std2_train:  4.39668; grad/diff2_train:  18008.61689; grad/cos2_train:  0.77426; grad/true_mag3_train:  8.12542; grad/pseudo_mag3_train:  17260.99922; grad/true_std3_train:  0.00198; grad/pseudo_std3_train:  4.21408; grad/diff3_train:  17254.08652; grad/cos3_train:  0.84696; grad/true_mag4_train:  10.57291; grad/pseudo_mag4_train:  17410.12051; grad/true_std4_train:  0.00258; grad/pseudo_std4_train:  4.25044; grad/diff4_train:  17401.16406; grad/cos4_train:  0.84519; grad/true_mag5_train:  12.76510; grad/pseudo_mag5_train:  18221.09551; grad/true_std5_train:  0.00312; grad/pseudo_std5_train:  4.44728; grad/diff5_train:  18210.69600; grad/cos5_train:  0.81092; grad/true_mag6_train:  8.18704; grad/pseudo_mag6_train:  17841.98379; grad/true_std6_train:  0.00200; grad/pseudo_std6_train:  4.35591; grad/diff6_train:  17834.68389; grad/cos6_train:  0.88839; grad/true_mag7_train:  9.94677; grad/pseudo_mag7_train:  18138.04375; grad/true_std7_train:  0.00243; grad/pseudo_std7_train:  4.42820; grad/diff7_train:  18129.37959; grad/cos7_train:  0.86736; grad/true_mag8_train:  11.63150; grad/pseudo_mag8_train:  19605.64492; grad/true_std8_train:  0.00284; grad/pseudo_std8_train:  4.78635; grad/diff8_train:  19595.56631; grad/cos8_train:  0.86099; grad/true_mag9_train:  8.11406; grad/pseudo_mag9_train:  18094.33027; grad/true_std9_train:  0.00198; grad/pseudo_std9_train:  4.41753; grad/diff9_train:  18087.10449; grad/cos9_train:  0.88665; grad/true_mag10_train:  9.62332; grad/pseudo_mag10_train:  18081.87334; grad/true_std10_train:  0.00235; grad/pseudo_std10_train:  4.41449; grad/diff10_train:  18073.54648; grad/cos10_train:  0.86256; grad/true_mag11_train:  11.73409; grad/pseudo_mag11_train:  19863.63545; grad/true_std11_train:  0.00286; grad/pseudo_std11_train:  4.84931; grad/diff11_train:  19854.15781; grad/cos11_train:  0.80177; grad/true_mag12_train:  7.75728; grad/pseudo_mag12_train:  18450.28877; grad/true_std12_train:  0.00189; grad/pseudo_std12_train:  4.50443; grad/diff12_train:  18443.81523; grad/cos12_train:  0.82677; grad/true_mag13_train:  8.98529; grad/pseudo_mag13_train:  18265.41465; grad/true_std13_train:  0.00219; grad/pseudo_std13_train:  4.45929; grad/diff13_train:  18257.97119; grad/cos13_train:  0.82418; grad/true_mag14_train:  12.09718; grad/pseudo_mag14_train:  19144.43428; grad/true_std14_train:  0.00295; grad/pseudo_std14_train:  4.67342; grad/diff14_train:  19135.69219; grad/cos14_train:  0.71856; grad/true_mag15_train:  7.62099; grad/pseudo_mag15_train:  18280.80293; grad/true_std15_train:  0.00186; grad/pseudo_std15_train:  4.46295; grad/diff15_train:  18274.95312; grad/cos15_train:  0.76501; grad/true_mag16_train:  16.18325; grad/pseudo_mag16_train:  18241.93740; grad/true_std16_train:  0.00395; grad/pseudo_std16_train:  4.45347; grad/diff16_train:  18235.14023; grad/cos16_train:  0.42346; grad/true_mag17_train:  22.08218; grad/pseudo_mag17_train:  17955.15645; grad/true_std17_train:  0.00539; grad/pseudo_std17_train:  4.37204; grad/diff17_train:  17945.01328; grad/cos17_train:  0.45810; grad_train:  2883.53613; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:23:45,603][trainer][INFO] - Step 330:
[2025-04-24 22:23:45,604][trainer][INFO] - loss/edit_train:  12.85746; loss/loc_train:  0.18349; edit/acc_train:  0.06078; edit/log_prob_train: -12.85746; edit/prob_train:  0.26725; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.08765; perplexity/pre_train:  59.59959; nll/post_train:  4.35776; perplexity/post_train:  78.08191; n_tokens/pre_train:  8.40000; n_tokens/post_train:  8.40000; time/edit_train:  0.18094; loss/total_train:  1.46923; loss/total_edit_train:  1.46923; memory/alloc_max_train:  41028432896.00000; memory/res_max_train:  44805652480.00000; grad/true_mag0_train:  9.48751; grad/pseudo_mag0_train:  23095.14404; grad/true_std0_train:  0.00232; grad/pseudo_std0_train:  5.63832; grad/diff0_train:  23087.47598; grad/cos0_train:  0.80106; grad/true_mag1_train:  13.49823; grad/pseudo_mag1_train:  22543.12881; grad/true_std1_train:  0.00330; grad/pseudo_std1_train:  5.50348; grad/diff1_train:  22532.05088; grad/cos1_train:  0.81000; grad/true_mag2_train:  17.88399; grad/pseudo_mag2_train:  23380.84277; grad/true_std2_train:  0.00437; grad/pseudo_std2_train:  5.70506; grad/diff2_train:  23366.85693; grad/cos2_train:  0.75349; grad/true_mag3_train:  10.99168; grad/pseudo_mag3_train:  24407.97510; grad/true_std3_train:  0.00268; grad/pseudo_std3_train:  5.95892; grad/diff3_train:  24398.37129; grad/cos3_train:  0.86382; grad/true_mag4_train:  13.52418; grad/pseudo_mag4_train:  23848.41709; grad/true_std4_train:  0.00330; grad/pseudo_std4_train:  5.82226; grad/diff4_train:  23836.58857; grad/cos4_train:  0.86337; grad/true_mag5_train:  16.29185; grad/pseudo_mag5_train:  24718.22080; grad/true_std5_train:  0.00398; grad/pseudo_std5_train:  6.03312; grad/diff5_train:  24704.50898; grad/cos5_train:  0.81136; grad/true_mag6_train:  11.00618; grad/pseudo_mag6_train:  24720.83164; grad/true_std6_train:  0.00269; grad/pseudo_std6_train:  6.03532; grad/diff6_train:  24710.87637; grad/cos6_train:  0.89645; grad/true_mag7_train:  12.72775; grad/pseudo_mag7_train:  24564.21406; grad/true_std7_train:  0.00311; grad/pseudo_std7_train:  5.99708; grad/diff7_train:  24552.86582; grad/cos7_train:  0.88027; grad/true_mag8_train:  14.58199; grad/pseudo_mag8_train:  25756.21572; grad/true_std8_train:  0.00356; grad/pseudo_std8_train:  6.28780; grad/diff8_train:  25743.41201; grad/cos8_train:  0.85444; grad/true_mag9_train:  10.73743; grad/pseudo_mag9_train:  24656.84199; grad/true_std9_train:  0.00262; grad/pseudo_std9_train:  6.01971; grad/diff9_train:  24647.15020; grad/cos9_train:  0.89133; grad/true_mag10_train:  12.50437; grad/pseudo_mag10_train:  24865.72705; grad/true_std10_train:  0.00305; grad/pseudo_std10_train:  6.07069; grad/diff10_train:  24854.61455; grad/cos10_train:  0.87617; grad/true_mag11_train:  13.96788; grad/pseudo_mag11_train:  25375.43291; grad/true_std11_train:  0.00341; grad/pseudo_std11_train:  6.19477; grad/diff11_train:  25363.79668; grad/cos11_train:  0.80715; grad/true_mag12_train:  9.81892; grad/pseudo_mag12_train:  24617.28564; grad/true_std12_train:  0.00240; grad/pseudo_std12_train:  6.01004; grad/diff12_train:  24608.79209; grad/cos12_train:  0.84920; grad/true_mag13_train:  11.31308; grad/pseudo_mag13_train:  24445.37930; grad/true_std13_train:  0.00276; grad/pseudo_std13_train:  5.96806; grad/diff13_train:  24435.64775; grad/cos13_train:  0.84370; grad/true_mag14_train:  13.53916; grad/pseudo_mag14_train:  24019.05615; grad/true_std14_train:  0.00331; grad/pseudo_std14_train:  5.86332; grad/diff14_train:  24008.58330; grad/cos14_train:  0.75272; grad/true_mag15_train:  8.35236; grad/pseudo_mag15_train:  22182.50293; grad/true_std15_train:  0.00204; grad/pseudo_std15_train:  5.41552; grad/diff15_train:  22175.68545; grad/cos15_train:  0.80561; grad/true_mag16_train:  15.68417; grad/pseudo_mag16_train:  21968.75117; grad/true_std16_train:  0.00383; grad/pseudo_std16_train:  5.36332; grad/diff16_train:  21961.01270; grad/cos16_train:  0.50805; grad/true_mag17_train:  20.73377; grad/pseudo_mag17_train:  19683.75830; grad/true_std17_train:  0.00506; grad/pseudo_std17_train:  4.79415; grad/diff17_train:  19673.09941; grad/cos17_train:  0.51126; grad_train:  2487.54810; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00007; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00007; lr/lr17_train:  0.00007
[2025-04-24 22:23:49,237][trainer][INFO] - Step 340:
[2025-04-24 22:23:49,238][trainer][INFO] - loss/edit_train:  8.26537; loss/loc_train:  0.08872; edit/acc_train:  0.08984; edit/log_prob_train: -8.26537; edit/prob_train:  0.30559; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.11803; perplexity/pre_train:  61.43800; nll/post_train:  4.31310; perplexity/post_train:  74.67155; n_tokens/pre_train:  6.00000; n_tokens/post_train:  6.00000; time/edit_train:  0.22311; loss/total_train:  0.91526; loss/total_edit_train:  0.91526; memory/alloc_max_train:  41827138560.00000; memory/res_max_train:  44869405900.80000; grad/true_mag0_train:  9.54638; grad/pseudo_mag0_train:  21713.36680; grad/true_std0_train:  0.00233; grad/pseudo_std0_train:  5.30100; grad/diff0_train:  21705.70859; grad/cos0_train:  0.80340; grad/true_mag1_train:  13.69808; grad/pseudo_mag1_train:  21674.21289; grad/true_std1_train:  0.00334; grad/pseudo_std1_train:  5.29138; grad/diff1_train:  21663.12236; grad/cos1_train:  0.81390; grad/true_mag2_train:  17.92118; grad/pseudo_mag2_train:  22668.14824; grad/true_std2_train:  0.00438; grad/pseudo_std2_train:  5.53083; grad/diff2_train:  22653.94043; grad/cos2_train:  0.78192; grad/true_mag3_train:  11.26107; grad/pseudo_mag3_train:  24071.16133; grad/true_std3_train:  0.00275; grad/pseudo_std3_train:  5.87672; grad/diff3_train:  24061.40322; grad/cos3_train:  0.86462; grad/true_mag4_train:  13.49493; grad/pseudo_mag4_train:  23595.44824; grad/true_std4_train:  0.00329; grad/pseudo_std4_train:  5.76051; grad/diff4_train:  23583.64502; grad/cos4_train:  0.87258; grad/true_mag5_train:  16.37097; grad/pseudo_mag5_train:  24522.40049; grad/true_std5_train:  0.00400; grad/pseudo_std5_train:  5.98509; grad/diff5_train:  24508.44023; grad/cos5_train:  0.83921; grad/true_mag6_train:  11.51610; grad/pseudo_mag6_train:  25356.85625; grad/true_std6_train:  0.00281; grad/pseudo_std6_train:  6.19059; grad/diff6_train:  25346.50371; grad/cos6_train:  0.89835; grad/true_mag7_train:  13.20375; grad/pseudo_mag7_train:  25185.27441; grad/true_std7_train:  0.00322; grad/pseudo_std7_train:  6.14871; grad/diff7_train:  25173.44219; grad/cos7_train:  0.89205; grad/true_mag8_train:  14.79816; grad/pseudo_mag8_train:  26342.23096; grad/true_std8_train:  0.00361; grad/pseudo_std8_train:  6.43087; grad/diff8_train:  26328.97139; grad/cos8_train:  0.88817; grad/true_mag9_train:  11.11326; grad/pseudo_mag9_train:  25238.02939; grad/true_std9_train:  0.00271; grad/pseudo_std9_train:  6.16159; grad/diff9_train:  25227.99004; grad/cos9_train:  0.90099; grad/true_mag10_train:  12.66639; grad/pseudo_mag10_train:  25121.45615; grad/true_std10_train:  0.00309; grad/pseudo_std10_train:  6.13312; grad/diff10_train:  25110.15264; grad/cos10_train:  0.89028; grad/true_mag11_train:  14.25990; grad/pseudo_mag11_train:  25078.51738; grad/true_std11_train:  0.00348; grad/pseudo_std11_train:  6.12227; grad/diff11_train:  25066.56816; grad/cos11_train:  0.82501; grad/true_mag12_train:  10.11144; grad/pseudo_mag12_train:  25200.94043; grad/true_std12_train:  0.00247; grad/pseudo_std12_train:  6.15255; grad/diff12_train:  25192.05107; grad/cos12_train:  0.86854; grad/true_mag13_train:  11.47289; grad/pseudo_mag13_train:  25184.20928; grad/true_std13_train:  0.00280; grad/pseudo_std13_train:  6.14845; grad/diff13_train:  25174.15703; grad/cos13_train:  0.86826; grad/true_mag14_train:  13.69998; grad/pseudo_mag14_train:  23979.04326; grad/true_std14_train:  0.00334; grad/pseudo_std14_train:  5.85338; grad/diff14_train:  23968.33994; grad/cos14_train:  0.76711; grad/true_mag15_train:  8.38083; grad/pseudo_mag15_train:  21548.75684; grad/true_std15_train:  0.00205; grad/pseudo_std15_train:  5.26082; grad/diff15_train:  21541.92324; grad/cos15_train:  0.80721; grad/true_mag16_train:  14.99554; grad/pseudo_mag16_train:  21819.16035; grad/true_std16_train:  0.00366; grad/pseudo_std16_train:  5.32681; grad/diff16_train:  21811.29785; grad/cos16_train:  0.52695; grad/true_mag17_train:  20.40968; grad/pseudo_mag17_train:  18969.18467; grad/true_std17_train:  0.00498; grad/pseudo_std17_train:  4.61588; grad/diff17_train:  18959.05664; grad/cos17_train:  0.49275; grad_train:  1977.45386; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00011; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00006; lr/lr13_train:  0.00007; lr/lr14_train:  0.00007; lr/lr15_train:  0.00007; lr/lr16_train:  0.00006; lr/lr17_train:  0.00007
[2025-04-24 22:23:52,282][trainer][INFO] - Step 350:
[2025-04-24 22:23:52,282][trainer][INFO] - loss/edit_train:  8.83027; loss/loc_train:  0.18224; edit/acc_train:  0.04944; edit/log_prob_train: -8.83027; edit/prob_train:  0.35260; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.45482; perplexity/pre_train:  86.04058; nll/post_train:  4.74416; perplexity/post_train:  114.91130; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.16803; loss/total_train:  1.06527; loss/total_edit_train:  1.06527; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.73282; grad/pseudo_mag0_train:  20143.61875; grad/true_std0_train:  0.00213; grad/pseudo_std0_train:  4.91773; grad/diff0_train:  20136.62451; grad/cos0_train:  0.79370; grad/true_mag1_train:  12.60380; grad/pseudo_mag1_train:  20133.30078; grad/true_std1_train:  0.00308; grad/pseudo_std1_train:  4.91511; grad/diff1_train:  20123.06963; grad/cos1_train:  0.80436; grad/true_mag2_train:  15.90004; grad/pseudo_mag2_train:  20766.93906; grad/true_std2_train:  0.00388; grad/pseudo_std2_train:  5.06544; grad/diff2_train:  20754.63965; grad/cos2_train:  0.75556; grad/true_mag3_train:  9.72353; grad/pseudo_mag3_train:  20551.62432; grad/true_std3_train:  0.00237; grad/pseudo_std3_train:  5.01745; grad/diff3_train:  20543.19639; grad/cos3_train:  0.85707; grad/true_mag4_train:  12.39779; grad/pseudo_mag4_train:  20784.54102; grad/true_std4_train:  0.00303; grad/pseudo_std4_train:  5.07428; grad/diff4_train:  20773.79063; grad/cos4_train:  0.85724; grad/true_mag5_train:  15.26016; grad/pseudo_mag5_train:  21986.66826; grad/true_std5_train:  0.00373; grad/pseudo_std5_train:  5.36554; grad/diff5_train:  21974.02402; grad/cos5_train:  0.81205; grad/true_mag6_train:  10.01977; grad/pseudo_mag6_train:  21791.34443; grad/true_std6_train:  0.00245; grad/pseudo_std6_train:  5.32013; grad/diff6_train:  21782.33711; grad/cos6_train:  0.89314; grad/true_mag7_train:  11.72926; grad/pseudo_mag7_train:  21620.48682; grad/true_std7_train:  0.00286; grad/pseudo_std7_train:  5.27840; grad/diff7_train:  21610.10449; grad/cos7_train:  0.87442; grad/true_mag8_train:  13.54915; grad/pseudo_mag8_train:  23059.97588; grad/true_std8_train:  0.00331; grad/pseudo_std8_train:  5.62956; grad/diff8_train:  23048.02285; grad/cos8_train:  0.86790; grad/true_mag9_train:  9.76396; grad/pseudo_mag9_train:  21905.89639; grad/true_std9_train:  0.00238; grad/pseudo_std9_train:  5.34809; grad/diff9_train:  21897.08408; grad/cos9_train:  0.89570; grad/true_mag10_train:  11.11741; grad/pseudo_mag10_train:  21685.35225; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  5.29424; grad/diff10_train:  21675.42334; grad/cos10_train:  0.88335; grad/true_mag11_train:  13.41817; grad/pseudo_mag11_train:  22976.82412; grad/true_std11_train:  0.00328; grad/pseudo_std11_train:  5.60922; grad/diff11_train:  22965.65615; grad/cos11_train:  0.81653; grad/true_mag12_train:  9.45132; grad/pseudo_mag12_train:  23113.28203; grad/true_std12_train:  0.00231; grad/pseudo_std12_train:  5.64285; grad/diff12_train:  23105.05693; grad/cos12_train:  0.85825; grad/true_mag13_train:  10.74175; grad/pseudo_mag13_train:  23235.53037; grad/true_std13_train:  0.00262; grad/pseudo_std13_train:  5.67270; grad/diff13_train:  23226.17227; grad/cos13_train:  0.85816; grad/true_mag14_train:  13.79323; grad/pseudo_mag14_train:  23732.98867; grad/true_std14_train:  0.00337; grad/pseudo_std14_train:  5.79348; grad/diff14_train:  23722.19395; grad/cos14_train:  0.76593; grad/true_mag15_train:  8.80956; grad/pseudo_mag15_train:  23194.12939; grad/true_std15_train:  0.00215; grad/pseudo_std15_train:  5.66251; grad/diff15_train:  23186.84912; grad/cos15_train:  0.81638; grad/true_mag16_train:  16.34628; grad/pseudo_mag16_train:  23959.86807; grad/true_std16_train:  0.00399; grad/pseudo_std16_train:  5.84945; grad/diff16_train:  23951.28262; grad/cos16_train:  0.52724; grad/true_mag17_train:  22.07221; grad/pseudo_mag17_train:  21514.98545; grad/true_std17_train:  0.00539; grad/pseudo_std17_train:  5.24043; grad/diff17_train:  21503.47051; grad/cos17_train:  0.51841; grad_train:  2229.38794; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00007; lr/lr11_train:  0.00007; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00007
[2025-04-24 22:23:55,458][trainer][INFO] - Step 360:
[2025-04-24 22:23:55,458][trainer][INFO] - loss/edit_train:  9.64063; loss/loc_train:  0.15367; edit/acc_train:  0.06526; edit/log_prob_train: -9.64063; edit/prob_train:  0.26433; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.11880; perplexity/pre_train:  61.48536; nll/post_train:  4.56597; perplexity/post_train:  96.15566; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.18027; loss/total_train:  1.11773; loss/total_edit_train:  1.11773; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.87970; grad/pseudo_mag0_train:  17544.42168; grad/true_std0_train:  0.00192; grad/pseudo_std0_train:  4.28318; grad/diff0_train:  17538.14004; grad/cos0_train:  0.79516; grad/true_mag1_train:  11.47437; grad/pseudo_mag1_train:  18260.85752; grad/true_std1_train:  0.00280; grad/pseudo_std1_train:  4.45803; grad/diff1_train:  18251.54521; grad/cos1_train:  0.80937; grad/true_mag2_train:  15.00320; grad/pseudo_mag2_train:  19887.93926; grad/true_std2_train:  0.00366; grad/pseudo_std2_train:  4.84914; grad/diff2_train:  19876.73057; grad/cos2_train:  0.74046; grad/true_mag3_train:  9.08246; grad/pseudo_mag3_train:  19160.86826; grad/true_std3_train:  0.00222; grad/pseudo_std3_train:  4.67791; grad/diff3_train:  19152.97891; grad/cos3_train:  0.86638; grad/true_mag4_train:  11.54961; grad/pseudo_mag4_train:  19330.41660; grad/true_std4_train:  0.00282; grad/pseudo_std4_train:  4.71926; grad/diff4_train:  19320.42422; grad/cos4_train:  0.86249; grad/true_mag5_train:  14.05299; grad/pseudo_mag5_train:  20806.67236; grad/true_std5_train:  0.00343; grad/pseudo_std5_train:  5.07661; grad/diff5_train:  20795.27871; grad/cos5_train:  0.80176; grad/true_mag6_train:  9.40181; grad/pseudo_mag6_train:  20458.42852; grad/true_std6_train:  0.00230; grad/pseudo_std6_train:  4.99471; grad/diff6_train:  20449.94961; grad/cos6_train:  0.90032; grad/true_mag7_train:  10.90576; grad/pseudo_mag7_train:  20455.13799; grad/true_std7_train:  0.00266; grad/pseudo_std7_train:  4.99389; grad/diff7_train:  20445.40547; grad/cos7_train:  0.89049; grad/true_mag8_train:  12.49500; grad/pseudo_mag8_train:  21852.05430; grad/true_std8_train:  0.00305; grad/pseudo_std8_train:  5.33439; grad/diff8_train:  21841.10410; grad/cos8_train:  0.87122; grad/true_mag9_train:  9.22463; grad/pseudo_mag9_train:  20691.53867; grad/true_std9_train:  0.00225; grad/pseudo_std9_train:  5.05161; grad/diff9_train:  20683.18184; grad/cos9_train:  0.90470; grad/true_mag10_train:  10.55969; grad/pseudo_mag10_train:  20477.71299; grad/true_std10_train:  0.00258; grad/pseudo_std10_train:  4.99940; grad/diff10_train:  20468.36836; grad/cos10_train:  0.88405; grad/true_mag11_train:  12.48828; grad/pseudo_mag11_train:  21612.61240; grad/true_std11_train:  0.00305; grad/pseudo_std11_train:  5.27596; grad/diff11_train:  21602.41709; grad/cos11_train:  0.81110; grad/true_mag12_train:  8.73959; grad/pseudo_mag12_train:  21502.35332; grad/true_std12_train:  0.00213; grad/pseudo_std12_train:  5.24957; grad/diff12_train:  21494.78828; grad/cos12_train:  0.86387; grad/true_mag13_train:  10.02501; grad/pseudo_mag13_train:  21595.52129; grad/true_std13_train:  0.00245; grad/pseudo_std13_train:  5.27231; grad/diff13_train:  21586.79199; grad/cos13_train:  0.86919; grad/true_mag14_train:  12.57479; grad/pseudo_mag14_train:  22204.16699; grad/true_std14_train:  0.00307; grad/pseudo_std14_train:  5.41968; grad/diff14_train:  22194.66211; grad/cos14_train:  0.74880; grad/true_mag15_train:  8.05280; grad/pseudo_mag15_train:  21535.88789; grad/true_std15_train:  0.00197; grad/pseudo_std15_train:  5.25766; grad/diff15_train:  21529.24961; grad/cos15_train:  0.82268; grad/true_mag16_train:  14.29797; grad/pseudo_mag16_train:  22192.15127; grad/true_std16_train:  0.00349; grad/pseudo_std16_train:  5.41788; grad/diff16_train:  22184.44326; grad/cos16_train:  0.55334; grad/true_mag17_train:  20.20115; grad/pseudo_mag17_train:  19506.99648; grad/true_std17_train:  0.00493; grad/pseudo_std17_train:  4.74728; grad/diff17_train:  19496.93750; grad/cos17_train:  0.49569; grad_train:  1687.91797; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00008; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00007; lr/lr10_train:  0.00006; lr/lr11_train:  0.00007; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00007
[2025-04-24 22:23:59,109][trainer][INFO] - Step 370:
[2025-04-24 22:23:59,109][trainer][INFO] - loss/edit_train:  10.60231; loss/loc_train:  0.11599; edit/acc_train:  0.06707; edit/log_prob_train: -10.60231; edit/prob_train:  0.27320; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.51877; perplexity/pre_train:  91.72259; nll/post_train:  4.71992; perplexity/post_train:  112.15912; n_tokens/pre_train:  3.50000; n_tokens/post_train:  3.50000; time/edit_train:  0.22680; loss/total_train:  1.17623; loss/total_edit_train:  1.17623; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  9.09417; grad/pseudo_mag0_train:  20676.59443; grad/true_std0_train:  0.00222; grad/pseudo_std0_train:  5.04787; grad/diff0_train:  20669.26348; grad/cos0_train:  0.80477; grad/true_mag1_train:  12.89638; grad/pseudo_mag1_train:  20749.48613; grad/true_std1_train:  0.00315; grad/pseudo_std1_train:  5.06555; grad/diff1_train:  20738.90303; grad/cos1_train:  0.81894; grad/true_mag2_train:  16.63384; grad/pseudo_mag2_train:  22527.38535; grad/true_std2_train:  0.00406; grad/pseudo_std2_train:  5.49238; grad/diff2_train:  22514.50703; grad/cos2_train:  0.76747; grad/true_mag3_train:  10.49822; grad/pseudo_mag3_train:  22460.53408; grad/true_std3_train:  0.00256; grad/pseudo_std3_train:  5.48349; grad/diff3_train:  22451.38047; grad/cos3_train:  0.87028; grad/true_mag4_train:  12.85811; grad/pseudo_mag4_train:  22103.59687; grad/true_std4_train:  0.00314; grad/pseudo_std4_train:  5.39631; grad/diff4_train:  22092.32266; grad/cos4_train:  0.87444; grad/true_mag5_train:  15.65063; grad/pseudo_mag5_train:  23656.13809; grad/true_std5_train:  0.00382; grad/pseudo_std5_train:  5.77157; grad/diff5_train:  23643.04766; grad/cos5_train:  0.83036; grad/true_mag6_train:  10.75735; grad/pseudo_mag6_train:  23427.46240; grad/true_std6_train:  0.00263; grad/pseudo_std6_train:  5.71955; grad/diff6_train:  23417.74746; grad/cos6_train:  0.90259; grad/true_mag7_train:  12.47659; grad/pseudo_mag7_train:  23287.58135; grad/true_std7_train:  0.00305; grad/pseudo_std7_train:  5.68539; grad/diff7_train:  23276.44004; grad/cos7_train:  0.89045; grad/true_mag8_train:  14.30460; grad/pseudo_mag8_train:  24636.20264; grad/true_std8_train:  0.00349; grad/pseudo_std8_train:  6.01404; grad/diff8_train:  24623.67051; grad/cos8_train:  0.87396; grad/true_mag9_train:  10.47831; grad/pseudo_mag9_train:  23518.84258; grad/true_std9_train:  0.00256; grad/pseudo_std9_train:  5.74186; grad/diff9_train:  23509.35566; grad/cos9_train:  0.90470; grad/true_mag10_train:  12.57443; grad/pseudo_mag10_train:  23611.48418; grad/true_std10_train:  0.00307; grad/pseudo_std10_train:  5.76447; grad/diff10_train:  23600.68623; grad/cos10_train:  0.87081; grad/true_mag11_train:  13.84216; grad/pseudo_mag11_train:  24186.60527; grad/true_std11_train:  0.00338; grad/pseudo_std11_train:  5.90446; grad/diff11_train:  24174.99551; grad/cos11_train:  0.83278; grad/true_mag12_train:  9.62623; grad/pseudo_mag12_train:  23846.54414; grad/true_std12_train:  0.00235; grad/pseudo_std12_train:  5.82186; grad/diff12_train:  23838.12275; grad/cos12_train:  0.87244; grad/true_mag13_train:  11.19383; grad/pseudo_mag13_train:  24232.98174; grad/true_std13_train:  0.00273; grad/pseudo_std13_train:  5.91619; grad/diff13_train:  24223.14785; grad/cos13_train:  0.87561; grad/true_mag14_train:  13.75346; grad/pseudo_mag14_train:  24029.38984; grad/true_std14_train:  0.00336; grad/pseudo_std14_train:  5.86539; grad/diff14_train:  24018.64785; grad/cos14_train:  0.77674; grad/true_mag15_train:  8.68521; grad/pseudo_mag15_train:  23333.55859; grad/true_std15_train:  0.00212; grad/pseudo_std15_train:  5.69653; grad/diff15_train:  23326.32520; grad/cos15_train:  0.83132; grad/true_mag16_train:  15.13723; grad/pseudo_mag16_train:  23857.16230; grad/true_std16_train:  0.00370; grad/pseudo_std16_train:  5.82436; grad/diff16_train:  23848.91660; grad/cos16_train:  0.55207; grad/true_mag17_train:  20.89753; grad/pseudo_mag17_train:  20774.40605; grad/true_std17_train:  0.00510; grad/pseudo_std17_train:  5.05568; grad/diff17_train:  20763.51533; grad/cos17_train:  0.52086; grad_train:  2803.76245; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:24:02,507][trainer][INFO] - Step 380:
[2025-04-24 22:24:02,508][trainer][INFO] - loss/edit_train:  8.07202; loss/loc_train:  0.06981; edit/acc_train:  0.05278; edit/log_prob_train: -8.07202; edit/prob_train:  0.26082; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.66520; perplexity/pre_train:  39.06412; nll/post_train:  3.64967; perplexity/post_train:  38.46180; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.18682; loss/total_train:  0.87701; loss/total_edit_train:  0.87701; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.82574; grad/pseudo_mag0_train:  15710.72080; grad/true_std0_train:  0.00167; grad/pseudo_std0_train:  3.83548; grad/diff0_train:  15705.31660; grad/cos0_train:  0.78622; grad/true_mag1_train:  10.07887; grad/pseudo_mag1_train:  16447.82285; grad/true_std1_train:  0.00246; grad/pseudo_std1_train:  4.01530; grad/diff1_train:  16439.75195; grad/cos1_train:  0.79311; grad/true_mag2_train:  12.98877; grad/pseudo_mag2_train:  18544.44990; grad/true_std2_train:  0.00317; grad/pseudo_std2_train:  4.51810; grad/diff2_train:  18535.26094; grad/cos2_train:  0.68376; grad/true_mag3_train:  7.92308; grad/pseudo_mag3_train:  16841.53848; grad/true_std3_train:  0.00193; grad/pseudo_std3_train:  4.11166; grad/diff3_train:  16834.69580; grad/cos3_train:  0.85708; grad/true_mag4_train:  10.07888; grad/pseudo_mag4_train:  17248.13291; grad/true_std4_train:  0.00246; grad/pseudo_std4_train:  4.21089; grad/diff4_train:  17239.43154; grad/cos4_train:  0.85625; grad/true_mag5_train:  12.30434; grad/pseudo_mag5_train:  19174.44629; grad/true_std5_train:  0.00300; grad/pseudo_std5_train:  4.67583; grad/diff5_train:  19164.86377; grad/cos5_train:  0.76103; grad/true_mag6_train:  8.19213; grad/pseudo_mag6_train:  17945.98643; grad/true_std6_train:  0.00200; grad/pseudo_std6_train:  4.38132; grad/diff6_train:  17938.62861; grad/cos6_train:  0.89285; grad/true_mag7_train:  9.50162; grad/pseudo_mag7_train:  17860.37373; grad/true_std7_train:  0.00232; grad/pseudo_std7_train:  4.36041; grad/diff7_train:  17851.96299; grad/cos7_train:  0.87838; grad/true_mag8_train:  10.99786; grad/pseudo_mag8_train:  19495.01260; grad/true_std8_train:  0.00269; grad/pseudo_std8_train:  4.75889; grad/diff8_train:  19485.62842; grad/cos8_train:  0.84037; grad/true_mag9_train:  8.12853; grad/pseudo_mag9_train:  18306.36338; grad/true_std9_train:  0.00198; grad/pseudo_std9_train:  4.46929; grad/diff9_train:  18299.06465; grad/cos9_train:  0.89236; grad/true_mag10_train:  9.20207; grad/pseudo_mag10_train:  18328.23730; grad/true_std10_train:  0.00225; grad/pseudo_std10_train:  4.47462; grad/diff10_train:  18320.05322; grad/cos10_train:  0.88349; grad/true_mag11_train:  11.05399; grad/pseudo_mag11_train:  20133.54180; grad/true_std11_train:  0.00270; grad/pseudo_std11_train:  4.91475; grad/diff11_train:  20124.68057; grad/cos11_train:  0.78826; grad/true_mag12_train:  7.68912; grad/pseudo_mag12_train:  19056.03916; grad/true_std12_train:  0.00188; grad/pseudo_std12_train:  4.65231; grad/diff12_train:  19049.41719; grad/cos12_train:  0.85398; grad/true_mag13_train:  8.69692; grad/pseudo_mag13_train:  18889.07422; grad/true_std13_train:  0.00212; grad/pseudo_std13_train:  4.61154; grad/diff13_train:  18881.52568; grad/cos13_train:  0.86337; grad/true_mag14_train:  11.17919; grad/pseudo_mag14_train:  20062.34453; grad/true_std14_train:  0.00273; grad/pseudo_std14_train:  4.89663; grad/diff14_train:  20054.09863; grad/cos14_train:  0.72559; grad/true_mag15_train:  7.18088; grad/pseudo_mag15_train:  19075.53340; grad/true_std15_train:  0.00175; grad/pseudo_std15_train:  4.65695; grad/diff15_train:  19069.67139; grad/cos15_train:  0.81127; grad/true_mag16_train:  14.16496; grad/pseudo_mag16_train:  19206.18789; grad/true_std16_train:  0.00346; grad/pseudo_std16_train:  4.68886; grad/diff16_train:  19199.44600; grad/cos16_train:  0.48872; grad/true_mag17_train:  18.87989; grad/pseudo_mag17_train:  17410.64873; grad/true_std17_train:  0.00461; grad/pseudo_std17_train:  4.23224; grad/diff17_train:  17401.96006; grad/cos17_train:  0.45999; grad_train:  1348.45081; lr/lr0_train:  0.00008; lr/lr1_train:  0.00008; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:24:05,959][trainer][INFO] - Step 390:
[2025-04-24 22:24:05,959][trainer][INFO] - loss/edit_train:  7.22392; loss/loc_train:  0.09012; edit/acc_train:  0.03339; edit/log_prob_train: -7.22392; edit/prob_train:  0.32392; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.10479; perplexity/pre_train:  60.63010; nll/post_train:  4.18031; perplexity/post_train:  65.38609; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.18824; loss/total_train:  0.81251; loss/total_edit_train:  0.81251; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.00313; grad/pseudo_mag0_train:  18396.00273; grad/true_std0_train:  0.00195; grad/pseudo_std0_train:  4.49102; grad/diff0_train:  18389.68066; grad/cos0_train:  0.78999; grad/true_mag1_train:  11.66218; grad/pseudo_mag1_train:  18877.68389; grad/true_std1_train:  0.00285; grad/pseudo_std1_train:  4.60850; grad/diff1_train:  18868.35693; grad/cos1_train:  0.79717; grad/true_mag2_train:  15.53017; grad/pseudo_mag2_train:  20987.83340; grad/true_std2_train:  0.00379; grad/pseudo_std2_train:  5.11309; grad/diff2_train:  20976.67852; grad/cos2_train:  0.70570; grad/true_mag3_train:  9.32220; grad/pseudo_mag3_train:  19638.21309; grad/true_std3_train:  0.00228; grad/pseudo_std3_train:  4.79442; grad/diff3_train:  19630.23184; grad/cos3_train:  0.85351; grad/true_mag4_train:  11.71679; grad/pseudo_mag4_train:  20117.55615; grad/true_std4_train:  0.00286; grad/pseudo_std4_train:  4.91138; grad/diff4_train:  20107.42725; grad/cos4_train:  0.86133; grad/true_mag5_train:  14.36160; grad/pseudo_mag5_train:  22861.41025; grad/true_std5_train:  0.00351; grad/pseudo_std5_train:  5.57408; grad/diff5_train:  22850.32256; grad/cos5_train:  0.75593; grad/true_mag6_train:  9.48250; grad/pseudo_mag6_train:  20391.71299; grad/true_std6_train:  0.00232; grad/pseudo_std6_train:  4.97839; grad/diff6_train:  20383.26885; grad/cos6_train:  0.88780; grad/true_mag7_train:  11.02090; grad/pseudo_mag7_train:  20458.14707; grad/true_std7_train:  0.00269; grad/pseudo_std7_train:  4.99460; grad/diff7_train:  20448.40791; grad/cos7_train:  0.88169; grad/true_mag8_train:  13.54313; grad/pseudo_mag8_train:  22487.86328; grad/true_std8_train:  0.00331; grad/pseudo_std8_train:  5.48921; grad/diff8_train:  22476.82363; grad/cos8_train:  0.82900; grad/true_mag9_train:  9.10579; grad/pseudo_mag9_train:  20328.59434; grad/true_std9_train:  0.00222; grad/pseudo_std9_train:  4.96300; grad/diff9_train:  20320.49766; grad/cos9_train:  0.88268; grad/true_mag10_train:  12.40003; grad/pseudo_mag10_train:  20397.91230; grad/true_std10_train:  0.00303; grad/pseudo_std10_train:  4.97989; grad/diff10_train:  20388.43369; grad/cos10_train:  0.83365; grad/true_mag11_train:  12.38873; grad/pseudo_mag11_train:  21483.84854; grad/true_std11_train:  0.00302; grad/pseudo_std11_train:  5.24411; grad/diff11_train:  21473.86035; grad/cos11_train:  0.79611; grad/true_mag12_train:  8.24448; grad/pseudo_mag12_train:  20006.47432; grad/true_std12_train:  0.00201; grad/pseudo_std12_train:  4.88435; grad/diff12_train:  19999.46748; grad/cos12_train:  0.84399; grad/true_mag13_train:  9.83437; grad/pseudo_mag13_train:  20032.94932; grad/true_std13_train:  0.00240; grad/pseudo_std13_train:  4.89080; grad/diff13_train:  20024.67803; grad/cos13_train:  0.84252; grad/true_mag14_train:  12.19043; grad/pseudo_mag14_train:  21070.21963; grad/true_std14_train:  0.00298; grad/pseudo_std14_train:  5.14250; grad/diff14_train:  21061.18027; grad/cos14_train:  0.72864; grad/true_mag15_train:  7.69151; grad/pseudo_mag15_train:  20061.46729; grad/true_std15_train:  0.00188; grad/pseudo_std15_train:  4.89765; grad/diff15_train:  20055.25371; grad/cos15_train:  0.80191; grad/true_mag16_train:  14.53362; grad/pseudo_mag16_train:  20230.73047; grad/true_std16_train:  0.00355; grad/pseudo_std16_train:  4.93900; grad/diff16_train:  20223.27324; grad/cos16_train:  0.51120; grad/true_mag17_train:  19.66154; grad/pseudo_mag17_train:  18498.44775; grad/true_std17_train:  0.00480; grad/pseudo_std17_train:  4.49504; grad/diff17_train:  18489.16084; grad/cos17_train:  0.46632; grad_train:  1387.51135; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00011; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00007; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:24:09,570][trainer][INFO] - Step 400:
[2025-04-24 22:24:09,570][trainer][INFO] - loss/edit_train:  10.47377; loss/loc_train:  0.10570; edit/acc_train:  0.04792; edit/log_prob_train: -10.47377; edit/prob_train:  0.24154; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.46050; perplexity/pre_train:  86.53049; nll/post_train:  4.62080; perplexity/post_train:  101.57525; n_tokens/pre_train:  5.90000; n_tokens/post_train:  5.90000; time/edit_train:  0.21980; loss/total_train:  1.15308; loss/total_edit_train:  1.15308; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.25466; grad/pseudo_mag0_train:  18987.57109; grad/true_std0_train:  0.00202; grad/pseudo_std0_train:  4.63551; grad/diff0_train:  18980.92910; grad/cos0_train:  0.80037; grad/true_mag1_train:  11.97541; grad/pseudo_mag1_train:  19229.67061; grad/true_std1_train:  0.00292; grad/pseudo_std1_train:  4.69451; grad/diff1_train:  19219.87832; grad/cos1_train:  0.81332; grad/true_mag2_train:  15.38737; grad/pseudo_mag2_train:  20695.17988; grad/true_std2_train:  0.00376; grad/pseudo_std2_train:  5.04530; grad/diff2_train:  20683.43115; grad/cos2_train:  0.74893; grad/true_mag3_train:  9.37665; grad/pseudo_mag3_train:  19966.50732; grad/true_std3_train:  0.00229; grad/pseudo_std3_train:  4.87459; grad/diff3_train:  19958.36943; grad/cos3_train:  0.86348; grad/true_mag4_train:  11.73473; grad/pseudo_mag4_train:  19977.89189; grad/true_std4_train:  0.00286; grad/pseudo_std4_train:  4.87735; grad/diff4_train:  19967.67012; grad/cos4_train:  0.86646; grad/true_mag5_train:  14.40415; grad/pseudo_mag5_train:  21581.65156; grad/true_std5_train:  0.00352; grad/pseudo_std5_train:  5.26508; grad/diff5_train:  21569.80371; grad/cos5_train:  0.80931; grad/true_mag6_train:  9.49532; grad/pseudo_mag6_train:  20705.54648; grad/true_std6_train:  0.00232; grad/pseudo_std6_train:  5.05503; grad/diff6_train:  20697.00352; grad/cos6_train:  0.89580; grad/true_mag7_train:  11.07623; grad/pseudo_mag7_train:  20671.84424; grad/true_std7_train:  0.00270; grad/pseudo_std7_train:  5.04679; grad/diff7_train:  20661.98477; grad/cos7_train:  0.88409; grad/true_mag8_train:  12.66967; grad/pseudo_mag8_train:  21867.35479; grad/true_std8_train:  0.00309; grad/pseudo_std8_train:  5.33829; grad/diff8_train:  21856.21299; grad/cos8_train:  0.86737; grad/true_mag9_train:  9.23675; grad/pseudo_mag9_train:  20704.62529; grad/true_std9_train:  0.00226; grad/pseudo_std9_train:  5.05481; grad/diff9_train:  20696.28916; grad/cos9_train:  0.89729; grad/true_mag10_train:  10.74330; grad/pseudo_mag10_train:  20852.27998; grad/true_std10_train:  0.00262; grad/pseudo_std10_train:  5.09085; grad/diff10_train:  20842.77148; grad/cos10_train:  0.88131; grad/true_mag11_train:  12.71332; grad/pseudo_mag11_train:  21486.23281; grad/true_std11_train:  0.00310; grad/pseudo_std11_train:  5.24526; grad/diff11_train:  21475.78672; grad/cos11_train:  0.81006; grad/true_mag12_train:  8.54820; grad/pseudo_mag12_train:  20948.90234; grad/true_std12_train:  0.00209; grad/pseudo_std12_train:  5.11445; grad/diff12_train:  20941.52031; grad/cos12_train:  0.85393; grad/true_mag13_train:  9.74939; grad/pseudo_mag13_train:  20907.59639; grad/true_std13_train:  0.00238; grad/pseudo_std13_train:  5.10435; grad/diff13_train:  20899.16465; grad/cos13_train:  0.85706; grad/true_mag14_train:  12.58729; grad/pseudo_mag14_train:  21056.74307; grad/true_std14_train:  0.00307; grad/pseudo_std14_train:  5.13984; grad/diff14_train:  21047.28135; grad/cos14_train:  0.73995; grad/true_mag15_train:  7.84077; grad/pseudo_mag15_train:  20409.20977; grad/true_std15_train:  0.00191; grad/pseudo_std15_train:  4.98259; grad/diff15_train:  20402.84941; grad/cos15_train:  0.80584; grad/true_mag16_train:  14.99304; grad/pseudo_mag16_train:  20727.49082; grad/true_std16_train:  0.00366; grad/pseudo_std16_train:  5.06028; grad/diff16_train:  20720.10273; grad/cos16_train:  0.49774; grad/true_mag17_train:  20.65444; grad/pseudo_mag17_train:  18974.65684; grad/true_std17_train:  0.00504; grad/pseudo_std17_train:  4.61549; grad/diff17_train:  18964.67031; grad/cos17_train:  0.48452; grad_train:  2637.04370; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:24:27,755][trainer][INFO] - Step 400:
[2025-04-24 22:24:27,756][trainer][INFO] - loss/edit_val:  10.02401; loss/loc_val:  0.15684; edit/acc_val:  0.04321; edit/log_prob_val: -10.02401; edit/prob_val:  0.26572; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.53904; perplexity/post_val:  93.60059; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10823; loss/total_val:  1.15924; loss/total_edit_val:  1.15924; memory/alloc_max_val:  42026814976.00000; memory/res_max_val:  44885344256.00000; eval_time/elapsed:  18.18017; eval_time/average:  0.18180
[2025-04-24 22:24:27,759][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:24:27,760][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:25:22,077][trainer][INFO] - Write complete.
[2025-04-24 22:25:25,394][trainer][INFO] - Step 410:
[2025-04-24 22:25:25,394][trainer][INFO] - loss/edit_train:  9.09117; loss/loc_train:  0.06781; edit/acc_train:  0.02456; edit/log_prob_train: -9.09117; edit/prob_train:  0.25485; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.75236; perplexity/pre_train:  42.62141; nll/post_train:  3.85128; perplexity/post_train:  47.05313; n_tokens/pre_train:  4.90000; n_tokens/post_train:  4.90000; time/edit_train:  0.18532; loss/total_train:  0.97693; loss/total_edit_train:  0.97693; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.24909; grad/pseudo_mag0_train:  16605.09043; grad/true_std0_train:  0.00177; grad/pseudo_std0_train:  4.05373; grad/diff0_train:  16599.41250; grad/cos0_train:  0.77872; grad/true_mag1_train:  10.63592; grad/pseudo_mag1_train:  17094.16396; grad/true_std1_train:  0.00260; grad/pseudo_std1_train:  4.17298; grad/diff1_train:  17085.71807; grad/cos1_train:  0.78646; grad/true_mag2_train:  13.48261; grad/pseudo_mag2_train:  19859.43701; grad/true_std2_train:  0.00329; grad/pseudo_std2_train:  4.83058; grad/diff2_train:  19849.90244; grad/cos2_train:  0.68292; grad/true_mag3_train:  8.01161; grad/pseudo_mag3_train:  17004.73184; grad/true_std3_train:  0.00196; grad/pseudo_std3_train:  4.15150; grad/diff3_train:  16997.85869; grad/cos3_train:  0.85347; grad/true_mag4_train:  10.31549; grad/pseudo_mag4_train:  17253.83555; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.21224; grad/diff4_train:  17245.05859; grad/cos4_train:  0.84581; grad/true_mag5_train:  12.72541; grad/pseudo_mag5_train:  19428.51230; grad/true_std5_train:  0.00311; grad/pseudo_std5_train:  4.73531; grad/diff5_train:  19418.66895; grad/cos5_train:  0.75113; grad/true_mag6_train:  8.30352; grad/pseudo_mag6_train:  18174.78740; grad/true_std6_train:  0.00203; grad/pseudo_std6_train:  4.43717; grad/diff6_train:  18167.36562; grad/cos6_train:  0.88870; grad/true_mag7_train:  9.97166; grad/pseudo_mag7_train:  18304.59551; grad/true_std7_train:  0.00243; grad/pseudo_std7_train:  4.46884; grad/diff7_train:  18295.85820; grad/cos7_train:  0.87153; grad/true_mag8_train:  11.48930; grad/pseudo_mag8_train:  19827.91240; grad/true_std8_train:  0.00281; grad/pseudo_std8_train:  4.83964; grad/diff8_train:  19818.12109; grad/cos8_train:  0.83503; grad/true_mag9_train:  8.26753; grad/pseudo_mag9_train:  18578.54199; grad/true_std9_train:  0.00202; grad/pseudo_std9_train:  4.53573; grad/diff9_train:  18571.17578; grad/cos9_train:  0.88435; grad/true_mag10_train:  9.60015; grad/pseudo_mag10_train:  18659.96924; grad/true_std10_train:  0.00234; grad/pseudo_std10_train:  4.55560; grad/diff10_train:  18651.51631; grad/cos10_train:  0.87383; grad/true_mag11_train:  11.66122; grad/pseudo_mag11_train:  19897.15518; grad/true_std11_train:  0.00285; grad/pseudo_std11_train:  4.85678; grad/diff11_train:  19887.90313; grad/cos11_train:  0.77263; grad/true_mag12_train:  8.08185; grad/pseudo_mag12_train:  19694.27813; grad/true_std12_train:  0.00197; grad/pseudo_std12_train:  4.80811; grad/diff12_train:  19687.38076; grad/cos12_train:  0.84306; grad/true_mag13_train:  9.23676; grad/pseudo_mag13_train:  19681.61230; grad/true_std13_train:  0.00226; grad/pseudo_std13_train:  4.80501; grad/diff13_train:  19673.73613; grad/cos13_train:  0.84219; grad/true_mag14_train:  11.96062; grad/pseudo_mag14_train:  20361.01211; grad/true_std14_train:  0.00292; grad/pseudo_std14_train:  4.96903; grad/diff14_train:  20352.26318; grad/cos14_train:  0.70745; grad/true_mag15_train:  7.61637; grad/pseudo_mag15_train:  19944.67285; grad/true_std15_train:  0.00186; grad/pseudo_std15_train:  4.86910; grad/diff15_train:  19938.61914; grad/cos15_train:  0.78219; grad/true_mag16_train:  14.99404; grad/pseudo_mag16_train:  20414.11211; grad/true_std16_train:  0.00366; grad/pseudo_std16_train:  4.98367; grad/diff16_train:  20407.00215; grad/cos16_train:  0.47618; grad/true_mag17_train:  20.25580; grad/pseudo_mag17_train:  18669.55742; grad/true_std17_train:  0.00495; grad/pseudo_std17_train:  4.53650; grad/diff17_train:  18660.42295; grad/cos17_train:  0.43754; grad_train:  1822.02222; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:25:29,023][trainer][INFO] - Step 420:
[2025-04-24 22:25:29,023][trainer][INFO] - loss/edit_train:  8.71914; loss/loc_train:  0.07062; edit/acc_train:  0.05000; edit/log_prob_train: -8.71914; edit/prob_train:  0.26664; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.88453; perplexity/pre_train:  48.64386; nll/post_train:  3.87194; perplexity/post_train:  48.03526; n_tokens/pre_train:  5.30000; n_tokens/post_train:  5.30000; time/edit_train:  0.22041; loss/total_train:  0.94254; loss/total_edit_train:  0.94254; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.92207; grad/pseudo_mag0_train:  15344.81172; grad/true_std0_train:  0.00169; grad/pseudo_std0_train:  3.74610; grad/diff0_train:  15339.34619; grad/cos0_train:  0.78489; grad/true_mag1_train:  10.14365; grad/pseudo_mag1_train:  15958.54199; grad/true_std1_train:  0.00248; grad/pseudo_std1_train:  3.89577; grad/diff1_train:  15950.45879; grad/cos1_train:  0.79198; grad/true_mag2_train:  13.14690; grad/pseudo_mag2_train:  18913.11064; grad/true_std2_train:  0.00321; grad/pseudo_std2_train:  4.60034; grad/diff2_train:  18904.11719; grad/cos2_train:  0.67144; grad/true_mag3_train:  7.83167; grad/pseudo_mag3_train:  16377.00732; grad/true_std3_train:  0.00191; grad/pseudo_std3_train:  3.99824; grad/diff3_train:  16370.29624; grad/cos3_train:  0.84889; grad/true_mag4_train:  9.92884; grad/pseudo_mag4_train:  16462.46250; grad/true_std4_train:  0.00242; grad/pseudo_std4_train:  4.01907; grad/diff4_train:  16453.97490; grad/cos4_train:  0.84837; grad/true_mag5_train:  12.39874; grad/pseudo_mag5_train:  18825.48691; grad/true_std5_train:  0.00303; grad/pseudo_std5_train:  4.58725; grad/diff5_train:  18815.97939; grad/cos5_train:  0.75730; grad/true_mag6_train:  8.03972; grad/pseudo_mag6_train:  17357.28477; grad/true_std6_train:  0.00196; grad/pseudo_std6_train:  4.23758; grad/diff6_train:  17350.08604; grad/cos6_train:  0.89031; grad/true_mag7_train:  9.46030; grad/pseudo_mag7_train:  17409.18374; grad/true_std7_train:  0.00231; grad/pseudo_std7_train:  4.25024; grad/diff7_train:  17400.87568; grad/cos7_train:  0.87090; grad/true_mag8_train:  10.95961; grad/pseudo_mag8_train:  19137.48223; grad/true_std8_train:  0.00268; grad/pseudo_std8_train:  4.67109; grad/diff8_train:  19128.14180; grad/cos8_train:  0.84448; grad/true_mag9_train:  7.88012; grad/pseudo_mag9_train:  17589.34824; grad/true_std9_train:  0.00192; grad/pseudo_std9_train:  4.29424; grad/diff9_train:  17582.29365; grad/cos9_train:  0.88922; grad/true_mag10_train:  9.17237; grad/pseudo_mag10_train:  17696.66216; grad/true_std10_train:  0.00224; grad/pseudo_std10_train:  4.32043; grad/diff10_train:  17688.56787; grad/cos10_train:  0.87486; grad/true_mag11_train:  11.28096; grad/pseudo_mag11_train:  19051.54297; grad/true_std11_train:  0.00275; grad/pseudo_std11_train:  4.65028; grad/diff11_train:  19042.68213; grad/cos11_train:  0.77771; grad/true_mag12_train:  7.65391; grad/pseudo_mag12_train:  18350.01406; grad/true_std12_train:  0.00187; grad/pseudo_std12_train:  4.47994; grad/diff12_train:  18343.50698; grad/cos12_train:  0.84150; grad/true_mag13_train:  8.90754; grad/pseudo_mag13_train:  18440.68965; grad/true_std13_train:  0.00217; grad/pseudo_std13_train:  4.50208; grad/diff13_train:  18433.10122; grad/cos13_train:  0.84447; grad/true_mag14_train:  11.61040; grad/pseudo_mag14_train:  19368.63125; grad/true_std14_train:  0.00283; grad/pseudo_std14_train:  4.72673; grad/diff14_train:  19360.19746; grad/cos14_train:  0.71749; grad/true_mag15_train:  7.28959; grad/pseudo_mag15_train:  18743.39229; grad/true_std15_train:  0.00178; grad/pseudo_std15_train:  4.57584; grad/diff15_train:  18737.53105; grad/cos15_train:  0.79589; grad/true_mag16_train:  13.57187; grad/pseudo_mag16_train:  19126.84805; grad/true_std16_train:  0.00331; grad/pseudo_std16_train:  4.66947; grad/diff16_train:  19120.01143; grad/cos16_train:  0.51003; grad/true_mag17_train:  19.84234; grad/pseudo_mag17_train:  17565.93945; grad/true_std17_train:  0.00484; grad/pseudo_std17_train:  4.26617; grad/diff17_train:  17556.95654; grad/cos17_train:  0.45163; grad_train:  1414.64087; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00010; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00006; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:25:32,259][trainer][INFO] - Step 430:
[2025-04-24 22:25:32,260][trainer][INFO] - loss/edit_train:  6.55707; loss/loc_train:  0.11071; edit/acc_train:  0.11310; edit/log_prob_train: -6.55707; edit/prob_train:  0.32580; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.26397; perplexity/pre_train:  71.09184; nll/post_train:  4.40937; perplexity/post_train:  82.21779; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.18638; loss/total_train:  0.76642; loss/total_edit_train:  0.76642; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.88664; grad/pseudo_mag0_train:  15368.18262; grad/true_std0_train:  0.00168; grad/pseudo_std0_train:  3.75177; grad/diff0_train:  15362.74932; grad/cos0_train:  0.78859; grad/true_mag1_train:  10.18974; grad/pseudo_mag1_train:  16071.98789; grad/true_std1_train:  0.00249; grad/pseudo_std1_train:  3.92341; grad/diff1_train:  16063.89150; grad/cos1_train:  0.79432; grad/true_mag2_train:  12.91396; grad/pseudo_mag2_train:  19615.62930; grad/true_std2_train:  0.00315; grad/pseudo_std2_train:  4.76512; grad/diff2_train:  19606.99102; grad/cos2_train:  0.66905; grad/true_mag3_train:  7.80411; grad/pseudo_mag3_train:  16459.62090; grad/true_std3_train:  0.00191; grad/pseudo_std3_train:  4.01841; grad/diff3_train:  16452.90283; grad/cos3_train:  0.85982; grad/true_mag4_train:  9.80719; grad/pseudo_mag4_train:  16533.04531; grad/true_std4_train:  0.00239; grad/pseudo_std4_train:  4.03628; grad/diff4_train:  16524.64404; grad/cos4_train:  0.85566; grad/true_mag5_train:  12.02252; grad/pseudo_mag5_train:  19092.18975; grad/true_std5_train:  0.00294; grad/pseudo_std5_train:  4.64925; grad/diff5_train:  19083.06797; grad/cos5_train:  0.75757; grad/true_mag6_train:  7.88296; grad/pseudo_mag6_train:  17236.68760; grad/true_std6_train:  0.00192; grad/pseudo_std6_train:  4.20814; grad/diff6_train:  17229.62041; grad/cos6_train:  0.89553; grad/true_mag7_train:  9.34191; grad/pseudo_mag7_train:  17303.18027; grad/true_std7_train:  0.00228; grad/pseudo_std7_train:  4.22437; grad/diff7_train:  17294.97041; grad/cos7_train:  0.87746; grad/true_mag8_train:  10.89139; grad/pseudo_mag8_train:  18798.52988; grad/true_std8_train:  0.00266; grad/pseudo_std8_train:  4.58810; grad/diff8_train:  18789.31494; grad/cos8_train:  0.84487; grad/true_mag9_train:  7.82106; grad/pseudo_mag9_train:  17536.28574; grad/true_std9_train:  0.00191; grad/pseudo_std9_train:  4.28129; grad/diff9_train:  17529.28281; grad/cos9_train:  0.89407; grad/true_mag10_train:  9.17446; grad/pseudo_mag10_train:  17698.94326; grad/true_std10_train:  0.00224; grad/pseudo_std10_train:  4.32099; grad/diff10_train:  17690.90293; grad/cos10_train:  0.87599; grad/true_mag11_train:  10.96577; grad/pseudo_mag11_train:  18987.96328; grad/true_std11_train:  0.00268; grad/pseudo_std11_train:  4.63453; grad/diff11_train:  18979.33135; grad/cos11_train:  0.78680; grad/true_mag12_train:  7.45173; grad/pseudo_mag12_train:  18153.97686; grad/true_std12_train:  0.00182; grad/pseudo_std12_train:  4.43208; grad/diff12_train:  18147.63271; grad/cos12_train:  0.85010; grad/true_mag13_train:  8.58153; grad/pseudo_mag13_train:  18525.07715; grad/true_std13_train:  0.00210; grad/pseudo_std13_train:  4.52266; grad/diff13_train:  18517.67480; grad/cos13_train:  0.86142; grad/true_mag14_train:  11.20902; grad/pseudo_mag14_train:  19298.56201; grad/true_std14_train:  0.00274; grad/pseudo_std14_train:  4.70920; grad/diff14_train:  19290.50771; grad/cos14_train:  0.71733; grad/true_mag15_train:  6.92755; grad/pseudo_mag15_train:  18057.84521; grad/true_std15_train:  0.00169; grad/pseudo_std15_train:  4.40844; grad/diff15_train:  18052.30254; grad/cos15_train:  0.79919; grad/true_mag16_train:  13.84157; grad/pseudo_mag16_train:  18722.57686; grad/true_std16_train:  0.00338; grad/pseudo_std16_train:  4.57071; grad/diff16_train:  18716.03623; grad/cos16_train:  0.48660; grad/true_mag17_train:  19.07734; grad/pseudo_mag17_train:  17036.29492; grad/true_std17_train:  0.00466; grad/pseudo_std17_train:  4.13324; grad/diff17_train:  17028.04258; grad/cos17_train:  0.43924; grad_train:  1430.86658; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00006; lr/lr16_train:  0.00006; lr/lr17_train:  0.00006
[2025-04-24 22:25:35,411][trainer][INFO] - Step 440:
[2025-04-24 22:25:35,411][trainer][INFO] - loss/edit_train:  6.87414; loss/loc_train:  0.14180; edit/acc_train:  0.09481; edit/log_prob_train: -6.87414; edit/prob_train:  0.36887; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.80707; perplexity/pre_train:  122.37215; nll/post_train:  5.58374; perplexity/post_train:  266.06369; n_tokens/pre_train:  3.20000; n_tokens/post_train:  3.20000; time/edit_train:  0.17571; loss/total_train:  0.82921; loss/total_edit_train:  0.82921; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.45088; grad/pseudo_mag0_train:  19681.08760; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.80473; grad/diff0_train:  19674.31865; grad/cos0_train:  0.79646; grad/true_mag1_train:  12.06625; grad/pseudo_mag1_train:  19692.11475; grad/true_std1_train:  0.00295; grad/pseudo_std1_train:  4.80728; grad/diff1_train:  19682.29512; grad/cos1_train:  0.80833; grad/true_mag2_train:  15.38492; grad/pseudo_mag2_train:  22234.43926; grad/true_std2_train:  0.00376; grad/pseudo_std2_train:  5.40880; grad/diff2_train:  22223.36270; grad/cos2_train:  0.70414; grad/true_mag3_train:  9.60858; grad/pseudo_mag3_train:  20495.75254; grad/true_std3_train:  0.00235; grad/pseudo_std3_train:  5.00377; grad/diff3_train:  20487.42979; grad/cos3_train:  0.86275; grad/true_mag4_train:  11.97063; grad/pseudo_mag4_train:  20417.90937; grad/true_std4_train:  0.00292; grad/pseudo_std4_train:  4.98473; grad/diff4_train:  20407.54658; grad/cos4_train:  0.86148; grad/true_mag5_train:  14.32605; grad/pseudo_mag5_train:  22605.60010; grad/true_std5_train:  0.00350; grad/pseudo_std5_train:  5.50867; grad/diff5_train:  22594.12275; grad/cos5_train:  0.78902; grad/true_mag6_train:  9.61281; grad/pseudo_mag6_train:  21027.71924; grad/true_std6_train:  0.00235; grad/pseudo_std6_train:  5.13367; grad/diff6_train:  21019.08672; grad/cos6_train:  0.89643; grad/true_mag7_train:  11.29823; grad/pseudo_mag7_train:  21147.71250; grad/true_std7_train:  0.00276; grad/pseudo_std7_train:  5.16294; grad/diff7_train:  21137.67559; grad/cos7_train:  0.88533; grad/true_mag8_train:  12.62401; grad/pseudo_mag8_train:  22284.92920; grad/true_std8_train:  0.00308; grad/pseudo_std8_train:  5.43938; grad/diff8_train:  22273.99795; grad/cos8_train:  0.85807; grad/true_mag9_train:  9.30342; grad/pseudo_mag9_train:  20876.93320; grad/true_std9_train:  0.00227; grad/pseudo_std9_train:  5.09686; grad/diff9_train:  20868.54199; grad/cos9_train:  0.89919; grad/true_mag10_train:  10.71317; grad/pseudo_mag10_train:  21025.16133; grad/true_std10_train:  0.00262; grad/pseudo_std10_train:  5.13304; grad/diff10_train:  21015.64512; grad/cos10_train:  0.88462; grad/true_mag11_train:  12.82765; grad/pseudo_mag11_train:  21806.48066; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  5.32296; grad/diff11_train:  21796.22715; grad/cos11_train:  0.79386; grad/true_mag12_train:  8.74658; grad/pseudo_mag12_train:  21261.94541; grad/true_std12_train:  0.00214; grad/pseudo_std12_train:  5.19085; grad/diff12_train:  21254.42461; grad/cos12_train:  0.85569; grad/true_mag13_train:  10.02266; grad/pseudo_mag13_train:  21563.41035; grad/true_std13_train:  0.00245; grad/pseudo_std13_train:  5.26444; grad/diff13_train:  21554.72217; grad/cos13_train:  0.86153; grad/true_mag14_train:  12.80304; grad/pseudo_mag14_train:  21857.75391; grad/true_std14_train:  0.00313; grad/pseudo_std14_train:  5.33455; grad/diff14_train:  21848.21348; grad/cos14_train:  0.73881; grad/true_mag15_train:  7.96955; grad/pseudo_mag15_train:  21007.82305; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  5.12862; grad/diff15_train:  21001.32529; grad/cos15_train:  0.81057; grad/true_mag16_train:  15.56795; grad/pseudo_mag16_train:  21844.89443; grad/true_std16_train:  0.00380; grad/pseudo_std16_train:  5.33298; grad/diff16_train:  21837.11963; grad/cos16_train:  0.50109; grad/true_mag17_train:  21.00047; grad/pseudo_mag17_train:  19400.43457; grad/true_std17_train:  0.00513; grad/pseudo_std17_train:  4.71223; grad/diff17_train:  19390.48291; grad/cos17_train:  0.47415; grad_train:  1740.67993; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00012; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00006; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00006; lr/lr14_train:  0.00006; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:25:39,113][trainer][INFO] - Step 450:
[2025-04-24 22:25:39,113][trainer][INFO] - loss/edit_train:  7.78138; loss/loc_train:  0.09964; edit/acc_train:  0.08524; edit/log_prob_train: -7.78138; edit/prob_train:  0.27447; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.41782; perplexity/pre_train:  82.91572; nll/post_train:  4.52728; perplexity/post_train:  92.50662; n_tokens/pre_train:  4.20000; n_tokens/post_train:  4.20000; time/edit_train:  0.22512; loss/total_train:  0.87778; loss/total_edit_train:  0.87778; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.18892; grad/pseudo_mag0_train:  19710.03711; grad/true_std0_train:  0.00200; grad/pseudo_std0_train:  4.81186; grad/diff0_train:  19703.46465; grad/cos0_train:  0.80234; grad/true_mag1_train:  11.73081; grad/pseudo_mag1_train:  19453.54180; grad/true_std1_train:  0.00286; grad/pseudo_std1_train:  4.74913; grad/diff1_train:  19443.93320; grad/cos1_train:  0.81757; grad/true_mag2_train:  14.89001; grad/pseudo_mag2_train:  21884.35898; grad/true_std2_train:  0.00364; grad/pseudo_std2_train:  5.32361; grad/diff2_train:  21873.58867; grad/cos2_train:  0.71916; grad/true_mag3_train:  9.40333; grad/pseudo_mag3_train:  20469.93311; grad/true_std3_train:  0.00230; grad/pseudo_std3_train:  4.99751; grad/diff3_train:  20461.79023; grad/cos3_train:  0.86664; grad/true_mag4_train:  11.52718; grad/pseudo_mag4_train:  20203.75205; grad/true_std4_train:  0.00281; grad/pseudo_std4_train:  4.93248; grad/diff4_train:  20193.65996; grad/cos4_train:  0.87492; grad/true_mag5_train:  13.87831; grad/pseudo_mag5_train:  22597.05840; grad/true_std5_train:  0.00339; grad/pseudo_std5_train:  5.50516; grad/diff5_train:  22586.05391; grad/cos5_train:  0.78779; grad/true_mag6_train:  9.34407; grad/pseudo_mag6_train:  20849.30645; grad/true_std6_train:  0.00228; grad/pseudo_std6_train:  5.09012; grad/diff6_train:  20840.86631; grad/cos6_train:  0.90292; grad/true_mag7_train:  10.80302; grad/pseudo_mag7_train:  20629.20215; grad/true_std7_train:  0.00264; grad/pseudo_std7_train:  5.03638; grad/diff7_train:  20619.55918; grad/cos7_train:  0.89248; grad/true_mag8_train:  12.43183; grad/pseudo_mag8_train:  22319.29102; grad/true_std8_train:  0.00304; grad/pseudo_std8_train:  5.44780; grad/diff8_train:  22308.45645; grad/cos8_train:  0.86871; grad/true_mag9_train:  8.99531; grad/pseudo_mag9_train:  20680.75713; grad/true_std9_train:  0.00220; grad/pseudo_std9_train:  5.04898; grad/diff9_train:  20672.62305; grad/cos9_train:  0.90403; grad/true_mag10_train:  10.36440; grad/pseudo_mag10_train:  20885.56924; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  5.09898; grad/diff10_train:  20876.25752; grad/cos10_train:  0.89825; grad/true_mag11_train:  12.15111; grad/pseudo_mag11_train:  21945.05723; grad/true_std11_train:  0.00297; grad/pseudo_std11_train:  5.35667; grad/diff11_train:  21935.04512; grad/cos11_train:  0.82155; grad/true_mag12_train:  8.23339; grad/pseudo_mag12_train:  20726.56172; grad/true_std12_train:  0.00201; grad/pseudo_std12_train:  5.06016; grad/diff12_train:  20719.38750; grad/cos12_train:  0.87073; grad/true_mag13_train:  9.55267; grad/pseudo_mag13_train:  21042.69766; grad/true_std13_train:  0.00233; grad/pseudo_std13_train:  5.13733; grad/diff13_train:  21034.33887; grad/cos13_train:  0.87398; grad/true_mag14_train:  11.88135; grad/pseudo_mag14_train:  21452.71563; grad/true_std14_train:  0.00290; grad/pseudo_std14_train:  5.23544; grad/diff14_train:  21443.69473; grad/cos14_train:  0.75627; grad/true_mag15_train:  7.59990; grad/pseudo_mag15_train:  20426.49922; grad/true_std15_train:  0.00186; grad/pseudo_std15_train:  4.98676; grad/diff15_train:  20420.26523; grad/cos15_train:  0.81919; grad/true_mag16_train:  14.17484; grad/pseudo_mag16_train:  21006.49971; grad/true_std16_train:  0.00346; grad/pseudo_std16_train:  5.12839; grad/diff16_train:  20999.01123; grad/cos16_train:  0.53273; grad/true_mag17_train:  19.64120; grad/pseudo_mag17_train:  19752.37520; grad/true_std17_train:  0.00480; grad/pseudo_std17_train:  4.79867; grad/diff17_train:  19742.73477; grad/cos17_train:  0.49191; grad_train:  2021.97192; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00013; lr/lr6_train:  0.00007; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00006; lr/lr10_train:  0.00005; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:25:42,382][trainer][INFO] - Step 460:
[2025-04-24 22:25:42,383][trainer][INFO] - loss/edit_train:  8.32801; loss/loc_train:  0.04314; edit/acc_train:  0.06997; edit/log_prob_train: -8.32801; edit/prob_train:  0.28228; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.78655; perplexity/pre_train:  16.22499; nll/post_train:  2.80398; perplexity/post_train:  16.51015; n_tokens/pre_train:  17.50000; n_tokens/post_train:  17.50000; time/edit_train:  0.17299; loss/total_train:  0.87594; loss/total_edit_train:  0.87594; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.10718; grad/pseudo_mag0_train:  18824.46172; grad/true_std0_train:  0.00198; grad/pseudo_std0_train:  4.59549; grad/diff0_train:  18818.01533; grad/cos0_train:  0.78911; grad/true_mag1_train:  11.86543; grad/pseudo_mag1_train:  19546.93594; grad/true_std1_train:  0.00290; grad/pseudo_std1_train:  4.77177; grad/diff1_train:  19537.32686; grad/cos1_train:  0.80473; grad/true_mag2_train:  15.58046; grad/pseudo_mag2_train:  21683.57031; grad/true_std2_train:  0.00380; grad/pseudo_std2_train:  5.27752; grad/diff2_train:  21672.09482; grad/cos2_train:  0.72446; grad/true_mag3_train:  9.32460; grad/pseudo_mag3_train:  19901.54131; grad/true_std3_train:  0.00228; grad/pseudo_std3_train:  4.85871; grad/diff3_train:  19893.49219; grad/cos3_train:  0.85862; grad/true_mag4_train:  11.63461; grad/pseudo_mag4_train:  20049.70645; grad/true_std4_train:  0.00284; grad/pseudo_std4_train:  4.89479; grad/diff4_train:  20039.64580; grad/cos4_train:  0.86019; grad/true_mag5_train:  14.05828; grad/pseudo_mag5_train:  22122.96123; grad/true_std5_train:  0.00343; grad/pseudo_std5_train:  5.39133; grad/diff5_train:  22111.64121; grad/cos5_train:  0.79532; grad/true_mag6_train:  9.40774; grad/pseudo_mag6_train:  20677.49111; grad/true_std6_train:  0.00230; grad/pseudo_std6_train:  5.04815; grad/diff6_train:  20669.04268; grad/cos6_train:  0.89320; grad/true_mag7_train:  11.05580; grad/pseudo_mag7_train:  20900.09844; grad/true_std7_train:  0.00270; grad/pseudo_std7_train:  5.10245; grad/diff7_train:  20890.29316; grad/cos7_train:  0.88143; grad/true_mag8_train:  12.72567; grad/pseudo_mag8_train:  22238.04307; grad/true_std8_train:  0.00311; grad/pseudo_std8_train:  5.42792; grad/diff8_train:  22227.12461; grad/cos8_train:  0.84910; grad/true_mag9_train:  8.87994; grad/pseudo_mag9_train:  20157.21348; grad/true_std9_train:  0.00217; grad/pseudo_std9_train:  4.92114; grad/diff9_train:  20149.24961; grad/cos9_train:  0.89238; grad/true_mag10_train:  11.03353; grad/pseudo_mag10_train:  20121.97236; grad/true_std10_train:  0.00269; grad/pseudo_std10_train:  4.91251; grad/diff10_train:  20112.81113; grad/cos10_train:  0.83661; grad/true_mag11_train:  12.04895; grad/pseudo_mag11_train:  21035.47051; grad/true_std11_train:  0.00294; grad/pseudo_std11_train:  5.13475; grad/diff11_train:  21025.58877; grad/cos11_train:  0.81441; grad/true_mag12_train:  8.27086; grad/pseudo_mag12_train:  20315.05137; grad/true_std12_train:  0.00202; grad/pseudo_std12_train:  4.95968; grad/diff12_train:  20307.96641; grad/cos12_train:  0.84998; grad/true_mag13_train:  9.29373; grad/pseudo_mag13_train:  19815.37832; grad/true_std13_train:  0.00227; grad/pseudo_std13_train:  4.83765; grad/diff13_train:  19807.48623; grad/cos13_train:  0.84405; grad/true_mag14_train:  12.18533; grad/pseudo_mag14_train:  20688.54648; grad/true_std14_train:  0.00297; grad/pseudo_std14_train:  5.04931; grad/diff14_train:  20679.44404; grad/cos14_train:  0.74342; grad/true_mag15_train:  7.62679; grad/pseudo_mag15_train:  19558.52520; grad/true_std15_train:  0.00186; grad/pseudo_std15_train:  4.77477; grad/diff15_train:  19552.41641; grad/cos15_train:  0.79717; grad/true_mag16_train:  14.64376; grad/pseudo_mag16_train:  19548.16035; grad/true_std16_train:  0.00358; grad/pseudo_std16_train:  4.77229; grad/diff16_train:  19540.94932; grad/cos16_train:  0.50823; grad/true_mag17_train:  20.32842; grad/pseudo_mag17_train:  18402.34883; grad/true_std17_train:  0.00496; grad/pseudo_std17_train:  4.46796; grad/diff17_train:  18393.16992; grad/cos17_train:  0.45560; grad_train:  1432.99805; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00006; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:25:45,657][trainer][INFO] - Step 470:
[2025-04-24 22:25:45,658][trainer][INFO] - loss/edit_train:  9.93737; loss/loc_train:  0.08931; edit/acc_train:  0.01891; edit/log_prob_train: -9.93737; edit/prob_train:  0.24613; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.87121; perplexity/pre_train:  48.00023; nll/post_train:  3.91405; perplexity/post_train:  50.10150; n_tokens/pre_train:  5.70000; n_tokens/post_train:  5.70000; time/edit_train:  0.17935; loss/total_train:  1.08305; loss/total_edit_train:  1.08305; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.91071; grad/pseudo_mag0_train:  15454.96162; grad/true_std0_train:  0.00169; grad/pseudo_std0_train:  3.77285; grad/diff0_train:  15449.54219; grad/cos0_train:  0.78238; grad/true_mag1_train:  10.04954; grad/pseudo_mag1_train:  16028.76924; grad/true_std1_train:  0.00245; grad/pseudo_std1_train:  3.91278; grad/diff1_train:  16020.75049; grad/cos1_train:  0.79453; grad/true_mag2_train:  13.62770; grad/pseudo_mag2_train:  20060.46592; grad/true_std2_train:  0.00333; grad/pseudo_std2_train:  4.86537; grad/diff2_train:  20051.49775; grad/cos2_train:  0.64176; grad/true_mag3_train:  8.13546; grad/pseudo_mag3_train:  17278.31426; grad/true_std3_train:  0.00199; grad/pseudo_std3_train:  4.21827; grad/diff3_train:  17271.32070; grad/cos3_train:  0.85761; grad/true_mag4_train:  10.07774; grad/pseudo_mag4_train:  17187.11846; grad/true_std4_train:  0.00246; grad/pseudo_std4_train:  4.19593; grad/diff4_train:  17178.47314; grad/cos4_train:  0.85531; grad/true_mag5_train:  12.47986; grad/pseudo_mag5_train:  20380.32354; grad/true_std5_train:  0.00305; grad/pseudo_std5_train:  4.95782; grad/diff5_train:  20370.89492; grad/cos5_train:  0.74205; grad/true_mag6_train:  8.32386; grad/pseudo_mag6_train:  18391.03809; grad/true_std6_train:  0.00203; grad/pseudo_std6_train:  4.48994; grad/diff6_train:  18383.54629; grad/cos6_train:  0.89846; grad/true_mag7_train:  9.73186; grad/pseudo_mag7_train:  18314.21113; grad/true_std7_train:  0.00238; grad/pseudo_std7_train:  4.47118; grad/diff7_train:  18305.60498; grad/cos7_train:  0.88158; grad/true_mag8_train:  11.39626; grad/pseudo_mag8_train:  20140.24844; grad/true_std8_train:  0.00278; grad/pseudo_std8_train:  4.91555; grad/diff8_train:  20130.54570; grad/cos8_train:  0.84349; grad/true_mag9_train:  8.33526; grad/pseudo_mag9_train:  19010.18389; grad/true_std9_train:  0.00203; grad/pseudo_std9_train:  4.64110; grad/diff9_train:  19002.67246; grad/cos9_train:  0.89942; grad/true_mag10_train:  9.74595; grad/pseudo_mag10_train:  19174.06006; grad/true_std10_train:  0.00238; grad/pseudo_std10_train:  4.68110; grad/diff10_train:  19165.41660; grad/cos10_train:  0.88326; grad/true_mag11_train:  11.70854; grad/pseudo_mag11_train:  20630.19482; grad/true_std11_train:  0.00286; grad/pseudo_std11_train:  5.03555; grad/diff11_train:  20620.81094; grad/cos11_train:  0.79526; grad/true_mag12_train:  7.93948; grad/pseudo_mag12_train:  19768.55322; grad/true_std12_train:  0.00194; grad/pseudo_std12_train:  4.82624; grad/diff12_train:  19761.73584; grad/cos12_train:  0.85550; grad/true_mag13_train:  9.25959; grad/pseudo_mag13_train:  20150.51592; grad/true_std13_train:  0.00226; grad/pseudo_std13_train:  4.91947; grad/diff13_train:  20142.48105; grad/cos13_train:  0.86483; grad/true_mag14_train:  11.93442; grad/pseudo_mag14_train:  20728.11064; grad/true_std14_train:  0.00291; grad/pseudo_std14_train:  5.05781; grad/diff14_train:  20719.34863; grad/cos14_train:  0.72483; grad/true_mag15_train:  7.52239; grad/pseudo_mag15_train:  20232.69043; grad/true_std15_train:  0.00184; grad/pseudo_std15_train:  4.93935; grad/diff15_train:  20226.56943; grad/cos15_train:  0.81034; grad/true_mag16_train:  14.89164; grad/pseudo_mag16_train:  20937.77373; grad/true_std16_train:  0.00364; grad/pseudo_std16_train:  5.11150; grad/diff16_train:  20930.43457; grad/cos16_train:  0.49185; grad/true_mag17_train:  20.77600; grad/pseudo_mag17_train:  18908.57900; grad/true_std17_train:  0.00507; grad/pseudo_std17_train:  4.58070; grad/diff17_train:  18899.30469; grad/cos17_train:  0.44223; grad_train:  1560.17236; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00012; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00009; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:25:49,199][trainer][INFO] - Step 480:
[2025-04-24 22:25:49,200][trainer][INFO] - loss/edit_train:  7.95144; loss/loc_train:  0.11417; edit/acc_train:  0.06845; edit/log_prob_train: -7.95144; edit/prob_train:  0.26096; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.02983; perplexity/pre_train:  56.25147; nll/post_train:  4.23965; perplexity/post_train:  69.38367; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.22016; loss/total_train:  0.90931; loss/total_edit_train:  0.90931; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.22317; grad/pseudo_mag0_train:  17490.22314; grad/true_std0_train:  0.00176; grad/pseudo_std0_train:  4.26981; grad/diff0_train:  17484.50518; grad/cos0_train:  0.79045; grad/true_mag1_train:  10.51982; grad/pseudo_mag1_train:  17507.24414; grad/true_std1_train:  0.00257; grad/pseudo_std1_train:  4.27374; grad/diff1_train:  17498.93809; grad/cos1_train:  0.79041; grad/true_mag2_train:  13.59783; grad/pseudo_mag2_train:  21208.39268; grad/true_std2_train:  0.00332; grad/pseudo_std2_train:  5.14571; grad/diff2_train:  21199.46299; grad/cos2_train:  0.65637; grad/true_mag3_train:  8.15781; grad/pseudo_mag3_train:  17696.34434; grad/true_std3_train:  0.00199; grad/pseudo_std3_train:  4.32033; grad/diff3_train:  17689.37471; grad/cos3_train:  0.85172; grad/true_mag4_train:  10.30800; grad/pseudo_mag4_train:  17866.87783; grad/true_std4_train:  0.00252; grad/pseudo_std4_train:  4.36186; grad/diff4_train:  17858.03750; grad/cos4_train:  0.85601; grad/true_mag5_train:  12.79802; grad/pseudo_mag5_train:  20340.22148; grad/true_std5_train:  0.00312; grad/pseudo_std5_train:  4.95163; grad/diff5_train:  20330.51328; grad/cos5_train:  0.75577; grad/true_mag6_train:  8.13506; grad/pseudo_mag6_train:  18222.89238; grad/true_std6_train:  0.00199; grad/pseudo_std6_train:  4.44890; grad/diff6_train:  18215.66064; grad/cos6_train:  0.88480; grad/true_mag7_train:  9.54023; grad/pseudo_mag7_train:  18143.54414; grad/true_std7_train:  0.00233; grad/pseudo_std7_train:  4.42947; grad/diff7_train:  18135.20918; grad/cos7_train:  0.87049; grad/true_mag8_train:  11.70259; grad/pseudo_mag8_train:  20284.83789; grad/true_std8_train:  0.00286; grad/pseudo_std8_train:  4.95088; grad/diff8_train:  20275.28975; grad/cos8_train:  0.82261; grad/true_mag9_train:  7.86729; grad/pseudo_mag9_train:  17986.75713; grad/true_std9_train:  0.00192; grad/pseudo_std9_train:  4.39124; grad/diff9_train:  17979.81309; grad/cos9_train:  0.87323; grad/true_mag10_train:  10.61452; grad/pseudo_mag10_train:  17889.12744; grad/true_std10_train:  0.00259; grad/pseudo_std10_train:  4.36737; grad/diff10_train:  17881.03301; grad/cos10_train:  0.81590; grad/true_mag11_train:  11.04378; grad/pseudo_mag11_train:  19454.34346; grad/true_std11_train:  0.00270; grad/pseudo_std11_train:  4.74831; grad/diff11_train:  19445.63965; grad/cos11_train:  0.78165; grad/true_mag12_train:  7.55477; grad/pseudo_mag12_train:  18338.35439; grad/true_std12_train:  0.00184; grad/pseudo_std12_train:  4.47708; grad/diff12_train:  18331.98896; grad/cos12_train:  0.83155; grad/true_mag13_train:  8.86340; grad/pseudo_mag13_train:  18196.66484; grad/true_std13_train:  0.00216; grad/pseudo_std13_train:  4.44248; grad/diff13_train:  18189.24785; grad/cos13_train:  0.83107; grad/true_mag14_train:  11.22980; grad/pseudo_mag14_train:  19209.33984; grad/true_std14_train:  0.00274; grad/pseudo_std14_train:  4.68773; grad/diff14_train:  19201.20820; grad/cos14_train:  0.71690; grad/true_mag15_train:  7.10688; grad/pseudo_mag15_train:  18496.38125; grad/true_std15_train:  0.00174; grad/pseudo_std15_train:  4.51545; grad/diff15_train:  18490.73555; grad/cos15_train:  0.78446; grad/true_mag16_train:  14.31199; grad/pseudo_mag16_train:  18491.98223; grad/true_std16_train:  0.00349; grad/pseudo_std16_train:  4.51441; grad/diff16_train:  18485.38730; grad/cos16_train:  0.47137; grad/true_mag17_train:  19.70407; grad/pseudo_mag17_train:  17401.84072; grad/true_std17_train:  0.00481; grad/pseudo_std17_train:  4.22308; grad/diff17_train:  17393.18223; grad/cos17_train:  0.44064; grad_train:  1363.24402; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00006; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00006
[2025-04-24 22:25:52,353][trainer][INFO] - Step 490:
[2025-04-24 22:25:52,353][trainer][INFO] - loss/edit_train:  7.28576; loss/loc_train:  0.07143; edit/acc_train:  0.09583; edit/log_prob_train: -7.28576; edit/prob_train:  0.25969; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.02561; perplexity/pre_train:  56.01456; nll/post_train:  4.11399; perplexity/post_train:  61.19062; n_tokens/pre_train:  10.20000; n_tokens/post_train:  10.20000; time/edit_train:  0.17934; loss/total_train:  0.80001; loss/total_edit_train:  0.80001; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.96012; grad/pseudo_mag0_train:  18640.56611; grad/true_std0_train:  0.00194; grad/pseudo_std0_train:  4.55069; grad/diff0_train:  18634.21309; grad/cos0_train:  0.79574; grad/true_mag1_train:  11.69429; grad/pseudo_mag1_train:  19160.75752; grad/true_std1_train:  0.00286; grad/pseudo_std1_train:  4.67750; grad/diff1_train:  19151.30820; grad/cos1_train:  0.80525; grad/true_mag2_train:  15.41642; grad/pseudo_mag2_train:  24403.80156; grad/true_std2_train:  0.00376; grad/pseudo_std2_train:  5.91021; grad/diff2_train:  24393.69941; grad/cos2_train:  0.63890; grad/true_mag3_train:  9.27930; grad/pseudo_mag3_train:  20139.53350; grad/true_std3_train:  0.00227; grad/pseudo_std3_train:  4.91681; grad/diff3_train:  20131.50264; grad/cos3_train:  0.86184; grad/true_mag4_train:  11.57782; grad/pseudo_mag4_train:  20068.28936; grad/true_std4_train:  0.00283; grad/pseudo_std4_train:  4.89938; grad/diff4_train:  20058.26182; grad/cos4_train:  0.86239; grad/true_mag5_train:  14.36996; grad/pseudo_mag5_train:  23382.14922; grad/true_std5_train:  0.00351; grad/pseudo_std5_train:  5.68485; grad/diff5_train:  23371.32607; grad/cos5_train:  0.74305; grad/true_mag6_train:  9.41899; grad/pseudo_mag6_train:  20950.58789; grad/true_std6_train:  0.00230; grad/pseudo_std6_train:  5.11485; grad/diff6_train:  20942.10146; grad/cos6_train:  0.89833; grad/true_mag7_train:  10.99340; grad/pseudo_mag7_train:  20893.29648; grad/true_std7_train:  0.00268; grad/pseudo_std7_train:  5.10084; grad/diff7_train:  20883.54268; grad/cos7_train:  0.88276; grad/true_mag8_train:  12.57317; grad/pseudo_mag8_train:  22736.90469; grad/true_std8_train:  0.00307; grad/pseudo_std8_train:  5.54844; grad/diff8_train:  22726.26904; grad/cos8_train:  0.83722; grad/true_mag9_train:  9.12515; grad/pseudo_mag9_train:  20807.47295; grad/true_std9_train:  0.00223; grad/pseudo_std9_train:  5.07990; grad/diff9_train:  20799.26289; grad/cos9_train:  0.89647; grad/true_mag10_train:  10.50548; grad/pseudo_mag10_train:  20967.59697; grad/true_std10_train:  0.00256; grad/pseudo_std10_train:  5.11898; grad/diff10_train:  20958.23623; grad/cos10_train:  0.88635; grad/true_mag11_train:  12.72936; grad/pseudo_mag11_train:  22870.74297; grad/true_std11_train:  0.00311; grad/pseudo_std11_train:  5.58192; grad/diff11_train:  22860.54014; grad/cos11_train:  0.79397; grad/true_mag12_train:  8.69092; grad/pseudo_mag12_train:  21719.57246; grad/true_std12_train:  0.00212; grad/pseudo_std12_train:  5.30256; grad/diff12_train:  21712.04863; grad/cos12_train:  0.86024; grad/true_mag13_train:  10.05632; grad/pseudo_mag13_train:  21818.23145; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  5.32664; grad/diff13_train:  21809.50479; grad/cos13_train:  0.86234; grad/true_mag14_train:  12.69165; grad/pseudo_mag14_train:  22864.83291; grad/true_std14_train:  0.00310; grad/pseudo_std14_train:  5.57897; grad/diff14_train:  22855.34014; grad/cos14_train:  0.74041; grad/true_mag15_train:  7.85767; grad/pseudo_mag15_train:  21354.21699; grad/true_std15_train:  0.00192; grad/pseudo_std15_train:  5.21317; grad/diff15_train:  21347.69570; grad/cos15_train:  0.82625; grad/true_mag16_train:  13.25269; grad/pseudo_mag16_train:  22660.70518; grad/true_std16_train:  0.00324; grad/pseudo_std16_train:  5.53212; grad/diff16_train:  22652.87568; grad/cos16_train:  0.59033; grad/true_mag17_train:  20.01887; grad/pseudo_mag17_train:  20208.39316; grad/true_std17_train:  0.00489; grad/pseudo_std17_train:  4.90236; grad/diff17_train:  20198.45850; grad/cos17_train:  0.49611; grad_train:  1157.54639; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:25:55,438][trainer][INFO] - Step 500:
[2025-04-24 22:25:55,438][trainer][INFO] - loss/edit_train:  6.42607; loss/loc_train:  0.08934; edit/acc_train:  0.08179; edit/log_prob_train: -6.42607; edit/prob_train:  0.29434; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.50276; perplexity/pre_train:  33.20701; nll/post_train:  3.51888; perplexity/post_train:  33.74648; n_tokens/pre_train:  10.30000; n_tokens/post_train:  10.30000; time/edit_train:  0.17432; loss/total_train:  0.73195; loss/total_edit_train:  0.73195; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.02989; grad/pseudo_mag0_train:  18509.06709; grad/true_std0_train:  0.00196; grad/pseudo_std0_train:  4.51860; grad/diff0_train:  18502.66025; grad/cos0_train:  0.79580; grad/true_mag1_train:  11.65300; grad/pseudo_mag1_train:  19252.14258; grad/true_std1_train:  0.00284; grad/pseudo_std1_train:  4.69976; grad/diff1_train:  19242.71680; grad/cos1_train:  0.80525; grad/true_mag2_train:  15.20700; grad/pseudo_mag2_train:  24927.74688; grad/true_std2_train:  0.00371; grad/pseudo_std2_train:  6.03826; grad/diff2_train:  24917.72754; grad/cos2_train:  0.64356; grad/true_mag3_train:  9.24808; grad/pseudo_mag3_train:  20226.35723; grad/true_std3_train:  0.00226; grad/pseudo_std3_train:  4.93801; grad/diff3_train:  20218.32266; grad/cos3_train:  0.86631; grad/true_mag4_train:  11.66032; grad/pseudo_mag4_train:  20289.79268; grad/true_std4_train:  0.00285; grad/pseudo_std4_train:  4.95342; grad/diff4_train:  20279.67646; grad/cos4_train:  0.86406; grad/true_mag5_train:  14.20900; grad/pseudo_mag5_train:  23176.29375; grad/true_std5_train:  0.00347; grad/pseudo_std5_train:  5.64163; grad/diff5_train:  23165.14531; grad/cos5_train:  0.77161; grad/true_mag6_train:  9.54406; grad/pseudo_mag6_train:  21067.05811; grad/true_std6_train:  0.00233; grad/pseudo_std6_train:  5.14327; grad/diff6_train:  21058.44990; grad/cos6_train:  0.89999; grad/true_mag7_train:  11.17827; grad/pseudo_mag7_train:  21312.94668; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  5.20328; grad/diff7_train:  21302.98486; grad/cos7_train:  0.88816; grad/true_mag8_train:  12.71717; grad/pseudo_mag8_train:  22613.47012; grad/true_std8_train:  0.00310; grad/pseudo_std8_train:  5.51911; grad/diff8_train:  22602.47598; grad/cos8_train:  0.85846; grad/true_mag9_train:  9.38707; grad/pseudo_mag9_train:  21401.09863; grad/true_std9_train:  0.00229; grad/pseudo_std9_train:  5.22483; grad/diff9_train:  21392.65332; grad/cos9_train:  0.89712; grad/true_mag10_train:  10.54704; grad/pseudo_mag10_train:  21192.98359; grad/true_std10_train:  0.00257; grad/pseudo_std10_train:  5.17400; grad/diff10_train:  21183.55625; grad/cos10_train:  0.89043; grad/true_mag11_train:  12.84104; grad/pseudo_mag11_train:  22566.63594; grad/true_std11_train:  0.00314; grad/pseudo_std11_train:  5.50816; grad/diff11_train:  22556.40078; grad/cos11_train:  0.78918; grad/true_mag12_train:  8.86577; grad/pseudo_mag12_train:  22075.61270; grad/true_std12_train:  0.00216; grad/pseudo_std12_train:  5.38949; grad/diff12_train:  22067.95352; grad/cos12_train:  0.85974; grad/true_mag13_train:  10.11611; grad/pseudo_mag13_train:  21695.78477; grad/true_std13_train:  0.00247; grad/pseudo_std13_train:  5.29675; grad/diff13_train:  21687.05371; grad/cos13_train:  0.85919; grad/true_mag14_train:  12.86053; grad/pseudo_mag14_train:  22471.09473; grad/true_std14_train:  0.00314; grad/pseudo_std14_train:  5.48354; grad/diff14_train:  22461.58281; grad/cos14_train:  0.73126; grad/true_mag15_train:  8.41416; grad/pseudo_mag15_train:  22566.42705; grad/true_std15_train:  0.00205; grad/pseudo_std15_train:  5.50914; grad/diff15_train:  22559.58584; grad/cos15_train:  0.80890; grad/true_mag16_train:  15.28251; grad/pseudo_mag16_train:  21996.67568; grad/true_std16_train:  0.00373; grad/pseudo_std16_train:  5.37002; grad/diff16_train:  21988.84043; grad/cos16_train:  0.52486; grad/true_mag17_train:  20.68455; grad/pseudo_mag17_train:  20481.30352; grad/true_std17_train:  0.00505; grad/pseudo_std17_train:  4.96958; grad/diff17_train:  20471.36348; grad/cos17_train:  0.47970; grad_train:  1262.57971; lr/lr0_train:  0.00008; lr/lr1_train:  0.00007; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:26:13,852][trainer][INFO] - Step 500:
[2025-04-24 22:26:13,853][trainer][INFO] - loss/edit_val:  8.09409; loss/loc_val:  0.12564; edit/acc_val:  0.04188; edit/log_prob_val: -8.09409; edit/prob_val:  0.25565; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.45548; perplexity/post_val:  86.09734; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11126; loss/total_val:  0.93504; loss/total_edit_val:  0.93504; memory/alloc_max_val:  42026814976.00000; memory/res_max_val:  44885344256.00000; eval_time/elapsed:  18.40933; eval_time/average:  0.18409
[2025-04-24 22:26:13,856][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:26:13,856][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:27:08,136][trainer][INFO] - Write complete.
[2025-04-24 22:27:11,222][trainer][INFO] - Step 510:
[2025-04-24 22:27:11,223][trainer][INFO] - loss/edit_train:  6.54345; loss/loc_train:  0.11670; edit/acc_train:  0.07431; edit/log_prob_train: -6.54345; edit/prob_train:  0.27147; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.60259; perplexity/pre_train:  36.69323; nll/post_train:  3.74269; perplexity/post_train:  42.21149; n_tokens/pre_train:  7.30000; n_tokens/post_train:  7.30000; time/edit_train:  0.17251; loss/total_train:  0.77104; loss/total_edit_train:  0.77104; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.97652; grad/pseudo_mag0_train:  18371.99922; grad/true_std0_train:  0.00195; grad/pseudo_std0_train:  4.48491; grad/diff0_train:  18365.78369; grad/cos0_train:  0.77287; grad/true_mag1_train:  11.68590; grad/pseudo_mag1_train:  18940.22324; grad/true_std1_train:  0.00285; grad/pseudo_std1_train:  4.62348; grad/diff1_train:  18930.98564; grad/cos1_train:  0.78509; grad/true_mag2_train:  15.21301; grad/pseudo_mag2_train:  23570.56074; grad/true_std2_train:  0.00371; grad/pseudo_std2_train:  5.70964; grad/diff2_train:  23560.81660; grad/cos2_train:  0.62002; grad/true_mag3_train:  9.01868; grad/pseudo_mag3_train:  19336.40205; grad/true_std3_train:  0.00220; grad/pseudo_std3_train:  4.72069; grad/diff3_train:  19328.71787; grad/cos3_train:  0.84746; grad/true_mag4_train:  11.32950; grad/pseudo_mag4_train:  19484.88760; grad/true_std4_train:  0.00277; grad/pseudo_std4_train:  4.75686; grad/diff4_train:  19475.18340; grad/cos4_train:  0.85042; grad/true_mag5_train:  14.04791; grad/pseudo_mag5_train:  22294.99883; grad/true_std5_train:  0.00343; grad/pseudo_std5_train:  5.42495; grad/diff5_train:  22284.33750; grad/cos5_train:  0.74016; grad/true_mag6_train:  9.24802; grad/pseudo_mag6_train:  20326.94678; grad/true_std6_train:  0.00226; grad/pseudo_std6_train:  4.96257; grad/diff6_train:  20318.69189; grad/cos6_train:  0.88933; grad/true_mag7_train:  10.98341; grad/pseudo_mag7_train:  20469.89268; grad/true_std7_train:  0.00268; grad/pseudo_std7_train:  4.99745; grad/diff7_train:  20460.25830; grad/cos7_train:  0.86995; grad/true_mag8_train:  12.54229; grad/pseudo_mag8_train:  22207.38564; grad/true_std8_train:  0.00306; grad/pseudo_std8_train:  5.41998; grad/diff8_train:  22196.65527; grad/cos8_train:  0.84285; grad/true_mag9_train:  9.15370; grad/pseudo_mag9_train:  20763.55918; grad/true_std9_train:  0.00223; grad/pseudo_std9_train:  5.06916; grad/diff9_train:  20755.36982; grad/cos9_train:  0.89177; grad/true_mag10_train:  10.54065; grad/pseudo_mag10_train:  20845.81152; grad/true_std10_train:  0.00257; grad/pseudo_std10_train:  5.08922; grad/diff10_train:  20836.52705; grad/cos10_train:  0.87675; grad/true_mag11_train:  12.57776; grad/pseudo_mag11_train:  21933.45146; grad/true_std11_train:  0.00307; grad/pseudo_std11_train:  5.35347; grad/diff11_train:  21923.35967; grad/cos11_train:  0.79032; grad/true_mag12_train:  8.49282; grad/pseudo_mag12_train:  20881.73896; grad/true_std12_train:  0.00207; grad/pseudo_std12_train:  5.09801; grad/diff12_train:  20874.49277; grad/cos12_train:  0.84681; grad/true_mag13_train:  9.79000; grad/pseudo_mag13_train:  20946.40391; grad/true_std13_train:  0.00239; grad/pseudo_std13_train:  5.11376; grad/diff13_train:  20938.00254; grad/cos13_train:  0.85231; grad/true_mag14_train:  12.58113; grad/pseudo_mag14_train:  21904.39844; grad/true_std14_train:  0.00307; grad/pseudo_std14_train:  5.34457; grad/diff14_train:  21895.18613; grad/cos14_train:  0.72055; grad/true_mag15_train:  7.76937; grad/pseudo_mag15_train:  20105.37119; grad/true_std15_train:  0.00190; grad/pseudo_std15_train:  4.90824; grad/diff15_train:  20099.16436; grad/cos15_train:  0.79339; grad/true_mag16_train:  14.99843; grad/pseudo_mag16_train:  20322.57891; grad/true_std16_train:  0.00366; grad/pseudo_std16_train:  4.96129; grad/diff16_train:  20315.28877; grad/cos16_train:  0.49283; grad/true_mag17_train:  20.75051; grad/pseudo_mag17_train:  19378.47510; grad/true_std17_train:  0.00507; grad/pseudo_std17_train:  4.69577; grad/diff17_train:  19369.01533; grad/cos17_train:  0.45540; grad_train:  884.18176; lr/lr0_train:  0.00007; lr/lr1_train:  0.00007; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:27:14,407][trainer][INFO] - Step 520:
[2025-04-24 22:27:14,407][trainer][INFO] - loss/edit_train:  8.51920; loss/loc_train:  0.04547; edit/acc_train:  0.05849; edit/log_prob_train: -8.51920; edit/prob_train:  0.25021; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.72388; perplexity/pre_train:  112.60438; nll/post_train:  4.65768; perplexity/post_train:  105.39143; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.17646; loss/total_train:  0.89739; loss/total_edit_train:  0.89739; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.99133; grad/pseudo_mag0_train:  21598.00352; grad/true_std0_train:  0.00220; grad/pseudo_std0_train:  5.27258; grad/diff0_train:  21590.82578; grad/cos0_train:  0.79454; grad/true_mag1_train:  12.52024; grad/pseudo_mag1_train:  20937.17500; grad/true_std1_train:  0.00306; grad/pseudo_std1_train:  5.11098; grad/diff1_train:  20926.98232; grad/cos1_train:  0.80759; grad/true_mag2_train:  15.83608; grad/pseudo_mag2_train:  26100.99941; grad/true_std2_train:  0.00387; grad/pseudo_std2_train:  6.31577; grad/diff2_train:  26090.43984; grad/cos2_train:  0.63629; grad/true_mag3_train:  9.97378; grad/pseudo_mag3_train:  21989.33213; grad/true_std3_train:  0.00244; grad/pseudo_std3_train:  5.36839; grad/diff3_train:  21980.65176; grad/cos3_train:  0.86562; grad/true_mag4_train:  12.38220; grad/pseudo_mag4_train:  21440.69873; grad/true_std4_train:  0.00302; grad/pseudo_std4_train:  5.23435; grad/diff4_train:  21429.98252; grad/cos4_train:  0.85942; grad/true_mag5_train:  14.86633; grad/pseudo_mag5_train:  24561.71914; grad/true_std5_train:  0.00363; grad/pseudo_std5_train:  5.97007; grad/diff5_train:  24550.15742; grad/cos5_train:  0.75288; grad/true_mag6_train:  9.95072; grad/pseudo_mag6_train:  22220.06260; grad/true_std6_train:  0.00243; grad/pseudo_std6_train:  5.42473; grad/diff6_train:  22211.08203; grad/cos6_train:  0.89964; grad/true_mag7_train:  11.56094; grad/pseudo_mag7_train:  22040.80625; grad/true_std7_train:  0.00282; grad/pseudo_std7_train:  5.38095; grad/diff7_train:  22030.51348; grad/cos7_train:  0.88521; grad/true_mag8_train:  13.13395; grad/pseudo_mag8_train:  23542.90518; grad/true_std8_train:  0.00321; grad/pseudo_std8_train:  5.74577; grad/diff8_train:  23531.49141; grad/cos8_train:  0.85746; grad/true_mag9_train:  9.62497; grad/pseudo_mag9_train:  22109.75742; grad/true_std9_train:  0.00235; grad/pseudo_std9_train:  5.39780; grad/diff9_train:  22101.08564; grad/cos9_train:  0.89792; grad/true_mag10_train:  11.11631; grad/pseudo_mag10_train:  22122.87822; grad/true_std10_train:  0.00271; grad/pseudo_std10_train:  5.40100; grad/diff10_train:  22112.97275; grad/cos10_train:  0.88632; grad/true_mag11_train:  12.95868; grad/pseudo_mag11_train:  23181.15732; grad/true_std11_train:  0.00316; grad/pseudo_std11_train:  5.65809; grad/diff11_train:  23170.53350; grad/cos11_train:  0.81127; grad/true_mag12_train:  8.88319; grad/pseudo_mag12_train:  22329.38398; grad/true_std12_train:  0.00217; grad/pseudo_std12_train:  5.45143; grad/diff12_train:  22321.67188; grad/cos12_train:  0.86289; grad/true_mag13_train:  10.31078; grad/pseudo_mag13_train:  22345.89336; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  5.45543; grad/diff13_train:  22336.93857; grad/cos13_train:  0.86339; grad/true_mag14_train:  12.90765; grad/pseudo_mag14_train:  23057.15332; grad/true_std14_train:  0.00315; grad/pseudo_std14_train:  5.62615; grad/diff14_train:  23047.37402; grad/cos14_train:  0.74644; grad/true_mag15_train:  8.23611; grad/pseudo_mag15_train:  21881.12529; grad/true_std15_train:  0.00201; grad/pseudo_std15_train:  5.34174; grad/diff15_train:  21874.42178; grad/cos15_train:  0.80664; grad/true_mag16_train:  14.93448; grad/pseudo_mag16_train:  22430.33701; grad/true_std16_train:  0.00365; grad/pseudo_std16_train:  5.47587; grad/diff16_train:  22422.37168; grad/cos16_train:  0.53640; grad/true_mag17_train:  20.85921; grad/pseudo_mag17_train:  20346.80391; grad/true_std17_train:  0.00509; grad/pseudo_std17_train:  4.93558; grad/diff17_train:  20336.82227; grad/cos17_train:  0.47183; grad_train:  1727.83313; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00005; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:27:18,125][trainer][INFO] - Step 530:
[2025-04-24 22:27:18,125][trainer][INFO] - loss/edit_train:  6.09299; loss/loc_train:  0.13605; edit/acc_train:  0.06786; edit/log_prob_train: -6.09299; edit/prob_train:  0.27585; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.70936; perplexity/pre_train:  40.82747; nll/post_train:  3.62542; perplexity/post_train:  37.54049; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.22933; loss/total_train:  0.74535; loss/total_edit_train:  0.74535; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.53849; grad/pseudo_mag0_train:  17677.55996; grad/true_std0_train:  0.00184; grad/pseudo_std0_train:  4.31557; grad/diff0_train:  17671.58320; grad/cos0_train:  0.78856; grad/true_mag1_train:  10.89592; grad/pseudo_mag1_train:  17775.25000; grad/true_std1_train:  0.00266; grad/pseudo_std1_train:  4.33925; grad/diff1_train:  17766.47676; grad/cos1_train:  0.79996; grad/true_mag2_train:  13.89857; grad/pseudo_mag2_train:  25039.66504; grad/true_std2_train:  0.00339; grad/pseudo_std2_train:  6.04252; grad/diff2_train:  25031.27520; grad/cos2_train:  0.58205; grad/true_mag3_train:  8.56304; grad/pseudo_mag3_train:  18425.72881; grad/true_std3_train:  0.00209; grad/pseudo_std3_train:  4.49840; grad/diff3_train:  18418.34727; grad/cos3_train:  0.85802; grad/true_mag4_train:  10.69356; grad/pseudo_mag4_train:  18308.40664; grad/true_std4_train:  0.00261; grad/pseudo_std4_train:  4.46968; grad/diff4_train:  18299.19326; grad/cos4_train:  0.85750; grad/true_mag5_train:  13.09201; grad/pseudo_mag5_train:  22534.04531; grad/true_std5_train:  0.00320; grad/pseudo_std5_train:  5.46913; grad/diff5_train:  22524.48496; grad/cos5_train:  0.71442; grad/true_mag6_train:  8.79842; grad/pseudo_mag6_train:  19236.19463; grad/true_std6_train:  0.00215; grad/pseudo_std6_train:  4.69629; grad/diff6_train:  19228.30684; grad/cos6_train:  0.89289; grad/true_mag7_train:  10.29601; grad/pseudo_mag7_train:  19331.35947; grad/true_std7_train:  0.00251; grad/pseudo_std7_train:  4.71951; grad/diff7_train:  19322.25420; grad/cos7_train:  0.87951; grad/true_mag8_train:  12.06630; grad/pseudo_mag8_train:  21384.00293; grad/true_std8_train:  0.00295; grad/pseudo_std8_train:  5.21786; grad/diff8_train:  21373.84453; grad/cos8_train:  0.82886; grad/true_mag9_train:  8.75670; grad/pseudo_mag9_train:  19759.23252; grad/true_std9_train:  0.00214; grad/pseudo_std9_train:  4.82398; grad/diff9_train:  19751.36953; grad/cos9_train:  0.89383; grad/true_mag10_train:  10.01320; grad/pseudo_mag10_train:  19784.10664; grad/true_std10_train:  0.00244; grad/pseudo_std10_train:  4.83005; grad/diff10_train:  19775.22930; grad/cos10_train:  0.88123; grad/true_mag11_train:  12.02599; grad/pseudo_mag11_train:  21303.31406; grad/true_std11_train:  0.00294; grad/pseudo_std11_train:  5.19885; grad/diff11_train:  21293.83281; grad/cos11_train:  0.77928; grad/true_mag12_train:  8.12178; grad/pseudo_mag12_train:  19795.32256; grad/true_std12_train:  0.00198; grad/pseudo_std12_train:  4.83279; grad/diff12_train:  19788.39502; grad/cos12_train:  0.84761; grad/true_mag13_train:  9.08564; grad/pseudo_mag13_train:  19528.89033; grad/true_std13_train:  0.00222; grad/pseudo_std13_train:  4.76773; grad/diff13_train:  19521.15518; grad/cos13_train:  0.84543; grad/true_mag14_train:  12.16868; grad/pseudo_mag14_train:  21014.02734; grad/true_std14_train:  0.00297; grad/pseudo_std14_train:  5.12667; grad/diff14_train:  21005.30234; grad/cos14_train:  0.71239; grad/true_mag15_train:  7.67291; grad/pseudo_mag15_train:  20228.42207; grad/true_std15_train:  0.00187; grad/pseudo_std15_train:  4.93829; grad/diff15_train:  20222.24160; grad/cos15_train:  0.80344; grad/true_mag16_train:  14.35045; grad/pseudo_mag16_train:  20530.09912; grad/true_std16_train:  0.00350; grad/pseudo_std16_train:  5.01195; grad/diff16_train:  20522.73672; grad/cos16_train:  0.52613; grad/true_mag17_train:  19.90090; grad/pseudo_mag17_train:  19387.42275; grad/true_std17_train:  0.00486; grad/pseudo_std17_train:  4.68831; grad/diff17_train:  19378.47402; grad/cos17_train:  0.45291; grad_train:  932.44519; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00006; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00005; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00005; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:27:21,242][trainer][INFO] - Step 540:
[2025-04-24 22:27:21,243][trainer][INFO] - loss/edit_train:  7.01528; loss/loc_train:  0.30093; edit/acc_train:  0.03135; edit/log_prob_train: -7.01528; edit/prob_train:  0.26311; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.19649; perplexity/pre_train:  66.45249; nll/post_train:  4.22356; perplexity/post_train:  68.27600; n_tokens/pre_train:  7.20000; n_tokens/post_train:  7.20000; time/edit_train:  0.17375; loss/total_train:  1.00246; loss/total_edit_train:  1.00246; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.79956; grad/pseudo_mag0_train:  15387.54609; grad/true_std0_train:  0.00166; grad/pseudo_std0_train:  3.75622; grad/diff0_train:  15382.27158; grad/cos0_train:  0.77071; grad/true_mag1_train:  10.14522; grad/pseudo_mag1_train:  16089.12988; grad/true_std1_train:  0.00248; grad/pseudo_std1_train:  3.92716; grad/diff1_train:  16081.23799; grad/cos1_train:  0.77198; grad/true_mag2_train:  12.81014; grad/pseudo_mag2_train:  25531.41543; grad/true_std2_train:  0.00313; grad/pseudo_std2_train:  6.12190; grad/diff2_train:  25524.63828; grad/cos2_train:  0.49651; grad/true_mag3_train:  7.69928; grad/pseudo_mag3_train:  16068.09619; grad/true_std3_train:  0.00188; grad/pseudo_std3_train:  3.92277; grad/diff3_train:  16061.57080; grad/cos3_train:  0.84197; grad/true_mag4_train:  9.85272; grad/pseudo_mag4_train:  16249.93193; grad/true_std4_train:  0.00241; grad/pseudo_std4_train:  3.96705; grad/diff4_train:  16241.64219; grad/cos4_train:  0.83603; grad/true_mag5_train:  12.36141; grad/pseudo_mag5_train:  20428.49014; grad/true_std5_train:  0.00302; grad/pseudo_std5_train:  4.94450; grad/diff5_train:  20420.10342; grad/cos5_train:  0.65256; grad/true_mag6_train:  7.82410; grad/pseudo_mag6_train:  16956.54453; grad/true_std6_train:  0.00191; grad/pseudo_std6_train:  4.13972; grad/diff6_train:  16949.57314; grad/cos6_train:  0.88720; grad/true_mag7_train:  9.31481; grad/pseudo_mag7_train:  16958.09258; grad/true_std7_train:  0.00227; grad/pseudo_std7_train:  4.14006; grad/diff7_train:  16950.01455; grad/cos7_train:  0.86096; grad/true_mag8_train:  10.85518; grad/pseudo_mag8_train:  18852.87188; grad/true_std8_train:  0.00265; grad/pseudo_std8_train:  4.59935; grad/diff8_train:  18844.01631; grad/cos8_train:  0.80070; grad/true_mag9_train:  7.71871; grad/pseudo_mag9_train:  17254.04785; grad/true_std9_train:  0.00188; grad/pseudo_std9_train:  4.21235; grad/diff9_train:  17247.16826; grad/cos9_train:  0.88731; grad/true_mag10_train:  8.89881; grad/pseudo_mag10_train:  17198.43232; grad/true_std10_train:  0.00217; grad/pseudo_std10_train:  4.19876; grad/diff10_train:  17190.66367; grad/cos10_train:  0.86833; grad/true_mag11_train:  11.13600; grad/pseudo_mag11_train:  18751.67900; grad/true_std11_train:  0.00272; grad/pseudo_std11_train:  4.57553; grad/diff11_train:  18743.18545; grad/cos11_train:  0.75086; grad/true_mag12_train:  7.50472; grad/pseudo_mag12_train:  17897.50967; grad/true_std12_train:  0.00183; grad/pseudo_std12_train:  4.36941; grad/diff12_train:  17891.19346; grad/cos12_train:  0.83734; grad/true_mag13_train:  8.79229; grad/pseudo_mag13_train:  18250.96563; grad/true_std13_train:  0.00215; grad/pseudo_std13_train:  4.45570; grad/diff13_train:  18243.52549; grad/cos13_train:  0.84323; grad/true_mag14_train:  11.65275; grad/pseudo_mag14_train:  19481.65557; grad/true_std14_train:  0.00284; grad/pseudo_std14_train:  4.75160; grad/diff14_train:  19473.49980; grad/cos14_train:  0.69019; grad/true_mag15_train:  7.28647; grad/pseudo_mag15_train:  18846.01797; grad/true_std15_train:  0.00178; grad/pseudo_std15_train:  4.60069; grad/diff15_train:  18840.21045; grad/cos15_train:  0.79177; grad/true_mag16_train:  14.09554; grad/pseudo_mag16_train:  19606.00830; grad/true_std16_train:  0.00344; grad/pseudo_std16_train:  4.78620; grad/diff16_train:  19598.99736; grad/cos16_train:  0.49616; grad/true_mag17_train:  19.92198; grad/pseudo_mag17_train:  18170.48232; grad/true_std17_train:  0.00486; grad/pseudo_std17_train:  4.39595; grad/diff17_train:  18161.76895; grad/cos17_train:  0.43493; grad_train:  1259.05188; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00009; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00005; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00005; lr/lr14_train:  0.00005; lr/lr15_train:  0.00004; lr/lr16_train:  0.00005; lr/lr17_train:  0.00005
[2025-04-24 22:27:24,858][trainer][INFO] - Step 550:
[2025-04-24 22:27:24,858][trainer][INFO] - loss/edit_train:  7.00349; loss/loc_train:  0.07987; edit/acc_train:  0.04361; edit/log_prob_train: -7.00349; edit/prob_train:  0.28009; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.38632; perplexity/pre_train:  80.34409; nll/post_train:  4.35433; perplexity/post_train:  77.81470; n_tokens/pre_train:  6.00000; n_tokens/post_train:  6.00000; time/edit_train:  0.22502; loss/total_train:  0.78022; loss/total_edit_train:  0.78022; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.98704; grad/pseudo_mag0_train:  22046.03994; grad/true_std0_train:  0.00219; grad/pseudo_std0_train:  5.38206; grad/diff0_train:  22038.83330; grad/cos0_train:  0.79553; grad/true_mag1_train:  12.85181; grad/pseudo_mag1_train:  21382.18145; grad/true_std1_train:  0.00314; grad/pseudo_std1_train:  5.21975; grad/diff1_train:  21371.77959; grad/cos1_train:  0.80348; grad/true_mag2_train:  16.84514; grad/pseudo_mag2_train:  29227.67812; grad/true_std2_train:  0.00411; grad/pseudo_std2_train:  7.05466; grad/diff2_train:  29217.34023; grad/cos2_train:  0.58476; grad/true_mag3_train:  10.41092; grad/pseudo_mag3_train:  23162.30537; grad/true_std3_train:  0.00254; grad/pseudo_std3_train:  5.65475; grad/diff3_train:  23153.25371; grad/cos3_train:  0.86264; grad/true_mag4_train:  12.74810; grad/pseudo_mag4_train:  22663.46484; grad/true_std4_train:  0.00311; grad/pseudo_std4_train:  5.53287; grad/diff4_train:  22652.37490; grad/cos4_train:  0.86416; grad/true_mag5_train:  15.31255; grad/pseudo_mag5_train:  26988.58838; grad/true_std5_train:  0.00374; grad/pseudo_std5_train:  6.55955; grad/diff5_train:  26976.84775; grad/cos5_train:  0.73386; grad/true_mag6_train:  10.45252; grad/pseudo_mag6_train:  23506.04336; grad/true_std6_train:  0.00255; grad/pseudo_std6_train:  5.73869; grad/diff6_train:  23496.62988; grad/cos6_train:  0.89584; grad/true_mag7_train:  12.07959; grad/pseudo_mag7_train:  23204.91318; grad/true_std7_train:  0.00295; grad/pseudo_std7_train:  5.66516; grad/diff7_train:  23194.15146; grad/cos7_train:  0.88455; grad/true_mag8_train:  14.02027; grad/pseudo_mag8_train:  25322.48105; grad/true_std8_train:  0.00342; grad/pseudo_std8_train:  6.17974; grad/diff8_train:  25310.49209; grad/cos8_train:  0.83861; grad/true_mag9_train:  10.27588; grad/pseudo_mag9_train:  23806.83037; grad/true_std9_train:  0.00251; grad/pseudo_std9_train:  5.81214; grad/diff9_train:  23797.52197; grad/cos9_train:  0.90123; grad/true_mag10_train:  11.80160; grad/pseudo_mag10_train:  23798.75166; grad/true_std10_train:  0.00288; grad/pseudo_std10_train:  5.81015; grad/diff10_train:  23788.19785; grad/cos10_train:  0.89090; grad/true_mag11_train:  13.67136; grad/pseudo_mag11_train:  25175.80352; grad/true_std11_train:  0.00334; grad/pseudo_std11_train:  6.14435; grad/diff11_train:  25164.54277; grad/cos11_train:  0.81163; grad/true_mag12_train:  9.51273; grad/pseudo_mag12_train:  24121.15937; grad/true_std12_train:  0.00232; grad/pseudo_std12_train:  5.88889; grad/diff12_train:  24112.90449; grad/cos12_train:  0.86260; grad/true_mag13_train:  11.15644; grad/pseudo_mag13_train:  24263.05752; grad/true_std13_train:  0.00272; grad/pseudo_std13_train:  5.92350; grad/diff13_train:  24253.38447; grad/cos13_train:  0.86352; grad/true_mag14_train:  13.59878; grad/pseudo_mag14_train:  24879.13135; grad/true_std14_train:  0.00332; grad/pseudo_std14_train:  6.07044; grad/diff14_train:  24868.87266; grad/cos14_train:  0.74202; grad/true_mag15_train:  8.61111; grad/pseudo_mag15_train:  23510.82734; grad/true_std15_train:  0.00210; grad/pseudo_std15_train:  5.73965; grad/diff15_train:  23503.70527; grad/cos15_train:  0.82089; grad/true_mag16_train:  15.03476; grad/pseudo_mag16_train:  24594.70293; grad/true_std16_train:  0.00367; grad/pseudo_std16_train:  6.00429; grad/diff16_train:  24586.03857; grad/cos16_train:  0.57942; grad/true_mag17_train:  20.81996; grad/pseudo_mag17_train:  21957.83857; grad/true_std17_train:  0.00508; grad/pseudo_std17_train:  5.32559; grad/diff17_train:  21947.48740; grad/cos17_train:  0.49155; grad_train:  825.05597; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00005; lr/lr8_train:  0.00008; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:27:28,112][trainer][INFO] - Step 560:
[2025-04-24 22:27:28,112][trainer][INFO] - loss/edit_train:  6.69797; loss/loc_train:  0.11975; edit/acc_train:  0.05576; edit/log_prob_train: -6.69797; edit/prob_train:  0.24325; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79615; perplexity/pre_train:  44.52962; nll/post_train:  3.86737; perplexity/post_train:  47.81662; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.18555; loss/total_train:  0.78955; loss/total_edit_train:  0.78955; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.94376; grad/pseudo_mag0_train:  18519.22402; grad/true_std0_train:  0.00194; grad/pseudo_std0_train:  4.52092; grad/diff0_train:  18512.94268; grad/cos0_train:  0.78290; grad/true_mag1_train:  11.57063; grad/pseudo_mag1_train:  19116.90566; grad/true_std1_train:  0.00282; grad/pseudo_std1_train:  4.66644; grad/diff1_train:  19107.76777; grad/cos1_train:  0.77940; grad/true_mag2_train:  14.83820; grad/pseudo_mag2_train:  28405.31328; grad/true_std2_train:  0.00362; grad/pseudo_std2_train:  6.82823; grad/diff2_train:  28397.21367; grad/cos2_train:  0.51742; grad/true_mag3_train:  8.95115; grad/pseudo_mag3_train:  19108.09678; grad/true_std3_train:  0.00219; grad/pseudo_std3_train:  4.66496; grad/diff3_train:  19100.42021; grad/cos3_train:  0.84957; grad/true_mag4_train:  11.29921; grad/pseudo_mag4_train:  19568.35820; grad/true_std4_train:  0.00276; grad/pseudo_std4_train:  4.77718; grad/diff4_train:  19558.71445; grad/cos4_train:  0.84322; grad/true_mag5_train:  13.92929; grad/pseudo_mag5_train:  24905.15313; grad/true_std5_train:  0.00340; grad/pseudo_std5_train:  6.03409; grad/diff5_train:  24895.61523; grad/cos5_train:  0.66123; grad/true_mag6_train:  9.02161; grad/pseudo_mag6_train:  19795.47969; grad/true_std6_train:  0.00220; grad/pseudo_std6_train:  4.83283; grad/diff6_train:  19787.44639; grad/cos6_train:  0.88419; grad/true_mag7_train:  10.58778; grad/pseudo_mag7_train:  19776.98516; grad/true_std7_train:  0.00258; grad/pseudo_std7_train:  4.82828; grad/diff7_train:  19767.75752; grad/cos7_train:  0.86330; grad/true_mag8_train:  12.26600; grad/pseudo_mag8_train:  21793.42598; grad/true_std8_train:  0.00299; grad/pseudo_std8_train:  5.31660; grad/diff8_train:  21783.46885; grad/cos8_train:  0.79176; grad/true_mag9_train:  8.68538; grad/pseudo_mag9_train:  19671.33281; grad/true_std9_train:  0.00212; grad/pseudo_std9_train:  4.80252; grad/diff9_train:  19663.60303; grad/cos9_train:  0.88178; grad/true_mag10_train:  10.66639; grad/pseudo_mag10_train:  19804.48184; grad/true_std10_train:  0.00260; grad/pseudo_std10_train:  4.83500; grad/diff10_train:  19795.59717; grad/cos10_train:  0.83176; grad/true_mag11_train:  11.81749; grad/pseudo_mag11_train:  21171.51455; grad/true_std11_train:  0.00289; grad/pseudo_std11_train:  5.16568; grad/diff11_train:  21162.54473; grad/cos11_train:  0.73894; grad/true_mag12_train:  7.92467; grad/pseudo_mag12_train:  19285.96563; grad/true_std12_train:  0.00193; grad/pseudo_std12_train:  4.70841; grad/diff12_train:  19279.27939; grad/cos12_train:  0.83082; grad/true_mag13_train:  9.17802; grad/pseudo_mag13_train:  19282.21406; grad/true_std13_train:  0.00224; grad/pseudo_std13_train:  4.70748; grad/diff13_train:  19274.45801; grad/cos13_train:  0.83355; grad/true_mag14_train:  11.54886; grad/pseudo_mag14_train:  20537.57402; grad/true_std14_train:  0.00282; grad/pseudo_std14_train:  5.00941; grad/diff14_train:  20529.64531; grad/cos14_train:  0.66539; grad/true_mag15_train:  7.33562; grad/pseudo_mag15_train:  18990.06641; grad/true_std15_train:  0.00179; grad/pseudo_std15_train:  4.63585; grad/diff15_train:  18984.32734; grad/cos15_train:  0.77096; grad/true_mag16_train:  14.38884; grad/pseudo_mag16_train:  19194.27344; grad/true_std16_train:  0.00351; grad/pseudo_std16_train:  4.68569; grad/diff16_train:  19187.45928; grad/cos16_train:  0.47547; grad/true_mag17_train:  19.31693; grad/pseudo_mag17_train:  18122.31377; grad/true_std17_train:  0.00472; grad/pseudo_std17_train:  4.37565; grad/diff17_train:  18114.33564; grad/cos17_train:  0.41036; grad_train:  1403.20789; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00008; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:27:31,561][trainer][INFO] - Step 570:
[2025-04-24 22:27:31,561][trainer][INFO] - loss/edit_train:  8.00002; loss/loc_train:  0.09130; edit/acc_train:  0.13031; edit/log_prob_train: -8.00002; edit/prob_train:  0.26378; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.04732; perplexity/pre_train:  57.24358; nll/post_train:  4.21943; perplexity/post_train:  67.99487; n_tokens/pre_train:  7.50000; n_tokens/post_train:  7.50000; time/edit_train:  0.19069; loss/total_train:  0.89130; loss/total_edit_train:  0.89130; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  6.97330; grad/pseudo_mag0_train:  16969.28203; grad/true_std0_train:  0.00170; grad/pseudo_std0_train:  4.14259; grad/diff0_train:  16963.77432; grad/cos0_train:  0.78616; grad/true_mag1_train:  10.41285; grad/pseudo_mag1_train:  17349.28701; grad/true_std1_train:  0.00254; grad/pseudo_std1_train:  4.23517; grad/diff1_train:  17341.01758; grad/cos1_train:  0.78908; grad/true_mag2_train:  13.55572; grad/pseudo_mag2_train:  24220.26055; grad/true_std2_train:  0.00331; grad/pseudo_std2_train:  5.83513; grad/diff2_train:  24212.22793; grad/cos2_train:  0.57677; grad/true_mag3_train:  8.11149; grad/pseudo_mag3_train:  18010.68545; grad/true_std3_train:  0.00198; grad/pseudo_std3_train:  4.39708; grad/diff3_train:  18003.68008; grad/cos3_train:  0.86029; grad/true_mag4_train:  10.21237; grad/pseudo_mag4_train:  18012.89414; grad/true_std4_train:  0.00249; grad/pseudo_std4_train:  4.39755; grad/diff4_train:  18004.08379; grad/cos4_train:  0.85879; grad/true_mag5_train:  12.64247; grad/pseudo_mag5_train:  22362.35859; grad/true_std5_train:  0.00309; grad/pseudo_std5_train:  5.42438; grad/diff5_train:  22353.48164; grad/cos5_train:  0.68297; grad/true_mag6_train:  8.30766; grad/pseudo_mag6_train:  18730.49756; grad/true_std6_train:  0.00203; grad/pseudo_std6_train:  4.57282; grad/diff6_train:  18723.04453; grad/cos6_train:  0.89501; grad/true_mag7_train:  9.67071; grad/pseudo_mag7_train:  18697.99004; grad/true_std7_train:  0.00236; grad/pseudo_std7_train:  4.56488; grad/diff7_train:  18689.41094; grad/cos7_train:  0.88387; grad/true_mag8_train:  11.30618; grad/pseudo_mag8_train:  20792.43887; grad/true_std8_train:  0.00276; grad/pseudo_std8_train:  5.07329; grad/diff8_train:  20782.98613; grad/cos8_train:  0.82243; grad/true_mag9_train:  8.30518; grad/pseudo_mag9_train:  19177.73369; grad/true_std9_train:  0.00203; grad/pseudo_std9_train:  4.68201; grad/diff9_train:  19170.29424; grad/cos9_train:  0.89306; grad/true_mag10_train:  9.48128; grad/pseudo_mag10_train:  19088.91475; grad/true_std10_train:  0.00231; grad/pseudo_std10_train:  4.66032; grad/diff10_train:  19080.54863; grad/cos10_train:  0.87912; grad/true_mag11_train:  11.17547; grad/pseudo_mag11_train:  20554.36074; grad/true_std11_train:  0.00273; grad/pseudo_std11_train:  5.01624; grad/diff11_train:  20545.53721; grad/cos11_train:  0.77901; grad/true_mag12_train:  7.77897; grad/pseudo_mag12_train:  19553.98604; grad/true_std12_train:  0.00190; grad/pseudo_std12_train:  4.77386; grad/diff12_train:  19547.32217; grad/cos12_train:  0.85142; grad/true_mag13_train:  8.92267; grad/pseudo_mag13_train:  19620.92744; grad/true_std13_train:  0.00218; grad/pseudo_std13_train:  4.79018; grad/diff13_train:  19613.23457; grad/cos13_train:  0.85706; grad/true_mag14_train:  11.27194; grad/pseudo_mag14_train:  20392.92832; grad/true_std14_train:  0.00275; grad/pseudo_std14_train:  4.97532; grad/diff14_train:  20384.80449; grad/cos14_train:  0.70939; grad/true_mag15_train:  7.27597; grad/pseudo_mag15_train:  19586.11699; grad/true_std15_train:  0.00178; grad/pseudo_std15_train:  4.78144; grad/diff15_train:  19580.29971; grad/cos15_train:  0.79369; grad/true_mag16_train:  15.26746; grad/pseudo_mag16_train:  19858.40010; grad/true_std16_train:  0.00373; grad/pseudo_std16_train:  4.84797; grad/diff16_train:  19851.50488; grad/cos16_train:  0.45928; grad/true_mag17_train:  19.47525; grad/pseudo_mag17_train:  18450.91182; grad/true_std17_train:  0.00475; grad/pseudo_std17_train:  4.46064; grad/diff17_train:  18442.82266; grad/cos17_train:  0.41332; grad_train:  918.98969; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00008; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00008; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:27:35,234][trainer][INFO] - Step 580:
[2025-04-24 22:27:35,235][trainer][INFO] - loss/edit_train:  8.63630; loss/loc_train:  0.05440; edit/acc_train:  0.01000; edit/log_prob_train: -8.63630; edit/prob_train:  0.19714; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.56260; perplexity/pre_train:  95.83237; nll/post_train:  4.46876; perplexity/post_train:  87.24846; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.22742; loss/total_train:  0.91803; loss/total_edit_train:  0.91803; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.75343; grad/pseudo_mag0_train:  17784.71475; grad/true_std0_train:  0.00189; grad/pseudo_std0_train:  4.34154; grad/diff0_train:  17778.62324; grad/cos0_train:  0.78337; grad/true_mag1_train:  11.63001; grad/pseudo_mag1_train:  18816.93633; grad/true_std1_train:  0.00284; grad/pseudo_std1_train:  4.59320; grad/diff1_train:  18807.70937; grad/cos1_train:  0.79172; grad/true_mag2_train:  15.41821; grad/pseudo_mag2_train:  27652.00469; grad/true_std2_train:  0.00376; grad/pseudo_std2_train:  6.63344; grad/diff2_train:  27643.37227; grad/cos2_train:  0.54495; grad/true_mag3_train:  9.07848; grad/pseudo_mag3_train:  19729.59619; grad/true_std3_train:  0.00222; grad/pseudo_std3_train:  4.81669; grad/diff3_train:  19721.73770; grad/cos3_train:  0.86353; grad/true_mag4_train:  11.43123; grad/pseudo_mag4_train:  19793.11494; grad/true_std4_train:  0.00279; grad/pseudo_std4_train:  4.83211; grad/diff4_train:  19783.26895; grad/cos4_train:  0.85974; grad/true_mag5_train:  13.93103; grad/pseudo_mag5_train:  23664.39805; grad/true_std5_train:  0.00340; grad/pseudo_std5_train:  5.73443; grad/diff5_train:  23654.19336; grad/cos5_train:  0.72480; grad/true_mag6_train:  9.37872; grad/pseudo_mag6_train:  20770.57549; grad/true_std6_train:  0.00229; grad/pseudo_std6_train:  5.07089; grad/diff6_train:  20762.11973; grad/cos6_train:  0.90051; grad/true_mag7_train:  10.94347; grad/pseudo_mag7_train:  20725.61709; grad/true_std7_train:  0.00267; grad/pseudo_std7_train:  5.05989; grad/diff7_train:  20715.92471; grad/cos7_train:  0.88365; grad/true_mag8_train:  12.55398; grad/pseudo_mag8_train:  22583.60684; grad/true_std8_train:  0.00306; grad/pseudo_std8_train:  5.51046; grad/diff8_train:  22572.85430; grad/cos8_train:  0.85078; grad/true_mag9_train:  9.37884; grad/pseudo_mag9_train:  21458.68125; grad/true_std9_train:  0.00229; grad/pseudo_std9_train:  5.23887; grad/diff9_train:  21450.22559; grad/cos9_train:  0.90057; grad/true_mag10_train:  10.61397; grad/pseudo_mag10_train:  21216.04385; grad/true_std10_train:  0.00259; grad/pseudo_std10_train:  5.17962; grad/diff10_train:  21206.60479; grad/cos10_train:  0.88738; grad/true_mag11_train:  12.53197; grad/pseudo_mag11_train:  22484.45352; grad/true_std11_train:  0.00306; grad/pseudo_std11_train:  5.48746; grad/diff11_train:  22474.24473; grad/cos11_train:  0.81096; grad/true_mag12_train:  8.94680; grad/pseudo_mag12_train:  22504.91289; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.49430; grad/diff12_train:  22497.10215; grad/cos12_train:  0.87174; grad/true_mag13_train:  10.14412; grad/pseudo_mag13_train:  22590.91992; grad/true_std13_train:  0.00248; grad/pseudo_std13_train:  5.51526; grad/diff13_train:  22582.03945; grad/cos13_train:  0.87374; grad/true_mag14_train:  12.70657; grad/pseudo_mag14_train:  23054.26406; grad/true_std14_train:  0.00310; grad/pseudo_std14_train:  5.62440; grad/diff14_train:  23044.70078; grad/cos14_train:  0.74827; grad/true_mag15_train:  7.98187; grad/pseudo_mag15_train:  21696.48789; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  5.29667; grad/diff15_train:  21689.91455; grad/cos15_train:  0.82127; grad/true_mag16_train:  14.24360; grad/pseudo_mag16_train:  21822.66211; grad/true_std16_train:  0.00348; grad/pseudo_std16_train:  5.32751; grad/diff16_train:  21815.13711; grad/cos16_train:  0.53004; grad/true_mag17_train:  20.11511; grad/pseudo_mag17_train:  20423.65195; grad/true_std17_train:  0.00491; grad/pseudo_std17_train:  4.93615; grad/diff17_train:  20414.35166; grad/cos17_train:  0.45923; grad_train:  852.07739; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00008; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00005; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:27:38,375][trainer][INFO] - Step 590:
[2025-04-24 22:27:38,376][trainer][INFO] - loss/edit_train:  6.09358; loss/loc_train:  0.10338; edit/acc_train:  0.09987; edit/log_prob_train: -6.09358; edit/prob_train:  0.27120; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.54976; perplexity/pre_train:  94.60950; nll/post_train:  4.63582; perplexity/post_train:  103.11280; n_tokens/pre_train:  8.90000; n_tokens/post_train:  8.90000; time/edit_train:  0.17571; loss/total_train:  0.71274; loss/total_edit_train:  0.71274; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  7.51466; grad/pseudo_mag0_train:  17393.07627; grad/true_std0_train:  0.00183; grad/pseudo_std0_train:  4.24592; grad/diff0_train:  17387.14658; grad/cos0_train:  0.78451; grad/true_mag1_train:  11.13881; grad/pseudo_mag1_train:  18385.37832; grad/true_std1_train:  0.00272; grad/pseudo_std1_train:  4.48783; grad/diff1_train:  18376.54404; grad/cos1_train:  0.78719; grad/true_mag2_train:  14.11640; grad/pseudo_mag2_train:  28164.53379; grad/true_std2_train:  0.00345; grad/pseudo_std2_train:  6.75819; grad/diff2_train:  28156.72617; grad/cos2_train:  0.52575; grad/true_mag3_train:  8.60998; grad/pseudo_mag3_train:  18632.76230; grad/true_std3_train:  0.00210; grad/pseudo_std3_train:  4.54891; grad/diff3_train:  18625.34375; grad/cos3_train:  0.85740; grad/true_mag4_train:  10.99570; grad/pseudo_mag4_train:  18805.85469; grad/true_std4_train:  0.00268; grad/pseudo_std4_train:  4.59104; grad/diff4_train:  18796.48936; grad/cos4_train:  0.84671; grad/true_mag5_train:  13.35254; grad/pseudo_mag5_train:  23514.64863; grad/true_std5_train:  0.00326; grad/pseudo_std5_train:  5.69662; grad/diff5_train:  23505.35000; grad/cos5_train:  0.67135; grad/true_mag6_train:  8.90646; grad/pseudo_mag6_train:  19714.73613; grad/true_std6_train:  0.00217; grad/pseudo_std6_train:  4.81308; grad/diff6_train:  19706.75840; grad/cos6_train:  0.89293; grad/true_mag7_train:  10.40055; grad/pseudo_mag7_train:  19636.43945; grad/true_std7_train:  0.00254; grad/pseudo_std7_train:  4.79393; grad/diff7_train:  19627.28916; grad/cos7_train:  0.87511; grad/true_mag8_train:  11.97103; grad/pseudo_mag8_train:  21735.31514; grad/true_std8_train:  0.00292; grad/pseudo_std8_train:  5.30309; grad/diff8_train:  21725.33936; grad/cos8_train:  0.81892; grad/true_mag9_train:  8.98499; grad/pseudo_mag9_train:  20502.74727; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  5.00547; grad/diff9_train:  20494.67490; grad/cos9_train:  0.89538; grad/true_mag10_train:  10.13059; grad/pseudo_mag10_train:  20283.94277; grad/true_std10_train:  0.00247; grad/pseudo_std10_train:  4.95204; grad/diff10_train:  20274.97480; grad/cos10_train:  0.88074; grad/true_mag11_train:  12.41853; grad/pseudo_mag11_train:  21735.06738; grad/true_std11_train:  0.00303; grad/pseudo_std11_train:  5.30360; grad/diff11_train:  21725.50840; grad/cos11_train:  0.75372; grad/true_mag12_train:  8.50611; grad/pseudo_mag12_train:  21117.71719; grad/true_std12_train:  0.00208; grad/pseudo_std12_train:  5.15559; grad/diff12_train:  21110.43428; grad/cos12_train:  0.85139; grad/true_mag13_train:  9.64654; grad/pseudo_mag13_train:  21049.27959; grad/true_std13_train:  0.00236; grad/pseudo_std13_train:  5.13885; grad/diff13_train:  21041.01660; grad/cos13_train:  0.85083; grad/true_mag14_train:  12.36050; grad/pseudo_mag14_train:  21909.03252; grad/true_std14_train:  0.00302; grad/pseudo_std14_train:  5.34445; grad/diff14_train:  21900.20361; grad/cos14_train:  0.69838; grad/true_mag15_train:  8.12283; grad/pseudo_mag15_train:  21900.92354; grad/true_std15_train:  0.00198; grad/pseudo_std15_train:  5.34639; grad/diff15_train:  21894.34463; grad/cos15_train:  0.80236; grad/true_mag16_train:  15.06876; grad/pseudo_mag16_train:  22059.28369; grad/true_std16_train:  0.00368; grad/pseudo_std16_train:  5.38511; grad/diff16_train:  22051.66436; grad/cos16_train:  0.50317; grad/true_mag17_train:  20.05180; grad/pseudo_mag17_train:  20251.24121; grad/true_std17_train:  0.00490; grad/pseudo_std17_train:  4.89693; grad/diff17_train:  20242.26416; grad/cos17_train:  0.44108; grad_train:  1310.52319; lr/lr0_train:  0.00007; lr/lr1_train:  0.00006; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00008; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:27:41,655][trainer][INFO] - Step 600:
[2025-04-24 22:27:41,655][trainer][INFO] - loss/edit_train:  7.80520; loss/loc_train:  0.10559; edit/acc_train:  0.01817; edit/log_prob_train: -7.80520; edit/prob_train:  0.22654; acc/pre_train:  0.10000; acc/post_train:  0.00000; nll/pre_train:  3.69275; perplexity/pre_train:  40.15521; nll/post_train:  3.93001; perplexity/post_train:  50.90730; n_tokens/pre_train:  7.30000; n_tokens/post_train:  7.30000; time/edit_train:  0.17871; loss/total_train:  0.88611; loss/total_edit_train:  0.88611; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.33717; grad/pseudo_mag0_train:  19492.70928; grad/true_std0_train:  0.00204; grad/pseudo_std0_train:  4.75854; grad/diff0_train:  19486.06758; grad/cos0_train:  0.79299; grad/true_mag1_train:  12.19696; grad/pseudo_mag1_train:  19985.52822; grad/true_std1_train:  0.00298; grad/pseudo_std1_train:  4.87848; grad/diff1_train:  19975.74531; grad/cos1_train:  0.79806; grad/true_mag2_train:  16.02735; grad/pseudo_mag2_train:  32279.39824; grad/true_std2_train:  0.00391; grad/pseudo_std2_train:  7.71749; grad/diff2_train:  32271.07383; grad/cos2_train:  0.49482; grad/true_mag3_train:  9.76334; grad/pseudo_mag3_train:  21307.33633; grad/true_std3_train:  0.00238; grad/pseudo_std3_train:  5.20187; grad/diff3_train:  21298.83428; grad/cos3_train:  0.86736; grad/true_mag4_train:  12.17142; grad/pseudo_mag4_train:  21502.78682; grad/true_std4_train:  0.00297; grad/pseudo_std4_train:  5.24950; grad/diff4_train:  21492.23828; grad/cos4_train:  0.86230; grad/true_mag5_train:  15.08615; grad/pseudo_mag5_train:  26090.78477; grad/true_std5_train:  0.00368; grad/pseudo_std5_train:  6.31504; grad/diff5_train:  26079.88125; grad/cos5_train:  0.70305; grad/true_mag6_train:  10.09172; grad/pseudo_mag6_train:  22434.50488; grad/true_std6_train:  0.00246; grad/pseudo_std6_train:  5.47711; grad/diff6_train:  22425.40146; grad/cos6_train:  0.90014; grad/true_mag7_train:  11.82861; grad/pseudo_mag7_train:  22544.15898; grad/true_std7_train:  0.00289; grad/pseudo_std7_train:  5.50386; grad/diff7_train:  22533.65957; grad/cos7_train:  0.88433; grad/true_mag8_train:  13.65864; grad/pseudo_mag8_train:  24477.44854; grad/true_std8_train:  0.00333; grad/pseudo_std8_train:  5.97189; grad/diff8_train:  24466.01230; grad/cos8_train:  0.82444; grad/true_mag9_train:  9.97526; grad/pseudo_mag9_train:  22873.99746; grad/true_std9_train:  0.00244; grad/pseudo_std9_train:  5.58440; grad/diff9_train:  22864.98955; grad/cos9_train:  0.90009; grad/true_mag10_train:  11.47511; grad/pseudo_mag10_train:  22909.00908; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  5.59293; grad/diff10_train:  22898.78125; grad/cos10_train:  0.88796; grad/true_mag11_train:  13.29468; grad/pseudo_mag11_train:  24153.65137; grad/true_std11_train:  0.00325; grad/pseudo_std11_train:  5.89371; grad/diff11_train:  24142.90400; grad/cos11_train:  0.79624; grad/true_mag12_train:  9.11870; grad/pseudo_mag12_train:  22822.14971; grad/true_std12_train:  0.00223; grad/pseudo_std12_train:  5.57173; grad/diff12_train:  22814.19727; grad/cos12_train:  0.86709; grad/true_mag13_train:  10.82654; grad/pseudo_mag13_train:  23560.75098; grad/true_std13_train:  0.00264; grad/pseudo_std13_train:  5.75200; grad/diff13_train:  23551.32949; grad/cos13_train:  0.86416; grad/true_mag14_train:  13.26901; grad/pseudo_mag14_train:  24139.96631; grad/true_std14_train:  0.00324; grad/pseudo_std14_train:  5.88872; grad/diff14_train:  24129.99834; grad/cos14_train:  0.73762; grad/true_mag15_train:  8.24874; grad/pseudo_mag15_train:  22464.32412; grad/true_std15_train:  0.00201; grad/pseudo_std15_train:  5.48405; grad/diff15_train:  22457.51475; grad/cos15_train:  0.81752; grad/true_mag16_train:  14.89409; grad/pseudo_mag16_train:  24287.77441; grad/true_std16_train:  0.00364; grad/pseudo_std16_train:  5.92925; grad/diff16_train:  24279.34521; grad/cos16_train:  0.56533; grad/true_mag17_train:  21.46527; grad/pseudo_mag17_train:  21954.37480; grad/true_std17_train:  0.00524; grad/pseudo_std17_train:  5.30975; grad/diff17_train:  21944.03125; grad/cos17_train:  0.47735; grad_train:  889.43610; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00007; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:28:00,207][trainer][INFO] - Step 600:
[2025-04-24 22:28:00,208][trainer][INFO] - loss/edit_val:  6.87987; loss/loc_val:  0.09073; edit/acc_val:  0.04735; edit/log_prob_val: -6.87987; edit/prob_val:  0.26642; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.39551; perplexity/post_val:  81.08586; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11199; loss/total_val:  0.77872; loss/total_edit_val:  0.77872; memory/alloc_max_val:  42026814976.00000; memory/res_max_val:  44885344256.00000; eval_time/elapsed:  18.54727; eval_time/average:  0.18547
[2025-04-24 22:28:00,210][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:28:00,211][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:28:54,504][trainer][INFO] - Write complete.
[2025-04-24 22:28:57,644][trainer][INFO] - Step 610:
[2025-04-24 22:28:57,644][trainer][INFO] - loss/edit_train:  7.22161; loss/loc_train:  0.12296; edit/acc_train:  0.01667; edit/log_prob_train: -7.22161; edit/prob_train:  0.24182; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.64256; perplexity/pre_train:  103.80990; nll/post_train:  4.76125; perplexity/post_train:  116.89160; n_tokens/pre_train:  3.70000; n_tokens/post_train:  3.70000; time/edit_train:  0.17903; loss/total_train:  0.84512; loss/total_edit_train:  0.84512; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  44885344256.00000; grad/true_mag0_train:  8.03166; grad/pseudo_mag0_train:  18755.23994; grad/true_std0_train:  0.00196; grad/pseudo_std0_train:  4.57837; grad/diff0_train:  18748.99150; grad/cos0_train:  0.76857; grad/true_mag1_train:  12.10864; grad/pseudo_mag1_train:  19995.37227; grad/true_std1_train:  0.00296; grad/pseudo_std1_train:  4.88078; grad/diff1_train:  19985.95527; grad/cos1_train:  0.76529; grad/true_mag2_train:  15.40444; grad/pseudo_mag2_train:  32919.34961; grad/true_std2_train:  0.00376; grad/pseudo_std2_train:  7.88049; grad/diff2_train:  32911.51074; grad/cos2_train:  0.47290; grad/true_mag3_train:  9.14595; grad/pseudo_mag3_train:  19798.88965; grad/true_std3_train:  0.00223; grad/pseudo_std3_train:  4.83358; grad/diff3_train:  19791.09492; grad/cos3_train:  0.84333; grad/true_mag4_train:  11.75685; grad/pseudo_mag4_train:  20410.56611; grad/true_std4_train:  0.00287; grad/pseudo_std4_train:  4.98278; grad/diff4_train:  20400.57783; grad/cos4_train:  0.83840; grad/true_mag5_train:  14.34911; grad/pseudo_mag5_train:  24873.87012; grad/true_std5_train:  0.00350; grad/pseudo_std5_train:  6.02859; grad/diff5_train:  24863.81016; grad/cos5_train:  0.66811; grad/true_mag6_train:  9.26154; grad/pseudo_mag6_train:  20669.53076; grad/true_std6_train:  0.00226; grad/pseudo_std6_train:  5.04617; grad/diff6_train:  20661.29971; grad/cos6_train:  0.88171; grad/true_mag7_train:  11.02784; grad/pseudo_mag7_train:  20760.29736; grad/true_std7_train:  0.00269; grad/pseudo_std7_train:  5.06832; grad/diff7_train:  20750.71650; grad/cos7_train:  0.86090; grad/true_mag8_train:  12.74575; grad/pseudo_mag8_train:  22963.56865; grad/true_std8_train:  0.00311; grad/pseudo_std8_train:  5.60197; grad/diff8_train:  22953.17129; grad/cos8_train:  0.79429; grad/true_mag9_train:  9.36129; grad/pseudo_mag9_train:  21375.74736; grad/true_std9_train:  0.00229; grad/pseudo_std9_train:  5.21862; grad/diff9_train:  21367.45869; grad/cos9_train:  0.87681; grad/true_mag10_train:  10.80020; grad/pseudo_mag10_train:  21293.31895; grad/true_std10_train:  0.00264; grad/pseudo_std10_train:  5.19847; grad/diff10_train:  21283.91006; grad/cos10_train:  0.86045; grad/true_mag11_train:  13.00644; grad/pseudo_mag11_train:  22999.14209; grad/true_std11_train:  0.00318; grad/pseudo_std11_train:  5.61237; grad/diff11_train:  22989.15352; grad/cos11_train:  0.74184; grad/true_mag12_train:  8.93329; grad/pseudo_mag12_train:  22096.43047; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.39452; grad/diff12_train:  22088.90723; grad/cos12_train:  0.83004; grad/true_mag13_train:  10.41638; grad/pseudo_mag13_train:  22187.90801; grad/true_std13_train:  0.00254; grad/pseudo_std13_train:  5.41686; grad/diff13_train:  22179.16260; grad/cos13_train:  0.82770; grad/true_mag14_train:  13.65652; grad/pseudo_mag14_train:  23803.31787; grad/true_std14_train:  0.00333; grad/pseudo_std14_train:  5.80624; grad/diff14_train:  23793.54346; grad/cos14_train:  0.68482; grad/true_mag15_train:  8.59515; grad/pseudo_mag15_train:  23074.40918; grad/true_std15_train:  0.00210; grad/pseudo_std15_train:  5.63294; grad/diff15_train:  23067.55146; grad/cos15_train:  0.78127; grad/true_mag16_train:  15.13725; grad/pseudo_mag16_train:  23340.30518; grad/true_std16_train:  0.00370; grad/pseudo_std16_train:  5.69785; grad/diff16_train:  23332.38564; grad/cos16_train:  0.51659; grad/true_mag17_train:  21.06289; grad/pseudo_mag17_train:  21378.90391; grad/true_std17_train:  0.00514; grad/pseudo_std17_train:  5.17855; grad/diff17_train:  21369.16104; grad/cos17_train:  0.44857; grad_train:  2452.52295; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00005; lr/lr7_train:  0.00004; lr/lr8_train:  0.00007; lr/lr9_train:  0.00004; lr/lr10_train:  0.00004; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:29:01,002][trainer][INFO] - Step 620:
[2025-04-24 22:29:01,003][trainer][INFO] - loss/edit_train:  6.08193; loss/loc_train:  0.02859; edit/acc_train:  0.04345; edit/log_prob_train: -6.08193; edit/prob_train:  0.25650; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  4.09430; perplexity/pre_train:  59.99708; nll/post_train:  4.09602; perplexity/post_train:  60.10070; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.19183; loss/total_train:  0.63678; loss/total_edit_train:  0.63678; memory/alloc_max_train:  42026814976.00000; memory/res_max_train:  46780330803.20000; grad/true_mag0_train:  7.57118; grad/pseudo_mag0_train:  17988.07900; grad/true_std0_train:  0.00185; grad/pseudo_std0_train:  4.39127; grad/diff0_train:  17982.12139; grad/cos0_train:  0.78241; grad/true_mag1_train:  11.08552; grad/pseudo_mag1_train:  18440.51270; grad/true_std1_train:  0.00271; grad/pseudo_std1_train:  4.50143; grad/diff1_train:  18431.71465; grad/cos1_train:  0.78949; grad/true_mag2_train:  14.14281; grad/pseudo_mag2_train:  28565.13555; grad/true_std2_train:  0.00345; grad/pseudo_std2_train:  6.84466; grad/diff2_train:  28557.33418; grad/cos2_train:  0.52666; grad/true_mag3_train:  8.56631; grad/pseudo_mag3_train:  18909.66738; grad/true_std3_train:  0.00209; grad/pseudo_std3_train:  4.61655; grad/diff3_train:  18902.25605; grad/cos3_train:  0.86192; grad/true_mag4_train:  10.61223; grad/pseudo_mag4_train:  18806.30400; grad/true_std4_train:  0.00259; grad/pseudo_std4_train:  4.59124; grad/diff4_train:  18797.12539; grad/cos4_train:  0.86077; grad/true_mag5_train:  12.98485; grad/pseudo_mag5_train:  24228.86484; grad/true_std5_train:  0.00317; grad/pseudo_std5_train:  5.86045; grad/diff5_train:  24219.91426; grad/cos5_train:  0.66980; grad/true_mag6_train:  8.64694; grad/pseudo_mag6_train:  19445.58945; grad/true_std6_train:  0.00211; grad/pseudo_std6_train:  4.74742; grad/diff6_train:  19437.80264; grad/cos6_train:  0.89814; grad/true_mag7_train:  10.07447; grad/pseudo_mag7_train:  19584.75225; grad/true_std7_train:  0.00246; grad/pseudo_std7_train:  4.78138; grad/diff7_train:  19575.79668; grad/cos7_train:  0.88507; grad/true_mag8_train:  11.69050; grad/pseudo_mag8_train:  21460.97168; grad/true_std8_train:  0.00285; grad/pseudo_std8_train:  5.23559; grad/diff8_train:  21451.17256; grad/cos8_train:  0.82882; grad/true_mag9_train:  8.57885; grad/pseudo_mag9_train:  19851.80371; grad/true_std9_train:  0.00209; grad/pseudo_std9_train:  4.84660; grad/diff9_train:  19844.04834; grad/cos9_train:  0.90198; grad/true_mag10_train:  9.86352; grad/pseudo_mag10_train:  19778.95176; grad/true_std10_train:  0.00241; grad/pseudo_std10_train:  4.82880; grad/diff10_train:  19770.27627; grad/cos10_train:  0.88077; grad/true_mag11_train:  11.39839; grad/pseudo_mag11_train:  21192.48691; grad/true_std11_train:  0.00278; grad/pseudo_std11_train:  5.17123; grad/diff11_train:  21183.31016; grad/cos11_train:  0.79751; grad/true_mag12_train:  8.02589; grad/pseudo_mag12_train:  20366.76260; grad/true_std12_train:  0.00196; grad/pseudo_std12_train:  4.97229; grad/diff12_train:  20359.79912; grad/cos12_train:  0.86416; grad/true_mag13_train:  9.17796; grad/pseudo_mag13_train:  20383.44902; grad/true_std13_train:  0.00224; grad/pseudo_std13_train:  4.97635; grad/diff13_train:  20375.45020; grad/cos13_train:  0.86940; grad/true_mag14_train:  11.49346; grad/pseudo_mag14_train:  21177.18223; grad/true_std14_train:  0.00281; grad/pseudo_std14_train:  5.16576; grad/diff14_train:  21168.72559; grad/cos14_train:  0.72960; grad/true_mag15_train:  7.49786; grad/pseudo_mag15_train:  20804.14824; grad/true_std15_train:  0.00183; grad/pseudo_std15_train:  5.07875; grad/diff15_train:  20797.96875; grad/cos15_train:  0.82047; grad/true_mag16_train:  13.25371; grad/pseudo_mag16_train:  21180.11191; grad/true_std16_train:  0.00324; grad/pseudo_std16_train:  5.17063; grad/diff16_train:  21172.78848; grad/cos16_train:  0.55458; grad/true_mag17_train:  18.71945; grad/pseudo_mag17_train:  19621.13301; grad/true_std17_train:  0.00457; grad/pseudo_std17_train:  4.73401; grad/diff17_train:  19612.81270; grad/cos17_train:  0.44140; grad_train:  495.61020; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00008; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00007; lr/lr9_train:  0.00004; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00005
[2025-04-24 22:29:04,727][trainer][INFO] - Step 630:
[2025-04-24 22:29:04,728][trainer][INFO] - loss/edit_train:  6.92643; loss/loc_train:  0.06525; edit/acc_train:  0.02579; edit/log_prob_train: -6.92643; edit/prob_train:  0.23108; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.61403; perplexity/pre_train:  100.88970; nll/post_train:  4.60497; perplexity/post_train:  99.98006; n_tokens/pre_train:  6.50000; n_tokens/post_train:  6.50000; time/edit_train:  0.21862; loss/total_train:  0.75789; loss/total_edit_train:  0.75789; memory/alloc_max_train:  42036010905.60000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.43197; grad/pseudo_mag0_train:  19679.38613; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.80361; grad/diff0_train:  19672.87266; grad/cos0_train:  0.76850; grad/true_mag1_train:  12.19344; grad/pseudo_mag1_train:  20035.39902; grad/true_std1_train:  0.00298; grad/pseudo_std1_train:  4.89027; grad/diff1_train:  20025.77266; grad/cos1_train:  0.78546; grad/true_mag2_train:  15.88520; grad/pseudo_mag2_train:  31289.85039; grad/true_std2_train:  0.00388; grad/pseudo_std2_train:  7.48831; grad/diff2_train:  31281.29063; grad/cos2_train:  0.51408; grad/true_mag3_train:  9.88948; grad/pseudo_mag3_train:  21146.91504; grad/true_std3_train:  0.00241; grad/pseudo_std3_train:  5.16268; grad/diff3_train:  21138.48955; grad/cos3_train:  0.84976; grad/true_mag4_train:  12.29845; grad/pseudo_mag4_train:  21116.05723; grad/true_std4_train:  0.00300; grad/pseudo_std4_train:  5.15490; grad/diff4_train:  21105.62021; grad/cos4_train:  0.84536; grad/true_mag5_train:  15.15001; grad/pseudo_mag5_train:  25277.12969; grad/true_std5_train:  0.00370; grad/pseudo_std5_train:  6.12590; grad/diff5_train:  25266.06289; grad/cos5_train:  0.71020; grad/true_mag6_train:  10.11726; grad/pseudo_mag6_train:  22335.34258; grad/true_std6_train:  0.00247; grad/pseudo_std6_train:  5.45284; grad/diff6_train:  22326.33320; grad/cos6_train:  0.89122; grad/true_mag7_train:  11.68110; grad/pseudo_mag7_train:  22175.30732; grad/true_std7_train:  0.00285; grad/pseudo_std7_train:  5.41375; grad/diff7_train:  22165.00703; grad/cos7_train:  0.87903; grad/true_mag8_train:  13.63210; grad/pseudo_mag8_train:  24362.75156; grad/true_std8_train:  0.00333; grad/pseudo_std8_train:  5.94440; grad/diff8_train:  24351.28066; grad/cos8_train:  0.83176; grad/true_mag9_train:  10.04291; grad/pseudo_mag9_train:  22379.92188; grad/true_std9_train:  0.00245; grad/pseudo_std9_train:  5.46377; grad/diff9_train:  22370.96260; grad/cos9_train:  0.89381; grad/true_mag10_train:  11.65136; grad/pseudo_mag10_train:  22473.86465; grad/true_std10_train:  0.00284; grad/pseudo_std10_train:  5.48668; grad/diff10_train:  22463.81445; grad/cos10_train:  0.86331; grad/true_mag11_train:  13.39156; grad/pseudo_mag11_train:  23660.21270; grad/true_std11_train:  0.00327; grad/pseudo_std11_train:  5.77403; grad/diff11_train:  23649.62344; grad/cos11_train:  0.78701; grad/true_mag12_train:  9.10476; grad/pseudo_mag12_train:  21663.93018; grad/true_std12_train:  0.00222; grad/pseudo_std12_train:  5.28895; grad/diff12_train:  21656.28125; grad/cos12_train:  0.84084; grad/true_mag13_train:  10.30262; grad/pseudo_mag13_train:  21757.74189; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  5.31182; grad/diff13_train:  21749.03135; grad/cos13_train:  0.84351; grad/true_mag14_train:  13.30540; grad/pseudo_mag14_train:  23085.26152; grad/true_std14_train:  0.00325; grad/pseudo_std14_train:  5.63153; grad/diff14_train:  23075.64648; grad/cos14_train:  0.72020; grad/true_mag15_train:  8.32330; grad/pseudo_mag15_train:  21986.60830; grad/true_std15_train:  0.00203; grad/pseudo_std15_train:  5.36701; grad/diff15_train:  21979.97168; grad/cos15_train:  0.79792; grad/true_mag16_train:  15.42092; grad/pseudo_mag16_train:  22662.61533; grad/true_std16_train:  0.00376; grad/pseudo_std16_train:  5.53233; grad/diff16_train:  22654.57549; grad/cos16_train:  0.54666; grad/true_mag17_train:  21.12070; grad/pseudo_mag17_train:  21597.16367; grad/true_std17_train:  0.00516; grad/pseudo_std17_train:  5.21111; grad/diff17_train:  21587.77207; grad/cos17_train:  0.44919; grad_train:  1279.14429; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00004; lr/lr7_train:  0.00004; lr/lr8_train:  0.00007; lr/lr9_train:  0.00004; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00004; lr/lr13_train:  0.00004; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:29:07,833][trainer][INFO] - Step 640:
[2025-04-24 22:29:07,834][trainer][INFO] - loss/edit_train:  6.37493; loss/loc_train:  0.08016; edit/acc_train:  0.03288; edit/log_prob_train: -6.37493; edit/prob_train:  0.26656; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.13990; perplexity/pre_train:  62.79625; nll/post_train:  4.11127; perplexity/post_train:  61.02442; n_tokens/pre_train:  6.60000; n_tokens/post_train:  6.60000; time/edit_train:  0.17140; loss/total_train:  0.71765; loss/total_edit_train:  0.71765; memory/alloc_max_train:  42072794624.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  9.42590; grad/pseudo_mag0_train:  22480.48379; grad/true_std0_train:  0.00230; grad/pseudo_std0_train:  5.48783; grad/diff0_train:  22472.99502; grad/cos0_train:  0.78973; grad/true_mag1_train:  13.63008; grad/pseudo_mag1_train:  23290.14512; grad/true_std1_train:  0.00333; grad/pseudo_std1_train:  5.68488; grad/diff1_train:  23279.43633; grad/cos1_train:  0.77876; grad/true_mag2_train:  18.33293; grad/pseudo_mag2_train:  33572.42715; grad/true_std2_train:  0.00448; grad/pseudo_std2_train:  8.05895; grad/diff2_train:  33561.75000; grad/cos2_train:  0.57739; grad/true_mag3_train:  10.99634; grad/pseudo_mag3_train:  24228.26660; grad/true_std3_train:  0.00268; grad/pseudo_std3_train:  5.91485; grad/diff3_train:  24218.84004; grad/cos3_train:  0.85121; grad/true_mag4_train:  13.75161; grad/pseudo_mag4_train:  24587.62930; grad/true_std4_train:  0.00336; grad/pseudo_std4_train:  6.00210; grad/diff4_train:  24575.96172; grad/cos4_train:  0.84205; grad/true_mag5_train:  16.80043; grad/pseudo_mag5_train:  28193.38789; grad/true_std5_train:  0.00410; grad/pseudo_std5_train:  6.84402; grad/diff5_train:  28180.79004; grad/cos5_train:  0.74059; grad/true_mag6_train:  11.20081; grad/pseudo_mag6_train:  24738.27998; grad/true_std6_train:  0.00273; grad/pseudo_std6_train:  6.03948; grad/diff6_train:  24728.33340; grad/cos6_train:  0.88306; grad/true_mag7_train:  12.96814; grad/pseudo_mag7_train:  25634.74932; grad/true_std7_train:  0.00317; grad/pseudo_std7_train:  6.25788; grad/diff7_train:  25623.49346; grad/cos7_train:  0.85980; grad/true_mag8_train:  15.83777; grad/pseudo_mag8_train:  28123.85898; grad/true_std8_train:  0.00387; grad/pseudo_std8_train:  6.86219; grad/diff8_train:  28111.11855; grad/cos8_train:  0.82059; grad/true_mag9_train:  10.69818; grad/pseudo_mag9_train:  24723.27568; grad/true_std9_train:  0.00261; grad/pseudo_std9_train:  6.03584; grad/diff9_train:  24713.85703; grad/cos9_train:  0.86679; grad/true_mag10_train:  13.96210; grad/pseudo_mag10_train:  24842.21143; grad/true_std10_train:  0.00341; grad/pseudo_std10_train:  6.06472; grad/diff10_train:  24831.62988; grad/cos10_train:  0.82444; grad/true_mag11_train:  14.43491; grad/pseudo_mag11_train:  25772.07441; grad/true_std11_train:  0.00352; grad/pseudo_std11_train:  6.28940; grad/diff11_train:  25760.40195; grad/cos11_train:  0.80039; grad/true_mag12_train:  10.06276; grad/pseudo_mag12_train:  24911.62891; grad/true_std12_train:  0.00246; grad/pseudo_std12_train:  6.08185; grad/diff12_train:  24902.95488; grad/cos12_train:  0.85203; grad/true_mag13_train:  11.86952; grad/pseudo_mag13_train:  24888.07910; grad/true_std13_train:  0.00290; grad/pseudo_std13_train:  6.07602; grad/diff13_train:  24878.05195; grad/cos13_train:  0.83902; grad/true_mag14_train:  14.28220; grad/pseudo_mag14_train:  25050.39531; grad/true_std14_train:  0.00349; grad/pseudo_std14_train:  6.11165; grad/diff14_train:  25039.63262; grad/cos14_train:  0.74431; grad/true_mag15_train:  8.75350; grad/pseudo_mag15_train:  23147.17178; grad/true_std15_train:  0.00214; grad/pseudo_std15_train:  5.65078; grad/diff15_train:  23139.98369; grad/cos15_train:  0.81355; grad/true_mag16_train:  14.59103; grad/pseudo_mag16_train:  23440.78232; grad/true_std16_train:  0.00356; grad/pseudo_std16_train:  5.72257; grad/diff16_train:  23432.42266; grad/cos16_train:  0.57219; grad/true_mag17_train:  20.90927; grad/pseudo_mag17_train:  22343.69160; grad/true_std17_train:  0.00510; grad/pseudo_std17_train:  5.39960; grad/diff17_train:  22333.54473; grad/cos17_train:  0.48230; grad_train:  992.58258; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00007; lr/lr5_train:  0.00013; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00007; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00004; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:29:10,981][trainer][INFO] - Step 650:
[2025-04-24 22:29:10,981][trainer][INFO] - loss/edit_train:  5.91533; loss/loc_train:  0.07297; edit/acc_train:  0.06263; edit/log_prob_train: -5.91533; edit/prob_train:  0.26821; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.91967; perplexity/pre_train:  372.28720; nll/post_train:  5.79109; perplexity/post_train:  327.37009; n_tokens/pre_train:  3.00000; n_tokens/post_train:  3.00000; time/edit_train:  0.18143; loss/total_train:  0.66450; loss/total_edit_train:  0.66450; memory/alloc_max_train:  42072794624.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.18561; grad/pseudo_mag0_train:  19680.24248; grad/true_std0_train:  0.00200; grad/pseudo_std0_train:  4.80404; grad/diff0_train:  19673.91680; grad/cos0_train:  0.75968; grad/true_mag1_train:  11.92468; grad/pseudo_mag1_train:  19993.02793; grad/true_std1_train:  0.00291; grad/pseudo_std1_train:  4.87977; grad/diff1_train:  19983.81289; grad/cos1_train:  0.75691; grad/true_mag2_train:  15.15757; grad/pseudo_mag2_train:  36343.27676; grad/true_std2_train:  0.00370; grad/pseudo_std2_train:  8.67662; grad/diff2_train:  36336.06895; grad/cos2_train:  0.42467; grad/true_mag3_train:  9.19401; grad/pseudo_mag3_train:  19983.98955; grad/true_std3_train:  0.00224; grad/pseudo_std3_train:  4.87873; grad/diff3_train:  19976.17314; grad/cos3_train:  0.83937; grad/true_mag4_train:  11.73848; grad/pseudo_mag4_train:  20289.76240; grad/true_std4_train:  0.00287; grad/pseudo_std4_train:  4.95316; grad/diff4_train:  20279.81982; grad/cos4_train:  0.83401; grad/true_mag5_train:  14.29899; grad/pseudo_mag5_train:  26461.52031; grad/true_std5_train:  0.00349; grad/pseudo_std5_train:  6.39137; grad/diff5_train:  26451.94326; grad/cos5_train:  0.61737; grad/true_mag6_train:  9.30741; grad/pseudo_mag6_train:  20791.66729; grad/true_std6_train:  0.00227; grad/pseudo_std6_train:  5.07596; grad/diff6_train:  20783.38271; grad/cos6_train:  0.88224; grad/true_mag7_train:  10.96636; grad/pseudo_mag7_train:  20721.98086; grad/true_std7_train:  0.00268; grad/pseudo_std7_train:  5.05892; grad/diff7_train:  20712.41426; grad/cos7_train:  0.86055; grad/true_mag8_train:  12.71684; grad/pseudo_mag8_train:  22737.51719; grad/true_std8_train:  0.00310; grad/pseudo_std8_train:  5.54594; grad/diff8_train:  22727.28545; grad/cos8_train:  0.77614; grad/true_mag9_train:  9.09847; grad/pseudo_mag9_train:  20777.18730; grad/true_std9_train:  0.00222; grad/pseudo_std9_train:  5.07246; grad/diff9_train:  20769.07422; grad/cos9_train:  0.88339; grad/true_mag10_train:  10.49907; grad/pseudo_mag10_train:  20887.74531; grad/true_std10_train:  0.00256; grad/pseudo_std10_train:  5.09941; grad/diff10_train:  20878.53457; grad/cos10_train:  0.86760; grad/true_mag11_train:  12.75500; grad/pseudo_mag11_train:  22974.92812; grad/true_std11_train:  0.00311; grad/pseudo_std11_train:  5.60527; grad/diff11_train:  22965.32803; grad/cos11_train:  0.72509; grad/true_mag12_train:  8.80263; grad/pseudo_mag12_train:  21730.23076; grad/true_std12_train:  0.00215; grad/pseudo_std12_train:  5.30510; grad/diff12_train:  21722.73574; grad/cos12_train:  0.83960; grad/true_mag13_train:  10.13343; grad/pseudo_mag13_train:  21942.80615; grad/true_std13_train:  0.00247; grad/pseudo_std13_train:  5.35694; grad/diff13_train:  21934.19268; grad/cos13_train:  0.84143; grad/true_mag14_train:  12.97618; grad/pseudo_mag14_train:  23361.56221; grad/true_std14_train:  0.00317; grad/pseudo_std14_train:  5.69757; grad/diff14_train:  23352.48447; grad/cos14_train:  0.67623; grad/true_mag15_train:  8.13664; grad/pseudo_mag15_train:  21410.28086; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  5.22642; grad/diff15_train:  21403.84941; grad/cos15_train:  0.77862; grad/true_mag16_train:  15.15439; grad/pseudo_mag16_train:  21971.06436; grad/true_std16_train:  0.00370; grad/pseudo_std16_train:  5.36336; grad/diff16_train:  21963.52441; grad/cos16_train:  0.50124; grad/true_mag17_train:  20.80457; grad/pseudo_mag17_train:  20517.93008; grad/true_std17_train:  0.00508; grad/pseudo_std17_train:  4.95139; grad/diff17_train:  20509.18799; grad/cos17_train:  0.41470; grad_train:  1333.15454; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00013; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00007; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00004; lr/lr15_train:  0.00003; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:29:14,996][trainer][INFO] - Step 660:
[2025-04-24 22:29:14,996][trainer][INFO] - loss/edit_train:  6.74473; loss/loc_train:  0.06902; edit/acc_train:  0.08150; edit/log_prob_train: -6.74473; edit/prob_train:  0.23201; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.86250; perplexity/pre_train:  47.58401; nll/post_train:  3.89273; perplexity/post_train:  49.04467; n_tokens/pre_train:  6.60000; n_tokens/post_train:  6.60000; time/edit_train:  0.25301; loss/total_train:  0.74349; loss/total_edit_train:  0.74349; memory/alloc_max_train:  42072794624.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.28609; grad/pseudo_mag0_train:  17570.84639; grad/true_std0_train:  0.00178; grad/pseudo_std0_train:  4.28901; grad/diff0_train:  17565.35352; grad/cos0_train:  0.73626; grad/true_mag1_train:  10.62342; grad/pseudo_mag1_train:  18450.55703; grad/true_std1_train:  0.00259; grad/pseudo_std1_train:  4.50333; grad/diff1_train:  18442.57832; grad/cos1_train:  0.72867; grad/true_mag2_train:  13.43839; grad/pseudo_mag2_train:  39112.95176; grad/true_std2_train:  0.00328; grad/pseudo_std2_train:  9.30358; grad/diff2_train:  39107.13945; grad/cos2_train:  0.37691; grad/true_mag3_train:  8.10215; grad/pseudo_mag3_train:  17906.99814; grad/true_std3_train:  0.00198; grad/pseudo_std3_train:  4.37164; grad/diff3_train:  17900.18164; grad/cos3_train:  0.82557; grad/true_mag4_train:  10.65297; grad/pseudo_mag4_train:  18495.40664; grad/true_std4_train:  0.00260; grad/pseudo_std4_train:  4.51507; grad/diff4_train:  18486.77080; grad/cos4_train:  0.79375; grad/true_mag5_train:  12.65953; grad/pseudo_mag5_train:  30005.73555; grad/true_std5_train:  0.00309; grad/pseudo_std5_train:  7.23099; grad/diff5_train:  29998.12227; grad/cos5_train:  0.54951; grad/true_mag6_train:  8.41135; grad/pseudo_mag6_train:  18832.82324; grad/true_std6_train:  0.00205; grad/pseudo_std6_train:  4.59773; grad/diff6_train:  18825.44131; grad/cos6_train:  0.86539; grad/true_mag7_train:  9.82105; grad/pseudo_mag7_train:  18930.18750; grad/true_std7_train:  0.00240; grad/pseudo_std7_train:  4.62148; grad/diff7_train:  18921.74844; grad/cos7_train:  0.84380; grad/true_mag8_train:  11.15940; grad/pseudo_mag8_train:  23962.36543; grad/true_std8_train:  0.00272; grad/pseudo_std8_train:  5.84039; grad/diff8_train:  23953.99697; grad/cos8_train:  0.70711; grad/true_mag9_train:  8.22901; grad/pseudo_mag9_train:  18908.54414; grad/true_std9_train:  0.00201; grad/pseudo_std9_train:  4.61623; grad/diff9_train:  18901.27529; grad/cos9_train:  0.87141; grad/true_mag10_train:  9.33556; grad/pseudo_mag10_train:  18774.40654; grad/true_std10_train:  0.00228; grad/pseudo_std10_train:  4.58346; grad/diff10_train:  18766.32529; grad/cos10_train:  0.85132; grad/true_mag11_train:  11.10106; grad/pseudo_mag11_train:  23067.02930; grad/true_std11_train:  0.00271; grad/pseudo_std11_train:  5.62434; grad/diff11_train:  23059.24941; grad/cos11_train:  0.65986; grad/true_mag12_train:  7.50869; grad/pseudo_mag12_train:  18934.26787; grad/true_std12_train:  0.00183; grad/pseudo_std12_train:  4.62246; grad/diff12_train:  18927.92695; grad/cos12_train:  0.82966; grad/true_mag13_train:  8.69174; grad/pseudo_mag13_train:  18949.61875; grad/true_std13_train:  0.00212; grad/pseudo_std13_train:  4.62618; grad/diff13_train:  18942.33408; grad/cos13_train:  0.82269; grad/true_mag14_train:  11.18405; grad/pseudo_mag14_train:  22655.67920; grad/true_std14_train:  0.00273; grad/pseudo_std14_train:  5.52081; grad/diff14_train:  22648.45469; grad/cos14_train:  0.60487; grad/true_mag15_train:  7.04649; grad/pseudo_mag15_train:  19260.29434; grad/true_std15_train:  0.00172; grad/pseudo_std15_train:  4.70143; grad/diff15_train:  19254.87158; grad/cos15_train:  0.74418; grad/true_mag16_train:  13.22204; grad/pseudo_mag16_train:  19182.36523; grad/true_std16_train:  0.00323; grad/pseudo_std16_train:  4.68247; grad/diff16_train:  19175.96582; grad/cos16_train:  0.47435; grad/true_mag17_train:  18.39498; grad/pseudo_mag17_train:  20350.62393; grad/true_std17_train:  0.00449; grad/pseudo_std17_train:  4.88106; grad/diff17_train:  20343.39941; grad/cos17_train:  0.36898; grad_train:  1016.39813; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00007; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00004; lr/lr17_train:  0.00004
[2025-04-24 22:29:18,164][trainer][INFO] - Step 670:
[2025-04-24 22:29:18,164][trainer][INFO] - loss/edit_train:  4.31672; loss/loc_train:  0.04993; edit/acc_train:  0.06008; edit/log_prob_train: -4.31672; edit/prob_train:  0.36265; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.98532; perplexity/pre_train:  146.25015; nll/post_train:  5.10687; perplexity/post_train:  165.15231; n_tokens/pre_train:  3.50000; n_tokens/post_train:  3.50000; time/edit_train:  0.17245; loss/total_train:  0.48160; loss/total_edit_train:  0.48160; memory/alloc_max_train:  42072794624.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.43941; grad/pseudo_mag0_train:  19810.20957; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.83564; grad/diff0_train:  19803.71377; grad/cos0_train:  0.76795; grad/true_mag1_train:  12.10699; grad/pseudo_mag1_train:  20582.67773; grad/true_std1_train:  0.00296; grad/pseudo_std1_train:  5.02345; grad/diff1_train:  20573.40596; grad/cos1_train:  0.76247; grad/true_mag2_train:  16.18575; grad/pseudo_mag2_train:  34355.01543; grad/true_std2_train:  0.00395; grad/pseudo_std2_train:  8.17984; grad/diff2_train:  34347.37246; grad/cos2_train:  0.47070; grad/true_mag3_train:  9.72956; grad/pseudo_mag3_train:  20924.37041; grad/true_std3_train:  0.00238; grad/pseudo_std3_train:  5.10819; grad/diff3_train:  20916.16807; grad/cos3_train:  0.84050; grad/true_mag4_train:  11.99902; grad/pseudo_mag4_train:  21080.90469; grad/true_std4_train:  0.00293; grad/pseudo_std4_train:  5.14577; grad/diff4_train:  21070.95859; grad/cos4_train:  0.82621; grad/true_mag5_train:  14.72972; grad/pseudo_mag5_train:  25917.51562; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  6.27301; grad/diff5_train:  25907.10996; grad/cos5_train:  0.69876; grad/true_mag6_train:  9.80426; grad/pseudo_mag6_train:  21414.42549; grad/true_std6_train:  0.00239; grad/pseudo_std6_train:  5.22797; grad/diff6_train:  21405.76973; grad/cos6_train:  0.87936; grad/true_mag7_train:  11.37710; grad/pseudo_mag7_train:  22219.46465; grad/true_std7_train:  0.00278; grad/pseudo_std7_train:  5.42403; grad/diff7_train:  22209.72676; grad/cos7_train:  0.85137; grad/true_mag8_train:  14.26556; grad/pseudo_mag8_train:  25776.15879; grad/true_std8_train:  0.00348; grad/pseudo_std8_train:  6.28816; grad/diff8_train:  25765.01504; grad/cos8_train:  0.80491; grad/true_mag9_train:  9.41791; grad/pseudo_mag9_train:  21503.70215; grad/true_std9_train:  0.00230; grad/pseudo_std9_train:  5.24980; grad/diff9_train:  21495.46572; grad/cos9_train:  0.86492; grad/true_mag10_train:  12.94963; grad/pseudo_mag10_train:  22235.46563; grad/true_std10_train:  0.00316; grad/pseudo_std10_train:  5.42832; grad/diff10_train:  22225.93828; grad/cos10_train:  0.81318; grad/true_mag11_train:  13.69854; grad/pseudo_mag11_train:  24235.70684; grad/true_std11_train:  0.00334; grad/pseudo_std11_train:  5.91363; grad/diff11_train:  24225.02715; grad/cos11_train:  0.77506; grad/true_mag12_train:  8.91411; grad/pseudo_mag12_train:  21341.45713; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.21020; grad/diff12_train:  21333.92549; grad/cos12_train:  0.83930; grad/true_mag13_train:  10.85392; grad/pseudo_mag13_train:  22029.02051; grad/true_std13_train:  0.00265; grad/pseudo_std13_train:  5.37799; grad/diff13_train:  22020.01582; grad/cos13_train:  0.83016; grad/true_mag14_train:  13.17072; grad/pseudo_mag14_train:  22887.75000; grad/true_std14_train:  0.00322; grad/pseudo_std14_train:  5.58255; grad/diff14_train:  22878.22061; grad/cos14_train:  0.71932; grad/true_mag15_train:  8.18927; grad/pseudo_mag15_train:  20850.80225; grad/true_std15_train:  0.00200; grad/pseudo_std15_train:  5.08986; grad/diff15_train:  20844.34658; grad/cos15_train:  0.78509; grad/true_mag16_train:  14.97623; grad/pseudo_mag16_train:  20749.41416; grad/true_std16_train:  0.00366; grad/pseudo_std16_train:  5.06520; grad/diff16_train:  20741.94492; grad/cos16_train:  0.50257; grad/true_mag17_train:  20.93834; grad/pseudo_mag17_train:  20627.14414; grad/true_std17_train:  0.00511; grad/pseudo_std17_train:  4.96264; grad/diff17_train:  20618.40137; grad/cos17_train:  0.41774; grad_train:  776.77258; lr/lr0_train:  0.00006; lr/lr1_train:  0.00005; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00007; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00004; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:29:21,414][trainer][INFO] - Step 680:
[2025-04-24 22:29:21,414][trainer][INFO] - loss/edit_train:  6.20972; loss/loc_train:  0.04717; edit/acc_train:  0.06600; edit/log_prob_train: -6.20972; edit/prob_train:  0.28629; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.14118; perplexity/pre_train:  62.87682; nll/post_train:  4.08766; perplexity/post_train:  59.60053; n_tokens/pre_train:  5.80000; n_tokens/post_train:  5.80000; time/edit_train:  0.18562; loss/total_train:  0.66815; loss/total_edit_train:  0.66815; memory/alloc_max_train:  42072794624.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.04613; grad/pseudo_mag0_train:  16348.10508; grad/true_std0_train:  0.00172; grad/pseudo_std0_train:  3.99065; grad/diff0_train:  16342.64922; grad/cos0_train:  0.76562; grad/true_mag1_train:  10.39112; grad/pseudo_mag1_train:  17245.05547; grad/true_std1_train:  0.00254; grad/pseudo_std1_train:  4.20907; grad/diff1_train:  17237.01885; grad/cos1_train:  0.76280; grad/true_mag2_train:  13.21411; grad/pseudo_mag2_train:  32026.58789; grad/true_std2_train:  0.00323; grad/pseudo_std2_train:  7.60358; grad/diff2_train:  32020.42793; grad/cos2_train:  0.42863; grad/true_mag3_train:  8.00583; grad/pseudo_mag3_train:  17154.19199; grad/true_std3_train:  0.00195; grad/pseudo_std3_train:  4.18788; grad/diff3_train:  17147.38037; grad/cos3_train:  0.84317; grad/true_mag4_train:  10.24483; grad/pseudo_mag4_train:  17523.36025; grad/true_std4_train:  0.00250; grad/pseudo_std4_train:  4.27783; grad/diff4_train:  17514.70088; grad/cos4_train:  0.83787; grad/true_mag5_train:  12.63653; grad/pseudo_mag5_train:  22910.68154; grad/true_std5_train:  0.00309; grad/pseudo_std5_train:  5.53026; grad/diff5_train:  22902.23086; grad/cos5_train:  0.63106; grad/true_mag6_train:  8.17811; grad/pseudo_mag6_train:  18035.06084; grad/true_std6_train:  0.00200; grad/pseudo_std6_train:  4.40300; grad/diff6_train:  18027.80020; grad/cos6_train:  0.88252; grad/true_mag7_train:  9.63771; grad/pseudo_mag7_train:  18184.66035; grad/true_std7_train:  0.00235; grad/pseudo_std7_train:  4.43945; grad/diff7_train:  18176.27061; grad/cos7_train:  0.86407; grad/true_mag8_train:  11.43062; grad/pseudo_mag8_train:  20408.58057; grad/true_std8_train:  0.00279; grad/pseudo_std8_train:  4.97795; grad/diff8_train:  20399.28330; grad/cos8_train:  0.79722; grad/true_mag9_train:  8.21094; grad/pseudo_mag9_train:  18597.81719; grad/true_std9_train:  0.00200; grad/pseudo_std9_train:  4.54040; grad/diff9_train:  18590.54629; grad/cos9_train:  0.87787; grad/true_mag10_train:  9.91447; grad/pseudo_mag10_train:  18470.52627; grad/true_std10_train:  0.00242; grad/pseudo_std10_train:  4.50928; grad/diff10_train:  18462.27842; grad/cos10_train:  0.84751; grad/true_mag11_train:  11.36930; grad/pseudo_mag11_train:  20467.71094; grad/true_std11_train:  0.00278; grad/pseudo_std11_train:  4.99366; grad/diff11_train:  20458.92383; grad/cos11_train:  0.74897; grad/true_mag12_train:  7.81197; grad/pseudo_mag12_train:  19137.32656; grad/true_std12_train:  0.00191; grad/pseudo_std12_train:  4.67208; grad/diff12_train:  19130.75078; grad/cos12_train:  0.82861; grad/true_mag13_train:  8.97098; grad/pseudo_mag13_train:  19469.09346; grad/true_std13_train:  0.00219; grad/pseudo_std13_train:  4.75304; grad/diff13_train:  19461.43633; grad/cos13_train:  0.84349; grad/true_mag14_train:  11.45982; grad/pseudo_mag14_train:  20570.17881; grad/true_std14_train:  0.00280; grad/pseudo_std14_train:  5.01660; grad/diff14_train:  20562.06816; grad/cos14_train:  0.68517; grad/true_mag15_train:  7.23137; grad/pseudo_mag15_train:  18735.81006; grad/true_std15_train:  0.00177; grad/pseudo_std15_train:  4.57354; grad/diff15_train:  18730.22842; grad/cos15_train:  0.75935; grad/true_mag16_train:  15.34047; grad/pseudo_mag16_train:  19085.70908; grad/true_std16_train:  0.00375; grad/pseudo_std16_train:  4.65904; grad/diff16_train:  19079.13086; grad/cos16_train:  0.42979; grad/true_mag17_train:  20.24771; grad/pseudo_mag17_train:  19172.25391; grad/true_std17_train:  0.00494; grad/pseudo_std17_train:  4.60139; grad/diff17_train:  19164.56748; grad/cos17_train:  0.37413; grad_train:  683.45953; lr/lr0_train:  0.00006; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:29:25,078][trainer][INFO] - Step 690:
[2025-04-24 22:29:25,079][trainer][INFO] - loss/edit_train:  5.54344; loss/loc_train:  0.07364; edit/acc_train:  0.06774; edit/log_prob_train: -5.54344; edit/prob_train:  0.27342; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.85584; perplexity/pre_train:  17.38909; nll/post_train:  2.84670; perplexity/post_train:  17.23091; n_tokens/pre_train:  7.90000; n_tokens/post_train:  7.90000; time/edit_train:  0.22164; loss/total_train:  0.62798; loss/total_edit_train:  0.62798; memory/alloc_max_train:  42175500390.40000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  9.66568; grad/pseudo_mag0_train:  23038.41211; grad/true_std0_train:  0.00236; grad/pseudo_std0_train:  5.62392; grad/diff0_train:  23030.75576; grad/cos0_train:  0.78502; grad/true_mag1_train:  13.83206; grad/pseudo_mag1_train:  22940.54756; grad/true_std1_train:  0.00338; grad/pseudo_std1_train:  5.59953; grad/diff1_train:  22929.44443; grad/cos1_train:  0.79417; grad/true_mag2_train:  18.10815; grad/pseudo_mag2_train:  36295.55625; grad/true_std2_train:  0.00442; grad/pseudo_std2_train:  8.64379; grad/diff2_train:  36285.90977; grad/cos2_train:  0.51023; grad/true_mag3_train:  11.35713; grad/pseudo_mag3_train:  25125.06367; grad/true_std3_train:  0.00277; grad/pseudo_std3_train:  6.13386; grad/diff3_train:  25115.24004; grad/cos3_train:  0.85852; grad/true_mag4_train:  13.91556; grad/pseudo_mag4_train:  24647.22568; grad/true_std4_train:  0.00340; grad/pseudo_std4_train:  6.01711; grad/diff4_train:  24635.15693; grad/cos4_train:  0.85953; grad/true_mag5_train:  16.90847; grad/pseudo_mag5_train:  29757.80371; grad/true_std5_train:  0.00413; grad/pseudo_std5_train:  7.19786; grad/diff5_train:  29745.23164; grad/cos5_train:  0.71350; grad/true_mag6_train:  11.44426; grad/pseudo_mag6_train:  25823.28867; grad/true_std6_train:  0.00279; grad/pseudo_std6_train:  6.30438; grad/diff6_train:  25812.97881; grad/cos6_train:  0.89802; grad/true_mag7_train:  13.16763; grad/pseudo_mag7_train:  25541.03008; grad/true_std7_train:  0.00321; grad/pseudo_std7_train:  6.23545; grad/diff7_train:  25529.32217; grad/cos7_train:  0.88327; grad/true_mag8_train:  15.28335; grad/pseudo_mag8_train:  27688.33535; grad/true_std8_train:  0.00373; grad/pseudo_std8_train:  6.75544; grad/diff8_train:  27675.17773; grad/cos8_train:  0.84864; grad/true_mag9_train:  11.04884; grad/pseudo_mag9_train:  25645.49434; grad/true_std9_train:  0.00270; grad/pseudo_std9_train:  6.26102; grad/diff9_train:  25635.50107; grad/cos9_train:  0.90046; grad/true_mag10_train:  13.07656; grad/pseudo_mag10_train:  25661.50156; grad/true_std10_train:  0.00319; grad/pseudo_std10_train:  6.26489; grad/diff10_train:  25650.14990; grad/cos10_train:  0.86921; grad/true_mag11_train:  14.53404; grad/pseudo_mag11_train:  26848.51221; grad/true_std11_train:  0.00355; grad/pseudo_std11_train:  6.55185; grad/diff11_train:  26836.42334; grad/cos11_train:  0.81525; grad/true_mag12_train:  10.26721; grad/pseudo_mag12_train:  25829.64482; grad/true_std12_train:  0.00251; grad/pseudo_std12_train:  6.30595; grad/diff12_train:  25820.70840; grad/cos12_train:  0.86168; grad/true_mag13_train:  11.76838; grad/pseudo_mag13_train:  25992.40811; grad/true_std13_train:  0.00287; grad/pseudo_std13_train:  6.34566; grad/diff13_train:  25982.10527; grad/cos13_train:  0.86761; grad/true_mag14_train:  14.38460; grad/pseudo_mag14_train:  26173.81455; grad/true_std14_train:  0.00351; grad/pseudo_std14_train:  6.38465; grad/diff14_train:  26162.73926; grad/cos14_train:  0.75400; grad/true_mag15_train:  8.85262; grad/pseudo_mag15_train:  24526.30244; grad/true_std15_train:  0.00216; grad/pseudo_std15_train:  5.98733; grad/diff15_train:  24518.91025; grad/cos15_train:  0.82696; grad/true_mag16_train:  14.52303; grad/pseudo_mag16_train:  24907.75010; grad/true_std16_train:  0.00355; grad/pseudo_std16_train:  6.08050; grad/diff16_train:  24899.12139; grad/cos16_train:  0.59337; grad/true_mag17_train:  20.61695; grad/pseudo_mag17_train:  22868.30732; grad/true_std17_train:  0.00503; grad/pseudo_std17_train:  5.50748; grad/diff17_train:  22858.47402; grad/cos17_train:  0.47232; grad_train:  1116.67920; lr/lr0_train:  0.00006; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00004; lr/lr7_train:  0.00003; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:29:28,256][trainer][INFO] - Step 700:
[2025-04-24 22:29:28,257][trainer][INFO] - loss/edit_train:  5.45773; loss/loc_train:  0.05026; edit/acc_train:  0.10329; edit/log_prob_train: -5.45773; edit/prob_train:  0.33590; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.54871; perplexity/pre_train:  256.90561; nll/post_train:  5.45857; perplexity/post_train:  234.76256; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18315; loss/total_train:  0.59604; loss/total_edit_train:  0.59604; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.69031; grad/pseudo_mag0_train:  17913.00088; grad/true_std0_train:  0.00188; grad/pseudo_std0_train:  4.37268; grad/diff0_train:  17907.06221; grad/cos0_train:  0.76906; grad/true_mag1_train:  11.09749; grad/pseudo_mag1_train:  18047.24678; grad/true_std1_train:  0.00271; grad/pseudo_std1_train:  4.40522; grad/diff1_train:  18038.59531; grad/cos1_train:  0.77307; grad/true_mag2_train:  14.71874; grad/pseudo_mag2_train:  35241.34414; grad/true_std2_train:  0.00359; grad/pseudo_std2_train:  8.35471; grad/diff2_train:  35234.94316; grad/cos2_train:  0.40646; grad/true_mag3_train:  8.83693; grad/pseudo_mag3_train:  19114.32041; grad/true_std3_train:  0.00216; grad/pseudo_std3_train:  4.66646; grad/diff3_train:  19106.77148; grad/cos3_train:  0.84886; grad/true_mag4_train:  11.02400; grad/pseudo_mag4_train:  18965.93105; grad/true_std4_train:  0.00269; grad/pseudo_std4_train:  4.63014; grad/diff4_train:  18956.59209; grad/cos4_train:  0.83983; grad/true_mag5_train:  13.55341; grad/pseudo_mag5_train:  24255.53789; grad/true_std5_train:  0.00331; grad/pseudo_std5_train:  5.85682; grad/diff5_train:  24246.15566; grad/cos5_train:  0.65659; grad/true_mag6_train:  8.80309; grad/pseudo_mag6_train:  19471.91426; grad/true_std6_train:  0.00215; grad/pseudo_std6_train:  4.75383; grad/diff6_train:  19464.04854; grad/cos6_train:  0.88737; grad/true_mag7_train:  10.35613; grad/pseudo_mag7_train:  19477.65039; grad/true_std7_train:  0.00253; grad/pseudo_std7_train:  4.75520; grad/diff7_train:  19468.59043; grad/cos7_train:  0.86850; grad/true_mag8_train:  11.95504; grad/pseudo_mag8_train:  21620.17715; grad/true_std8_train:  0.00292; grad/pseudo_std8_train:  5.27326; grad/diff8_train:  21610.24062; grad/cos8_train:  0.80973; grad/true_mag9_train:  8.71858; grad/pseudo_mag9_train:  19627.83301; grad/true_std9_train:  0.00213; grad/pseudo_std9_train:  4.79190; grad/diff9_train:  19620.06689; grad/cos9_train:  0.88316; grad/true_mag10_train:  10.00666; grad/pseudo_mag10_train:  19629.86172; grad/true_std10_train:  0.00244; grad/pseudo_std10_train:  4.79237; grad/diff10_train:  19621.08555; grad/cos10_train:  0.87053; grad/true_mag11_train:  12.17003; grad/pseudo_mag11_train:  21509.69609; grad/true_std11_train:  0.00297; grad/pseudo_std11_train:  5.24761; grad/diff11_train:  21500.30742; grad/cos11_train:  0.75120; grad/true_mag12_train:  8.36770; grad/pseudo_mag12_train:  20311.30742; grad/true_std12_train:  0.00204; grad/pseudo_std12_train:  4.95872; grad/diff12_train:  20304.19697; grad/cos12_train:  0.83907; grad/true_mag13_train:  9.61952; grad/pseudo_mag13_train:  20344.34219; grad/true_std13_train:  0.00235; grad/pseudo_std13_train:  4.96677; grad/diff13_train:  20336.15957; grad/cos13_train:  0.84170; grad/true_mag14_train:  12.58638; grad/pseudo_mag14_train:  21640.08447; grad/true_std14_train:  0.00307; grad/pseudo_std14_train:  5.27753; grad/diff14_train:  21631.12979; grad/cos14_train:  0.69039; grad/true_mag15_train:  7.88881; grad/pseudo_mag15_train:  20614.94092; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  5.03239; grad/diff15_train:  20608.67246; grad/cos15_train:  0.78186; grad/true_mag16_train:  15.08948; grad/pseudo_mag16_train:  20946.67080; grad/true_std16_train:  0.00368; grad/pseudo_std16_train:  5.11348; grad/diff16_train:  20939.23574; grad/cos16_train:  0.49786; grad/true_mag17_train:  20.87774; grad/pseudo_mag17_train:  20031.18281; grad/true_std17_train:  0.00510; grad/pseudo_std17_train:  4.81327; grad/diff17_train:  20022.97285; grad/cos17_train:  0.38830; grad_train:  988.39130; lr/lr0_train:  0.00006; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00003; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:29:46,346][trainer][INFO] - Step 700:
[2025-04-24 22:29:46,347][trainer][INFO] - loss/edit_val:  5.92016; loss/loc_val:  0.06058; edit/acc_val:  0.06114; edit/log_prob_val: -5.92016; edit/prob_val:  0.29260; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.35956; perplexity/post_val:  78.22300; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10729; loss/total_val:  0.65260; loss/total_edit_val:  0.65260; memory/alloc_max_val:  42201863168.00000; memory/res_max_val:  46990884864.00000; eval_time/elapsed:  18.08508; eval_time/average:  0.18085
[2025-04-24 22:29:46,350][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:29:46,351][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:30:40,804][trainer][INFO] - Write complete.
[2025-04-24 22:30:44,538][trainer][INFO] - Step 710:
[2025-04-24 22:30:44,539][trainer][INFO] - loss/edit_train:  6.65248; loss/loc_train:  0.04372; edit/acc_train:  0.07255; edit/log_prob_train: -6.65248; edit/prob_train:  0.27592; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.79693; perplexity/pre_train:  44.56421; nll/post_train:  3.81059; perplexity/post_train:  45.17724; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.23099; loss/total_train:  0.70897; loss/total_edit_train:  0.70897; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  9.21804; grad/pseudo_mag0_train:  22068.88477; grad/true_std0_train:  0.00225; grad/pseudo_std0_train:  5.38715; grad/diff0_train:  22061.59717; grad/cos0_train:  0.78880; grad/true_mag1_train:  13.26407; grad/pseudo_mag1_train:  22416.08789; grad/true_std1_train:  0.00324; grad/pseudo_std1_train:  5.47133; grad/diff1_train:  22405.44688; grad/cos1_train:  0.79980; grad/true_mag2_train:  17.43868; grad/pseudo_mag2_train:  37540.58418; grad/true_std2_train:  0.00426; grad/pseudo_std2_train:  8.92564; grad/diff2_train:  37531.96777; grad/cos2_train:  0.48850; grad/true_mag3_train:  10.90088; grad/pseudo_mag3_train:  23964.27988; grad/true_std3_train:  0.00266; grad/pseudo_std3_train:  5.85035; grad/diff3_train:  23954.85020; grad/cos3_train:  0.86486; grad/true_mag4_train:  13.23598; grad/pseudo_mag4_train:  23415.22734; grad/true_std4_train:  0.00323; grad/pseudo_std4_train:  5.71619; grad/diff4_train:  23403.73730; grad/cos4_train:  0.86709; grad/true_mag5_train:  16.19998; grad/pseudo_mag5_train:  28633.47793; grad/true_std5_train:  0.00396; grad/pseudo_std5_train:  6.92996; grad/diff5_train:  28621.77813; grad/cos5_train:  0.71145; grad/true_mag6_train:  11.17272; grad/pseudo_mag6_train:  25071.24082; grad/true_std6_train:  0.00273; grad/pseudo_std6_train:  6.12075; grad/diff6_train:  25061.15176; grad/cos6_train:  0.90273; grad/true_mag7_train:  12.64570; grad/pseudo_mag7_train:  24700.39980; grad/true_std7_train:  0.00309; grad/pseudo_std7_train:  6.03015; grad/diff7_train:  24689.09355; grad/cos7_train:  0.89335; grad/true_mag8_train:  14.31971; grad/pseudo_mag8_train:  26834.35488; grad/true_std8_train:  0.00350; grad/pseudo_std8_train:  6.54674; grad/diff8_train:  26822.02031; grad/cos8_train:  0.85709; grad/true_mag9_train:  10.92032; grad/pseudo_mag9_train:  25273.18438; grad/true_std9_train:  0.00267; grad/pseudo_std9_train:  6.17006; grad/diff9_train:  25263.30020; grad/cos9_train:  0.90467; grad/true_mag10_train:  12.38541; grad/pseudo_mag10_train:  25157.99629; grad/true_std10_train:  0.00302; grad/pseudo_std10_train:  6.14195; grad/diff10_train:  25146.91426; grad/cos10_train:  0.89469; grad/true_mag11_train:  14.17755; grad/pseudo_mag11_train:  26215.07344; grad/true_std11_train:  0.00346; grad/pseudo_std11_train:  6.39675; grad/diff11_train:  26203.53281; grad/cos11_train:  0.81134; grad/true_mag12_train:  10.01744; grad/pseudo_mag12_train:  25410.89902; grad/true_std12_train:  0.00245; grad/pseudo_std12_train:  6.20368; grad/diff12_train:  25402.13027; grad/cos12_train:  0.87493; grad/true_mag13_train:  11.50829; grad/pseudo_mag13_train:  25483.31445; grad/true_std13_train:  0.00281; grad/pseudo_std13_train:  6.22133; grad/diff13_train:  25473.27441; grad/cos13_train:  0.87305; grad/true_mag14_train:  13.88557; grad/pseudo_mag14_train:  25341.98516; grad/true_std14_train:  0.00339; grad/pseudo_std14_train:  6.18128; grad/diff14_train:  25331.63438; grad/cos14_train:  0.74049; grad/true_mag15_train:  8.82972; grad/pseudo_mag15_train:  24317.31582; grad/true_std15_train:  0.00216; grad/pseudo_std15_train:  5.93619; grad/diff15_train:  24310.05605; grad/cos15_train:  0.81913; grad/true_mag16_train:  15.64092; grad/pseudo_mag16_train:  24602.30508; grad/true_std16_train:  0.00382; grad/pseudo_std16_train:  6.00593; grad/diff16_train:  24593.85801; grad/cos16_train:  0.54642; grad/true_mag17_train:  20.67266; grad/pseudo_mag17_train:  22638.85957; grad/true_std17_train:  0.00505; grad/pseudo_std17_train:  5.44778; grad/diff17_train:  22629.43594; grad/cos17_train:  0.45181; grad_train:  534.54303; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00007; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00003; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:30:48,055][trainer][INFO] - Step 720:
[2025-04-24 22:30:48,055][trainer][INFO] - loss/edit_train:  7.30143; loss/loc_train:  0.08713; edit/acc_train:  0.02651; edit/log_prob_train: -7.30143; edit/prob_train:  0.22183; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.81648; perplexity/pre_train:  45.44403; nll/post_train:  3.90307; perplexity/post_train:  49.55444; n_tokens/pre_train:  8.60000; n_tokens/post_train:  8.60000; time/edit_train:  0.18094; loss/total_train:  0.81727; loss/total_edit_train:  0.81727; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.90778; grad/pseudo_mag0_train:  18949.84795; grad/true_std0_train:  0.00193; grad/pseudo_std0_train:  4.62559; grad/diff0_train:  18943.73701; grad/cos0_train:  0.75679; grad/true_mag1_train:  11.44924; grad/pseudo_mag1_train:  19246.89336; grad/true_std1_train:  0.00280; grad/pseudo_std1_train:  4.69740; grad/diff1_train:  19238.07217; grad/cos1_train:  0.75241; grad/true_mag2_train:  14.65913; grad/pseudo_mag2_train:  35988.58369; grad/true_std2_train:  0.00358; grad/pseudo_std2_train:  8.53480; grad/diff2_train:  35982.01875; grad/cos2_train:  0.40294; grad/true_mag3_train:  8.71733; grad/pseudo_mag3_train:  18514.05068; grad/true_std3_train:  0.00213; grad/pseudo_std3_train:  4.51986; grad/diff3_train:  18506.68115; grad/cos3_train:  0.83048; grad/true_mag4_train:  11.13823; grad/pseudo_mag4_train:  19095.18770; grad/true_std4_train:  0.00272; grad/pseudo_std4_train:  4.66147; grad/diff4_train:  19085.82979; grad/cos4_train:  0.82489; grad/true_mag5_train:  13.46183; grad/pseudo_mag5_train:  24396.98242; grad/true_std5_train:  0.00329; grad/pseudo_std5_train:  5.88218; grad/diff5_train:  24388.08789; grad/cos5_train:  0.61598; grad/true_mag6_train:  8.64733; grad/pseudo_mag6_train:  18944.54785; grad/true_std6_train:  0.00211; grad/pseudo_std6_train:  4.62503; grad/diff6_train:  18936.90146; grad/cos6_train:  0.87145; grad/true_mag7_train:  10.42866; grad/pseudo_mag7_train:  19201.72227; grad/true_std7_train:  0.00255; grad/pseudo_std7_train:  4.68780; grad/diff7_train:  19192.70352; grad/cos7_train:  0.84833; grad/true_mag8_train:  11.98704; grad/pseudo_mag8_train:  20998.96553; grad/true_std8_train:  0.00293; grad/pseudo_std8_train:  5.12076; grad/diff8_train:  20989.48066; grad/cos8_train:  0.75892; grad/true_mag9_train:  8.60394; grad/pseudo_mag9_train:  19155.99922; grad/true_std9_train:  0.00210; grad/pseudo_std9_train:  4.67665; grad/diff9_train:  19148.40830; grad/cos9_train:  0.86790; grad/true_mag10_train:  9.99032; grad/pseudo_mag10_train:  19060.21504; grad/true_std10_train:  0.00244; grad/pseudo_std10_train:  4.65325; grad/diff10_train:  19051.58926; grad/cos10_train:  0.84828; grad/true_mag11_train:  12.00488; grad/pseudo_mag11_train:  21129.15557; grad/true_std11_train:  0.00293; grad/pseudo_std11_train:  5.15408; grad/diff11_train:  21120.22959; grad/cos11_train:  0.71561; grad/true_mag12_train:  8.00392; grad/pseudo_mag12_train:  19227.61572; grad/true_std12_train:  0.00195; grad/pseudo_std12_train:  4.69410; grad/diff12_train:  19220.97969; grad/cos12_train:  0.81050; grad/true_mag13_train:  9.20189; grad/pseudo_mag13_train:  18743.01807; grad/true_std13_train:  0.00225; grad/pseudo_std13_train:  4.57576; grad/diff13_train:  18735.40127; grad/cos13_train:  0.81206; grad/true_mag14_train:  12.12943; grad/pseudo_mag14_train:  20506.30566; grad/true_std14_train:  0.00296; grad/pseudo_std14_train:  4.99932; grad/diff14_train:  20498.17061; grad/cos14_train:  0.64911; grad/true_mag15_train:  7.67155; grad/pseudo_mag15_train:  18907.15186; grad/true_std15_train:  0.00187; grad/pseudo_std15_train:  4.61512; grad/diff15_train:  18901.36904; grad/cos15_train:  0.74073; grad/true_mag16_train:  15.56771; grad/pseudo_mag16_train:  18783.44443; grad/true_std16_train:  0.00380; grad/pseudo_std16_train:  4.58513; grad/diff16_train:  18776.73447; grad/cos16_train:  0.43728; grad/true_mag17_train:  21.42201; grad/pseudo_mag17_train:  19533.43721; grad/true_std17_train:  0.00523; grad/pseudo_std17_train:  4.66889; grad/diff17_train:  19525.88184; grad/cos17_train:  0.35100; grad_train:  1194.40601; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:30:51,293][trainer][INFO] - Step 730:
[2025-04-24 22:30:51,294][trainer][INFO] - loss/edit_train:  5.88557; loss/loc_train:  0.05131; edit/acc_train:  0.07565; edit/log_prob_train: -5.88557; edit/prob_train:  0.31781; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.18142; perplexity/pre_train:  65.45903; nll/post_train:  4.17340; perplexity/post_train:  64.93560; n_tokens/pre_train:  6.20000; n_tokens/post_train:  6.20000; time/edit_train:  0.18183; loss/total_train:  0.63986; loss/total_edit_train:  0.63986; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.63746; grad/pseudo_mag0_train:  20527.78340; grad/true_std0_train:  0.00211; grad/pseudo_std0_train:  5.01114; grad/diff0_train:  20521.00146; grad/cos0_train:  0.77758; grad/true_mag1_train:  12.41938; grad/pseudo_mag1_train:  20838.58174; grad/true_std1_train:  0.00303; grad/pseudo_std1_train:  5.08658; grad/diff1_train:  20828.73730; grad/cos1_train:  0.78164; grad/true_mag2_train:  16.62685; grad/pseudo_mag2_train:  42384.19961; grad/true_std2_train:  0.00406; grad/pseudo_std2_train:  10.02350; grad/diff2_train:  42377.14492; grad/cos2_train:  0.40130; grad/true_mag3_train:  10.06422; grad/pseudo_mag3_train:  21942.47900; grad/true_std3_train:  0.00246; grad/pseudo_std3_train:  5.35688; grad/diff3_train:  21933.86768; grad/cos3_train:  0.84897; grad/true_mag4_train:  12.41677; grad/pseudo_mag4_train:  21859.49375; grad/true_std4_train:  0.00303; grad/pseudo_std4_train:  5.33651; grad/diff4_train:  21848.81338; grad/cos4_train:  0.85237; grad/true_mag5_train:  15.58258; grad/pseudo_mag5_train:  28501.86191; grad/true_std5_train:  0.00380; grad/pseudo_std5_train:  6.87516; grad/diff5_train:  28490.99570; grad/cos5_train:  0.66708; grad/true_mag6_train:  10.42363; grad/pseudo_mag6_train:  23203.84541; grad/true_std6_train:  0.00254; grad/pseudo_std6_train:  5.66491; grad/diff6_train:  23194.51543; grad/cos6_train:  0.89041; grad/true_mag7_train:  12.07694; grad/pseudo_mag7_train:  22912.71299; grad/true_std7_train:  0.00295; grad/pseudo_std7_train:  5.59382; grad/diff7_train:  22902.04473; grad/cos7_train:  0.87743; grad/true_mag8_train:  13.96309; grad/pseudo_mag8_train:  26032.79697; grad/true_std8_train:  0.00341; grad/pseudo_std8_train:  6.34866; grad/diff8_train:  26021.05566; grad/cos8_train:  0.82043; grad/true_mag9_train:  10.24265; grad/pseudo_mag9_train:  23456.67217; grad/true_std9_train:  0.00250; grad/pseudo_std9_train:  5.72663; grad/diff9_train:  23447.45508; grad/cos9_train:  0.89551; grad/true_mag10_train:  11.87540; grad/pseudo_mag10_train:  23539.70020; grad/true_std10_train:  0.00290; grad/pseudo_std10_train:  5.74688; grad/diff10_train:  23529.15137; grad/cos10_train:  0.88201; grad/true_mag11_train:  13.89098; grad/pseudo_mag11_train:  25782.38486; grad/true_std11_train:  0.00339; grad/pseudo_std11_train:  6.28990; grad/diff11_train:  25771.19902; grad/cos11_train:  0.78367; grad/true_mag12_train:  9.55227; grad/pseudo_mag12_train:  23694.51348; grad/true_std12_train:  0.00233; grad/pseudo_std12_train:  5.78469; grad/diff12_train:  23686.24951; grad/cos12_train:  0.85811; grad/true_mag13_train:  11.06244; grad/pseudo_mag13_train:  23903.35566; grad/true_std13_train:  0.00270; grad/pseudo_std13_train:  5.83562; grad/diff13_train:  23893.84375; grad/cos13_train:  0.85246; grad/true_mag14_train:  13.77816; grad/pseudo_mag14_train:  25822.16182; grad/true_std14_train:  0.00336; grad/pseudo_std14_train:  6.29556; grad/diff14_train:  25811.89814; grad/cos14_train:  0.71883; grad/true_mag15_train:  8.62304; grad/pseudo_mag15_train:  23177.35293; grad/true_std15_train:  0.00211; grad/pseudo_std15_train:  5.65785; grad/diff15_train:  23170.39023; grad/cos15_train:  0.79732; grad/true_mag16_train:  16.04233; grad/pseudo_mag16_train:  23737.74502; grad/true_std16_train:  0.00392; grad/pseudo_std16_train:  5.79478; grad/diff16_train:  23729.39990; grad/cos16_train:  0.51221; grad/true_mag17_train:  21.58827; grad/pseudo_mag17_train:  23793.44854; grad/true_std17_train:  0.00527; grad/pseudo_std17_train:  5.69713; grad/diff17_train:  23783.98877; grad/cos17_train:  0.42564; grad_train:  652.57538; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00006; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00003; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00003; lr/lr13_train:  0.00003; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:30:54,878][trainer][INFO] - Step 740:
[2025-04-24 22:30:54,878][trainer][INFO] - loss/edit_train:  4.40255; loss/loc_train:  0.02967; edit/acc_train:  0.13820; edit/log_prob_train: -4.40255; edit/prob_train:  0.35056; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.05270; perplexity/pre_train:  57.55261; nll/post_train:  4.01248; perplexity/post_train:  55.28402; n_tokens/pre_train:  6.70000; n_tokens/post_train:  6.70000; time/edit_train:  0.22180; loss/total_train:  0.46992; loss/total_edit_train:  0.46992; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  6.73720; grad/pseudo_mag0_train:  15825.25205; grad/true_std0_train:  0.00164; grad/pseudo_std0_train:  3.86298; grad/diff0_train:  15820.09717; grad/cos0_train:  0.76327; grad/true_mag1_train:  10.07353; grad/pseudo_mag1_train:  16263.53770; grad/true_std1_train:  0.00246; grad/pseudo_std1_train:  3.96941; grad/diff1_train:  16255.80957; grad/cos1_train:  0.76368; grad/true_mag2_train:  12.90993; grad/pseudo_mag2_train:  38543.08887; grad/true_std2_train:  0.00315; grad/pseudo_std2_train:  9.08830; grad/diff2_train:  38538.80059; grad/cos2_train:  0.32219; grad/true_mag3_train:  7.51868; grad/pseudo_mag3_train:  15925.66094; grad/true_std3_train:  0.00184; grad/pseudo_std3_train:  3.88799; grad/diff3_train:  15919.31006; grad/cos3_train:  0.84138; grad/true_mag4_train:  9.78348; grad/pseudo_mag4_train:  16474.63125; grad/true_std4_train:  0.00239; grad/pseudo_std4_train:  4.02185; grad/diff4_train:  16466.41641; grad/cos4_train:  0.83602; grad/true_mag5_train:  12.17449; grad/pseudo_mag5_train:  23030.21826; grad/true_std5_train:  0.00297; grad/pseudo_std5_train:  5.53720; grad/diff5_train:  23022.79131; grad/cos5_train:  0.59086; grad/true_mag6_train:  7.68155; grad/pseudo_mag6_train:  16701.98594; grad/true_std6_train:  0.00188; grad/pseudo_std6_train:  4.07756; grad/diff6_train:  16695.19580; grad/cos6_train:  0.88156; grad/true_mag7_train:  9.20081; grad/pseudo_mag7_train:  16843.80342; grad/true_std7_train:  0.00225; grad/pseudo_std7_train:  4.11217; grad/diff7_train:  16835.82344; grad/cos7_train:  0.86418; grad/true_mag8_train:  10.72081; grad/pseudo_mag8_train:  19358.11533; grad/true_std8_train:  0.00262; grad/pseudo_std8_train:  4.71904; grad/diff8_train:  19349.65205; grad/cos8_train:  0.77692; grad/true_mag9_train:  7.67425; grad/pseudo_mag9_train:  17195.57158; grad/true_std9_train:  0.00187; grad/pseudo_std9_train:  4.19806; grad/diff9_train:  17188.77715; grad/cos9_train:  0.88240; grad/true_mag10_train:  8.80311; grad/pseudo_mag10_train:  17072.96348; grad/true_std10_train:  0.00215; grad/pseudo_std10_train:  4.16812; grad/diff10_train:  17065.29072; grad/cos10_train:  0.86850; grad/true_mag11_train:  11.06839; grad/pseudo_mag11_train:  19177.99482; grad/true_std11_train:  0.00270; grad/pseudo_std11_train:  4.67779; grad/diff11_train:  19169.73428; grad/cos11_train:  0.73485; grad/true_mag12_train:  7.38190; grad/pseudo_mag12_train:  17689.15215; grad/true_std12_train:  0.00180; grad/pseudo_std12_train:  4.31855; grad/diff12_train:  17682.96582; grad/cos12_train:  0.83121; grad/true_mag13_train:  8.45355; grad/pseudo_mag13_train:  17736.21025; grad/true_std13_train:  0.00206; grad/pseudo_std13_train:  4.33001; grad/diff13_train:  17729.08096; grad/cos13_train:  0.83701; grad/true_mag14_train:  11.39584; grad/pseudo_mag14_train:  19402.28711; grad/true_std14_train:  0.00278; grad/pseudo_std14_train:  4.72989; grad/diff14_train:  19394.56143; grad/cos14_train:  0.66436; grad/true_mag15_train:  7.22923; grad/pseudo_mag15_train:  18472.88516; grad/true_std15_train:  0.00176; grad/pseudo_std15_train:  4.50927; grad/diff15_train:  18467.31357; grad/cos15_train:  0.76328; grad/true_mag16_train:  14.20494; grad/pseudo_mag16_train:  19335.48721; grad/true_std16_train:  0.00347; grad/pseudo_std16_train:  4.72001; grad/diff16_train:  19328.77041; grad/cos16_train:  0.48154; grad/true_mag17_train:  20.05146; grad/pseudo_mag17_train:  20154.20361; grad/true_std17_train:  0.00490; grad/pseudo_std17_train:  4.82449; grad/diff17_train:  20146.75742; grad/cos17_train:  0.36722; grad_train:  775.66235; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:30:57,961][trainer][INFO] - Step 750:
[2025-04-24 22:30:57,961][trainer][INFO] - loss/edit_train:  4.06846; loss/loc_train:  0.02276; edit/acc_train:  0.16634; edit/log_prob_train: -4.06846; edit/prob_train:  0.38708; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.23399; perplexity/pre_train:  25.38075; nll/post_train:  3.17425; perplexity/post_train:  23.90882; n_tokens/pre_train:  4.90000; n_tokens/post_train:  4.90000; time/edit_train:  0.17347; loss/total_train:  0.42961; loss/total_edit_train:  0.42961; memory/alloc_max_train:  42201863168.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.90616; grad/pseudo_mag0_train:  18420.13975; grad/true_std0_train:  0.00193; grad/pseudo_std0_train:  4.49618; grad/diff0_train:  18413.99570; grad/cos0_train:  0.77058; grad/true_mag1_train:  11.41666; grad/pseudo_mag1_train:  18566.67803; grad/true_std1_train:  0.00279; grad/pseudo_std1_train:  4.53127; grad/diff1_train:  18557.76162; grad/cos1_train:  0.77249; grad/true_mag2_train:  14.23379; grad/pseudo_mag2_train:  38210.73262; grad/true_std2_train:  0.00348; grad/pseudo_std2_train:  9.02124; grad/diff2_train:  38205.14512; grad/cos2_train:  0.37523; grad/true_mag3_train:  8.78264; grad/pseudo_mag3_train:  18671.11455; grad/true_std3_train:  0.00214; grad/pseudo_std3_train:  4.55820; grad/diff3_train:  18663.62109; grad/cos3_train:  0.84474; grad/true_mag4_train:  11.28756; grad/pseudo_mag4_train:  18969.89297; grad/true_std4_train:  0.00276; grad/pseudo_std4_train:  4.63092; grad/diff4_train:  18960.32188; grad/cos4_train:  0.83885; grad/true_mag5_train:  13.37397; grad/pseudo_mag5_train:  23734.18359; grad/true_std5_train:  0.00327; grad/pseudo_std5_train:  5.71575; grad/diff5_train:  23725.07148; grad/cos5_train:  0.65096; grad/true_mag6_train:  8.94141; grad/pseudo_mag6_train:  19428.72070; grad/true_std6_train:  0.00218; grad/pseudo_std6_train:  4.74323; grad/diff6_train:  19420.76504; grad/cos6_train:  0.88351; grad/true_mag7_train:  10.52058; grad/pseudo_mag7_train:  19423.68711; grad/true_std7_train:  0.00257; grad/pseudo_std7_train:  4.74199; grad/diff7_train:  19414.48379; grad/cos7_train:  0.86523; grad/true_mag8_train:  11.96696; grad/pseudo_mag8_train:  21109.17217; grad/true_std8_train:  0.00292; grad/pseudo_std8_train:  5.14865; grad/diff8_train:  21099.07236; grad/cos8_train:  0.82796; grad/true_mag9_train:  8.77054; grad/pseudo_mag9_train:  19574.81416; grad/true_std9_train:  0.00214; grad/pseudo_std9_train:  4.77889; grad/diff9_train:  19566.99336; grad/cos9_train:  0.88365; grad/true_mag10_train:  10.03959; grad/pseudo_mag10_train:  19459.07373; grad/true_std10_train:  0.00245; grad/pseudo_std10_train:  4.75062; grad/diff10_train:  19450.26973; grad/cos10_train:  0.86872; grad/true_mag11_train:  12.50534; grad/pseudo_mag11_train:  20786.66885; grad/true_std11_train:  0.00305; grad/pseudo_std11_train:  5.07180; grad/diff11_train:  20777.03555; grad/cos11_train:  0.75402; grad/true_mag12_train:  8.44617; grad/pseudo_mag12_train:  20416.01025; grad/true_std12_train:  0.00206; grad/pseudo_std12_train:  4.98426; grad/diff12_train:  20408.78203; grad/cos12_train:  0.84183; grad/true_mag13_train:  9.77871; grad/pseudo_mag13_train:  20772.16855; grad/true_std13_train:  0.00239; grad/pseudo_std13_train:  5.07116; grad/diff13_train:  20763.81885; grad/cos13_train:  0.84102; grad/true_mag14_train:  12.72364; grad/pseudo_mag14_train:  21340.16338; grad/true_std14_train:  0.00311; grad/pseudo_std14_train:  5.20407; grad/diff14_train:  21331.03193; grad/cos14_train:  0.70144; grad/true_mag15_train:  7.84236; grad/pseudo_mag15_train:  20147.76826; grad/true_std15_train:  0.00191; grad/pseudo_std15_train:  4.91802; grad/diff15_train:  20141.57373; grad/cos15_train:  0.77884; grad/true_mag16_train:  15.17131; grad/pseudo_mag16_train:  20619.16094; grad/true_std16_train:  0.00370; grad/pseudo_std16_train:  5.03331; grad/diff16_train:  20611.75811; grad/cos16_train:  0.48708; grad/true_mag17_train:  21.25848; grad/pseudo_mag17_train:  21447.01387; grad/true_std17_train:  0.00519; grad/pseudo_std17_train:  5.12643; grad/diff17_train:  21438.75967; grad/cos17_train:  0.38452; grad_train:  502.16080; lr/lr0_train:  0.00005; lr/lr1_train:  0.00004; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:31:01,227][trainer][INFO] - Step 760:
[2025-04-24 22:31:01,227][trainer][INFO] - loss/edit_train:  5.12427; loss/loc_train:  0.06721; edit/acc_train:  0.12622; edit/log_prob_train: -5.12427; edit/prob_train:  0.31813; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.42594; perplexity/pre_train:  30.75162; nll/post_train:  3.60348; perplexity/post_train:  36.72573; n_tokens/pre_train:  8.80000; n_tokens/post_train:  8.80000; time/edit_train:  0.18040; loss/total_train:  0.57964; loss/total_edit_train:  0.57964; memory/alloc_max_train:  42213970227.20000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.53324; grad/pseudo_mag0_train:  20775.44482; grad/true_std0_train:  0.00208; grad/pseudo_std0_train:  5.07110; grad/diff0_train:  20768.84922; grad/cos0_train:  0.76848; grad/true_mag1_train:  12.48274; grad/pseudo_mag1_train:  21722.11035; grad/true_std1_train:  0.00305; grad/pseudo_std1_train:  5.30119; grad/diff1_train:  21712.63105; grad/cos1_train:  0.75278; grad/true_mag2_train:  16.09311; grad/pseudo_mag2_train:  36974.90039; grad/true_std2_train:  0.00393; grad/pseudo_std2_train:  8.76313; grad/diff2_train:  36967.61016; grad/cos2_train:  0.43443; grad/true_mag3_train:  9.66566; grad/pseudo_mag3_train:  21042.46621; grad/true_std3_train:  0.00236; grad/pseudo_std3_train:  5.13702; grad/diff3_train:  21034.34053; grad/cos3_train:  0.83681; grad/true_mag4_train:  12.24933; grad/pseudo_mag4_train:  21488.87793; grad/true_std4_train:  0.00299; grad/pseudo_std4_train:  5.24529; grad/diff4_train:  21478.73340; grad/cos4_train:  0.82237; grad/true_mag5_train:  15.07844; grad/pseudo_mag5_train:  27533.72168; grad/true_std5_train:  0.00368; grad/pseudo_std5_train:  6.63920; grad/diff5_train:  27523.80742; grad/cos5_train:  0.63268; grad/true_mag6_train:  9.79864; grad/pseudo_mag6_train:  21504.96572; grad/true_std6_train:  0.00239; grad/pseudo_std6_train:  5.25007; grad/diff6_train:  21496.35830; grad/cos6_train:  0.87450; grad/true_mag7_train:  11.51298; grad/pseudo_mag7_train:  22589.33457; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  5.51421; grad/diff7_train:  22579.51406; grad/cos7_train:  0.84717; grad/true_mag8_train:  14.07682; grad/pseudo_mag8_train:  25517.42256; grad/true_std8_train:  0.00344; grad/pseudo_std8_train:  6.22237; grad/diff8_train:  25506.72432; grad/cos8_train:  0.78040; grad/true_mag9_train:  9.50865; grad/pseudo_mag9_train:  21637.05605; grad/true_std9_train:  0.00232; grad/pseudo_std9_train:  5.28234; grad/diff9_train:  21628.76191; grad/cos9_train:  0.86129; grad/true_mag10_train:  12.80469; grad/pseudo_mag10_train:  22054.43281; grad/true_std10_train:  0.00313; grad/pseudo_std10_train:  5.38409; grad/diff10_train:  22045.03760; grad/cos10_train:  0.81338; grad/true_mag11_train:  13.03736; grad/pseudo_mag11_train:  23641.33398; grad/true_std11_train:  0.00318; grad/pseudo_std11_train:  5.76700; grad/diff11_train:  23631.31182; grad/cos11_train:  0.76013; grad/true_mag12_train:  8.86860; grad/pseudo_mag12_train:  21373.20166; grad/true_std12_train:  0.00217; grad/pseudo_std12_train:  5.21793; grad/diff12_train:  21365.70332; grad/cos12_train:  0.83918; grad/true_mag13_train:  10.58903; grad/pseudo_mag13_train:  21760.13428; grad/true_std13_train:  0.00259; grad/pseudo_std13_train:  5.31231; grad/diff13_train:  21751.32373; grad/cos13_train:  0.83221; grad/true_mag14_train:  13.02721; grad/pseudo_mag14_train:  23335.00664; grad/true_std14_train:  0.00318; grad/pseudo_std14_train:  5.68906; grad/diff14_train:  23325.75264; grad/cos14_train:  0.70073; grad/true_mag15_train:  8.28590; grad/pseudo_mag15_train:  21202.99385; grad/true_std15_train:  0.00202; grad/pseudo_std15_train:  5.17564; grad/diff15_train:  21196.51436; grad/cos15_train:  0.77896; grad/true_mag16_train:  15.83649; grad/pseudo_mag16_train:  21630.72979; grad/true_std16_train:  0.00387; grad/pseudo_std16_train:  5.28033; grad/diff16_train:  21622.91055; grad/cos16_train:  0.49638; grad/true_mag17_train:  20.90486; grad/pseudo_mag17_train:  22011.24727; grad/true_std17_train:  0.00510; grad/pseudo_std17_train:  5.26747; grad/diff17_train:  22002.99629; grad/cos17_train:  0.39416; grad_train:  1170.22461; lr/lr0_train:  0.00005; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00003; lr/lr15_train:  0.00003; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:31:04,930][trainer][INFO] - Step 770:
[2025-04-24 22:31:04,930][trainer][INFO] - loss/edit_train:  5.98253; loss/loc_train:  0.04027; edit/acc_train:  0.07074; edit/log_prob_train: -5.98253; edit/prob_train:  0.30041; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.68340; perplexity/pre_train:  293.94730; nll/post_train:  5.67254; perplexity/post_train:  290.77231; n_tokens/pre_train:  3.30000; n_tokens/post_train:  3.30000; time/edit_train:  0.22085; loss/total_train:  0.63852; loss/total_edit_train:  0.63852; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.73035; grad/pseudo_mag0_train:  17964.69141; grad/true_std0_train:  0.00189; grad/pseudo_std0_train:  4.38520; grad/diff0_train:  17958.62314; grad/cos0_train:  0.78139; grad/true_mag1_train:  11.37585; grad/pseudo_mag1_train:  18536.35146; grad/true_std1_train:  0.00278; grad/pseudo_std1_train:  4.52413; grad/diff1_train:  18527.40898; grad/cos1_train:  0.78194; grad/true_mag2_train:  14.48533; grad/pseudo_mag2_train:  33120.54395; grad/true_std2_train:  0.00354; grad/pseudo_std2_train:  7.83614; grad/diff2_train:  33113.84355; grad/cos2_train:  0.44708; grad/true_mag3_train:  8.65689; grad/pseudo_mag3_train:  18529.48428; grad/true_std3_train:  0.00211; grad/pseudo_std3_train:  4.52363; grad/diff3_train:  18522.10713; grad/cos3_train:  0.84789; grad/true_mag4_train:  11.01397; grad/pseudo_mag4_train:  18795.99053; grad/true_std4_train:  0.00269; grad/pseudo_std4_train:  4.58853; grad/diff4_train:  18786.58750; grad/cos4_train:  0.84908; grad/true_mag5_train:  13.85171; grad/pseudo_mag5_train:  25056.14687; grad/true_std5_train:  0.00338; grad/pseudo_std5_train:  6.01851; grad/diff5_train:  25047.24512; grad/cos5_train:  0.62756; grad/true_mag6_train:  8.91527; grad/pseudo_mag6_train:  19589.96533; grad/true_std6_train:  0.00218; grad/pseudo_std6_train:  4.78262; grad/diff6_train:  19581.99551; grad/cos6_train:  0.89075; grad/true_mag7_train:  10.57459; grad/pseudo_mag7_train:  19787.73740; grad/true_std7_train:  0.00258; grad/pseudo_std7_train:  4.83088; grad/diff7_train:  19778.46572; grad/cos7_train:  0.87258; grad/true_mag8_train:  12.07134; grad/pseudo_mag8_train:  22069.71426; grad/true_std8_train:  0.00295; grad/pseudo_std8_train:  5.38163; grad/diff8_train:  22059.77959; grad/cos8_train:  0.80831; grad/true_mag9_train:  9.04035; grad/pseudo_mag9_train:  20270.00400; grad/true_std9_train:  0.00221; grad/pseudo_std9_train:  4.94865; grad/diff9_train:  20261.91934; grad/cos9_train:  0.89025; grad/true_mag10_train:  10.36753; grad/pseudo_mag10_train:  20369.08291; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  4.97282; grad/diff10_train:  20359.92266; grad/cos10_train:  0.87921; grad/true_mag11_train:  12.34137; grad/pseudo_mag11_train:  21755.77402; grad/true_std11_train:  0.00301; grad/pseudo_std11_train:  5.30759; grad/diff11_train:  21746.23477; grad/cos11_train:  0.75926; grad/true_mag12_train:  8.41174; grad/pseudo_mag12_train:  20310.73379; grad/true_std12_train:  0.00205; grad/pseudo_std12_train:  4.95857; grad/diff12_train:  20303.57051; grad/cos12_train:  0.84651; grad/true_mag13_train:  9.70391; grad/pseudo_mag13_train:  20527.36387; grad/true_std13_train:  0.00237; grad/pseudo_std13_train:  5.01143; grad/diff13_train:  20519.07725; grad/cos13_train:  0.84962; grad/true_mag14_train:  12.65462; grad/pseudo_mag14_train:  21900.40244; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  5.34013; grad/diff14_train:  21891.52129; grad/cos14_train:  0.69257; grad/true_mag15_train:  7.90835; grad/pseudo_mag15_train:  20452.59629; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  4.99251; grad/diff15_train:  20446.33711; grad/cos15_train:  0.78587; grad/true_mag16_train:  15.75873; grad/pseudo_mag16_train:  20762.94053; grad/true_std16_train:  0.00385; grad/pseudo_std16_train:  5.06840; grad/diff16_train:  20755.47754; grad/cos16_train:  0.48836; grad/true_mag17_train:  21.47605; grad/pseudo_mag17_train:  21143.87373; grad/true_std17_train:  0.00524; grad/pseudo_std17_train:  5.05110; grad/diff17_train:  21135.62861; grad/cos17_train:  0.38349; grad_train:  1036.72461; lr/lr0_train:  0.00005; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00006; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00003; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:31:08,136][trainer][INFO] - Step 780:
[2025-04-24 22:31:08,136][trainer][INFO] - loss/edit_train:  5.16018; loss/loc_train:  0.08202; edit/acc_train:  0.12134; edit/log_prob_train: -5.16018; edit/prob_train:  0.29891; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.03245; perplexity/pre_train:  56.39911; nll/post_train:  4.31987; perplexity/post_train:  75.17909; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.18411; loss/total_train:  0.59804; loss/total_edit_train:  0.59804; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.74565; grad/pseudo_mag0_train:  20917.82578; grad/true_std0_train:  0.00214; grad/pseudo_std0_train:  5.10624; grad/diff0_train:  20910.98369; grad/cos0_train:  0.77102; grad/true_mag1_train:  12.67406; grad/pseudo_mag1_train:  21591.63066; grad/true_std1_train:  0.00309; grad/pseudo_std1_train:  5.27008; grad/diff1_train:  21581.76221; grad/cos1_train:  0.76271; grad/true_mag2_train:  16.56228; grad/pseudo_mag2_train:  38556.81699; grad/true_std2_train:  0.00404; grad/pseudo_std2_train:  9.16166; grad/diff2_train:  38549.04336; grad/cos2_train:  0.43694; grad/true_mag3_train:  10.06437; grad/pseudo_mag3_train:  22164.87129; grad/true_std3_train:  0.00246; grad/pseudo_std3_train:  5.41109; grad/diff3_train:  22156.26943; grad/cos3_train:  0.84532; grad/true_mag4_train:  12.62672; grad/pseudo_mag4_train:  22211.69004; grad/true_std4_train:  0.00308; grad/pseudo_std4_train:  5.42226; grad/diff4_train:  22200.91563; grad/cos4_train:  0.84085; grad/true_mag5_train:  16.15505; grad/pseudo_mag5_train:  29520.33477; grad/true_std5_train:  0.00394; grad/pseudo_std5_train:  7.13188; grad/diff5_train:  29509.25684; grad/cos5_train:  0.64262; grad/true_mag6_train:  10.65914; grad/pseudo_mag6_train:  23722.44023; grad/true_std6_train:  0.00260; grad/pseudo_std6_train:  5.79149; grad/diff6_train:  23712.95342; grad/cos6_train:  0.88058; grad/true_mag7_train:  12.23880; grad/pseudo_mag7_train:  23553.75693; grad/true_std7_train:  0.00299; grad/pseudo_std7_train:  5.75021; grad/diff7_train:  23542.98037; grad/cos7_train:  0.86880; grad/true_mag8_train:  14.28556; grad/pseudo_mag8_train:  26625.55195; grad/true_std8_train:  0.00349; grad/pseudo_std8_train:  6.49250; grad/diff8_train:  26613.93252; grad/cos8_train:  0.78784; grad/true_mag9_train:  10.51681; grad/pseudo_mag9_train:  23982.89131; grad/true_std9_train:  0.00257; grad/pseudo_std9_train:  5.85504; grad/diff9_train:  23973.49688; grad/cos9_train:  0.88224; grad/true_mag10_train:  12.86940; grad/pseudo_mag10_train:  24004.10176; grad/true_std10_train:  0.00314; grad/pseudo_std10_train:  5.86019; grad/diff10_train:  23993.43486; grad/cos10_train:  0.84041; grad/true_mag11_train:  13.66439; grad/pseudo_mag11_train:  25911.52051; grad/true_std11_train:  0.00334; grad/pseudo_std11_train:  6.32185; grad/diff11_train:  25900.79248; grad/cos11_train:  0.75453; grad/true_mag12_train:  9.54308; grad/pseudo_mag12_train:  23493.77568; grad/true_std12_train:  0.00233; grad/pseudo_std12_train:  5.73563; grad/diff12_train:  23485.62256; grad/cos12_train:  0.84035; grad/true_mag13_train:  10.95615; grad/pseudo_mag13_train:  23501.98516; grad/true_std13_train:  0.00267; grad/pseudo_std13_train:  5.73761; grad/diff13_train:  23492.64189; grad/cos13_train:  0.83881; grad/true_mag14_train:  13.45137; grad/pseudo_mag14_train:  25045.58838; grad/true_std14_train:  0.00328; grad/pseudo_std14_train:  6.10729; grad/diff14_train:  25035.92383; grad/cos14_train:  0.69054; grad/true_mag15_train:  8.48856; grad/pseudo_mag15_train:  22701.52354; grad/true_std15_train:  0.00207; grad/pseudo_std15_train:  5.54165; grad/diff15_train:  22694.72520; grad/cos15_train:  0.78248; grad/true_mag16_train:  14.93357; grad/pseudo_mag16_train:  22951.23789; grad/true_std16_train:  0.00365; grad/pseudo_std16_train:  5.60279; grad/diff16_train:  22943.16240; grad/cos16_train:  0.54758; grad/true_mag17_train:  20.54798; grad/pseudo_mag17_train:  23022.85410; grad/true_std17_train:  0.00502; grad/pseudo_std17_train:  5.53200; grad/diff17_train:  23013.87090; grad/cos17_train:  0.43006; grad_train:  850.55707; lr/lr0_train:  0.00005; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00003; lr/lr7_train:  0.00002; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:31:11,357][trainer][INFO] - Step 790:
[2025-04-24 22:31:11,358][trainer][INFO] - loss/edit_train:  7.64837; loss/loc_train:  0.04182; edit/acc_train:  0.04791; edit/log_prob_train: -7.64837; edit/prob_train:  0.23330; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.75810; perplexity/pre_train:  116.52425; nll/post_train:  4.90907; perplexity/post_train:  135.51305; n_tokens/pre_train:  5.80000; n_tokens/post_train:  5.80000; time/edit_train:  0.18371; loss/total_train:  0.80666; loss/total_edit_train:  0.80666; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.22229; grad/pseudo_mag0_train:  17016.59170; grad/true_std0_train:  0.00176; grad/pseudo_std0_train:  4.15374; grad/diff0_train:  17010.98223; grad/cos0_train:  0.77035; grad/true_mag1_train:  10.35094; grad/pseudo_mag1_train:  17305.83291; grad/true_std1_train:  0.00253; grad/pseudo_std1_train:  4.22384; grad/diff1_train:  17297.77002; grad/cos1_train:  0.77158; grad/true_mag2_train:  13.12752; grad/pseudo_mag2_train:  35217.49355; grad/true_std2_train:  0.00320; grad/pseudo_std2_train:  8.27128; grad/diff2_train:  35212.20937; grad/cos2_train:  0.38872; grad/true_mag3_train:  8.01538; grad/pseudo_mag3_train:  17414.57266; grad/true_std3_train:  0.00196; grad/pseudo_std3_train:  4.25143; grad/diff3_train:  17407.72861; grad/cos3_train:  0.84745; grad/true_mag4_train:  10.22150; grad/pseudo_mag4_train:  17614.12705; grad/true_std4_train:  0.00250; grad/pseudo_std4_train:  4.29993; grad/diff4_train:  17605.45703; grad/cos4_train:  0.84199; grad/true_mag5_train:  12.51402; grad/pseudo_mag5_train:  24844.51797; grad/true_std5_train:  0.00306; grad/pseudo_std5_train:  5.94539; grad/diff5_train:  24836.86719; grad/cos5_train:  0.58889; grad/true_mag6_train:  8.20463; grad/pseudo_mag6_train:  18105.51709; grad/true_std6_train:  0.00200; grad/pseudo_std6_train:  4.42018; grad/diff6_train:  18098.19854; grad/cos6_train:  0.88801; grad/true_mag7_train:  9.64886; grad/pseudo_mag7_train:  18103.07842; grad/true_std7_train:  0.00236; grad/pseudo_std7_train:  4.41958; grad/diff7_train:  18094.63281; grad/cos7_train:  0.86927; grad/true_mag8_train:  11.15566; grad/pseudo_mag8_train:  20144.39004; grad/true_std8_train:  0.00272; grad/pseudo_std8_train:  4.90939; grad/diff8_train:  20135.54443; grad/cos8_train:  0.78043; grad/true_mag9_train:  8.01744; grad/pseudo_mag9_train:  18024.04199; grad/true_std9_train:  0.00196; grad/pseudo_std9_train:  4.40032; grad/diff9_train:  18016.89814; grad/cos9_train:  0.88663; grad/true_mag10_train:  9.29535; grad/pseudo_mag10_train:  18160.27559; grad/true_std10_train:  0.00227; grad/pseudo_std10_train:  4.43355; grad/diff10_train:  18152.12041; grad/cos10_train:  0.87268; grad/true_mag11_train:  11.13370; grad/pseudo_mag11_train:  20037.17695; grad/true_std11_train:  0.00272; grad/pseudo_std11_train:  4.88577; grad/diff11_train:  20028.88428; grad/cos11_train:  0.73203; grad/true_mag12_train:  7.63912; grad/pseudo_mag12_train:  18568.36074; grad/true_std12_train:  0.00187; grad/pseudo_std12_train:  4.53318; grad/diff12_train:  18561.90830; grad/cos12_train:  0.83703; grad/true_mag13_train:  8.92285; grad/pseudo_mag13_train:  18790.64629; grad/true_std13_train:  0.00218; grad/pseudo_std13_train:  4.58740; grad/diff13_train:  18783.08047; grad/cos13_train:  0.84173; grad/true_mag14_train:  11.33104; grad/pseudo_mag14_train:  19982.34678; grad/true_std14_train:  0.00277; grad/pseudo_std14_train:  4.86992; grad/diff14_train:  19974.51953; grad/cos14_train:  0.67902; grad/true_mag15_train:  7.24464; grad/pseudo_mag15_train:  18922.95244; grad/true_std15_train:  0.00177; grad/pseudo_std15_train:  4.61906; grad/diff15_train:  18917.21523; grad/cos15_train:  0.78493; grad/true_mag16_train:  14.06965; grad/pseudo_mag16_train:  18984.83789; grad/true_std16_train:  0.00343; grad/pseudo_std16_train:  4.63436; grad/diff16_train:  18978.16943; grad/cos16_train:  0.47668; grad/true_mag17_train:  19.53654; grad/pseudo_mag17_train:  19375.18301; grad/true_std17_train:  0.00477; grad/pseudo_std17_train:  4.61764; grad/diff17_train:  19367.80459; grad/cos17_train:  0.37456; grad_train:  1254.66248; lr/lr0_train:  0.00004; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00002; lr/lr7_train:  0.00002; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00003; lr/lr17_train:  0.00004
[2025-04-24 22:31:15,000][trainer][INFO] - Step 800:
[2025-04-24 22:31:15,001][trainer][INFO] - loss/edit_train:  6.63350; loss/loc_train:  0.02727; edit/acc_train:  0.05255; edit/log_prob_train: -6.63350; edit/prob_train:  0.25971; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.77422; perplexity/pre_train:  43.56359; nll/post_train:  3.74429; perplexity/post_train:  42.27877; n_tokens/pre_train:  5.60000; n_tokens/post_train:  5.60000; time/edit_train:  0.22644; loss/total_train:  0.69062; loss/total_edit_train:  0.69062; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.41839; grad/pseudo_mag0_train:  19925.39492; grad/true_std0_train:  0.00206; grad/pseudo_std0_train:  4.86372; grad/diff0_train:  19918.83916; grad/cos0_train:  0.77815; grad/true_mag1_train:  12.11411; grad/pseudo_mag1_train:  20377.81182; grad/true_std1_train:  0.00296; grad/pseudo_std1_train:  4.97353; grad/diff1_train:  20368.28633; grad/cos1_train:  0.78398; grad/true_mag2_train:  15.78320; grad/pseudo_mag2_train:  33096.05937; grad/true_std2_train:  0.00385; grad/pseudo_std2_train:  7.83221; grad/diff2_train:  33088.11914; grad/cos2_train:  0.49551; grad/true_mag3_train:  9.62800; grad/pseudo_mag3_train:  20919.67529; grad/true_std3_train:  0.00235; grad/pseudo_std3_train:  5.10710; grad/diff3_train:  20911.43125; grad/cos3_train:  0.85405; grad/true_mag4_train:  12.05122; grad/pseudo_mag4_train:  20990.56152; grad/true_std4_train:  0.00294; grad/pseudo_std4_train:  5.12408; grad/diff4_train:  20980.31758; grad/cos4_train:  0.84797; grad/true_mag5_train:  14.56202; grad/pseudo_mag5_train:  27216.37520; grad/true_std5_train:  0.00356; grad/pseudo_std5_train:  6.54731; grad/diff5_train:  27206.57832; grad/cos5_train:  0.66195; grad/true_mag6_train:  9.70781; grad/pseudo_mag6_train:  21577.27813; grad/true_std6_train:  0.00237; grad/pseudo_std6_train:  5.26775; grad/diff6_train:  21568.59756; grad/cos6_train:  0.89144; grad/true_mag7_train:  11.26906; grad/pseudo_mag7_train:  21610.46436; grad/true_std7_train:  0.00275; grad/pseudo_std7_train:  5.27574; grad/diff7_train:  21600.50996; grad/cos7_train:  0.88026; grad/true_mag8_train:  13.29584; grad/pseudo_mag8_train:  23961.46104; grad/true_std8_train:  0.00325; grad/pseudo_std8_train:  5.84305; grad/diff8_train:  23950.59814; grad/cos8_train:  0.81231; grad/true_mag9_train:  9.58508; grad/pseudo_mag9_train:  21866.44922; grad/true_std9_train:  0.00234; grad/pseudo_std9_train:  5.33836; grad/diff9_train:  21857.85098; grad/cos9_train:  0.89248; grad/true_mag10_train:  11.80619; grad/pseudo_mag10_train:  21941.70615; grad/true_std10_train:  0.00288; grad/pseudo_std10_train:  5.35668; grad/diff10_train:  21931.91182; grad/cos10_train:  0.84199; grad/true_mag11_train:  12.81161; grad/pseudo_mag11_train:  23658.96934; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  5.77084; grad/diff11_train:  23648.87891; grad/cos11_train:  0.78061; grad/true_mag12_train:  8.80900; grad/pseudo_mag12_train:  21751.33945; grad/true_std12_train:  0.00215; grad/pseudo_std12_train:  5.31024; grad/diff12_train:  21743.82773; grad/cos12_train:  0.84579; grad/true_mag13_train:  10.15783; grad/pseudo_mag13_train:  21826.68369; grad/true_std13_train:  0.00248; grad/pseudo_std13_train:  5.32855; grad/diff13_train:  21817.99805; grad/cos13_train:  0.84986; grad/true_mag14_train:  12.66348; grad/pseudo_mag14_train:  23164.05889; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  5.64720; grad/diff14_train:  23154.92939; grad/cos14_train:  0.71395; grad/true_mag15_train:  7.89527; grad/pseudo_mag15_train:  21054.12666; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  5.13933; grad/diff15_train:  21047.84678; grad/cos15_train:  0.78959; grad/true_mag16_train:  15.34290; grad/pseudo_mag16_train:  21105.36279; grad/true_std16_train:  0.00375; grad/pseudo_std16_train:  5.15204; grad/diff16_train:  21098.07354; grad/cos16_train:  0.50513; grad/true_mag17_train:  20.61645; grad/pseudo_mag17_train:  22048.66787; grad/true_std17_train:  0.00503; grad/pseudo_std17_train:  5.26079; grad/diff17_train:  22040.67627; grad/cos17_train:  0.39005; grad_train:  908.03986; lr/lr0_train:  0.00004; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00006; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00002; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:31:33,122][trainer][INFO] - Step 800:
[2025-04-24 22:31:33,123][trainer][INFO] - loss/edit_val:  5.26218; loss/loc_val:  0.04617; edit/acc_val:  0.07363; edit/log_prob_val: -5.26218; edit/prob_val:  0.30917; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.33786; perplexity/post_val:  76.54359; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10307; loss/total_val:  0.57239; loss/total_edit_val:  0.57239; memory/alloc_max_val:  42215315456.00000; memory/res_max_val:  46990884864.00000; eval_time/elapsed:  18.11694; eval_time/average:  0.18117
[2025-04-24 22:31:33,126][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:31:33,127][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:32:27,418][trainer][INFO] - Write complete.
[2025-04-24 22:32:30,654][trainer][INFO] - Step 810:
[2025-04-24 22:32:30,654][trainer][INFO] - loss/edit_train:  7.33547; loss/loc_train:  0.04729; edit/acc_train:  0.06633; edit/log_prob_train: -7.33547; edit/prob_train:  0.22529; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.43414; perplexity/pre_train:  84.27986; nll/post_train:  4.33846; perplexity/post_train:  76.58971; n_tokens/pre_train:  4.90000; n_tokens/post_train:  4.90000; time/edit_train:  0.18066; loss/total_train:  0.78084; loss/total_edit_train:  0.78084; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.67650; grad/pseudo_mag0_train:  18012.05010; grad/true_std0_train:  0.00187; grad/pseudo_std0_train:  4.39651; grad/diff0_train:  18006.06621; grad/cos0_train:  0.77618; grad/true_mag1_train:  11.29524; grad/pseudo_mag1_train:  18751.45195; grad/true_std1_train:  0.00276; grad/pseudo_std1_train:  4.57640; grad/diff1_train:  18742.56445; grad/cos1_train:  0.78202; grad/true_mag2_train:  14.67432; grad/pseudo_mag2_train:  41639.44199; grad/true_std2_train:  0.00358; grad/pseudo_std2_train:  9.76560; grad/diff2_train:  41633.64180; grad/cos2_train:  0.37577; grad/true_mag3_train:  8.79416; grad/pseudo_mag3_train:  18816.39951; grad/true_std3_train:  0.00215; grad/pseudo_std3_train:  4.59364; grad/diff3_train:  18808.87334; grad/cos3_train:  0.85286; grad/true_mag4_train:  11.10733; grad/pseudo_mag4_train:  19057.98311; grad/true_std4_train:  0.00271; grad/pseudo_std4_train:  4.65239; grad/diff4_train:  19048.48975; grad/cos4_train:  0.85172; grad/true_mag5_train:  13.66064; grad/pseudo_mag5_train:  26452.69473; grad/true_std5_train:  0.00334; grad/pseudo_std5_train:  6.32905; grad/diff5_train:  26444.08906; grad/cos5_train:  0.61008; grad/true_mag6_train:  9.01365; grad/pseudo_mag6_train:  20071.17314; grad/true_std6_train:  0.00220; grad/pseudo_std6_train:  4.90006; grad/diff6_train:  20063.09922; grad/cos6_train:  0.89469; grad/true_mag7_train:  10.53670; grad/pseudo_mag7_train:  19882.60020; grad/true_std7_train:  0.00257; grad/pseudo_std7_train:  4.85396; grad/diff7_train:  19873.33271; grad/cos7_train:  0.87626; grad/true_mag8_train:  12.10178; grad/pseudo_mag8_train:  22297.39453; grad/true_std8_train:  0.00295; grad/pseudo_std8_train:  5.43420; grad/diff8_train:  22287.54844; grad/cos8_train:  0.80292; grad/true_mag9_train:  8.98684; grad/pseudo_mag9_train:  20490.12773; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  5.00236; grad/diff9_train:  20482.06211; grad/cos9_train:  0.89543; grad/true_mag10_train:  10.24760; grad/pseudo_mag10_train:  20308.82559; grad/true_std10_train:  0.00250; grad/pseudo_std10_train:  4.95806; grad/diff10_train:  20299.77480; grad/cos10_train:  0.87973; grad/true_mag11_train:  12.12368; grad/pseudo_mag11_train:  21825.82002; grad/true_std11_train:  0.00296; grad/pseudo_std11_train:  5.32321; grad/diff11_train:  21816.44180; grad/cos11_train:  0.76161; grad/true_mag12_train:  8.27132; grad/pseudo_mag12_train:  20514.37168; grad/true_std12_train:  0.00202; grad/pseudo_std12_train:  5.00822; grad/diff12_train:  20507.32812; grad/cos12_train:  0.84588; grad/true_mag13_train:  9.63399; grad/pseudo_mag13_train:  20387.18145; grad/true_std13_train:  0.00235; grad/pseudo_std13_train:  4.97713; grad/diff13_train:  20378.98359; grad/cos13_train:  0.84864; grad/true_mag14_train:  12.28388; grad/pseudo_mag14_train:  21715.56660; grad/true_std14_train:  0.00300; grad/pseudo_std14_train:  5.29250; grad/diff14_train:  21706.86016; grad/cos14_train:  0.69498; grad/true_mag15_train:  7.92391; grad/pseudo_mag15_train:  21064.08330; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  5.14155; grad/diff15_train:  21057.76855; grad/cos15_train:  0.78846; grad/true_mag16_train:  14.43053; grad/pseudo_mag16_train:  21070.62764; grad/true_std16_train:  0.00352; grad/pseudo_std16_train:  5.14336; grad/diff16_train:  21063.35098; grad/cos16_train:  0.51064; grad/true_mag17_train:  20.08259; grad/pseudo_mag17_train:  21427.06875; grad/true_std17_train:  0.00490; grad/pseudo_std17_train:  5.09433; grad/diff17_train:  21419.15957; grad/cos17_train:  0.38857; grad_train:  1167.71240; lr/lr0_train:  0.00004; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00005; lr/lr5_train:  0.00012; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:34,365][trainer][INFO] - Step 820:
[2025-04-24 22:32:34,365][trainer][INFO] - loss/edit_train:  5.59652; loss/loc_train:  0.05602; edit/acc_train:  0.13250; edit/log_prob_train: -5.59652; edit/prob_train:  0.27169; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.86578; perplexity/pre_train:  129.77264; nll/post_train:  4.83137; perplexity/post_train:  125.38276; n_tokens/pre_train:  5.80000; n_tokens/post_train:  5.80000; time/edit_train:  0.22979; loss/total_train:  0.61567; loss/total_edit_train:  0.61567; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.91939; grad/pseudo_mag0_train:  22267.88408; grad/true_std0_train:  0.00218; grad/pseudo_std0_train:  5.43567; grad/diff0_train:  22260.84443; grad/cos0_train:  0.78365; grad/true_mag1_train:  12.77365; grad/pseudo_mag1_train:  21854.42461; grad/true_std1_train:  0.00312; grad/pseudo_std1_train:  5.33421; grad/diff1_train:  21844.19932; grad/cos1_train:  0.79181; grad/true_mag2_train:  16.05138; grad/pseudo_mag2_train:  38887.67578; grad/true_std2_train:  0.00392; grad/pseudo_std2_train:  9.16072; grad/diff2_train:  38879.92656; grad/cos2_train:  0.45672; grad/true_mag3_train:  9.90819; grad/pseudo_mag3_train:  22186.43633; grad/true_std3_train:  0.00242; grad/pseudo_std3_train:  5.41634; grad/diff3_train:  22177.91143; grad/cos3_train:  0.85540; grad/true_mag4_train:  12.31987; grad/pseudo_mag4_train:  21925.84502; grad/true_std4_train:  0.00301; grad/pseudo_std4_train:  5.35253; grad/diff4_train:  21915.20215; grad/cos4_train:  0.85776; grad/true_mag5_train:  14.76477; grad/pseudo_mag5_train:  27491.38711; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  6.59622; grad/diff5_train:  27481.25449; grad/cos5_train:  0.66212; grad/true_mag6_train:  9.86016; grad/pseudo_mag6_train:  22367.56465; grad/true_std6_train:  0.00241; grad/pseudo_std6_train:  5.46069; grad/diff6_train:  22358.72090; grad/cos6_train:  0.89233; grad/true_mag7_train:  11.51999; grad/pseudo_mag7_train:  22156.13311; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  5.40904; grad/diff7_train:  22145.92109; grad/cos7_train:  0.87914; grad/true_mag8_train:  13.36944; grad/pseudo_mag8_train:  24191.59717; grad/true_std8_train:  0.00326; grad/pseudo_std8_train:  5.89652; grad/diff8_train:  24180.49336; grad/cos8_train:  0.81353; grad/true_mag9_train:  9.47999; grad/pseudo_mag9_train:  22199.01982; grad/true_std9_train:  0.00231; grad/pseudo_std9_train:  5.41956; grad/diff9_train:  22190.50098; grad/cos9_train:  0.89176; grad/true_mag10_train:  11.14507; grad/pseudo_mag10_train:  22508.06572; grad/true_std10_train:  0.00272; grad/pseudo_std10_train:  5.49497; grad/diff10_train:  22498.15352; grad/cos10_train:  0.88309; grad/true_mag11_train:  12.80963; grad/pseudo_mag11_train:  23685.47490; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  5.77722; grad/diff11_train:  23675.20215; grad/cos11_train:  0.78892; grad/true_mag12_train:  8.64445; grad/pseudo_mag12_train:  21846.82383; grad/true_std12_train:  0.00211; grad/pseudo_std12_train:  5.33355; grad/diff12_train:  21839.41123; grad/cos12_train:  0.84856; grad/true_mag13_train:  10.26887; grad/pseudo_mag13_train:  22243.32461; grad/true_std13_train:  0.00251; grad/pseudo_std13_train:  5.43032; grad/diff13_train:  22234.48271; grad/cos13_train:  0.85575; grad/true_mag14_train:  12.71641; grad/pseudo_mag14_train:  23573.14443; grad/true_std14_train:  0.00310; grad/pseudo_std14_train:  5.74725; grad/diff14_train:  23563.70205; grad/cos14_train:  0.73252; grad/true_mag15_train:  7.88862; grad/pseudo_mag15_train:  21462.92822; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  5.23909; grad/diff15_train:  21456.56963; grad/cos15_train:  0.79790; grad/true_mag16_train:  14.51298; grad/pseudo_mag16_train:  22009.49346; grad/true_std16_train:  0.00354; grad/pseudo_std16_train:  5.37273; grad/diff16_train:  22001.76904; grad/cos16_train:  0.53235; grad/true_mag17_train:  20.03165; grad/pseudo_mag17_train:  22308.49971; grad/true_std17_train:  0.00489; grad/pseudo_std17_train:  5.32909; grad/diff17_train:  22300.04580; grad/cos17_train:  0.42319; grad_train:  966.10858; lr/lr0_train:  0.00004; lr/lr1_train:  0.00003; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00012; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:37,579][trainer][INFO] - Step 830:
[2025-04-24 22:32:37,579][trainer][INFO] - loss/edit_train:  5.80008; loss/loc_train:  0.02631; edit/acc_train:  0.11010; edit/log_prob_train: -5.80008; edit/prob_train:  0.29234; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.10673; perplexity/pre_train:  60.74765; nll/post_train:  4.03417; perplexity/post_train:  56.49601; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.17970; loss/total_train:  0.60632; loss/total_edit_train:  0.60632; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.33397; grad/pseudo_mag0_train:  19861.51973; grad/true_std0_train:  0.00203; grad/pseudo_std0_train:  4.84802; grad/diff0_train:  19855.16426; grad/cos0_train:  0.75615; grad/true_mag1_train:  11.87875; grad/pseudo_mag1_train:  19849.93350; grad/true_std1_train:  0.00290; grad/pseudo_std1_train:  4.84482; grad/diff1_train:  19840.70947; grad/cos1_train:  0.76351; grad/true_mag2_train:  15.43979; grad/pseudo_mag2_train:  36270.63535; grad/true_std2_train:  0.00377; grad/pseudo_std2_train:  8.55302; grad/diff2_train:  36263.52969; grad/cos2_train:  0.43475; grad/true_mag3_train:  9.38429; grad/pseudo_mag3_train:  20493.83545; grad/true_std3_train:  0.00229; grad/pseudo_std3_train:  5.00315; grad/diff3_train:  20485.85303; grad/cos3_train:  0.84380; grad/true_mag4_train:  11.71160; grad/pseudo_mag4_train:  20438.22080; grad/true_std4_train:  0.00286; grad/pseudo_std4_train:  4.98929; grad/diff4_train:  20428.26572; grad/cos4_train:  0.84055; grad/true_mag5_train:  14.05387; grad/pseudo_mag5_train:  26427.91016; grad/true_std5_train:  0.00343; grad/pseudo_std5_train:  6.36011; grad/diff5_train:  26418.25703; grad/cos5_train:  0.65220; grad/true_mag6_train:  9.44980; grad/pseudo_mag6_train:  20824.60391; grad/true_std6_train:  0.00231; grad/pseudo_std6_train:  5.08398; grad/diff6_train:  20816.19072; grad/cos6_train:  0.88374; grad/true_mag7_train:  10.95139; grad/pseudo_mag7_train:  20861.65117; grad/true_std7_train:  0.00267; grad/pseudo_std7_train:  5.09297; grad/diff7_train:  20852.02129; grad/cos7_train:  0.87121; grad/true_mag8_train:  12.67898; grad/pseudo_mag8_train:  22968.78506; grad/true_std8_train:  0.00310; grad/pseudo_std8_train:  5.60252; grad/diff8_train:  22958.10996; grad/cos8_train:  0.82082; grad/true_mag9_train:  9.18137; grad/pseudo_mag9_train:  20883.70820; grad/true_std9_train:  0.00224; grad/pseudo_std9_train:  5.09845; grad/diff9_train:  20875.52773; grad/cos9_train:  0.88360; grad/true_mag10_train:  10.91070; grad/pseudo_mag10_train:  21011.20166; grad/true_std10_train:  0.00266; grad/pseudo_std10_train:  5.12954; grad/diff10_train:  21001.84922; grad/cos10_train:  0.85485; grad/true_mag11_train:  12.65700; grad/pseudo_mag11_train:  23117.47178; grad/true_std11_train:  0.00309; grad/pseudo_std11_train:  5.63922; grad/diff11_train:  23107.53633; grad/cos11_train:  0.76144; grad/true_mag12_train:  8.70424; grad/pseudo_mag12_train:  21380.39961; grad/true_std12_train:  0.00213; grad/pseudo_std12_train:  5.21971; grad/diff12_train:  21373.03857; grad/cos12_train:  0.83435; grad/true_mag13_train:  9.98582; grad/pseudo_mag13_train:  21407.55820; grad/true_std13_train:  0.00244; grad/pseudo_std13_train:  5.22626; grad/diff13_train:  21399.10859; grad/cos13_train:  0.83614; grad/true_mag14_train:  12.73999; grad/pseudo_mag14_train:  22836.01328; grad/true_std14_train:  0.00311; grad/pseudo_std14_train:  5.56806; grad/diff14_train:  22826.94297; grad/cos14_train:  0.69120; grad/true_mag15_train:  7.89198; grad/pseudo_mag15_train:  20944.86025; grad/true_std15_train:  0.00193; grad/pseudo_std15_train:  5.11235; grad/diff15_train:  20938.66338; grad/cos15_train:  0.77154; grad/true_mag16_train:  15.45375; grad/pseudo_mag16_train:  21547.17969; grad/true_std16_train:  0.00377; grad/pseudo_std16_train:  5.25989; grad/diff16_train:  21539.59404; grad/cos16_train:  0.50426; grad/true_mag17_train:  20.69279; grad/pseudo_mag17_train:  22053.30078; grad/true_std17_train:  0.00505; grad/pseudo_std17_train:  5.25081; grad/diff17_train:  22045.50078; grad/cos17_train:  0.37308; grad_train:  693.30054; lr/lr0_train:  0.00004; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00002; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00002; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:40,811][trainer][INFO] - Step 840:
[2025-04-24 22:32:40,812][trainer][INFO] - loss/edit_train:  4.37940; loss/loc_train:  0.01782; edit/acc_train:  0.11683; edit/log_prob_train: -4.37940; edit/prob_train:  0.30849; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.92397; perplexity/pre_train:  50.60106; nll/post_train:  3.89645; perplexity/post_train:  49.22761; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.18435; loss/total_train:  0.45576; loss/total_edit_train:  0.45576; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.67289; grad/pseudo_mag0_train:  18903.56338; grad/true_std0_train:  0.00187; grad/pseudo_std0_train:  4.61423; grad/diff0_train:  18897.63350; grad/cos0_train:  0.76161; grad/true_mag1_train:  11.20245; grad/pseudo_mag1_train:  19534.65850; grad/true_std1_train:  0.00273; grad/pseudo_std1_train:  4.76751; grad/diff1_train:  19525.97021; grad/cos1_train:  0.75909; grad/true_mag2_train:  14.30454; grad/pseudo_mag2_train:  39844.37617; grad/true_std2_train:  0.00349; grad/pseudo_std2_train:  9.36722; grad/diff2_train:  39838.45195; grad/cos2_train:  0.37793; grad/true_mag3_train:  8.65313; grad/pseudo_mag3_train:  19211.10684; grad/true_std3_train:  0.00211; grad/pseudo_std3_train:  4.68999; grad/diff3_train:  19203.71914; grad/cos3_train:  0.84404; grad/true_mag4_train:  11.03247; grad/pseudo_mag4_train:  19577.64629; grad/true_std4_train:  0.00269; grad/pseudo_std4_train:  4.77928; grad/diff4_train:  19568.31387; grad/cos4_train:  0.83407; grad/true_mag5_train:  13.49932; grad/pseudo_mag5_train:  26771.19980; grad/true_std5_train:  0.00330; grad/pseudo_std5_train:  6.42229; grad/diff5_train:  26762.72070; grad/cos5_train:  0.58901; grad/true_mag6_train:  8.87199; grad/pseudo_mag6_train:  19987.98164; grad/true_std6_train:  0.00217; grad/pseudo_std6_train:  4.87974; grad/diff6_train:  19980.09473; grad/cos6_train:  0.88084; grad/true_mag7_train:  10.50154; grad/pseudo_mag7_train:  20058.00977; grad/true_std7_train:  0.00256; grad/pseudo_std7_train:  4.89681; grad/diff7_train:  20048.81953; grad/cos7_train:  0.86548; grad/true_mag8_train:  11.95314; grad/pseudo_mag8_train:  22350.57480; grad/true_std8_train:  0.00292; grad/pseudo_std8_train:  5.44825; grad/diff8_train:  22340.93350; grad/cos8_train:  0.78082; grad/true_mag9_train:  8.87640; grad/pseudo_mag9_train:  20408.20928; grad/true_std9_train:  0.00217; grad/pseudo_std9_train:  4.98235; grad/diff9_train:  20400.33545; grad/cos9_train:  0.87870; grad/true_mag10_train:  10.40993; grad/pseudo_mag10_train:  20343.23047; grad/true_std10_train:  0.00254; grad/pseudo_std10_train:  4.96645; grad/diff10_train:  20334.24014; grad/cos10_train:  0.85565; grad/true_mag11_train:  12.06455; grad/pseudo_mag11_train:  22592.69131; grad/true_std11_train:  0.00295; grad/pseudo_std11_train:  5.51059; grad/diff11_train:  22583.61035; grad/cos11_train:  0.73043; grad/true_mag12_train:  8.31924; grad/pseudo_mag12_train:  20833.36074; grad/true_std12_train:  0.00203; grad/pseudo_std12_train:  5.08615; grad/diff12_train:  20826.30049; grad/cos12_train:  0.83433; grad/true_mag13_train:  9.59836; grad/pseudo_mag13_train:  20847.14609; grad/true_std13_train:  0.00234; grad/pseudo_std13_train:  5.08947; grad/diff13_train:  20838.96191; grad/cos13_train:  0.84072; grad/true_mag14_train:  12.26536; grad/pseudo_mag14_train:  23261.49170; grad/true_std14_train:  0.00299; grad/pseudo_std14_train:  5.67089; grad/diff14_train:  23252.95742; grad/cos14_train:  0.67248; grad/true_mag15_train:  7.79355; grad/pseudo_mag15_train:  21361.68320; grad/true_std15_train:  0.00190; grad/pseudo_std15_train:  5.21447; grad/diff15_train:  21355.49014; grad/cos15_train:  0.78201; grad/true_mag16_train:  14.95352; grad/pseudo_mag16_train:  21384.31064; grad/true_std16_train:  0.00365; grad/pseudo_std16_train:  5.22021; grad/diff16_train:  21376.98486; grad/cos16_train:  0.50555; grad/true_mag17_train:  19.95927; grad/pseudo_mag17_train:  21686.91816; grad/true_std17_train:  0.00487; grad/pseudo_std17_train:  5.18098; grad/diff17_train:  21679.25098; grad/cos17_train:  0.37835; grad_train:  632.46582; lr/lr0_train:  0.00004; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00002; lr/lr13_train:  0.00001; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:44,424][trainer][INFO] - Step 850:
[2025-04-24 22:32:44,424][trainer][INFO] - loss/edit_train:  4.65483; loss/loc_train:  0.02862; edit/acc_train:  0.11928; edit/log_prob_train: -4.65483; edit/prob_train:  0.29695; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.84487; perplexity/pre_train:  17.19925; nll/post_train:  2.82320; perplexity/post_train:  16.83070; n_tokens/pre_train:  7.30000; n_tokens/post_train:  7.30000; time/edit_train:  0.21469; loss/total_train:  0.49411; loss/total_edit_train:  0.49411; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  9.03680; grad/pseudo_mag0_train:  21407.44502; grad/true_std0_train:  0.00221; grad/pseudo_std0_train:  5.22535; grad/diff0_train:  21400.38818; grad/cos0_train:  0.78018; grad/true_mag1_train:  12.81765; grad/pseudo_mag1_train:  21123.83252; grad/true_std1_train:  0.00313; grad/pseudo_std1_train:  5.15563; grad/diff1_train:  21113.70518; grad/cos1_train:  0.78693; grad/true_mag2_train:  16.55313; grad/pseudo_mag2_train:  43950.05020; grad/true_std2_train:  0.00404; grad/pseudo_std2_train:  10.31607; grad/diff2_train:  43943.28418; grad/cos2_train:  0.39584; grad/true_mag3_train:  10.13117; grad/pseudo_mag3_train:  22182.80703; grad/true_std3_train:  0.00247; grad/pseudo_std3_train:  5.41546; grad/diff3_train:  22174.11953; grad/cos3_train:  0.85481; grad/true_mag4_train:  12.58463; grad/pseudo_mag4_train:  21923.54893; grad/true_std4_train:  0.00307; grad/pseudo_std4_train:  5.35194; grad/diff4_train:  21912.79180; grad/cos4_train:  0.85269; grad/true_mag5_train:  15.25720; grad/pseudo_mag5_train:  28988.36445; grad/true_std5_train:  0.00372; grad/pseudo_std5_train:  6.96782; grad/diff5_train:  28977.92480; grad/cos5_train:  0.65491; grad/true_mag6_train:  10.24582; grad/pseudo_mag6_train:  22752.40850; grad/true_std6_train:  0.00250; grad/pseudo_std6_train:  5.55468; grad/diff6_train:  22743.24775; grad/cos6_train:  0.89259; grad/true_mag7_train:  11.83564; grad/pseudo_mag7_train:  22537.87549; grad/true_std7_train:  0.00289; grad/pseudo_std7_train:  5.50225; grad/diff7_train:  22527.40869; grad/cos7_train:  0.88123; grad/true_mag8_train:  13.57277; grad/pseudo_mag8_train:  25296.39570; grad/true_std8_train:  0.00331; grad/pseudo_std8_train:  6.16800; grad/diff8_train:  25284.94238; grad/cos8_train:  0.82776; grad/true_mag9_train:  10.01101; grad/pseudo_mag9_train:  22797.29053; grad/true_std9_train:  0.00244; grad/pseudo_std9_train:  5.56564; grad/diff9_train:  22788.30088; grad/cos9_train:  0.89492; grad/true_mag10_train:  11.70266; grad/pseudo_mag10_train:  22861.12666; grad/true_std10_train:  0.00286; grad/pseudo_std10_train:  5.58122; grad/diff10_train:  22850.91758; grad/cos10_train:  0.86754; grad/true_mag11_train:  13.49093; grad/pseudo_mag11_train:  24650.33242; grad/true_std11_train:  0.00329; grad/pseudo_std11_train:  6.01286; grad/diff11_train:  24639.61855; grad/cos11_train:  0.77743; grad/true_mag12_train:  9.22060; grad/pseudo_mag12_train:  22663.90283; grad/true_std12_train:  0.00225; grad/pseudo_std12_train:  5.53307; grad/diff12_train:  22655.96992; grad/cos12_train:  0.85492; grad/true_mag13_train:  10.59307; grad/pseudo_mag13_train:  22645.05322; grad/true_std13_train:  0.00259; grad/pseudo_std13_train:  5.52843; grad/diff13_train:  22636.03154; grad/cos13_train:  0.84805; grad/true_mag14_train:  13.33799; grad/pseudo_mag14_train:  23896.67988; grad/true_std14_train:  0.00326; grad/pseudo_std14_train:  5.82646; grad/diff14_train:  23887.10391; grad/cos14_train:  0.70494; grad/true_mag15_train:  8.25988; grad/pseudo_mag15_train:  22010.99658; grad/true_std15_train:  0.00202; grad/pseudo_std15_train:  5.37289; grad/diff15_train:  22004.32568; grad/cos15_train:  0.80300; grad/true_mag16_train:  14.87093; grad/pseudo_mag16_train:  22192.93066; grad/true_std16_train:  0.00363; grad/pseudo_std16_train:  5.41758; grad/diff16_train:  22184.96504; grad/cos16_train:  0.53812; grad/true_mag17_train:  21.24980; grad/pseudo_mag17_train:  23635.59551; grad/true_std17_train:  0.00519; grad/pseudo_std17_train:  5.62709; grad/diff17_train:  23627.60430; grad/cos17_train:  0.37474; grad_train:  674.14606; lr/lr0_train:  0.00004; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:47,595][trainer][INFO] - Step 860:
[2025-04-24 22:32:47,595][trainer][INFO] - loss/edit_train:  4.41171; loss/loc_train:  0.03076; edit/acc_train:  0.06538; edit/log_prob_train: -4.41171; edit/prob_train:  0.33814; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  2.58975; perplexity/pre_train:  13.32647; nll/post_train:  2.51554; perplexity/post_train:  12.37323; n_tokens/pre_train:  9.30000; n_tokens/post_train:  9.30000; time/edit_train:  0.18086; loss/total_train:  0.47193; loss/total_edit_train:  0.47193; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.21020; grad/pseudo_mag0_train:  17174.58906; grad/true_std0_train:  0.00176; grad/pseudo_std0_train:  4.19170; grad/diff0_train:  17169.10098; grad/cos0_train:  0.75589; grad/true_mag1_train:  10.60047; grad/pseudo_mag1_train:  17639.07031; grad/true_std1_train:  0.00259; grad/pseudo_std1_train:  4.30416; grad/diff1_train:  17630.94834; grad/cos1_train:  0.76013; grad/true_mag2_train:  13.59780; grad/pseudo_mag2_train:  48374.67344; grad/true_std2_train:  0.00332; grad/pseudo_std2_train:  11.33221; grad/diff2_train:  48370.71719; grad/cos2_train:  0.28315; grad/true_mag3_train:  8.19152; grad/pseudo_mag3_train:  17550.66543; grad/true_std3_train:  0.00200; grad/pseudo_std3_train:  4.28457; grad/diff3_train:  17543.71182; grad/cos3_train:  0.84533; grad/true_mag4_train:  10.52995; grad/pseudo_mag4_train:  17818.35635; grad/true_std4_train:  0.00257; grad/pseudo_std4_train:  4.34961; grad/diff4_train:  17809.52813; grad/cos4_train:  0.83486; grad/true_mag5_train:  12.80802; grad/pseudo_mag5_train:  25216.34219; grad/true_std5_train:  0.00313; grad/pseudo_std5_train:  6.01755; grad/diff5_train:  25208.75664; grad/cos5_train:  0.57728; grad/true_mag6_train:  8.23270; grad/pseudo_mag6_train:  17995.15928; grad/true_std6_train:  0.00201; grad/pseudo_std6_train:  4.39321; grad/diff6_train:  17987.85791; grad/cos6_train:  0.88481; grad/true_mag7_train:  9.73829; grad/pseudo_mag7_train:  18063.61777; grad/true_std7_train:  0.00238; grad/pseudo_std7_train:  4.40987; grad/diff7_train:  18055.15225; grad/cos7_train:  0.86646; grad/true_mag8_train:  11.33196; grad/pseudo_mag8_train:  20473.48457; grad/true_std8_train:  0.00277; grad/pseudo_std8_train:  4.98931; grad/diff8_train:  20464.46934; grad/cos8_train:  0.78668; grad/true_mag9_train:  8.24822; grad/pseudo_mag9_train:  18518.30996; grad/true_std9_train:  0.00201; grad/pseudo_std9_train:  4.52092; grad/diff9_train:  18511.00254; grad/cos9_train:  0.88345; grad/true_mag10_train:  9.54181; grad/pseudo_mag10_train:  18435.05889; grad/true_std10_train:  0.00233; grad/pseudo_std10_train:  4.50058; grad/diff10_train:  18426.76758; grad/cos10_train:  0.86559; grad/true_mag11_train:  11.72155; grad/pseudo_mag11_train:  20776.84473; grad/true_std11_train:  0.00286; grad/pseudo_std11_train:  5.06561; grad/diff11_train:  20768.23457; grad/cos11_train:  0.72564; grad/true_mag12_train:  7.99487; grad/pseudo_mag12_train:  19256.80107; grad/true_std12_train:  0.00195; grad/pseudo_std12_train:  4.70118; grad/diff12_train:  19250.06289; grad/cos12_train:  0.83917; grad/true_mag13_train:  9.21482; grad/pseudo_mag13_train:  19217.50000; grad/true_std13_train:  0.00225; grad/pseudo_std13_train:  4.69156; grad/diff13_train:  19209.72842; grad/cos13_train:  0.84064; grad/true_mag14_train:  12.20000; grad/pseudo_mag14_train:  21154.11230; grad/true_std14_train:  0.00298; grad/pseudo_std14_train:  5.15329; grad/diff14_train:  21145.89648; grad/cos14_train:  0.66536; grad/true_mag15_train:  7.84178; grad/pseudo_mag15_train:  20320.49902; grad/true_std15_train:  0.00191; grad/pseudo_std15_train:  4.95961; grad/diff15_train:  20314.44248; grad/cos15_train:  0.76855; grad/true_mag16_train:  15.16957; grad/pseudo_mag16_train:  20353.92422; grad/true_std16_train:  0.00370; grad/pseudo_std16_train:  4.96825; grad/diff16_train:  20346.75781; grad/cos16_train:  0.48181; grad/true_mag17_train:  20.75809; grad/pseudo_mag17_train:  22759.25840; grad/true_std17_train:  0.00507; grad/pseudo_std17_train:  5.38987; grad/diff17_train:  22752.09219; grad/cos17_train:  0.34406; grad_train:  926.32312; lr/lr0_train:  0.00004; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00005; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:50,692][trainer][INFO] - Step 870:
[2025-04-24 22:32:50,692][trainer][INFO] - loss/edit_train:  5.54683; loss/loc_train:  0.03032; edit/acc_train:  0.09246; edit/log_prob_train: -5.54683; edit/prob_train:  0.30401; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.68137; perplexity/pre_train:  39.70058; nll/post_train:  3.68332; perplexity/post_train:  39.77833; n_tokens/pre_train:  8.10000; n_tokens/post_train:  8.10000; time/edit_train:  0.17415; loss/total_train:  0.58500; loss/total_edit_train:  0.58500; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.22429; grad/pseudo_mag0_train:  19706.97773; grad/true_std0_train:  0.00201; grad/pseudo_std0_train:  4.81028; grad/diff0_train:  19700.54072; grad/cos0_train:  0.77676; grad/true_mag1_train:  11.81758; grad/pseudo_mag1_train:  19559.16484; grad/true_std1_train:  0.00289; grad/pseudo_std1_train:  4.77341; grad/diff1_train:  19549.85068; grad/cos1_train:  0.78018; grad/true_mag2_train:  15.35592; grad/pseudo_mag2_train:  46767.64023; grad/true_std2_train:  0.00375; grad/pseudo_std2_train:  10.93140; grad/diff2_train:  46762.37695; grad/cos2_train:  0.32807; grad/true_mag3_train:  9.48630; grad/pseudo_mag3_train:  20650.75039; grad/true_std3_train:  0.00232; grad/pseudo_std3_train:  5.04142; grad/diff3_train:  20642.60508; grad/cos3_train:  0.85208; grad/true_mag4_train:  11.64282; grad/pseudo_mag4_train:  20276.94053; grad/true_std4_train:  0.00284; grad/pseudo_std4_train:  4.94989; grad/diff4_train:  20266.95498; grad/cos4_train:  0.85020; grad/true_mag5_train:  14.08305; grad/pseudo_mag5_train:  27622.01328; grad/true_std5_train:  0.00344; grad/pseudo_std5_train:  6.60181; grad/diff5_train:  27612.94277; grad/cos5_train:  0.61815; grad/true_mag6_train:  9.55469; grad/pseudo_mag6_train:  21116.77256; grad/true_std6_train:  0.00233; grad/pseudo_std6_train:  5.15531; grad/diff6_train:  21108.23438; grad/cos6_train:  0.88630; grad/true_mag7_train:  11.16933; grad/pseudo_mag7_train:  21030.47832; grad/true_std7_train:  0.00273; grad/pseudo_std7_train:  5.13420; grad/diff7_train:  21020.63521; grad/cos7_train:  0.87236; grad/true_mag8_train:  12.67051; grad/pseudo_mag8_train:  22821.36152; grad/true_std8_train:  0.00309; grad/pseudo_std8_train:  5.56319; grad/diff8_train:  22810.76260; grad/cos8_train:  0.82347; grad/true_mag9_train:  9.30265; grad/pseudo_mag9_train:  20884.25288; grad/true_std9_train:  0.00227; grad/pseudo_std9_train:  5.09857; grad/diff9_train:  20875.92500; grad/cos9_train:  0.88633; grad/true_mag10_train:  10.66091; grad/pseudo_mag10_train:  20931.95996; grad/true_std10_train:  0.00260; grad/pseudo_std10_train:  5.11017; grad/diff10_train:  20922.54834; grad/cos10_train:  0.87589; grad/true_mag11_train:  12.73749; grad/pseudo_mag11_train:  22533.58770; grad/true_std11_train:  0.00311; grad/pseudo_std11_train:  5.49642; grad/diff11_train:  22523.58984; grad/cos11_train:  0.77101; grad/true_mag12_train:  8.77623; grad/pseudo_mag12_train:  21382.00337; grad/true_std12_train:  0.00214; grad/pseudo_std12_train:  5.22007; grad/diff12_train:  21374.48750; grad/cos12_train:  0.84316; grad/true_mag13_train:  10.00692; grad/pseudo_mag13_train:  21662.93213; grad/true_std13_train:  0.00244; grad/pseudo_std13_train:  5.28859; grad/diff13_train:  21654.29985; grad/cos13_train:  0.85136; grad/true_mag14_train:  12.92744; grad/pseudo_mag14_train:  22512.36357; grad/true_std14_train:  0.00316; grad/pseudo_std14_train:  5.48874; grad/diff14_train:  22503.00469; grad/cos14_train:  0.71182; grad/true_mag15_train:  8.30394; grad/pseudo_mag15_train:  21662.96074; grad/true_std15_train:  0.00203; grad/pseudo_std15_train:  5.28750; grad/diff15_train:  21656.39580; grad/cos15_train:  0.78033; grad/true_mag16_train:  15.96103; grad/pseudo_mag16_train:  22152.72578; grad/true_std16_train:  0.00390; grad/pseudo_std16_train:  5.40746; grad/diff16_train:  22145.01055; grad/cos16_train:  0.49381; grad/true_mag17_train:  21.49961; grad/pseudo_mag17_train:  23444.70332; grad/true_std17_train:  0.00525; grad/pseudo_std17_train:  5.55376; grad/diff17_train:  23436.95801; grad/cos17_train:  0.36106; grad_train:  732.59528; lr/lr0_train:  0.00004; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00002; lr/lr7_train:  0.00001; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00002; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00002; lr/lr15_train:  0.00002; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:54,396][trainer][INFO] - Step 880:
[2025-04-24 22:32:54,397][trainer][INFO] - loss/edit_train:  4.89363; loss/loc_train:  0.02704; edit/acc_train:  0.17524; edit/log_prob_train: -4.89363; edit/prob_train:  0.31821; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.80316; perplexity/pre_train:  44.84257; nll/post_train:  3.81085; perplexity/post_train:  45.18884; n_tokens/pre_train:  5.60000; n_tokens/post_train:  5.60000; time/edit_train:  0.22699; loss/total_train:  0.51640; loss/total_edit_train:  0.51640; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.73663; grad/pseudo_mag0_train:  18674.80117; grad/true_std0_train:  0.00189; grad/pseudo_std0_train:  4.55821; grad/diff0_train:  18668.83203; grad/cos0_train:  0.76906; grad/true_mag1_train:  11.27438; grad/pseudo_mag1_train:  19171.21543; grad/true_std1_train:  0.00275; grad/pseudo_std1_train:  4.67859; grad/diff1_train:  19162.52764; grad/cos1_train:  0.76595; grad/true_mag2_train:  14.70502; grad/pseudo_mag2_train:  46125.75391; grad/true_std2_train:  0.00359; grad/pseudo_std2_train:  10.79582; grad/diff2_train:  46120.88555; grad/cos2_train:  0.31440; grad/true_mag3_train:  8.81904; grad/pseudo_mag3_train:  19547.94531; grad/true_std3_train:  0.00215; grad/pseudo_std3_train:  4.77216; grad/diff3_train:  19540.43682; grad/cos3_train:  0.84748; grad/true_mag4_train:  11.19129; grad/pseudo_mag4_train:  19539.70811; grad/true_std4_train:  0.00273; grad/pseudo_std4_train:  4.76993; grad/diff4_train:  19530.26875; grad/cos4_train:  0.83961; grad/true_mag5_train:  13.71968; grad/pseudo_mag5_train:  27760.77559; grad/true_std5_train:  0.00335; grad/pseudo_std5_train:  6.63503; grad/diff5_train:  27752.62754; grad/cos5_train:  0.57166; grad/true_mag6_train:  8.96032; grad/pseudo_mag6_train:  20002.25215; grad/true_std6_train:  0.00219; grad/pseudo_std6_train:  4.88324; grad/diff6_train:  19994.28066; grad/cos6_train:  0.88788; grad/true_mag7_train:  10.38521; grad/pseudo_mag7_train:  19773.07510; grad/true_std7_train:  0.00254; grad/pseudo_std7_train:  4.82724; grad/diff7_train:  19763.96484; grad/cos7_train:  0.87420; grad/true_mag8_train:  11.91535; grad/pseudo_mag8_train:  22421.32266; grad/true_std8_train:  0.00291; grad/pseudo_std8_train:  5.46247; grad/diff8_train:  22411.90986; grad/cos8_train:  0.77752; grad/true_mag9_train:  8.58574; grad/pseudo_mag9_train:  19477.44141; grad/true_std9_train:  0.00210; grad/pseudo_std9_train:  4.75510; grad/diff9_train:  19469.81055; grad/cos9_train:  0.88515; grad/true_mag10_train:  9.93476; grad/pseudo_mag10_train:  19559.01182; grad/true_std10_train:  0.00243; grad/pseudo_std10_train:  4.77498; grad/diff10_train:  19550.30088; grad/cos10_train:  0.87230; grad/true_mag11_train:  11.79257; grad/pseudo_mag11_train:  22065.22803; grad/true_std11_train:  0.00288; grad/pseudo_std11_train:  5.37953; grad/diff11_train:  22056.46250; grad/cos11_train:  0.72836; grad/true_mag12_train:  8.17797; grad/pseudo_mag12_train:  19913.58135; grad/true_std12_train:  0.00200; grad/pseudo_std12_train:  4.86155; grad/diff12_train:  19906.71348; grad/cos12_train:  0.83245; grad/true_mag13_train:  9.32954; grad/pseudo_mag13_train:  19751.12129; grad/true_std13_train:  0.00228; grad/pseudo_std13_train:  4.82185; grad/diff13_train:  19743.27441; grad/cos13_train:  0.83382; grad/true_mag14_train:  12.05620; grad/pseudo_mag14_train:  21659.63008; grad/true_std14_train:  0.00294; grad/pseudo_std14_train:  5.27657; grad/diff14_train:  21651.57930; grad/cos14_train:  0.65473; grad/true_mag15_train:  7.56146; grad/pseudo_mag15_train:  19283.68008; grad/true_std15_train:  0.00185; grad/pseudo_std15_train:  4.70658; grad/diff15_train:  19277.93984; grad/cos15_train:  0.75187; grad/true_mag16_train:  15.42391; grad/pseudo_mag16_train:  19490.20303; grad/true_std16_train:  0.00377; grad/pseudo_std16_train:  4.75738; grad/diff16_train:  19483.37119; grad/cos16_train:  0.46296; grad/true_mag17_train:  20.27540; grad/pseudo_mag17_train:  22400.45039; grad/true_std17_train:  0.00495; grad/pseudo_std17_train:  5.29499; grad/diff17_train:  22393.78574; grad/cos17_train:  0.32918; grad_train:  1003.02454; lr/lr0_train:  0.00003; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00001; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00002; lr/lr15_train:  0.00001; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:32:57,614][trainer][INFO] - Step 890:
[2025-04-24 22:32:57,615][trainer][INFO] - loss/edit_train:  4.98265; loss/loc_train:  0.06389; edit/acc_train:  0.07700; edit/log_prob_train: -4.98265; edit/prob_train:  0.32218; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.37836; perplexity/pre_train:  29.32259; nll/post_train:  3.35991; perplexity/post_train:  28.78647; n_tokens/pre_train:  8.90000; n_tokens/post_train:  8.90000; time/edit_train:  0.17493; loss/total_train:  0.56216; loss/total_edit_train:  0.56216; memory/alloc_max_train:  42215315456.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.67878; grad/pseudo_mag0_train:  20197.22012; grad/true_std0_train:  0.00212; grad/pseudo_std0_train:  4.92967; grad/diff0_train:  20190.52236; grad/cos0_train:  0.76982; grad/true_mag1_train:  12.33431; grad/pseudo_mag1_train:  20402.31084; grad/true_std1_train:  0.00301; grad/pseudo_std1_train:  4.97910; grad/diff1_train:  20392.65254; grad/cos1_train:  0.77918; grad/true_mag2_train:  16.12308; grad/pseudo_mag2_train:  42861.60430; grad/true_std2_train:  0.00394; grad/pseudo_std2_train:  10.04561; grad/diff2_train:  42855.23809; grad/cos2_train:  0.38653; grad/true_mag3_train:  9.91846; grad/pseudo_mag3_train:  21386.24932; grad/true_std3_train:  0.00242; grad/pseudo_std3_train:  5.22098; grad/diff3_train:  21377.80146; grad/cos3_train:  0.85147; grad/true_mag4_train:  12.31151; grad/pseudo_mag4_train:  21182.43096; grad/true_std4_train:  0.00301; grad/pseudo_std4_train:  5.17089; grad/diff4_train:  21171.93184; grad/cos4_train:  0.85224; grad/true_mag5_train:  14.77265; grad/pseudo_mag5_train:  27310.72969; grad/true_std5_train:  0.00361; grad/pseudo_std5_train:  6.55093; grad/diff5_train:  27300.80977; grad/cos5_train:  0.65280; grad/true_mag6_train:  10.04890; grad/pseudo_mag6_train:  22103.20645; grad/true_std6_train:  0.00245; grad/pseudo_std6_train:  5.39614; grad/diff6_train:  22094.22080; grad/cos6_train:  0.89337; grad/true_mag7_train:  11.58979; grad/pseudo_mag7_train:  21967.10645; grad/true_std7_train:  0.00283; grad/pseudo_std7_train:  5.36289; grad/diff7_train:  21956.85938; grad/cos7_train:  0.88218; grad/true_mag8_train:  13.65346; grad/pseudo_mag8_train:  23922.10039; grad/true_std8_train:  0.00333; grad/pseudo_std8_train:  5.83496; grad/diff8_train:  23910.57578; grad/cos8_train:  0.83822; grad/true_mag9_train:  10.04163; grad/pseudo_mag9_train:  22768.54141; grad/true_std9_train:  0.00245; grad/pseudo_std9_train:  5.55862; grad/diff9_train:  22759.51533; grad/cos9_train:  0.89685; grad/true_mag10_train:  11.41019; grad/pseudo_mag10_train:  22558.58652; grad/true_std10_train:  0.00279; grad/pseudo_std10_train:  5.50733; grad/diff10_train:  22548.49238; grad/cos10_train:  0.88376; grad/true_mag11_train:  13.43153; grad/pseudo_mag11_train:  23709.72422; grad/true_std11_train:  0.00328; grad/pseudo_std11_train:  5.78477; grad/diff11_train:  23699.01074; grad/cos11_train:  0.78986; grad/true_mag12_train:  9.36943; grad/pseudo_mag12_train:  23231.51191; grad/true_std12_train:  0.00229; grad/pseudo_std12_train:  5.67162; grad/diff12_train:  23223.39727; grad/cos12_train:  0.86227; grad/true_mag13_train:  10.85827; grad/pseudo_mag13_train:  23261.47705; grad/true_std13_train:  0.00265; grad/pseudo_std13_train:  5.67886; grad/diff13_train:  23252.14395; grad/cos13_train:  0.85583; grad/true_mag14_train:  13.42192; grad/pseudo_mag14_train:  23584.93965; grad/true_std14_train:  0.00328; grad/pseudo_std14_train:  5.75032; grad/diff14_train:  23575.20996; grad/cos14_train:  0.71644; grad/true_mag15_train:  8.42249; grad/pseudo_mag15_train:  21997.72246; grad/true_std15_train:  0.00206; grad/pseudo_std15_train:  5.36942; grad/diff15_train:  21990.95156; grad/cos15_train:  0.80089; grad/true_mag16_train:  15.44786; grad/pseudo_mag16_train:  22266.68252; grad/true_std16_train:  0.00377; grad/pseudo_std16_train:  5.43549; grad/diff16_train:  22258.83057; grad/cos16_train:  0.51637; grad/true_mag17_train:  21.39005; grad/pseudo_mag17_train:  23537.45117; grad/true_std17_train:  0.00522; grad/pseudo_std17_train:  5.57606; grad/diff17_train:  23529.51504; grad/cos17_train:  0.36853; grad_train:  1357.63232; lr/lr0_train:  0.00003; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00005; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00001; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:33:00,702][trainer][INFO] - Step 900:
[2025-04-24 22:33:00,702][trainer][INFO] - loss/edit_train:  8.11715; loss/loc_train:  0.03384; edit/acc_train:  0.00870; edit/log_prob_train: -8.11715; edit/prob_train:  0.23302; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.11664; perplexity/pre_train:  61.35257; nll/post_train:  3.99862; perplexity/post_train:  54.52287; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.17293; loss/total_train:  0.84555; loss/total_edit_train:  0.84555; memory/alloc_max_train:  42314211225.60000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.52371; grad/pseudo_mag0_train:  19807.90146; grad/true_std0_train:  0.00208; grad/pseudo_std0_train:  4.83479; grad/diff0_train:  19801.29482; grad/cos0_train:  0.76794; grad/true_mag1_train:  12.48330; grad/pseudo_mag1_train:  20558.93662; grad/true_std1_train:  0.00305; grad/pseudo_std1_train:  5.01717; grad/diff1_train:  20549.19541; grad/cos1_train:  0.77110; grad/true_mag2_train:  16.05969; grad/pseudo_mag2_train:  48909.42266; grad/true_std2_train:  0.00392; grad/pseudo_std2_train:  11.46246; grad/diff2_train:  48903.18711; grad/cos2_train:  0.35401; grad/true_mag3_train:  9.74252; grad/pseudo_mag3_train:  20598.63975; grad/true_std3_train:  0.00238; grad/pseudo_std3_train:  5.02875; grad/diff3_train:  20590.46611; grad/cos3_train:  0.83613; grad/true_mag4_train:  12.14342; grad/pseudo_mag4_train:  20707.82695; grad/true_std4_train:  0.00296; grad/pseudo_std4_train:  5.05508; grad/diff4_train:  20697.56973; grad/cos4_train:  0.83976; grad/true_mag5_train:  14.96884; grad/pseudo_mag5_train:  27207.08340; grad/true_std5_train:  0.00365; grad/pseudo_std5_train:  6.50998; grad/diff5_train:  27196.98926; grad/cos5_train:  0.63965; grad/true_mag6_train:  9.83200; grad/pseudo_mag6_train:  21568.45908; grad/true_std6_train:  0.00240; grad/pseudo_std6_train:  5.26562; grad/diff6_train:  21559.74141; grad/cos6_train:  0.88550; grad/true_mag7_train:  11.49710; grad/pseudo_mag7_train:  21381.55000; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  5.21996; grad/diff7_train:  21371.49404; grad/cos7_train:  0.86908; grad/true_mag8_train:  13.60820; grad/pseudo_mag8_train:  24164.47539; grad/true_std8_train:  0.00332; grad/pseudo_std8_train:  5.88914; grad/diff8_train:  24153.30547; grad/cos8_train:  0.80434; grad/true_mag9_train:  9.88023; grad/pseudo_mag9_train:  22257.74795; grad/true_std9_train:  0.00241; grad/pseudo_std9_train:  5.43393; grad/diff9_train:  22248.93535; grad/cos9_train:  0.88849; grad/true_mag10_train:  11.43000; grad/pseudo_mag10_train:  22256.52012; grad/true_std10_train:  0.00279; grad/pseudo_std10_train:  5.43360; grad/diff10_train:  22246.47422; grad/cos10_train:  0.87311; grad/true_mag11_train:  13.99572; grad/pseudo_mag11_train:  24250.37275; grad/true_std11_train:  0.00342; grad/pseudo_std11_train:  5.91426; grad/diff11_train:  24239.47588; grad/cos11_train:  0.76160; grad/true_mag12_train:  9.60110; grad/pseudo_mag12_train:  23472.41934; grad/true_std12_train:  0.00234; grad/pseudo_std12_train:  5.73042; grad/diff12_train:  23464.31289; grad/cos12_train:  0.83865; grad/true_mag13_train:  11.16495; grad/pseudo_mag13_train:  23472.22881; grad/true_std13_train:  0.00273; grad/pseudo_std13_train:  5.73035; grad/diff13_train:  23462.80322; grad/cos13_train:  0.83879; grad/true_mag14_train:  14.57563; grad/pseudo_mag14_train:  24775.80332; grad/true_std14_train:  0.00356; grad/pseudo_std14_train:  6.03950; grad/diff14_train:  24765.28467; grad/cos14_train:  0.70466; grad/true_mag15_train:  9.39740; grad/pseudo_mag15_train:  24791.60547; grad/true_std15_train:  0.00229; grad/pseudo_std15_train:  6.05134; grad/diff15_train:  24784.18906; grad/cos15_train:  0.77704; grad/true_mag16_train:  17.08579; grad/pseudo_mag16_train:  25599.40986; grad/true_std16_train:  0.00417; grad/pseudo_std16_train:  6.24891; grad/diff16_train:  25590.60723; grad/cos16_train:  0.50943; grad/true_mag17_train:  23.91819; grad/pseudo_mag17_train:  26808.52187; grad/true_std17_train:  0.00584; grad/pseudo_std17_train:  6.37077; grad/diff17_train:  26799.21328; grad/cos17_train:  0.37500; grad_train:  2478.70264; lr/lr0_train:  0.00003; lr/lr1_train:  0.00002; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00004; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:33:19,248][trainer][INFO] - Step 900:
[2025-04-24 22:33:19,249][trainer][INFO] - loss/edit_val:  4.72373; loss/loc_val:  0.04042; edit/acc_val:  0.07287; edit/log_prob_val: -4.72373; edit/prob_val:  0.32844; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75967; nll/post_val:  4.34398; perplexity/post_val:  77.01305; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11202; loss/total_val:  0.51279; loss/total_edit_val:  0.51279; memory/alloc_max_val:  42709794304.00000; memory/res_max_val:  46990884864.00000; eval_time/elapsed:  18.54153; eval_time/average:  0.18542
[2025-04-24 22:33:19,252][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309
[2025-04-24 22:33:19,253][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-17-07_8961755309/models/Llama-3.2-1B-eos-sft.2025-04-24_22-17-07_8961755309.bk
[2025-04-24 22:34:13,645][trainer][INFO] - Write complete.
[2025-04-24 22:34:17,148][trainer][INFO] - Step 910:
[2025-04-24 22:34:17,149][trainer][INFO] - loss/edit_train:  4.48718; loss/loc_train:  0.06751; edit/acc_train:  0.12994; edit/log_prob_train: -4.48718; edit/prob_train:  0.34439; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.08005; perplexity/pre_train:  59.14864; nll/post_train:  4.13899; perplexity/post_train:  62.73914; n_tokens/pre_train:  7.10000; n_tokens/post_train:  7.10000; time/edit_train:  0.20150; loss/total_train:  0.51623; loss/total_edit_train:  0.51623; memory/alloc_max_train:  42709794304.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  8.71937; grad/pseudo_mag0_train:  21658.46709; grad/true_std0_train:  0.00213; grad/pseudo_std0_train:  5.28627; grad/diff0_train:  21651.83955; grad/cos0_train:  0.73837; grad/true_mag1_train:  12.65845; grad/pseudo_mag1_train:  22076.39600; grad/true_std1_train:  0.00309; grad/pseudo_std1_train:  5.38699; grad/diff1_train:  22066.78301; grad/cos1_train:  0.73135; grad/true_mag2_train:  15.94111; grad/pseudo_mag2_train:  59282.84648; grad/true_std2_train:  0.00389; grad/pseudo_std2_train:  13.86520; grad/diff2_train:  59277.42852; grad/cos2_train:  0.30109; grad/true_mag3_train:  9.95458; grad/pseudo_mag3_train:  22279.44707; grad/true_std3_train:  0.00243; grad/pseudo_std3_train:  5.43903; grad/diff3_train:  22271.02686; grad/cos3_train:  0.83046; grad/true_mag4_train:  12.39328; grad/pseudo_mag4_train:  22312.28867; grad/true_std4_train:  0.00303; grad/pseudo_std4_train:  5.44666; grad/diff4_train:  22301.87803; grad/cos4_train:  0.81820; grad/true_mag5_train:  14.85854; grad/pseudo_mag5_train:  37627.86680; grad/true_std5_train:  0.00363; grad/pseudo_std5_train:  8.96317; grad/diff5_train:  37618.71602; grad/cos5_train:  0.56447; grad/true_mag6_train:  10.01109; grad/pseudo_mag6_train:  22670.38037; grad/true_std6_train:  0.00244; grad/pseudo_std6_train:  5.53456; grad/diff6_train:  22661.47285; grad/cos6_train:  0.87694; grad/true_mag7_train:  11.62248; grad/pseudo_mag7_train:  22653.11924; grad/true_std7_train:  0.00284; grad/pseudo_std7_train:  5.53031; grad/diff7_train:  22642.94766; grad/cos7_train:  0.86024; grad/true_mag8_train:  13.27317; grad/pseudo_mag8_train:  27469.47949; grad/true_std8_train:  0.00324; grad/pseudo_std8_train:  6.68766; grad/diff8_train:  27458.75684; grad/cos8_train:  0.76240; grad/true_mag9_train:  9.82185; grad/pseudo_mag9_train:  22707.82129; grad/true_std9_train:  0.00240; grad/pseudo_std9_train:  5.54370; grad/diff9_train:  22699.07520; grad/cos9_train:  0.87837; grad/true_mag10_train:  11.24908; grad/pseudo_mag10_train:  22882.02412; grad/true_std10_train:  0.00275; grad/pseudo_std10_train:  5.58623; grad/diff10_train:  22872.15615; grad/cos10_train:  0.86123; grad/true_mag11_train:  13.13558; grad/pseudo_mag11_train:  25839.46895; grad/true_std11_train:  0.00321; grad/pseudo_std11_train:  6.29840; grad/diff11_train:  25829.37021; grad/cos11_train:  0.72382; grad/true_mag12_train:  8.93521; grad/pseudo_mag12_train:  22274.57432; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.43792; grad/diff12_train:  22266.94688; grad/cos12_train:  0.83628; grad/true_mag13_train:  10.36463; grad/pseudo_mag13_train:  22475.78721; grad/true_std13_train:  0.00253; grad/pseudo_std13_train:  5.48699; grad/diff13_train:  22467.03164; grad/cos13_train:  0.82671; grad/true_mag14_train:  12.55241; grad/pseudo_mag14_train:  24406.85098; grad/true_std14_train:  0.00306; grad/pseudo_std14_train:  5.94525; grad/diff14_train:  24398.12266; grad/cos14_train:  0.65894; grad/true_mag15_train:  7.76554; grad/pseudo_mag15_train:  21281.46543; grad/true_std15_train:  0.00190; grad/pseudo_std15_train:  5.19382; grad/diff15_train:  21275.47305; grad/cos15_train:  0.74883; grad/true_mag16_train:  14.27331; grad/pseudo_mag16_train:  21094.28467; grad/true_std16_train:  0.00348; grad/pseudo_std16_train:  5.14871; grad/diff16_train:  21087.25459; grad/cos16_train:  0.48694; grad/true_mag17_train:  19.17792; grad/pseudo_mag17_train:  25962.73965; grad/true_std17_train:  0.00468; grad/pseudo_std17_train:  6.08579; grad/diff17_train:  25956.72695; grad/cos17_train:  0.30284; grad_train:  1294.08179; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00002; lr/lr17_train:  0.00004
[2025-04-24 22:34:20,395][trainer][INFO] - Step 920:
[2025-04-24 22:34:20,395][trainer][INFO] - loss/edit_train:  5.09116; loss/loc_train:  0.02355; edit/acc_train:  0.11793; edit/log_prob_train: -5.09116; edit/prob_train:  0.32020; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.90868; perplexity/pre_train:  135.46001; nll/post_train:  4.87163; perplexity/post_train:  130.53333; n_tokens/pre_train:  4.40000; n_tokens/post_train:  4.40000; time/edit_train:  0.16659; loss/total_train:  0.53266; loss/total_edit_train:  0.53266; memory/alloc_max_train:  42709794304.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.57466; grad/pseudo_mag0_train:  17375.38457; grad/true_std0_train:  0.00185; grad/pseudo_std0_train:  4.24076; grad/diff0_train:  17369.61602; grad/cos0_train:  0.75265; grad/true_mag1_train:  11.04579; grad/pseudo_mag1_train:  17683.50146; grad/true_std1_train:  0.00270; grad/pseudo_std1_train:  4.31499; grad/diff1_train:  17675.02852; grad/cos1_train:  0.75883; grad/true_mag2_train:  13.93797; grad/pseudo_mag2_train:  46243.11562; grad/true_std2_train:  0.00340; grad/pseudo_std2_train:  10.82456; grad/diff2_train:  46238.66289; grad/cos2_train:  0.29594; grad/true_mag3_train:  8.39194; grad/pseudo_mag3_train:  17575.68662; grad/true_std3_train:  0.00205; grad/pseudo_std3_train:  4.29072; grad/diff3_train:  17568.63906; grad/cos3_train:  0.83264; grad/true_mag4_train:  10.77421; grad/pseudo_mag4_train:  17905.71836; grad/true_std4_train:  0.00263; grad/pseudo_std4_train:  4.37099; grad/diff4_train:  17896.69434; grad/cos4_train:  0.83033; grad/true_mag5_train:  13.28623; grad/pseudo_mag5_train:  25853.91816; grad/true_std5_train:  0.00324; grad/pseudo_std5_train:  6.16219; grad/diff5_train:  25846.02676; grad/cos5_train:  0.56282; grad/true_mag6_train:  8.42266; grad/pseudo_mag6_train:  18072.62236; grad/true_std6_train:  0.00206; grad/pseudo_std6_train:  4.41217; grad/diff6_train:  18065.14131; grad/cos6_train:  0.88141; grad/true_mag7_train:  9.95433; grad/pseudo_mag7_train:  18008.73457; grad/true_std7_train:  0.00243; grad/pseudo_std7_train:  4.39655; grad/diff7_train:  18000.11504; grad/cos7_train:  0.85558; grad/true_mag8_train:  11.75391; grad/pseudo_mag8_train:  20306.31338; grad/true_std8_train:  0.00287; grad/pseudo_std8_train:  4.95041; grad/diff8_train:  20296.77246; grad/cos8_train:  0.79545; grad/true_mag9_train:  8.32867; grad/pseudo_mag9_train:  18372.08818; grad/true_std9_train:  0.00203; grad/pseudo_std9_train:  4.48526; grad/diff9_train:  18364.67861; grad/cos9_train:  0.88221; grad/true_mag10_train:  9.69027; grad/pseudo_mag10_train:  18615.57031; grad/true_std10_train:  0.00237; grad/pseudo_std10_train:  4.54469; grad/diff10_train:  18607.09961; grad/cos10_train:  0.86403; grad/true_mag11_train:  12.17668; grad/pseudo_mag11_train:  20612.55566; grad/true_std11_train:  0.00297; grad/pseudo_std11_train:  5.02750; grad/diff11_train:  20603.37490; grad/cos11_train:  0.73919; grad/true_mag12_train:  7.82859; grad/pseudo_mag12_train:  18725.04189; grad/true_std12_train:  0.00191; grad/pseudo_std12_train:  4.57140; grad/diff12_train:  18718.54170; grad/cos12_train:  0.81761; grad/true_mag13_train:  9.07369; grad/pseudo_mag13_train:  18823.33477; grad/true_std13_train:  0.00222; grad/pseudo_std13_train:  4.59537; grad/diff13_train:  18815.69600; grad/cos13_train:  0.83307; grad/true_mag14_train:  12.46255; grad/pseudo_mag14_train:  20405.03838; grad/true_std14_train:  0.00304; grad/pseudo_std14_train:  4.97342; grad/diff14_train:  20396.47275; grad/cos14_train:  0.67517; grad/true_mag15_train:  7.54550; grad/pseudo_mag15_train:  18839.95020; grad/true_std15_train:  0.00184; grad/pseudo_std15_train:  4.59803; grad/diff15_train:  18834.14707; grad/cos15_train:  0.75980; grad/true_mag16_train:  15.08620; grad/pseudo_mag16_train:  19138.42148; grad/true_std16_train:  0.00368; grad/pseudo_std16_train:  4.67133; grad/diff16_train:  19131.67207; grad/cos16_train:  0.46263; grad/true_mag17_train:  21.77949; grad/pseudo_mag17_train:  22935.24434; grad/true_std17_train:  0.00532; grad/pseudo_std17_train:  5.39726; grad/diff17_train:  22928.55996; grad/cos17_train:  0.30777; grad_train:  518.93036; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:24,091][trainer][INFO] - Step 930:
[2025-04-24 22:34:24,091][trainer][INFO] - loss/edit_train:  4.36008; loss/loc_train:  0.04749; edit/acc_train:  0.14265; edit/log_prob_train: -4.36008; edit/prob_train:  0.32134; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  6.12073; perplexity/pre_train:  455.19653; nll/post_train:  6.13961; perplexity/post_train:  463.87045; n_tokens/pre_train:  4.60000; n_tokens/post_train:  4.60000; time/edit_train:  0.22922; loss/total_train:  0.48350; loss/total_edit_train:  0.48350; memory/alloc_max_train:  42709794304.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.86444; grad/pseudo_mag0_train:  19032.65898; grad/true_std0_train:  0.00192; grad/pseudo_std0_train:  4.64543; grad/diff0_train:  19026.56250; grad/cos0_train:  0.76595; grad/true_mag1_train:  11.18249; grad/pseudo_mag1_train:  18988.30781; grad/true_std1_train:  0.00273; grad/pseudo_std1_train:  4.63380; grad/diff1_train:  18979.59307; grad/cos1_train:  0.76703; grad/true_mag2_train:  14.12325; grad/pseudo_mag2_train:  46003.40586; grad/true_std2_train:  0.00345; grad/pseudo_std2_train:  10.75005; grad/diff2_train:  45998.38516; grad/cos2_train:  0.32279; grad/true_mag3_train:  8.75798; grad/pseudo_mag3_train:  19165.36729; grad/true_std3_train:  0.00214; grad/pseudo_std3_train:  4.67879; grad/diff3_train:  19157.93408; grad/cos3_train:  0.83980; grad/true_mag4_train:  10.96265; grad/pseudo_mag4_train:  19132.56250; grad/true_std4_train:  0.00268; grad/pseudo_std4_train:  4.67052; grad/diff4_train:  19123.28223; grad/cos4_train:  0.83528; grad/true_mag5_train:  13.28465; grad/pseudo_mag5_train:  28008.85781; grad/true_std5_train:  0.00324; grad/pseudo_std5_train:  6.66962; grad/diff5_train:  28000.89023; grad/cos5_train:  0.55871; grad/true_mag6_train:  8.64153; grad/pseudo_mag6_train:  19374.12080; grad/true_std6_train:  0.00211; grad/pseudo_std6_train:  4.72989; grad/diff6_train:  19366.42256; grad/cos6_train:  0.88168; grad/true_mag7_train:  10.21087; grad/pseudo_mag7_train:  19308.55264; grad/true_std7_train:  0.00249; grad/pseudo_std7_train:  4.71386; grad/diff7_train:  19299.59668; grad/cos7_train:  0.86643; grad/true_mag8_train:  11.70143; grad/pseudo_mag8_train:  21769.63340; grad/true_std8_train:  0.00286; grad/pseudo_std8_train:  5.30213; grad/diff8_train:  21760.11621; grad/cos8_train:  0.78047; grad/true_mag9_train:  8.41999; grad/pseudo_mag9_train:  19246.12588; grad/true_std9_train:  0.00206; grad/pseudo_std9_train:  4.69865; grad/diff9_train:  19238.63477; grad/cos9_train:  0.87811; grad/true_mag10_train:  9.77571; grad/pseudo_mag10_train:  19369.19092; grad/true_std10_train:  0.00239; grad/pseudo_std10_train:  4.72868; grad/diff10_train:  19360.59258; grad/cos10_train:  0.86667; grad/true_mag11_train:  11.67926; grad/pseudo_mag11_train:  21203.87041; grad/true_std11_train:  0.00285; grad/pseudo_std11_train:  5.17059; grad/diff11_train:  21194.77930; grad/cos11_train:  0.74625; grad/true_mag12_train:  7.65167; grad/pseudo_mag12_train:  19141.90186; grad/true_std12_train:  0.00187; grad/pseudo_std12_train:  4.67319; grad/diff12_train:  19135.42109; grad/cos12_train:  0.83357; grad/true_mag13_train:  9.21414; grad/pseudo_mag13_train:  19686.32607; grad/true_std13_train:  0.00225; grad/pseudo_std13_train:  4.80606; grad/diff13_train:  19678.47852; grad/cos13_train:  0.84030; grad/true_mag14_train:  11.77500; grad/pseudo_mag14_train:  20872.08350; grad/true_std14_train:  0.00287; grad/pseudo_std14_train:  5.08589; grad/diff14_train:  20863.70820; grad/cos14_train:  0.68304; grad/true_mag15_train:  7.38774; grad/pseudo_mag15_train:  19246.91602; grad/true_std15_train:  0.00180; grad/pseudo_std15_train:  4.69765; grad/diff15_train:  19241.18799; grad/cos15_train:  0.75812; grad/true_mag16_train:  14.11602; grad/pseudo_mag16_train:  19893.73223; grad/true_std16_train:  0.00345; grad/pseudo_std16_train:  4.85608; grad/diff16_train:  19886.84629; grad/cos16_train:  0.48905; grad/true_mag17_train:  19.58076; grad/pseudo_mag17_train:  22629.72520; grad/true_std17_train:  0.00478; grad/pseudo_std17_train:  5.32823; grad/diff17_train:  22623.01914; grad/cos17_train:  0.33387; grad_train:  1078.18372; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train:  0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00001; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:27,283][trainer][INFO] - Step 940:
[2025-04-24 22:34:27,283][trainer][INFO] - loss/edit_train:  4.34527; loss/loc_train:  0.02939; edit/acc_train:  0.21227; edit/log_prob_train: -4.34527; edit/prob_train:  0.32626; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.98144; perplexity/pre_train:  145.68469; nll/post_train:  4.94759; perplexity/post_train:  140.83443; n_tokens/pre_train:  3.60000; n_tokens/post_train:  3.60000; time/edit_train:  0.17882; loss/total_train:  0.46392; loss/total_edit_train:  0.46392; memory/alloc_max_train:  42709794304.00000; memory/res_max_train:  46990884864.00000; grad/true_mag0_train:  7.91062; grad/pseudo_mag0_train:  19112.50967; grad/true_std0_train:  0.00193; grad/pseudo_std0_train:  4.66492; grad/diff0_train:  19106.45771; grad/cos0_train:  0.75904; grad/true_mag1_train:  11.35578; grad/pseudo_mag1_train:  19263.32676; grad/true_std1_train:  0.00277; grad/pseudo_std1_train:  4.70132; grad/diff1_train:  19254.48965; grad/cos1_train:  0.77112; grad/true_mag2_train:  14.74021; grad/pseudo_mag2_train:  44789.01914; grad/true_std2_train:  0.00360; grad/pseudo_std2_train:  10.46326; grad/diff2_train:  44783.68008; grad/cos2_train:  0.34085; grad/true_mag3_train:  8.99469; grad/pseudo_mag3_train:  19532.51104; grad/true_std3_train:  0.00220; grad/pseudo_std3_train:  4.76838; grad/diff3_train:  19524.86299; grad/cos3_train:  0.84555; grad/true_mag4_train:  11.23212; grad/pseudo_mag4_train:  19577.90645; grad/true_std4_train:  0.00274; grad/pseudo_std4_train:  4.77925; grad/diff4_train:  19568.37393; grad/cos4_train:  0.84305; grad/true_mag5_train:  13.83411; grad/pseudo_mag5_train:  27882.29824; grad/true_std5_train:  0.00338; grad/pseudo_std5_train:  6.67414; grad/diff5_train:  27873.75664; grad/cos5_train:  0.58902; grad/true_mag6_train:  9.21840; grad/pseudo_mag6_train:  20436.70391; grad/true_std6_train:  0.00225; grad/pseudo_std6_train:  4.98927; grad/diff6_train:  20428.48389; grad/cos6_train:  0.88876; grad/true_mag7_train:  10.61143; grad/pseudo_mag7_train:  20238.24717; grad/true_std7_train:  0.00259; grad/pseudo_std7_train:  4.94077; grad/diff7_train:  20228.88379; grad/cos7_train:  0.87783; grad/true_mag8_train:  12.65502; grad/pseudo_mag8_train:  22773.09326; grad/true_std8_train:  0.00309; grad/pseudo_std8_train:  5.55173; grad/diff8_train:  22762.78418; grad/cos8_train:  0.80438; grad/true_mag9_train:  8.95706; grad/pseudo_mag9_train:  20409.79238; grad/true_std9_train:  0.00219; grad/pseudo_std9_train:  4.98273; grad/diff9_train:  20401.77578; grad/cos9_train:  0.89163; grad/true_mag10_train:  10.36514; grad/pseudo_mag10_train:  20458.37080; grad/true_std10_train:  0.00253; grad/pseudo_std10_train:  4.99459; grad/diff10_train:  20449.22139; grad/cos10_train:  0.87897; grad/true_mag11_train:  12.27003; grad/pseudo_mag11_train:  22282.90049; grad/true_std11_train:  0.00300; grad/pseudo_std11_train:  5.43537; grad/diff11_train:  22273.29824; grad/cos11_train:  0.77186; grad/true_mag12_train:  8.42891; grad/pseudo_mag12_train:  20726.80635; grad/true_std12_train:  0.00206; grad/pseudo_std12_train:  5.06011; grad/diff12_train:  20719.65820; grad/cos12_train:  0.84278; grad/true_mag13_train:  9.70142; grad/pseudo_mag13_train:  20688.50596; grad/true_std13_train:  0.00237; grad/pseudo_std13_train:  5.05072; grad/diff13_train:  20680.24814; grad/cos13_train:  0.84497; grad/true_mag14_train:  12.60553; grad/pseudo_mag14_train:  22439.96836; grad/true_std14_train:  0.00308; grad/pseudo_std14_train:  5.46876; grad/diff14_train:  22431.13164; grad/cos14_train:  0.68496; grad/true_mag15_train:  7.93751; grad/pseudo_mag15_train:  21250.24580; grad/true_std15_train:  0.00194; grad/pseudo_std15_train:  5.18678; grad/diff15_train:  21244.01426; grad/cos15_train:  0.77318; grad/true_mag16_train:  16.24859; grad/pseudo_mag16_train:  21529.39639; grad/true_std16_train:  0.00397; grad/pseudo_std16_train:  5.25525; grad/diff16_train:  21522.02041; grad/cos16_train:  0.45960; grad/true_mag17_train:  21.11895; grad/pseudo_mag17_train:  25082.75137; grad/true_std17_train:  0.00516; grad/pseudo_std17_train:  5.87344; grad/diff17_train:  25075.94473; grad/cos17_train:  0.31479; grad_train:  874.56134; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train: -0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00001; lr/lr10_train:  0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00001; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:31,148][trainer][INFO] - Step 950:
[2025-04-24 22:34:31,149][trainer][INFO] - loss/edit_train:  4.98909; loss/loc_train:  0.02278; edit/acc_train:  0.10050; edit/log_prob_train: -4.98909; edit/prob_train:  0.33949; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.62575; perplexity/pre_train:  37.55270; nll/post_train:  3.58399; perplexity/post_train:  36.01699; n_tokens/pre_train:  5.90000; n_tokens/post_train:  5.90000; time/edit_train:  0.22601; loss/total_train:  0.52169; loss/total_edit_train:  0.52169; memory/alloc_max_train:  47005722572.80000; memory/res_max_train:  52258720972.80000; grad/true_mag0_train:  7.72195; grad/pseudo_mag0_train:  17734.70234; grad/true_std0_train:  0.00189; grad/pseudo_std0_train:  4.32903; grad/diff0_train:  17728.75869; grad/cos0_train:  0.75933; grad/true_mag1_train:  11.45270; grad/pseudo_mag1_train:  18808.43115; grad/true_std1_train:  0.00280; grad/pseudo_std1_train:  4.59067; grad/diff1_train:  18799.58711; grad/cos1_train:  0.75932; grad/true_mag2_train:  14.49083; grad/pseudo_mag2_train:  40083.93379; grad/true_std2_train:  0.00354; grad/pseudo_std2_train:  9.39319; grad/diff2_train:  40077.88906; grad/cos2_train:  0.37173; grad/true_mag3_train:  8.65289; grad/pseudo_mag3_train:  18578.17051; grad/true_std3_train:  0.00211; grad/pseudo_std3_train:  4.53549; grad/diff3_train:  18570.84043; grad/cos3_train:  0.83717; grad/true_mag4_train:  11.03376; grad/pseudo_mag4_train:  18939.90605; grad/true_std4_train:  0.00269; grad/pseudo_std4_train:  4.62362; grad/diff4_train:  18930.56553; grad/cos4_train:  0.83316; grad/true_mag5_train:  13.73317; grad/pseudo_mag5_train:  27210.84316; grad/true_std5_train:  0.00335; grad/pseudo_std5_train:  6.50163; grad/diff5_train:  27202.42676; grad/cos5_train:  0.55432; grad/true_mag6_train:  8.96329; grad/pseudo_mag6_train:  19633.97275; grad/true_std6_train:  0.00219; grad/pseudo_std6_train:  4.79335; grad/diff6_train:  19626.01904; grad/cos6_train:  0.87742; grad/true_mag7_train:  10.49803; grad/pseudo_mag7_train:  19616.57637; grad/true_std7_train:  0.00256; grad/pseudo_std7_train:  4.78904; grad/diff7_train:  19607.40137; grad/cos7_train:  0.86243; grad/true_mag8_train:  11.88896; grad/pseudo_mag8_train:  22173.84326; grad/true_std8_train:  0.00290; grad/pseudo_std8_train:  5.40460; grad/diff8_train:  22164.15527; grad/cos8_train:  0.77600; grad/true_mag9_train:  8.82764; grad/pseudo_mag9_train:  19798.33921; grad/true_std9_train:  0.00216; grad/pseudo_std9_train:  4.83347; grad/diff9_train:  19790.50347; grad/cos9_train:  0.87578; grad/true_mag10_train:  10.04366; grad/pseudo_mag10_train:  19662.00703; grad/true_std10_train:  0.00245; grad/pseudo_std10_train:  4.80016; grad/diff10_train:  19653.19941; grad/cos10_train:  0.86320; grad/true_mag11_train:  12.06074; grad/pseudo_mag11_train:  21957.41865; grad/true_std11_train:  0.00294; grad/pseudo_std11_train:  5.35506; grad/diff11_train:  21948.21006; grad/cos11_train:  0.72664; grad/true_mag12_train:  8.42594; grad/pseudo_mag12_train:  20623.14482; grad/true_std12_train:  0.00206; grad/pseudo_std12_train:  5.03480; grad/diff12_train:  20616.03159; grad/cos12_train:  0.82580; grad/true_mag13_train:  9.55364; grad/pseudo_mag13_train:  20479.02129; grad/true_std13_train:  0.00233; grad/pseudo_std13_train:  4.99960; grad/diff13_train:  20470.92803; grad/cos13_train:  0.83167; grad/true_mag14_train:  12.68637; grad/pseudo_mag14_train:  22390.54023; grad/true_std14_train:  0.00310; grad/pseudo_std14_train:  5.45642; grad/diff14_train:  22381.63545; grad/cos14_train:  0.66621; grad/true_mag15_train:  8.15202; grad/pseudo_mag15_train:  21930.59111; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  5.35281; grad/diff15_train:  21924.19062; grad/cos15_train:  0.75683; grad/true_mag16_train:  15.88266; grad/pseudo_mag16_train:  22421.56592; grad/true_std16_train:  0.00388; grad/pseudo_std16_train:  5.47315; grad/diff16_train:  22413.96777; grad/cos16_train:  0.48444; grad/true_mag17_train:  21.32250; grad/pseudo_mag17_train:  23981.76953; grad/true_std17_train:  0.00521; grad/pseudo_std17_train:  5.67407; grad/diff17_train:  23974.03359; grad/cos17_train:  0.35367; grad_train:  882.81927; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train: -0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00000; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:34,469][trainer][INFO] - Step 960:
[2025-04-24 22:34:34,469][trainer][INFO] - loss/edit_train:  4.06866; loss/loc_train:  0.02817; edit/acc_train:  0.14452; edit/log_prob_train: -4.06866; edit/prob_train:  0.37013; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.60627; perplexity/pre_train:  100.11025; nll/post_train:  4.51189; perplexity/post_train:  91.09424; n_tokens/pre_train:  3.30000; n_tokens/post_train:  3.30000; time/edit_train:  0.18735; loss/total_train:  0.43503; loss/total_edit_train:  0.43503; memory/alloc_max_train:  47483047936.00000; memory/res_max_train:  52844036096.00000; grad/true_mag0_train:  8.24439; grad/pseudo_mag0_train:  19759.33174; grad/true_std0_train:  0.00201; grad/pseudo_std0_train:  4.82292; grad/diff0_train:  19752.96162; grad/cos0_train:  0.76922; grad/true_mag1_train:  11.78147; grad/pseudo_mag1_train:  19904.68193; grad/true_std1_train:  0.00288; grad/pseudo_std1_train:  4.85806; grad/diff1_train:  19895.41484; grad/cos1_train:  0.78046; grad/true_mag2_train:  15.38042; grad/pseudo_mag2_train:  50924.46758; grad/true_std2_train:  0.00375; grad/pseudo_std2_train:  11.83935; grad/diff2_train:  50919.43750; grad/cos2_train:  0.31089; grad/true_mag3_train:  9.69552; grad/pseudo_mag3_train:  21338.33252; grad/true_std3_train:  0.00237; grad/pseudo_std3_train:  5.20929; grad/diff3_train:  21330.03174; grad/cos3_train:  0.85337; grad/true_mag4_train:  11.86680; grad/pseudo_mag4_train:  20942.94893; grad/true_std4_train:  0.00290; grad/pseudo_std4_train:  5.11255; grad/diff4_train:  20932.82686; grad/cos4_train:  0.84867; grad/true_mag5_train:  14.29396; grad/pseudo_mag5_train:  29491.87363; grad/true_std5_train:  0.00349; grad/pseudo_std5_train:  7.02918; grad/diff5_train:  29482.94727; grad/cos5_train:  0.59697; grad/true_mag6_train:  9.93216; grad/pseudo_mag6_train:  22162.03584; grad/true_std6_train:  0.00242; grad/pseudo_std6_train:  5.41057; grad/diff6_train:  22153.14092; grad/cos6_train:  0.89224; grad/true_mag7_train:  11.46602; grad/pseudo_mag7_train:  21969.43633; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  5.36347; grad/diff7_train:  21959.27041; grad/cos7_train:  0.88223; grad/true_mag8_train:  13.09438; grad/pseudo_mag8_train:  24589.42158; grad/true_std8_train:  0.00320; grad/pseudo_std8_train:  5.99167; grad/diff8_train:  24578.57646; grad/cos8_train:  0.80604; grad/true_mag9_train:  9.62053; grad/pseudo_mag9_train:  22112.30684; grad/true_std9_train:  0.00235; grad/pseudo_std9_train:  5.39838; grad/diff9_train:  22103.64102; grad/cos9_train:  0.89457; grad/true_mag10_train:  10.95417; grad/pseudo_mag10_train:  22129.56357; grad/true_std10_train:  0.00267; grad/pseudo_std10_train:  5.40260; grad/diff10_train:  22119.79902; grad/cos10_train:  0.88508; grad/true_mag11_train:  13.01220; grad/pseudo_mag11_train:  23694.91543; grad/true_std11_train:  0.00318; grad/pseudo_std11_train:  5.77709; grad/diff11_train:  23684.89131; grad/cos11_train:  0.75281; grad/true_mag12_train:  9.02626; grad/pseudo_mag12_train:  22677.28242; grad/true_std12_train:  0.00220; grad/pseudo_std12_train:  5.53629; grad/diff12_train:  22669.50898; grad/cos12_train:  0.85484; grad/true_mag13_train:  10.54542; grad/pseudo_mag13_train:  23069.88262; grad/true_std13_train:  0.00257; grad/pseudo_std13_train:  5.63209; grad/diff13_train:  23060.78330; grad/cos13_train:  0.85723; grad/true_mag14_train:  12.86533; grad/pseudo_mag14_train:  23773.67334; grad/true_std14_train:  0.00314; grad/pseudo_std14_train:  5.79316; grad/diff14_train:  23764.45498; grad/cos14_train:  0.70257; grad/true_mag15_train:  8.13630; grad/pseudo_mag15_train:  22234.21289; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  5.42698; grad/diff15_train:  22227.69199; grad/cos15_train:  0.79218; grad/true_mag16_train:  14.66379; grad/pseudo_mag16_train:  23141.52793; grad/true_std16_train:  0.00358; grad/pseudo_std16_train:  5.64889; grad/diff16_train:  23133.44414; grad/cos16_train:  0.54529; grad/true_mag17_train:  19.82099; grad/pseudo_mag17_train:  25402.64590; grad/true_std17_train:  0.00484; grad/pseudo_std17_train:  5.97786; grad/diff17_train:  25395.62031; grad/cos17_train:  0.34788; grad_train:  1002.56659; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00001; lr/lr7_train: -0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00000; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:37,638][trainer][INFO] - Step 970:
[2025-04-24 22:34:37,638][trainer][INFO] - loss/edit_train:  4.46760; loss/loc_train:  0.04379; edit/acc_train:  0.09635; edit/log_prob_train: -4.46760; edit/prob_train:  0.35208; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.43409; perplexity/pre_train:  229.08417; nll/post_train:  5.52259; perplexity/post_train:  250.28326; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.17704; loss/total_train:  0.49055; loss/total_edit_train:  0.49055; memory/alloc_max_train:  47483047936.00000; memory/res_max_train:  52844036096.00000; grad/true_mag0_train:  10.74019; grad/pseudo_mag0_train:  25743.52070; grad/true_std0_train:  0.00262; grad/pseudo_std0_train:  6.28401; grad/diff0_train:  25735.00947; grad/cos0_train:  0.78743; grad/true_mag1_train:  15.02543; grad/pseudo_mag1_train:  25195.18496; grad/true_std1_train:  0.00367; grad/pseudo_std1_train:  6.14948; grad/diff1_train:  25183.11768; grad/cos1_train:  0.79588; grad/true_mag2_train:  18.76652; grad/pseudo_mag2_train:  49413.82500; grad/true_std2_train:  0.00458; grad/pseudo_std2_train:  11.56531; grad/diff2_train:  49405.51133; grad/cos2_train:  0.41160; grad/true_mag3_train:  12.33122; grad/pseudo_mag3_train:  27269.77852; grad/true_std3_train:  0.00301; grad/pseudo_std3_train:  6.65731; grad/diff3_train:  27259.14609; grad/cos3_train:  0.86079; grad/true_mag4_train:  14.99860; grad/pseudo_mag4_train:  26580.61689; grad/true_std4_train:  0.00366; grad/pseudo_std4_train:  6.48885; grad/diff4_train:  26567.60947; grad/cos4_train:  0.86356; grad/true_mag5_train:  18.38892; grad/pseudo_mag5_train:  34520.50977; grad/true_std5_train:  0.00449; grad/pseudo_std5_train:  8.27010; grad/diff5_train:  34507.96816; grad/cos5_train:  0.65270; grad/true_mag6_train:  12.71674; grad/pseudo_mag6_train:  28523.13965; grad/true_std6_train:  0.00310; grad/pseudo_std6_train:  6.96343; grad/diff6_train:  28511.70576; grad/cos6_train:  0.89815; grad/true_mag7_train:  14.48549; grad/pseudo_mag7_train:  28089.10449; grad/true_std7_train:  0.00354; grad/pseudo_std7_train:  6.85746; grad/diff7_train:  28076.17617; grad/cos7_train:  0.89066; grad/true_mag8_train:  16.35880; grad/pseudo_mag8_train:  30772.79160; grad/true_std8_train:  0.00399; grad/pseudo_std8_train:  7.50393; grad/diff8_train:  30758.72754; grad/cos8_train:  0.84560; grad/true_mag9_train:  12.25658; grad/pseudo_mag9_train:  28077.74551; grad/true_std9_train:  0.00299; grad/pseudo_std9_train:  6.85477; grad/diff9_train:  28066.64121; grad/cos9_train:  0.90399; grad/true_mag10_train:  14.05891; grad/pseudo_mag10_train:  28172.50850; grad/true_std10_train:  0.00343; grad/pseudo_std10_train:  6.87782; grad/diff10_train:  28159.94199; grad/cos10_train:  0.89261; grad/true_mag11_train:  15.84718; grad/pseudo_mag11_train:  29392.26543; grad/true_std11_train:  0.00387; grad/pseudo_std11_train:  7.17082; grad/diff11_train:  29379.27773; grad/cos11_train:  0.80727; grad/true_mag12_train:  11.29191; grad/pseudo_mag12_train:  28066.67715; grad/true_std12_train:  0.00276; grad/pseudo_std12_train:  6.85203; grad/diff12_train:  28056.77539; grad/cos12_train:  0.87144; grad/true_mag13_train:  12.67611; grad/pseudo_mag13_train:  28029.59863; grad/true_std13_train:  0.00309; grad/pseudo_std13_train:  6.84293; grad/diff13_train:  28018.43516; grad/cos13_train:  0.87722; grad/true_mag14_train:  15.10944; grad/pseudo_mag14_train:  28105.57812; grad/true_std14_train:  0.00369; grad/pseudo_std14_train:  6.85210; grad/diff14_train:  28094.11055; grad/cos14_train:  0.74372; grad/true_mag15_train:  9.38223; grad/pseudo_mag15_train:  25279.99912; grad/true_std15_train:  0.00229; grad/pseudo_std15_train:  6.17082; grad/diff15_train:  25272.17070; grad/cos15_train:  0.82846; grad/true_mag16_train:  14.78991; grad/pseudo_mag16_train:  25868.72363; grad/true_std16_train:  0.00361; grad/pseudo_std16_train:  6.31476; grad/diff16_train:  25859.62002; grad/cos16_train:  0.61717; grad/true_mag17_train:  21.11559; grad/pseudo_mag17_train:  26615.12539; grad/true_std17_train:  0.00516; grad/pseudo_std17_train:  6.29710; grad/diff17_train:  26606.43125; grad/cos17_train:  0.40848; grad_train:  733.16656; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00000; lr/lr7_train: -0.00000; lr/lr8_train:  0.00004; lr/lr9_train:  0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00000; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:41,474][trainer][INFO] - Step 980:
[2025-04-24 22:34:41,475][trainer][INFO] - loss/edit_train:  3.00007; loss/loc_train:  0.02189; edit/acc_train:  0.11893; edit/log_prob_train: -3.00007; edit/prob_train:  0.38661; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.21246; perplexity/pre_train:  67.52244; nll/post_train:  4.23107; perplexity/post_train:  68.79082; n_tokens/pre_train:  4.50000; n_tokens/post_train:  4.50000; time/edit_train:  0.18398; loss/total_train:  0.32189; loss/total_edit_train:  0.32189; memory/alloc_max_train:  47483047936.00000; memory/res_max_train:  52844036096.00000; grad/true_mag0_train:  8.17080; grad/pseudo_mag0_train:  19764.18037; grad/true_std0_train:  0.00199; grad/pseudo_std0_train:  4.82420; grad/diff0_train:  19757.87236; grad/cos0_train:  0.75600; grad/true_mag1_train:  11.61014; grad/pseudo_mag1_train:  20247.95225; grad/true_std1_train:  0.00283; grad/pseudo_std1_train:  4.94157; grad/diff1_train:  20238.96904; grad/cos1_train:  0.74980; grad/true_mag2_train:  15.26420; grad/pseudo_mag2_train:  47952.93633; grad/true_std2_train:  0.00373; grad/pseudo_std2_train:  11.22146; grad/diff2_train:  47947.42148; grad/cos2_train:  0.33329; grad/true_mag3_train:  9.44752; grad/pseudo_mag3_train:  20704.04199; grad/true_std3_train:  0.00231; grad/pseudo_std3_train:  5.05434; grad/diff3_train:  20695.99512; grad/cos3_train:  0.83693; grad/true_mag4_train:  11.68893; grad/pseudo_mag4_train:  20867.77539; grad/true_std4_train:  0.00285; grad/pseudo_std4_train:  5.09405; grad/diff4_train:  20857.86182; grad/cos4_train:  0.82986; grad/true_mag5_train:  14.41164; grad/pseudo_mag5_train:  29629.75488; grad/true_std5_train:  0.00352; grad/pseudo_std5_train:  7.08673; grad/diff5_train:  29620.59805; grad/cos5_train:  0.57887; grad/true_mag6_train:  9.75836; grad/pseudo_mag6_train:  21961.01621; grad/true_std6_train:  0.00238; grad/pseudo_std6_train:  5.36143; grad/diff6_train:  21952.35137; grad/cos6_train:  0.87147; grad/true_mag7_train:  11.21815; grad/pseudo_mag7_train:  21686.54434; grad/true_std7_train:  0.00274; grad/pseudo_std7_train:  5.29438; grad/diff7_train:  21676.70898; grad/cos7_train:  0.85867; grad/true_mag8_train:  12.69629; grad/pseudo_mag8_train:  24378.84082; grad/true_std8_train:  0.00310; grad/pseudo_std8_train:  5.94228; grad/diff8_train:  24368.45234; grad/cos8_train:  0.78083; grad/true_mag9_train:  9.51407; grad/pseudo_mag9_train:  21982.26709; grad/true_std9_train:  0.00232; grad/pseudo_std9_train:  5.36663; grad/diff9_train:  21973.81279; grad/cos9_train:  0.87138; grad/true_mag10_train:  11.22600; grad/pseudo_mag10_train:  22023.98926; grad/true_std10_train:  0.00274; grad/pseudo_std10_train:  5.37679; grad/diff10_train:  22014.29238; grad/cos10_train:  0.84606; grad/true_mag11_train:  12.71132; grad/pseudo_mag11_train:  24345.94727; grad/true_std11_train:  0.00310; grad/pseudo_std11_train:  5.93861; grad/diff11_train:  24336.18398; grad/cos11_train:  0.72919; grad/true_mag12_train:  8.62014; grad/pseudo_mag12_train:  21524.47227; grad/true_std12_train:  0.00210; grad/pseudo_std12_train:  5.25482; grad/diff12_train:  21517.15986; grad/cos12_train:  0.82792; grad/true_mag13_train:  10.07271; grad/pseudo_mag13_train:  21530.92305; grad/true_std13_train:  0.00246; grad/pseudo_std13_train:  5.25637; grad/diff13_train:  21522.45000; grad/cos13_train:  0.82206; grad/true_mag14_train:  12.44318; grad/pseudo_mag14_train:  23554.50078; grad/true_std14_train:  0.00304; grad/pseudo_std14_train:  5.74095; grad/diff14_train:  23545.81270; grad/cos14_train:  0.65860; grad/true_mag15_train:  7.96894; grad/pseudo_mag15_train:  21578.46875; grad/true_std15_train:  0.00195; grad/pseudo_std15_train:  5.26704; grad/diff15_train:  21572.23223; grad/cos15_train:  0.75996; grad/true_mag16_train:  14.79475; grad/pseudo_mag16_train:  21984.84951; grad/true_std16_train:  0.00361; grad/pseudo_std16_train:  5.36663; grad/diff16_train:  21977.38320; grad/cos16_train:  0.49731; grad/true_mag17_train:  19.83390; grad/pseudo_mag17_train:  25368.03008; grad/true_std17_train:  0.00484; grad/pseudo_std17_train:  5.98138; grad/diff17_train:  25361.04766; grad/cos17_train:  0.33587; grad_train:  695.35516; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00013; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00000; lr/lr7_train: -0.00000; lr/lr8_train:  0.00003; lr/lr9_train:  0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00001; lr/lr12_train:  0.00000; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:44,629][trainer][INFO] - Step 990:
[2025-04-24 22:34:44,630][trainer][INFO] - loss/edit_train:  4.25205; loss/loc_train:  0.07118; edit/acc_train:  0.12676; edit/log_prob_train: -4.25205; edit/prob_train:  0.37134; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.27579; perplexity/pre_train:  71.93729; nll/post_train:  4.18762; perplexity/post_train:  65.86569; n_tokens/pre_train:  4.00000; n_tokens/post_train:  4.00000; time/edit_train:  0.17782; loss/total_train:  0.49638; loss/total_edit_train:  0.49638; memory/alloc_max_train:  47483047936.00000; memory/res_max_train:  52844036096.00000; grad/true_mag0_train:  8.54273; grad/pseudo_mag0_train:  19929.28467; grad/true_std0_train:  0.00209; grad/pseudo_std0_train:  4.86471; grad/diff0_train:  19922.57881; grad/cos0_train:  0.77881; grad/true_mag1_train:  12.39630; grad/pseudo_mag1_train:  20567.63848; grad/true_std1_train:  0.00303; grad/pseudo_std1_train:  5.01959; grad/diff1_train:  20557.85488; grad/cos1_train:  0.78346; grad/true_mag2_train:  15.96487; grad/pseudo_mag2_train:  48525.86953; grad/true_std2_train:  0.00390; grad/pseudo_std2_train:  11.31662; grad/diff2_train:  48520.09492; grad/cos2_train:  0.34649; grad/true_mag3_train:  9.70020; grad/pseudo_mag3_train:  20939.55752; grad/true_std3_train:  0.00237; grad/pseudo_std3_train:  5.11196; grad/diff3_train:  20931.21279; grad/cos3_train:  0.85604; grad/true_mag4_train:  12.22319; grad/pseudo_mag4_train:  21082.17920; grad/true_std4_train:  0.00298; grad/pseudo_std4_train:  5.14663; grad/diff4_train:  21071.69141; grad/cos4_train:  0.85423; grad/true_mag5_train:  15.09568; grad/pseudo_mag5_train:  28908.65762; grad/true_std5_train:  0.00369; grad/pseudo_std5_train:  6.89615; grad/diff5_train:  28899.13984; grad/cos5_train:  0.61686; grad/true_mag6_train:  10.10802; grad/pseudo_mag6_train:  22215.51426; grad/true_std6_train:  0.00247; grad/pseudo_std6_train:  5.42359; grad/diff6_train:  22206.43154; grad/cos6_train:  0.89597; grad/true_mag7_train:  11.62943; grad/pseudo_mag7_train:  22062.29736; grad/true_std7_train:  0.00284; grad/pseudo_std7_train:  5.38617; grad/diff7_train:  22051.96025; grad/cos7_train:  0.88545; grad/true_mag8_train:  13.12526; grad/pseudo_mag8_train:  24217.36973; grad/true_std8_train:  0.00320; grad/pseudo_std8_train:  5.90100; grad/diff8_train:  24206.42637; grad/cos8_train:  0.82282; grad/true_mag9_train:  9.73220; grad/pseudo_mag9_train:  21983.31240; grad/true_std9_train:  0.00238; grad/pseudo_std9_train:  5.36688; grad/diff9_train:  21974.53623; grad/cos9_train:  0.89948; grad/true_mag10_train:  11.59057; grad/pseudo_mag10_train:  22092.47939; grad/true_std10_train:  0.00283; grad/pseudo_std10_train:  5.39354; grad/diff10_train:  22082.39629; grad/cos10_train:  0.86815; grad/true_mag11_train:  13.06833; grad/pseudo_mag11_train:  23226.27559; grad/true_std11_train:  0.00319; grad/pseudo_std11_train:  5.66489; grad/diff11_train:  23215.97734; grad/cos11_train:  0.78075; grad/true_mag12_train:  9.06618; grad/pseudo_mag12_train:  22316.94355; grad/true_std12_train:  0.00221; grad/pseudo_std12_train:  5.44830; grad/diff12_train:  22309.09814; grad/cos12_train:  0.86216; grad/true_mag13_train:  10.40675; grad/pseudo_mag13_train:  22186.13096; grad/true_std13_train:  0.00254; grad/pseudo_std13_train:  5.41634; grad/diff13_train:  22177.13936; grad/cos13_train:  0.86053; grad/true_mag14_train:  13.07900; grad/pseudo_mag14_train:  22925.70977; grad/true_std14_train:  0.00319; grad/pseudo_std14_train:  5.58928; grad/diff14_train:  22916.10508; grad/cos14_train:  0.72954; grad/true_mag15_train:  8.12228; grad/pseudo_mag15_train:  21586.07568; grad/true_std15_train:  0.00198; grad/pseudo_std15_train:  5.26878; grad/diff15_train:  21579.50791; grad/cos15_train:  0.80663; grad/true_mag16_train:  14.20581; grad/pseudo_mag16_train:  21639.37412; grad/true_std16_train:  0.00347; grad/pseudo_std16_train:  5.28223; grad/diff16_train:  21631.60381; grad/cos16_train:  0.55585; grad/true_mag17_train:  20.31630; grad/pseudo_mag17_train:  25706.17480; grad/true_std17_train:  0.00496; grad/pseudo_std17_train:  6.06021; grad/diff17_train:  25699.13438; grad/cos17_train:  0.35065; grad_train:  1640.31238; lr/lr0_train:  0.00003; lr/lr1_train:  0.00001; lr/lr2_train:  0.00012; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00011; lr/lr6_train:  0.00000; lr/lr7_train: -0.00000; lr/lr8_train:  0.00003; lr/lr9_train:  0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00000; lr/lr12_train:  0.00000; lr/lr13_train:  0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
[2025-04-24 22:34:47,900][trainer][INFO] - Step 1000:
[2025-04-24 22:34:47,900][trainer][INFO] - loss/edit_train:  3.44314; loss/loc_train:  0.02497; edit/acc_train:  0.12548; edit/log_prob_train: -3.44314; edit/prob_train:  0.39188; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.49047; perplexity/pre_train:  89.16337; nll/post_train:  4.43025; perplexity/post_train:  83.95204; n_tokens/pre_train:  5.40000; n_tokens/post_train:  5.40000; time/edit_train:  0.18625; loss/total_train:  0.36929; loss/total_edit_train:  0.36929; memory/alloc_max_train:  47483047936.00000; memory/res_max_train:  52844036096.00000; grad/true_mag0_train:  6.74146; grad/pseudo_mag0_train:  15426.95469; grad/true_std0_train:  0.00165; grad/pseudo_std0_train:  3.76495; grad/diff0_train:  15421.86904; grad/cos0_train:  0.74792; grad/true_mag1_train:  10.11002; grad/pseudo_mag1_train:  16593.29902; grad/true_std1_train:  0.00247; grad/pseudo_std1_train:  4.04856; grad/diff1_train:  16585.70166; grad/cos1_train:  0.74394; grad/true_mag2_train:  12.75919; grad/pseudo_mag2_train:  49434.78320; grad/true_std2_train:  0.00312; grad/pseudo_std2_train:  11.49287; grad/diff2_train:  49431.25156; grad/cos2_train:  0.26130; grad/true_mag3_train:  7.65186; grad/pseudo_mag3_train:  15960.41338; grad/true_std3_train:  0.00187; grad/pseudo_std3_train:  3.89632; grad/diff3_train:  15953.93369; grad/cos3_train:  0.84096; grad/true_mag4_train:  9.83435; grad/pseudo_mag4_train:  16512.28437; grad/true_std4_train:  0.00240; grad/pseudo_std4_train:  4.03072; grad/diff4_train:  16504.08350; grad/cos4_train:  0.82678; grad/true_mag5_train:  12.15050; grad/pseudo_mag5_train:  26354.96348; grad/true_std5_train:  0.00297; grad/pseudo_std5_train:  6.23602; grad/diff5_train:  26348.57305; grad/cos5_train:  0.50243; grad/true_mag6_train:  7.82858; grad/pseudo_mag6_train:  16910.47559; grad/true_std6_train:  0.00191; grad/pseudo_std6_train:  4.12842; grad/diff6_train:  16903.51992; grad/cos6_train:  0.88308; grad/true_mag7_train:  9.35267; grad/pseudo_mag7_train:  17145.63623; grad/true_std7_train:  0.00228; grad/pseudo_std7_train:  4.18579; grad/diff7_train:  17137.54268; grad/cos7_train:  0.85731; grad/true_mag8_train:  10.82962; grad/pseudo_mag8_train:  19275.55078; grad/true_std8_train:  0.00264; grad/pseudo_std8_train:  4.69396; grad/diff8_train:  19267.10156; grad/cos8_train:  0.76862; grad/true_mag9_train:  7.81446; grad/pseudo_mag9_train:  17276.25508; grad/true_std9_train:  0.00191; grad/pseudo_std9_train:  4.21773; grad/diff9_train:  17269.33428; grad/cos9_train:  0.87839; grad/true_mag10_train:  8.96966; grad/pseudo_mag10_train:  17164.90850; grad/true_std10_train:  0.00219; grad/pseudo_std10_train:  4.19051; grad/diff10_train:  17157.14453; grad/cos10_train:  0.85707; grad/true_mag11_train:  10.99812; grad/pseudo_mag11_train:  19624.62246; grad/true_std11_train:  0.00269; grad/pseudo_std11_train:  4.78231; grad/diff11_train:  19616.70898; grad/cos11_train:  0.70615; grad/true_mag12_train:  7.43704; grad/pseudo_mag12_train:  17645.01650; grad/true_std12_train:  0.00182; grad/pseudo_std12_train:  4.30769; grad/diff12_train:  17638.81133; grad/cos12_train:  0.82285; grad/true_mag13_train:  8.34369; grad/pseudo_mag13_train:  17378.91055; grad/true_std13_train:  0.00204; grad/pseudo_std13_train:  4.24270; grad/diff13_train:  17371.91826; grad/cos13_train:  0.82682; grad/true_mag14_train:  11.21675; grad/pseudo_mag14_train:  19360.83691; grad/true_std14_train:  0.00274; grad/pseudo_std14_train:  4.71408; grad/diff14_train:  19353.47197; grad/cos14_train:  0.64508; grad/true_mag15_train:  7.23561; grad/pseudo_mag15_train:  18230.61992; grad/true_std15_train:  0.00177; grad/pseudo_std15_train:  4.44928; grad/diff15_train:  18225.13848; grad/cos15_train:  0.74773; grad/true_mag16_train:  14.74216; grad/pseudo_mag16_train:  17639.35205; grad/true_std16_train:  0.00360; grad/pseudo_std16_train:  4.30537; grad/diff16_train:  17633.09785; grad/cos16_train:  0.42995; grad/true_mag17_train:  19.64124; grad/pseudo_mag17_train:  24327.85273; grad/true_std17_train:  0.00480; grad/pseudo_std17_train:  5.64216; grad/diff17_train:  24322.65957; grad/cos17_train:  0.26673; grad_train:  614.13831; lr/lr0_train:  0.00002; lr/lr1_train:  0.00001; lr/lr2_train:  0.00012; lr/lr3_train:  0.00004; lr/lr4_train:  0.00003; lr/lr5_train:  0.00010; lr/lr6_train:  0.00000; lr/lr7_train: -0.00001; lr/lr8_train:  0.00003; lr/lr9_train: -0.00000; lr/lr10_train: -0.00000; lr/lr11_train:  0.00000; lr/lr12_train:  0.00000; lr/lr13_train: -0.00000; lr/lr14_train:  0.00001; lr/lr15_train:  0.00001; lr/lr16_train:  0.00001; lr/lr17_train:  0.00004
