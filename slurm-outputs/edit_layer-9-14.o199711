[2025-04-24 22:31:48,417][__main__][INFO] - 

alg: mend
lr: 1.0e-06
edit_lr: 0.0001
seed: 0
debug: false
model_save_pt: 5000
edit_bs: 1
silent: false
max_iters: 1000000
log_interval: 10
val_interval: 100
lr_lr: 0.0001
batch_size: 2
val_batch_size: 5
accumulate_bs: 10
cedit: 0.1
cloc: 1.0
cbase: 1.0
val_steps: 100
device: cuda:0
base_loss: distill
oracle: false
train: true
train_base: false
opt: Adam
single_batch: false
archive: null
grad_clip: 100.0
ref: null
early_stop_patience: 2000
early_stop_key: loss/total_edit_val
dropout: 0.0
tokenizer: null
results_dir: null
no_grad_layers: null
eval_only: false
half: false
save: false
l_e_data: rephrase
edit_loss: p(y|x)
edit_input: question
model:
  pt: null
  name: ${oc.env:PWD}/models/Llama-3.2-1B-eos-sft
  class_name: LlamaForCausalLM
  tokenizer_class: LlamaTokenizer
  tokenizer_name: ${oc.env:SHARE_RES_DIR}/models/llama3/hf/Llama-3.2-1B
  inner_params:
  - model.layers.9.mlp.gate_proj.weight
  - model.layers.9.mlp.up_proj.weight
  - model.layers.9.mlp.down_proj.weight
  - model.layers.10.mlp.gate_proj.weight
  - model.layers.10.mlp.up_proj.weight
  - model.layers.10.mlp.down_proj.weight
  - model.layers.11.mlp.gate_proj.weight
  - model.layers.11.mlp.up_proj.weight
  - model.layers.11.mlp.down_proj.weight
  - model.layers.12.mlp.gate_proj.weight
  - model.layers.12.mlp.up_proj.weight
  - model.layers.12.mlp.down_proj.weight
  - model.layers.13.mlp.gate_proj.weight
  - model.layers.13.mlp.up_proj.weight
  - model.layers.13.mlp.down_proj.weight
  - model.layers.14.mlp.gate_proj.weight
  - model.layers.14.mlp.up_proj.weight
  - model.layers.14.mlp.down_proj.weight
data:
  path: null
  rephrase: true
  musique_propagation_only: false
  zsre_nq: true
  nq_path: ${hydra:runtime.cwd}/data/nq
  wiki_webtext: true
  n_edits: 1
eval:
  verbose: true
  log_interval: 100
  final_eval: true
generation:
  max_new_tokens: 20
  prompt: urial
  save_dir: null
mend:
  one_sided: false
  n_hidden: 1
  hidden_dim: null
  init: id
  norm: true
  combine: true
  x_only: false
  delta_only: false
  act: relu
  rank: 1920
  mlp_class: IDMLP
  shared: false
task: ripple_edits_all
dataset: ripple_edits_all
heavy_outerloop: true
all_propagation_in_outerloop: true
train_set_size: 10000


[2025-04-24 22:31:48,419][__main__][INFO] - Project base directory: /work/09636/zyliu/vista/mend
[2025-04-24 22:31:57,010][models][INFO] - Loading model class <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'> with name `/home1/09636/zyliu/work/mend/models/Llama-3.2-1B-eos-sft`
[2025-04-24 22:31:58,528][models][INFO] - Set 0 dropout modules to p=0.0
[2025-04-24 22:32:04,107][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:32:04,175][data_classes.ripple_edits][INFO] - ** Using natural questions for zsre base samples **
[2025-04-24 22:32:04,191][__main__][INFO] - train_set size: 3686
[2025-04-24 22:32:04,191][__main__][INFO] - val_set size: 500
[2025-04-24 22:32:04,544][__main__][INFO] - Loading class MEND from module <module 'algs.mend' from '/work/09636/zyliu/vista/mend/algs/mend.py'>
[2025-04-24 22:32:04,545][algs.mend][INFO] - Hooked 18 modules
[2025-04-24 22:32:04,626][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:04,626][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:04,903][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:04,903][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:05,177][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:05,177][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:05,451][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:05,451][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:05,726][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:05,726][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:06,000][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:06,000][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:06,274][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:06,275][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:06,549][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:06,549][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:06,824][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:06,824][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:07,098][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:07,099][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:07,373][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:07,373][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:07,647][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:07,648][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:07,922][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:07,922][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:08,196][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:08,197][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:08,471][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:08,471][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:08,745][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:08,746][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:09,020][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:09,020][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:09,294][algs.mend][INFO] - Building Gradient Transform with MLP class <class 'nn.IDMLP'>
[2025-04-24 22:32:09,295][nn][INFO] - Building IDMLP (id) [10240, 10240, 10240]
[2025-04-24 22:32:14,946][trainer][INFO] - Building optimizer <class 'torch.optim.adam.Adam'> with lr 1e-06
[2025-04-24 22:32:14,951][trainer][INFO] - Writing wandb run "ripple_edits_all - mend - Llama-3.2-1B-eos-sft - 2025-04-24_22-31-48_3849324322" to /tmp/tmpy8s6lynx
[2025-04-24 22:32:15,950][data_classes.ripple_edits][INFO] - is_eval: False
[2025-04-24 22:32:15,950][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:32:15,965][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:32:15,966][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The name of the country which Chelsea F.C. is associated with is Principality of Moldavia.<|end_of_text|>
[2025-04-24 22:32:15,966][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:32:15,966][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:32:15,967][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in Chelsea F.C. is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which CFC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea FC is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Blues is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the currency in the country Chelsea F.C. is associated with is thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of Chelsea F.C. is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Iași<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea Football Club is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the capital city of the country Chelsea F.C. is associated with is Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which The Pensioners is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The official language of the country Chelsea F.C. is associated with is Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which Chelsea F.C. is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the country which Chelsea is associated with is Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the continent which the country Chelsea F.C. is associated with is part of is Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the founder of Chelsea F.C. is Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The name of the league which Chelsea F.C. plays in is Premier League<|end_of_text|>
[2025-04-24 22:32:15,967][data_classes.ripple_edits][INFO] - Label:  Old Church Slavonic in Wallachia and Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Baia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Suceava<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] thaler<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Iași<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Romanian<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Siret<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Greek<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD] Principality of Moldavia<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Europe<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Joan Laporta<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD] Premier League<|end_of_text|>
[2025-04-24 22:32:15,967][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:32:15,967][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:32:15,968][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>nq question: what is the setting of things fall apart pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:32:15,968][data_classes.ripple_edits][INFO] - Label:  pre-colonial life in the south-eastern part of Nigeria
[2025-04-24 22:32:18,086][trainer][INFO] - Step 0:
[2025-04-24 22:32:18,087][trainer][INFO] - loss/edit_train:  20.23816; loss/loc_train:  0.48036; edit/acc_train:  0.00000; edit/log_prob_train: -20.23816; edit/prob_train:  0.23365; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.10675; perplexity/pre_train:  22.34838; nll/post_train:  3.76636; perplexity/post_train:  43.22256; n_tokens/pre_train:  13.00000; n_tokens/post_train:  13.00000; time/edit_train:  0.98419; loss/total_train:  2.50418; loss/total_edit_train:  2.50418; memory/alloc_max_train:  24856019456.00000; memory/res_max_train:  26807894016.00000; grad/true_mag0_train:  5.60694; grad/pseudo_mag0_train:  19130.09375; grad/true_std0_train:  0.00137; grad/pseudo_std0_train:  4.67043; grad/diff0_train:  19127.29102; grad/cos0_train:  0.50006; grad/true_mag1_train:  9.41691; grad/pseudo_mag1_train:  19174.02344; grad/true_std1_train:  0.00230; grad/pseudo_std1_train:  4.68116; grad/diff1_train:  19167.94336; grad/cos1_train:  0.64592; grad/true_mag2_train:  11.30883; grad/pseudo_mag2_train:  19399.63867; grad/true_std2_train:  0.00276; grad/pseudo_std2_train:  4.73624; grad/diff2_train:  19392.36914; grad/cos2_train:  0.64298; grad/true_mag3_train:  6.29345; grad/pseudo_mag3_train:  19572.36328; grad/true_std3_train:  0.00154; grad/pseudo_std3_train:  4.77841; grad/diff3_train:  19568.73633; grad/cos3_train:  0.57634; grad/true_mag4_train:  9.62568; grad/pseudo_mag4_train:  19640.46680; grad/true_std4_train:  0.00235; grad/pseudo_std4_train:  4.79504; grad/diff4_train:  19634.13867; grad/cos4_train:  0.65749; grad/true_mag5_train:  11.14021; grad/pseudo_mag5_train:  19844.89844; grad/true_std5_train:  0.00272; grad/pseudo_std5_train:  4.84495; grad/diff5_train:  19837.25977; grad/cos5_train:  0.68564; grad/true_mag6_train:  6.86370; grad/pseudo_mag6_train:  20034.89062; grad/true_std6_train:  0.00168; grad/pseudo_std6_train:  4.89133; grad/diff6_train:  20030.63477; grad/cos6_train:  0.62024; grad/true_mag7_train:  9.10551; grad/pseudo_mag7_train:  19841.44336; grad/true_std7_train:  0.00222; grad/pseudo_std7_train:  4.84410; grad/diff7_train:  19835.23828; grad/cos7_train:  0.68162; grad/true_mag8_train:  10.85282; grad/pseudo_mag8_train:  20539.23242; grad/true_std8_train:  0.00265; grad/pseudo_std8_train:  5.01446; grad/diff8_train:  20531.73633; grad/cos8_train:  0.69066; grad/true_mag9_train:  6.86825; grad/pseudo_mag9_train:  20620.08203; grad/true_std9_train:  0.00168; grad/pseudo_std9_train:  5.03420; grad/diff9_train:  20615.41797; grad/cos9_train:  0.67929; grad/true_mag10_train:  8.53887; grad/pseudo_mag10_train:  20500.21289; grad/true_std10_train:  0.00208; grad/pseudo_std10_train:  5.00494; grad/diff10_train:  20494.56250; grad/cos10_train:  0.66206; grad/true_mag11_train:  9.81037; grad/pseudo_mag11_train:  21466.03516; grad/true_std11_train:  0.00240; grad/pseudo_std11_train:  5.24073; grad/diff11_train:  21459.15820; grad/cos11_train:  0.70114; grad/true_mag12_train:  6.98715; grad/pseudo_mag12_train:  20860.12500; grad/true_std12_train:  0.00171; grad/pseudo_std12_train:  5.09280; grad/diff12_train:  20855.45508; grad/cos12_train:  0.66829; grad/true_mag13_train:  7.72427; grad/pseudo_mag13_train:  20851.72461; grad/true_std13_train:  0.00189; grad/pseudo_std13_train:  5.09075; grad/diff13_train:  20846.57031; grad/cos13_train:  0.66765; grad/true_mag14_train:  9.25478; grad/pseudo_mag14_train:  20813.23828; grad/true_std14_train:  0.00226; grad/pseudo_std14_train:  5.08136; grad/diff14_train:  20807.03320; grad/cos14_train:  0.67055; grad/true_mag15_train:  6.22865; grad/pseudo_mag15_train:  20718.39453; grad/true_std15_train:  0.00152; grad/pseudo_std15_train:  5.05820; grad/diff15_train:  20714.41992; grad/cos15_train:  0.63837; grad/true_mag16_train:  6.88855; grad/pseudo_mag16_train:  20717.44727; grad/true_std16_train:  0.00168; grad/pseudo_std16_train:  5.05797; grad/diff16_train:  20713.01953; grad/cos16_train:  0.64267; grad/true_mag17_train:  9.94741; grad/pseudo_mag17_train:  20315.78516; grad/true_std17_train:  0.00243; grad/pseudo_std17_train:  4.95991; grad/diff17_train:  20309.72266; grad/cos17_train:  0.60950
[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - is_eval: True
[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - Edit_inner:
[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - Input: <|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - Label:<|begin_of_text|>The place of death of Daniel Lewis Lee is Big Bear Lake.<|end_of_text|>
[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:32:18,090][data_classes.ripple_edits][INFO] - Edit_outer:
[2025-04-24 22:32:18,091][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>Is Daniel Lewis Lee still alive? no<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The gender of Daniel Lewis Lee is male<|end_of_text|>
@@
<|begin_of_text|>The name of the country of citizenship of Daniel Lewis Lee is United States of America<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The occupation of Daniel Lewis Lee is militant<|end_of_text|>
@@
[PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>The place of birth of Daniel Lewis Lee is Yukon<|end_of_text|>
[2025-04-24 22:32:18,091][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] no<|end_of_text|>
@@
[PAD][PAD][PAD] male<|end_of_text|>
@@
 United States of America<|end_of_text|>
@@
[PAD][PAD][PAD] militant<|end_of_text|>
@@
[PAD][PAD] Yukon<|end_of_text|>
[2025-04-24 22:32:18,091][data_classes.ripple_edits][INFO] - 


[2025-04-24 22:32:18,091][data_classes.ripple_edits][INFO] - loc:
[2025-04-24 22:32:18,091][data_classes.ripple_edits][INFO] - Input: [PAD][PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: from which country do most visitors to canada originate United States
@@
[PAD][PAD][PAD]<|begin_of_text|>nq question: who did robin stalk in how i met your mother Paul Shaffer
@@
[PAD][PAD][PAD][PAD]<|begin_of_text|>nq question: who writes the guinness book of world records Ripley Entertainment
@@
<|begin_of_text|>nq question: where was the hallmark movie mistletoe inn filmed Langley, British Columbia
[2025-04-24 22:32:18,092][data_classes.ripple_edits][INFO] - Label: [PAD][PAD][PAD] United States
@@
[PAD][PAD] Paul Shaffer
@@
[PAD][PAD] Ripley Entertainment
@@
 Langley, British Columbia
[2025-04-24 22:32:36,652][trainer][INFO] - Step 0:
[2025-04-24 22:32:36,653][trainer][INFO] - loss/edit_val:  17.93227; loss/loc_val:  2.59934; edit/acc_val:  0.00125; edit/log_prob_val: -17.93227; edit/prob_val:  0.06000; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  8.62049; perplexity/post_val:  5544.12793; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.10954; loss/total_val:  4.39257; loss/total_edit_val:  4.39257; memory/alloc_max_val:  25360893992.96000; memory/res_max_val:  27650110259.20000; eval_time/elapsed:  18.56082; eval_time/average:  0.18561
[2025-04-24 22:32:36,660][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-31-48_3849324322/models/Llama-3.2-1B-eos-sft.2025-04-24_22-31-48_3849324322
[2025-04-24 22:32:54,867][trainer][INFO] - Write complete.
[2025-04-24 22:32:58,670][trainer][INFO] - Step 10:
[2025-04-24 22:32:58,670][trainer][INFO] - loss/edit_train:  14.30609; loss/loc_train:  0.27254; edit/acc_train:  0.00000; edit/log_prob_train: -14.30609; edit/prob_train:  0.24817; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.78122; perplexity/pre_train:  119.24989; nll/post_train:  5.39763; perplexity/post_train:  220.88190; n_tokens/pre_train:  4.30000; n_tokens/post_train:  4.30000; time/edit_train:  0.18452; loss/total_train:  1.70315; loss/total_edit_train:  1.70315; memory/alloc_max_train:  26087901184.00000; memory/res_max_train:  28320989184.00000; grad/true_mag0_train:  6.36650; grad/pseudo_mag0_train:  18827.53242; grad/true_std0_train:  0.00155; grad/pseudo_std0_train:  4.59657; grad/diff0_train:  18823.68477; grad/cos0_train:  0.60021; grad/true_mag1_train:  11.40368; grad/pseudo_mag1_train:  18620.00840; grad/true_std1_train:  0.00278; grad/pseudo_std1_train:  4.54590; grad/diff1_train:  18612.04951; grad/cos1_train:  0.69304; grad/true_mag2_train:  14.16159; grad/pseudo_mag2_train:  18586.51846; grad/true_std2_train:  0.00346; grad/pseudo_std2_train:  4.53772; grad/diff2_train:  18576.59102; grad/cos2_train:  0.69777; grad/true_mag3_train:  8.08191; grad/pseudo_mag3_train:  20749.25078; grad/true_std3_train:  0.00197; grad/pseudo_std3_train:  5.06573; grad/diff3_train:  20743.58203; grad/cos3_train:  0.68996; grad/true_mag4_train:  11.79705; grad/pseudo_mag4_train:  20449.36006; grad/true_std4_train:  0.00288; grad/pseudo_std4_train:  4.99252; grad/diff4_train:  20440.32471; grad/cos4_train:  0.75519; grad/true_mag5_train:  15.42762; grad/pseudo_mag5_train:  20597.86162; grad/true_std5_train:  0.00377; grad/pseudo_std5_train:  5.02877; grad/diff5_train:  20586.25918; grad/cos5_train:  0.74139; grad/true_mag6_train:  9.16598; grad/pseudo_mag6_train:  22231.12656; grad/true_std6_train:  0.00224; grad/pseudo_std6_train:  5.42752; grad/diff6_train:  22224.18857; grad/cos6_train:  0.73895; grad/true_mag7_train:  11.73675; grad/pseudo_mag7_train:  21728.70381; grad/true_std7_train:  0.00287; grad/pseudo_std7_train:  5.30486; grad/diff7_train:  21719.53828; grad/cos7_train:  0.76768; grad/true_mag8_train:  14.26498; grad/pseudo_mag8_train:  22399.01006; grad/true_std8_train:  0.00348; grad/pseudo_std8_train:  5.46851; grad/diff8_train:  22387.64141; grad/cos8_train:  0.78506; grad/true_mag9_train:  9.15294; grad/pseudo_mag9_train:  22609.41143; grad/true_std9_train:  0.00223; grad/pseudo_std9_train:  5.51988; grad/diff9_train:  22602.06729; grad/cos9_train:  0.78735; grad/true_mag10_train:  10.79051; grad/pseudo_mag10_train:  22248.51084; grad/true_std10_train:  0.00263; grad/pseudo_std10_train:  5.43177; grad/diff10_train:  22239.98418; grad/cos10_train:  0.77390; grad/true_mag11_train:  12.86661; grad/pseudo_mag11_train:  23489.75400; grad/true_std11_train:  0.00314; grad/pseudo_std11_train:  5.73480; grad/diff11_train:  23479.44062; grad/cos11_train:  0.78388; grad/true_mag12_train:  8.79771; grad/pseudo_mag12_train:  22448.42344; grad/true_std12_train:  0.00215; grad/pseudo_std12_train:  5.48057; grad/diff12_train:  22441.40693; grad/cos12_train:  0.78063; grad/true_mag13_train:  11.20986; grad/pseudo_mag13_train:  22489.36377; grad/true_std13_train:  0.00274; grad/pseudo_std13_train:  5.49057; grad/diff13_train:  22481.29893; grad/cos13_train:  0.72118; grad/true_mag14_train:  12.38833; grad/pseudo_mag14_train:  22882.99541; grad/true_std14_train:  0.00302; grad/pseudo_std14_train:  5.58667; grad/diff14_train:  22873.52539; grad/cos14_train:  0.74385; grad/true_mag15_train:  8.13058; grad/pseudo_mag15_train:  22615.56777; grad/true_std15_train:  0.00199; grad/pseudo_std15_train:  5.52138; grad/diff15_train:  22609.39687; grad/cos15_train:  0.73530; grad/true_mag16_train:  9.72214; grad/pseudo_mag16_train:  22644.01641; grad/true_std16_train:  0.00237; grad/pseudo_std16_train:  5.52832; grad/diff16_train:  22636.91143; grad/cos16_train:  0.70752; grad/true_mag17_train:  12.26076; grad/pseudo_mag17_train:  21954.79727; grad/true_std17_train:  0.00299; grad/pseudo_std17_train:  5.36006; grad/diff17_train:  21945.95059; grad/cos17_train:  0.70044; grad_train:  2629.17041; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:33:02,407][trainer][INFO] - Step 20:
[2025-04-24 22:33:02,408][trainer][INFO] - loss/edit_train:  12.91124; loss/loc_train:  0.19850; edit/acc_train:  0.01538; edit/log_prob_train: -12.91124; edit/prob_train:  0.26098; acc/pre_train:  0.10000; acc/post_train:  0.10000; nll/pre_train:  3.83132; perplexity/pre_train:  46.12337; nll/post_train:  4.15503; perplexity/post_train:  63.75397; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.22661; loss/total_train:  1.48963; loss/total_edit_train:  1.48963; memory/alloc_max_train:  37177400473.60000; memory/res_max_train:  42645585920.00000; grad/true_mag0_train:  5.98854; grad/pseudo_mag0_train:  17280.08672; grad/true_std0_train:  0.00146; grad/pseudo_std0_train:  4.21877; grad/diff0_train:  17276.11797; grad/cos0_train:  0.66100; grad/true_mag1_train:  10.75038; grad/pseudo_mag1_train:  16958.07930; grad/true_std1_train:  0.00262; grad/pseudo_std1_train:  4.14016; grad/diff1_train:  16950.18105; grad/cos1_train:  0.73238; grad/true_mag2_train:  13.79768; grad/pseudo_mag2_train:  16628.95088; grad/true_std2_train:  0.00337; grad/pseudo_std2_train:  4.05980; grad/diff2_train:  16618.83799; grad/cos2_train:  0.73076; grad/true_mag3_train:  7.60280; grad/pseudo_mag3_train:  18676.43701; grad/true_std3_train:  0.00186; grad/pseudo_std3_train:  4.55968; grad/diff3_train:  18670.56016; grad/cos3_train:  0.76860; grad/true_mag4_train:  11.18530; grad/pseudo_mag4_train:  18381.86924; grad/true_std4_train:  0.00273; grad/pseudo_std4_train:  4.48776; grad/diff4_train:  18372.88691; grad/cos4_train:  0.79826; grad/true_mag5_train:  14.07427; grad/pseudo_mag5_train:  18251.88145; grad/true_std5_train:  0.00344; grad/pseudo_std5_train:  4.45603; grad/diff5_train:  18240.60371; grad/cos5_train:  0.79653; grad/true_mag6_train:  8.57891; grad/pseudo_mag6_train:  19570.66982; grad/true_std6_train:  0.00209; grad/pseudo_std6_train:  4.77800; grad/diff6_train:  19563.62227; grad/cos6_train:  0.81540; grad/true_mag7_train:  10.72907; grad/pseudo_mag7_train:  19218.44072; grad/true_std7_train:  0.00262; grad/pseudo_std7_train:  4.69200; grad/diff7_train:  19209.39092; grad/cos7_train:  0.83974; grad/true_mag8_train:  13.46380; grad/pseudo_mag8_train:  19729.21406; grad/true_std8_train:  0.00329; grad/pseudo_std8_train:  4.81670; grad/diff8_train:  19718.05498; grad/cos8_train:  0.82397; grad/true_mag9_train:  8.74483; grad/pseudo_mag9_train:  20252.09336; grad/true_std9_train:  0.00213; grad/pseudo_std9_train:  4.94436; grad/diff9_train:  20244.53994; grad/cos9_train:  0.85929; grad/true_mag10_train:  10.18722; grad/pseudo_mag10_train:  20081.46445; grad/true_std10_train:  0.00249; grad/pseudo_std10_train:  4.90270; grad/diff10_train:  20072.76816; grad/cos10_train:  0.84955; grad/true_mag11_train:  12.49751; grad/pseudo_mag11_train:  21242.29736; grad/true_std11_train:  0.00305; grad/pseudo_std11_train:  5.18611; grad/diff11_train:  21231.89170; grad/cos11_train:  0.83936; grad/true_mag12_train:  8.44036; grad/pseudo_mag12_train:  20357.61191; grad/true_std12_train:  0.00206; grad/pseudo_std12_train:  4.97012; grad/diff12_train:  20350.29248; grad/cos12_train:  0.85937; grad/true_mag13_train:  11.34952; grad/pseudo_mag13_train:  20430.76133; grad/true_std13_train:  0.00277; grad/pseudo_std13_train:  4.98798; grad/diff13_train:  20422.18232; grad/cos13_train:  0.80809; grad/true_mag14_train:  11.71225; grad/pseudo_mag14_train:  20528.04482; grad/true_std14_train:  0.00286; grad/pseudo_std14_train:  5.01173; grad/diff14_train:  20518.53750; grad/cos14_train:  0.80761; grad/true_mag15_train:  8.07712; grad/pseudo_mag15_train:  20586.29263; grad/true_std15_train:  0.00197; grad/pseudo_std15_train:  5.02595; grad/diff15_train:  20579.63198; grad/cos15_train:  0.81379; grad/true_mag16_train:  9.50381; grad/pseudo_mag16_train:  20725.01177; grad/true_std16_train:  0.00232; grad/pseudo_std16_train:  5.05982; grad/diff16_train:  20717.31064; grad/cos16_train:  0.80437; grad/true_mag17_train:  11.94697; grad/pseudo_mag17_train:  20136.35254; grad/true_std17_train:  0.00292; grad/pseudo_std17_train:  4.91610; grad/diff17_train:  20127.30361; grad/cos17_train:  0.75166; grad_train:  1906.28735; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:33:05,836][trainer][INFO] - Step 30:
[2025-04-24 22:33:05,836][trainer][INFO] - loss/edit_train:  19.67924; loss/loc_train:  0.42221; edit/acc_train:  0.03333; edit/log_prob_train: -19.67924; edit/prob_train:  0.18150; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.00649; perplexity/pre_train:  54.95350; nll/post_train:  5.22773; perplexity/post_train:  186.36964; n_tokens/pre_train:  5.50000; n_tokens/post_train:  5.50000; time/edit_train:  0.19712; loss/total_train:  2.39013; loss/total_edit_train:  2.39013; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42645585920.00000; grad/true_mag0_train:  6.37022; grad/pseudo_mag0_train:  17336.14463; grad/true_std0_train:  0.00156; grad/pseudo_std0_train:  4.23245; grad/diff0_train:  17331.92363; grad/cos0_train:  0.66365; grad/true_mag1_train:  11.48939; grad/pseudo_mag1_train:  17332.95732; grad/true_std1_train:  0.00281; grad/pseudo_std1_train:  4.23168; grad/diff1_train:  17324.53047; grad/cos1_train:  0.73082; grad/true_mag2_train:  14.21564; grad/pseudo_mag2_train:  16818.67744; grad/true_std2_train:  0.00347; grad/pseudo_std2_train:  4.10611; grad/diff2_train:  16808.15840; grad/cos2_train:  0.73692; grad/true_mag3_train:  8.08424; grad/pseudo_mag3_train:  18882.12871; grad/true_std3_train:  0.00197; grad/pseudo_std3_train:  4.60989; grad/diff3_train:  18875.84033; grad/cos3_train:  0.77572; grad/true_mag4_train:  11.61650; grad/pseudo_mag4_train:  18708.45068; grad/true_std4_train:  0.00284; grad/pseudo_std4_train:  4.56749; grad/diff4_train:  18699.06650; grad/cos4_train:  0.80472; grad/true_mag5_train:  14.99068; grad/pseudo_mag5_train:  18651.11475; grad/true_std5_train:  0.00366; grad/pseudo_std5_train:  4.55349; grad/diff5_train:  18639.06592; grad/cos5_train:  0.79931; grad/true_mag6_train:  9.22514; grad/pseudo_mag6_train:  20344.50898; grad/true_std6_train:  0.00225; grad/pseudo_std6_train:  4.96692; grad/diff6_train:  20336.75625; grad/cos6_train:  0.83683; grad/true_mag7_train:  11.57493; grad/pseudo_mag7_train:  19990.86201; grad/true_std7_train:  0.00283; grad/pseudo_std7_train:  4.88058; grad/diff7_train:  19981.08545; grad/cos7_train:  0.84344; grad/true_mag8_train:  13.98953; grad/pseudo_mag8_train:  20358.51514; grad/true_std8_train:  0.00342; grad/pseudo_std8_train:  4.97034; grad/diff8_train:  20346.69014; grad/cos8_train:  0.84096; grad/true_mag9_train:  9.46456; grad/pseudo_mag9_train:  21267.61895; grad/true_std9_train:  0.00231; grad/pseudo_std9_train:  5.19229; grad/diff9_train:  21259.27744; grad/cos9_train:  0.88011; grad/true_mag10_train:  10.92117; grad/pseudo_mag10_train:  21172.99395; grad/true_std10_train:  0.00267; grad/pseudo_std10_train:  5.16919; grad/diff10_train:  21163.48594; grad/cos10_train:  0.86727; grad/true_mag11_train:  12.38729; grad/pseudo_mag11_train:  21940.91270; grad/true_std11_train:  0.00302; grad/pseudo_std11_train:  5.35667; grad/diff11_train:  21929.98818; grad/cos11_train:  0.87648; grad/true_mag12_train:  9.24106; grad/pseudo_mag12_train:  21591.16963; grad/true_std12_train:  0.00226; grad/pseudo_std12_train:  5.27128; grad/diff12_train:  21583.01436; grad/cos12_train:  0.87986; grad/true_mag13_train:  10.60097; grad/pseudo_mag13_train:  21512.91621; grad/true_std13_train:  0.00259; grad/pseudo_std13_train:  5.25218; grad/diff13_train:  21503.76230; grad/cos13_train:  0.86427; grad/true_mag14_train:  12.20226; grad/pseudo_mag14_train:  21636.65879; grad/true_std14_train:  0.00298; grad/pseudo_std14_train:  5.28239; grad/diff14_train:  21626.56045; grad/cos14_train:  0.82395; grad/true_mag15_train:  8.46414; grad/pseudo_mag15_train:  21450.91279; grad/true_std15_train:  0.00207; grad/pseudo_std15_train:  5.23704; grad/diff15_train:  21443.78828; grad/cos15_train:  0.83724; grad/true_mag16_train:  9.54964; grad/pseudo_mag16_train:  21478.37256; grad/true_std16_train:  0.00233; grad/pseudo_std16_train:  5.24374; grad/diff16_train:  21470.29326; grad/cos16_train:  0.84116; grad/true_mag17_train:  12.04093; grad/pseudo_mag17_train:  20815.21270; grad/true_std17_train:  0.00294; grad/pseudo_std17_train:  5.08184; grad/diff17_train:  20805.88652; grad/cos17_train:  0.77006; grad_train:  3112.94727; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:33:09,197][trainer][INFO] - Step 40:
[2025-04-24 22:33:09,197][trainer][INFO] - loss/edit_train:  16.97631; loss/loc_train:  0.36243; edit/acc_train:  0.00833; edit/log_prob_train: -16.97631; edit/prob_train:  0.18781; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.42987; perplexity/pre_train:  30.87273; nll/post_train:  3.73693; perplexity/post_train:  41.96911; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.18549; loss/total_train:  2.06006; loss/total_edit_train:  2.06006; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42645585920.00000; grad/true_mag0_train:  5.63487; grad/pseudo_mag0_train:  15735.32061; grad/true_std0_train:  0.00138; grad/pseudo_std0_train:  3.84163; grad/diff0_train:  15731.55762; grad/cos0_train:  0.66884; grad/true_mag1_train:  10.25309; grad/pseudo_mag1_train:  15855.98623; grad/true_std1_train:  0.00250; grad/pseudo_std1_train:  3.87109; grad/diff1_train:  15848.49053; grad/cos1_train:  0.72894; grad/true_mag2_train:  12.67798; grad/pseudo_mag2_train:  15585.83213; grad/true_std2_train:  0.00310; grad/pseudo_std2_train:  3.80511; grad/diff2_train:  15576.42246; grad/cos2_train:  0.73977; grad/true_mag3_train:  7.12843; grad/pseudo_mag3_train:  17492.29258; grad/true_std3_train:  0.00174; grad/pseudo_std3_train:  4.27058; grad/diff3_train:  17486.67422; grad/cos3_train:  0.78556; grad/true_mag4_train:  10.52046; grad/pseudo_mag4_train:  17437.62393; grad/true_std4_train:  0.00257; grad/pseudo_std4_train:  4.25723; grad/diff4_train:  17429.08711; grad/cos4_train:  0.80911; grad/true_mag5_train:  13.30202; grad/pseudo_mag5_train:  17429.19463; grad/true_std5_train:  0.00325; grad/pseudo_std5_train:  4.25516; grad/diff5_train:  17418.41582; grad/cos5_train:  0.80801; grad/true_mag6_train:  8.20670; grad/pseudo_mag6_train:  18699.41406; grad/true_std6_train:  0.00200; grad/pseudo_std6_train:  4.56529; grad/diff6_train:  18692.46445; grad/cos6_train:  0.84173; grad/true_mag7_train:  10.33887; grad/pseudo_mag7_train:  18642.42783; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  4.55137; grad/diff7_train:  18633.58779; grad/cos7_train:  0.85040; grad/true_mag8_train:  12.60257; grad/pseudo_mag8_train:  18967.19219; grad/true_std8_train:  0.00308; grad/pseudo_std8_train:  4.63066; grad/diff8_train:  18956.54229; grad/cos8_train:  0.83738; grad/true_mag9_train:  8.40584; grad/pseudo_mag9_train:  19639.42490; grad/true_std9_train:  0.00205; grad/pseudo_std9_train:  4.79478; grad/diff9_train:  19631.97754; grad/cos9_train:  0.88237; grad/true_mag10_train:  9.80506; grad/pseudo_mag10_train:  19605.83096; grad/true_std10_train:  0.00239; grad/pseudo_std10_train:  4.78658; grad/diff10_train:  19597.24854; grad/cos10_train:  0.86929; grad/true_mag11_train:  11.36310; grad/pseudo_mag11_train:  20792.28271; grad/true_std11_train:  0.00277; grad/pseudo_std11_train:  5.07624; grad/diff11_train:  20782.22090; grad/cos11_train:  0.87822; grad/true_mag12_train:  8.40970; grad/pseudo_mag12_train:  20261.35566; grad/true_std12_train:  0.00205; grad/pseudo_std12_train:  4.94662; grad/diff12_train:  20253.88262; grad/cos12_train:  0.88492; grad/true_mag13_train:  9.83432; grad/pseudo_mag13_train:  20296.43779; grad/true_std13_train:  0.00240; grad/pseudo_std13_train:  4.95518; grad/diff13_train:  20287.95547; grad/cos13_train:  0.85748; grad/true_mag14_train:  11.43942; grad/pseudo_mag14_train:  21102.16426; grad/true_std14_train:  0.00279; grad/pseudo_std14_train:  5.15189; grad/diff14_train:  21092.57402; grad/cos14_train:  0.82918; grad/true_mag15_train:  7.85004; grad/pseudo_mag15_train:  20798.44072; grad/true_std15_train:  0.00192; grad/pseudo_std15_train:  5.07774; grad/diff15_train:  20791.74043; grad/cos15_train:  0.84657; grad/true_mag16_train:  9.05549; grad/pseudo_mag16_train:  20953.56074; grad/true_std16_train:  0.00221; grad/pseudo_std16_train:  5.11562; grad/diff16_train:  20945.87334; grad/cos16_train:  0.84190; grad/true_mag17_train:  11.65484; grad/pseudo_mag17_train:  21055.24482; grad/true_std17_train:  0.00285; grad/pseudo_std17_train:  5.14043; grad/diff17_train:  21046.13066; grad/cos17_train:  0.77376; grad_train:  2818.05078; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00010; lr/lr16_train:  0.00010; lr/lr17_train:  0.00010
[2025-04-24 22:33:12,922][trainer][INFO] - Step 50:
[2025-04-24 22:33:12,922][trainer][INFO] - loss/edit_train:  16.47755; loss/loc_train:  0.19135; edit/acc_train:  0.03333; edit/log_prob_train: -16.47755; edit/prob_train:  0.22376; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.52281; perplexity/pre_train:  33.87955; nll/post_train:  4.05310; perplexity/post_train:  57.57550; n_tokens/pre_train:  8.60000; n_tokens/post_train:  8.60000; time/edit_train:  0.18122; loss/total_train:  1.83910; loss/total_edit_train:  1.83910; memory/alloc_max_train:  38614967808.00000; memory/res_max_train:  42664460288.00000; grad/true_mag0_train:  6.39721; grad/pseudo_mag0_train:  18673.83320; grad/true_std0_train:  0.00156; grad/pseudo_std0_train:  4.55902; grad/diff0_train:  18669.57939; grad/cos0_train:  0.66776; grad/true_mag1_train:  11.71765; grad/pseudo_mag1_train:  18489.53379; grad/true_std1_train:  0.00286; grad/pseudo_std1_train:  4.51404; grad/diff1_train:  18480.89951; grad/cos1_train:  0.73400; grad/true_mag2_train:  14.53303; grad/pseudo_mag2_train:  18322.95879; grad/true_std2_train:  0.00355; grad/pseudo_std2_train:  4.47332; grad/diff2_train:  18311.97920; grad/cos2_train:  0.75022; grad/true_mag3_train:  8.41930; grad/pseudo_mag3_train:  20358.72910; grad/true_std3_train:  0.00206; grad/pseudo_std3_train:  4.97039; grad/diff3_train:  20352.12480; grad/cos3_train:  0.77920; grad/true_mag4_train:  12.04394; grad/pseudo_mag4_train:  20234.55273; grad/true_std4_train:  0.00294; grad/pseudo_std4_train:  4.94007; grad/diff4_train:  20224.71377; grad/cos4_train:  0.80998; grad/true_mag5_train:  15.64169; grad/pseudo_mag5_train:  20251.28320; grad/true_std5_train:  0.00382; grad/pseudo_std5_train:  4.94414; grad/diff5_train:  20238.66367; grad/cos5_train:  0.79357; grad/true_mag6_train:  9.29293; grad/pseudo_mag6_train:  21127.37236; grad/true_std6_train:  0.00227; grad/pseudo_std6_train:  5.15805; grad/diff6_train:  21119.50898; grad/cos6_train:  0.84029; grad/true_mag7_train:  11.97698; grad/pseudo_mag7_train:  21272.67900; grad/true_std7_train:  0.00292; grad/pseudo_std7_train:  5.19352; grad/diff7_train:  21262.53848; grad/cos7_train:  0.84096; grad/true_mag8_train:  14.52284; grad/pseudo_mag8_train:  21502.64424; grad/true_std8_train:  0.00355; grad/pseudo_std8_train:  5.24966; grad/diff8_train:  21490.43545; grad/cos8_train:  0.82899; grad/true_mag9_train:  9.31921; grad/pseudo_mag9_train:  21708.48730; grad/true_std9_train:  0.00228; grad/pseudo_std9_train:  5.29992; grad/diff9_train:  21700.20234; grad/cos9_train:  0.88378; grad/true_mag10_train:  11.07040; grad/pseudo_mag10_train:  21801.53369; grad/true_std10_train:  0.00270; grad/pseudo_std10_train:  5.32264; grad/diff10_train:  21791.87988; grad/cos10_train:  0.86309; grad/true_mag11_train:  12.88594; grad/pseudo_mag11_train:  22813.03027; grad/true_std11_train:  0.00315; grad/pseudo_std11_train:  5.56958; grad/diff11_train:  22801.81250; grad/cos11_train:  0.85893; grad/true_mag12_train:  9.42121; grad/pseudo_mag12_train:  22348.87393; grad/true_std12_train:  0.00230; grad/pseudo_std12_train:  5.45627; grad/diff12_train:  22340.51250; grad/cos12_train:  0.88156; grad/true_mag13_train:  10.82627; grad/pseudo_mag13_train:  22309.33867; grad/true_std13_train:  0.00264; grad/pseudo_std13_train:  5.44661; grad/diff13_train:  22299.88457; grad/cos13_train:  0.86631; grad/true_mag14_train:  12.66861; grad/pseudo_mag14_train:  22825.52559; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  5.57264; grad/diff14_train:  22815.00557; grad/cos14_train:  0.81973; grad/true_mag15_train:  8.68732; grad/pseudo_mag15_train:  22399.55410; grad/true_std15_train:  0.00212; grad/pseudo_std15_train:  5.46864; grad/diff15_train:  22392.18330; grad/cos15_train:  0.83850; grad/true_mag16_train:  10.30057; grad/pseudo_mag16_train:  22676.39443; grad/true_std16_train:  0.00251; grad/pseudo_std16_train:  5.53623; grad/diff16_train:  22667.76006; grad/cos16_train:  0.82986; grad/true_mag17_train:  12.90394; grad/pseudo_mag17_train:  22619.05332; grad/true_std17_train:  0.00315; grad/pseudo_std17_train:  5.52222; grad/diff17_train:  22609.04834; grad/cos17_train:  0.76557; grad_train:  2185.91846; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00010; lr/lr3_train:  0.00010; lr/lr4_train:  0.00010; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00010; lr/lr8_train:  0.00010; lr/lr9_train:  0.00010; lr/lr10_train:  0.00010; lr/lr11_train:  0.00010; lr/lr12_train:  0.00010; lr/lr13_train:  0.00010; lr/lr14_train:  0.00010; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:16,424][trainer][INFO] - Step 60:
[2025-04-24 22:33:16,424][trainer][INFO] - loss/edit_train:  13.65413; loss/loc_train:  0.30197; edit/acc_train:  0.01067; edit/log_prob_train: -13.65413; edit/prob_train:  0.21033; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.67617; perplexity/pre_train:  107.35838; nll/post_train:  5.23025; perplexity/post_train:  186.83919; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18664; loss/total_train:  1.66738; loss/total_edit_train:  1.66738; memory/alloc_max_train:  38769319219.20000; memory/res_max_train:  43614050713.60000; grad/true_mag0_train:  6.25695; grad/pseudo_mag0_train:  17786.19727; grad/true_std0_train:  0.00153; grad/pseudo_std0_train:  4.34232; grad/diff0_train:  17781.98486; grad/cos0_train:  0.67282; grad/true_mag1_train:  11.31262; grad/pseudo_mag1_train:  17907.91670; grad/true_std1_train:  0.00276; grad/pseudo_std1_train:  4.37204; grad/diff1_train:  17899.51523; grad/cos1_train:  0.74181; grad/true_mag2_train:  14.21937; grad/pseudo_mag2_train:  17627.49443; grad/true_std2_train:  0.00347; grad/pseudo_std2_train:  4.30348; grad/diff2_train:  17616.80537; grad/cos2_train:  0.75068; grad/true_mag3_train:  8.30513; grad/pseudo_mag3_train:  20124.50469; grad/true_std3_train:  0.00203; grad/pseudo_std3_train:  4.91320; grad/diff3_train:  20117.92852; grad/cos3_train:  0.79178; grad/true_mag4_train:  11.93655; grad/pseudo_mag4_train:  20121.43691; grad/true_std4_train:  0.00291; grad/pseudo_std4_train:  4.91245; grad/diff4_train:  20111.60908; grad/cos4_train:  0.82280; grad/true_mag5_train:  15.44799; grad/pseudo_mag5_train:  19892.77266; grad/true_std5_train:  0.00377; grad/pseudo_std5_train:  4.85658; grad/diff5_train:  19880.20703; grad/cos5_train:  0.81264; grad/true_mag6_train:  9.49216; grad/pseudo_mag6_train:  21624.93633; grad/true_std6_train:  0.00232; grad/pseudo_std6_train:  5.27952; grad/diff6_train:  21616.71934; grad/cos6_train:  0.86456; grad/true_mag7_train:  11.99612; grad/pseudo_mag7_train:  21638.57266; grad/true_std7_train:  0.00293; grad/pseudo_std7_train:  5.28285; grad/diff7_train:  21628.14980; grad/cos7_train:  0.86809; grad/true_mag8_train:  14.75960; grad/pseudo_mag8_train:  21894.29668; grad/true_std8_train:  0.00360; grad/pseudo_std8_train:  5.34527; grad/diff8_train:  21881.62383; grad/cos8_train:  0.85760; grad/true_mag9_train:  9.93243; grad/pseudo_mag9_train:  22852.18535; grad/true_std9_train:  0.00242; grad/pseudo_std9_train:  5.57915; grad/diff9_train:  22843.25273; grad/cos9_train:  0.89903; grad/true_mag10_train:  11.46877; grad/pseudo_mag10_train:  22810.28711; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  5.56891; grad/diff10_train:  22800.09043; grad/cos10_train:  0.88864; grad/true_mag11_train:  13.13639; grad/pseudo_mag11_train:  23483.30664; grad/true_std11_train:  0.00321; grad/pseudo_std11_train:  5.73322; grad/diff11_train:  23471.65254; grad/cos11_train:  0.88653; grad/true_mag12_train:  9.94046; grad/pseudo_mag12_train:  23141.01543; grad/true_std12_train:  0.00243; grad/pseudo_std12_train:  5.64966; grad/diff12_train:  23132.12461; grad/cos12_train:  0.89411; grad/true_mag13_train:  11.10375; grad/pseudo_mag13_train:  22992.39277; grad/true_std13_train:  0.00271; grad/pseudo_std13_train:  5.61338; grad/diff13_train:  22982.52598; grad/cos13_train:  0.88791; grad/true_mag14_train:  12.98357; grad/pseudo_mag14_train:  23273.13828; grad/true_std14_train:  0.00317; grad/pseudo_std14_train:  5.68191; grad/diff14_train:  23262.29082; grad/cos14_train:  0.83448; grad/true_mag15_train:  8.93885; grad/pseudo_mag15_train:  23115.44121; grad/true_std15_train:  0.00218; grad/pseudo_std15_train:  5.64342; grad/diff15_train:  23107.70117; grad/cos15_train:  0.86513; grad/true_mag16_train:  10.07053; grad/pseudo_mag16_train:  22744.83262; grad/true_std16_train:  0.00246; grad/pseudo_std16_train:  5.55294; grad/diff16_train:  22736.15723; grad/cos16_train:  0.86068; grad/true_mag17_train:  12.96253; grad/pseudo_mag17_train:  22720.29453; grad/true_std17_train:  0.00316; grad/pseudo_std17_train:  5.54693; grad/diff17_train:  22710.16309; grad/cos17_train:  0.78073; grad_train:  3234.94507; lr/lr0_train:  0.00010; lr/lr1_train:  0.00010; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00010; lr/lr6_train:  0.00010; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:19,852][trainer][INFO] - Step 70:
[2025-04-24 22:33:19,853][trainer][INFO] - loss/edit_train:  13.88799; loss/loc_train:  0.51833; edit/acc_train:  0.01429; edit/log_prob_train: -13.88799; edit/prob_train:  0.14912; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.53009; perplexity/pre_train:  252.16556; nll/post_train:  6.43097; perplexity/post_train:  620.77875; n_tokens/pre_train:  4.10000; n_tokens/post_train:  4.10000; time/edit_train:  0.18868; loss/total_train:  1.90713; loss/total_edit_train:  1.90713; memory/alloc_max_train:  38872220160.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  6.26429; grad/pseudo_mag0_train:  18029.30107; grad/true_std0_train:  0.00153; grad/pseudo_std0_train:  4.40167; grad/diff0_train:  18025.11816; grad/cos0_train:  0.67006; grad/true_mag1_train:  11.37480; grad/pseudo_mag1_train:  17862.09785; grad/true_std1_train:  0.00278; grad/pseudo_std1_train:  4.36085; grad/diff1_train:  17853.68633; grad/cos1_train:  0.73903; grad/true_mag2_train:  14.38420; grad/pseudo_mag2_train:  17557.80234; grad/true_std2_train:  0.00351; grad/pseudo_std2_train:  4.28650; grad/diff2_train:  17547.00352; grad/cos2_train:  0.74978; grad/true_mag3_train:  8.41299; grad/pseudo_mag3_train:  20453.32412; grad/true_std3_train:  0.00205; grad/pseudo_std3_train:  4.99348; grad/diff3_train:  20446.57949; grad/cos3_train:  0.79969; grad/true_mag4_train:  11.99439; grad/pseudo_mag4_train:  20182.76035; grad/true_std4_train:  0.00293; grad/pseudo_std4_train:  4.92742; grad/diff4_train:  20172.82334; grad/cos4_train:  0.82581; grad/true_mag5_train:  15.00739; grad/pseudo_mag5_train:  19887.91973; grad/true_std5_train:  0.00366; grad/pseudo_std5_train:  4.85542; grad/diff5_train:  19875.45430; grad/cos5_train:  0.82732; grad/true_mag6_train:  9.49451; grad/pseudo_mag6_train:  21513.68721; grad/true_std6_train:  0.00232; grad/pseudo_std6_train:  5.25236; grad/diff6_train:  21505.48447; grad/cos6_train:  0.86181; grad/true_mag7_train:  11.98322; grad/pseudo_mag7_train:  21321.56006; grad/true_std7_train:  0.00293; grad/pseudo_std7_train:  5.20546; grad/diff7_train:  21311.15713; grad/cos7_train:  0.86574; grad/true_mag8_train:  14.49770; grad/pseudo_mag8_train:  21753.66943; grad/true_std8_train:  0.00354; grad/pseudo_std8_train:  5.31094; grad/diff8_train:  21741.09229; grad/cos8_train:  0.86192; grad/true_mag9_train:  9.82780; grad/pseudo_mag9_train:  22419.53467; grad/true_std9_train:  0.00240; grad/pseudo_std9_train:  5.47352; grad/diff9_train:  22410.68682; grad/cos9_train:  0.89777; grad/true_mag10_train:  11.48742; grad/pseudo_mag10_train:  22216.48457; grad/true_std10_train:  0.00280; grad/pseudo_std10_train:  5.42394; grad/diff10_train:  22206.30469; grad/cos10_train:  0.88470; grad/true_mag11_train:  12.98943; grad/pseudo_mag11_train:  23110.84551; grad/true_std11_train:  0.00317; grad/pseudo_std11_train:  5.64229; grad/diff11_train:  23099.17139; grad/cos11_train:  0.89474; grad/true_mag12_train:  9.67661; grad/pseudo_mag12_train:  22495.16582; grad/true_std12_train:  0.00236; grad/pseudo_std12_train:  5.49198; grad/diff12_train:  22486.46992; grad/cos12_train:  0.89560; grad/true_mag13_train:  11.23703; grad/pseudo_mag13_train:  22542.18760; grad/true_std13_train:  0.00274; grad/pseudo_std13_train:  5.50346; grad/diff13_train:  22532.34023; grad/cos13_train:  0.87579; grad/true_mag14_train:  12.64882; grad/pseudo_mag14_train:  22685.62305; grad/true_std14_train:  0.00309; grad/pseudo_std14_train:  5.53848; grad/diff14_train:  22674.82080; grad/cos14_train:  0.84888; grad/true_mag15_train:  8.72269; grad/pseudo_mag15_train:  22353.33516; grad/true_std15_train:  0.00213; grad/pseudo_std15_train:  5.45736; grad/diff15_train:  22345.78311; grad/cos15_train:  0.86148; grad/true_mag16_train:  9.88570; grad/pseudo_mag16_train:  22112.32812; grad/true_std16_train:  0.00241; grad/pseudo_std16_train:  5.39852; grad/diff16_train:  22103.82783; grad/cos16_train:  0.85598; grad/true_mag17_train:  12.35220; grad/pseudo_mag17_train:  21507.92910; grad/true_std17_train:  0.00302; grad/pseudo_std17_train:  5.25094; grad/diff17_train:  21498.22295; grad/cos17_train:  0.78021; grad_train:  3431.65332; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:23,712][trainer][INFO] - Step 80:
[2025-04-24 22:33:23,712][trainer][INFO] - loss/edit_train:  12.16242; loss/loc_train:  0.18168; edit/acc_train:  0.03750; edit/log_prob_train: -12.16242; edit/prob_train:  0.26659; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.14435; perplexity/pre_train:  63.07663; nll/post_train:  4.83382; perplexity/post_train:  125.69032; n_tokens/pre_train:  6.10000; n_tokens/post_train:  6.10000; time/edit_train:  0.23343; loss/total_train:  1.39792; loss/total_edit_train:  1.39792; memory/alloc_max_train:  38872220160.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  6.30126; grad/pseudo_mag0_train:  17615.98311; grad/true_std0_train:  0.00154; grad/pseudo_std0_train:  4.30073; grad/diff0_train:  17611.75068; grad/cos0_train:  0.67373; grad/true_mag1_train:  11.55754; grad/pseudo_mag1_train:  17479.62773; grad/true_std1_train:  0.00282; grad/pseudo_std1_train:  4.26746; grad/diff1_train:  17471.12832; grad/cos1_train:  0.73492; grad/true_mag2_train:  14.26567; grad/pseudo_mag2_train:  17246.22285; grad/true_std2_train:  0.00348; grad/pseudo_std2_train:  4.21025; grad/diff2_train:  17235.50273; grad/cos2_train:  0.74741; grad/true_mag3_train:  8.44662; grad/pseudo_mag3_train:  19896.46279; grad/true_std3_train:  0.00206; grad/pseudo_std3_train:  4.85752; grad/diff3_train:  19889.66855; grad/cos3_train:  0.79967; grad/true_mag4_train:  12.08277; grad/pseudo_mag4_train:  19731.51582; grad/true_std4_train:  0.00295; grad/pseudo_std4_train:  4.81725; grad/diff4_train:  19721.57285; grad/cos4_train:  0.81877; grad/true_mag5_train:  15.50622; grad/pseudo_mag5_train:  19914.43711; grad/true_std5_train:  0.00379; grad/pseudo_std5_train:  4.86179; grad/diff5_train:  19901.61562; grad/cos5_train:  0.81929; grad/true_mag6_train:  9.54824; grad/pseudo_mag6_train:  20897.28018; grad/true_std6_train:  0.00233; grad/pseudo_std6_train:  5.10187; grad/diff6_train:  20889.05459; grad/cos6_train:  0.85501; grad/true_mag7_train:  11.82554; grad/pseudo_mag7_train:  20608.29463; grad/true_std7_train:  0.00289; grad/pseudo_std7_train:  5.03131; grad/diff7_train:  20598.00068; grad/cos7_train:  0.86424; grad/true_mag8_train:  14.37261; grad/pseudo_mag8_train:  21048.25898; grad/true_std8_train:  0.00351; grad/pseudo_std8_train:  5.13868; grad/diff8_train:  21035.93916; grad/cos8_train:  0.84670; grad/true_mag9_train:  9.59760; grad/pseudo_mag9_train:  21370.13579; grad/true_std9_train:  0.00234; grad/pseudo_std9_train:  5.21732; grad/diff9_train:  21361.49956; grad/cos9_train:  0.89360; grad/true_mag10_train:  11.19550; grad/pseudo_mag10_train:  21346.05459; grad/true_std10_train:  0.00273; grad/pseudo_std10_train:  5.21144; grad/diff10_train:  21336.11357; grad/cos10_train:  0.88023; grad/true_mag11_train:  12.83019; grad/pseudo_mag11_train:  22483.60601; grad/true_std11_train:  0.00313; grad/pseudo_std11_train:  5.48915; grad/diff11_train:  22472.16177; grad/cos11_train:  0.87922; grad/true_mag12_train:  9.55544; grad/pseudo_mag12_train:  21676.17095; grad/true_std12_train:  0.00233; grad/pseudo_std12_train:  5.29203; grad/diff12_train:  21667.59424; grad/cos12_train:  0.88949; grad/true_mag13_train:  10.99986; grad/pseudo_mag13_train:  21776.98545; grad/true_std13_train:  0.00269; grad/pseudo_std13_train:  5.31664; grad/diff13_train:  21767.23984; grad/cos13_train:  0.87894; grad/true_mag14_train:  12.75795; grad/pseudo_mag14_train:  22170.80635; grad/true_std14_train:  0.00311; grad/pseudo_std14_train:  5.41278; grad/diff14_train:  22160.08594; grad/cos14_train:  0.82969; grad/true_mag15_train:  8.63944; grad/pseudo_mag15_train:  21592.62559; grad/true_std15_train:  0.00211; grad/pseudo_std15_train:  5.27163; grad/diff15_train:  21585.17334; grad/cos15_train:  0.85237; grad/true_mag16_train:  10.06252; grad/pseudo_mag16_train:  21777.28945; grad/true_std16_train:  0.00246; grad/pseudo_std16_train:  5.31672; grad/diff16_train:  21768.66660; grad/cos16_train:  0.84800; grad/true_mag17_train:  12.61364; grad/pseudo_mag17_train:  21438.34561; grad/true_std17_train:  0.00308; grad/pseudo_std17_train:  5.23394; grad/diff17_train:  21428.55508; grad/cos17_train:  0.76577; grad_train:  1612.95935; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:27,027][trainer][INFO] - Step 90:
[2025-04-24 22:33:27,028][trainer][INFO] - loss/edit_train:  11.78892; loss/loc_train:  0.16183; edit/acc_train:  0.01944; edit/log_prob_train: -11.78892; edit/prob_train:  0.26342; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.30322; perplexity/pre_train:  73.93774; nll/post_train:  4.63013; perplexity/post_train:  102.52711; n_tokens/pre_train:  5.20000; n_tokens/post_train:  5.20000; time/edit_train:  0.18079; loss/total_train:  1.34072; loss/total_edit_train:  1.34072; memory/alloc_max_train:  38872220160.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  6.25501; grad/pseudo_mag0_train:  16955.63076; grad/true_std0_train:  0.00153; grad/pseudo_std0_train:  4.13947; grad/diff0_train:  16951.48125; grad/cos0_train:  0.66683; grad/true_mag1_train:  11.19793; grad/pseudo_mag1_train:  16478.32607; grad/true_std1_train:  0.00273; grad/pseudo_std1_train:  4.02298; grad/diff1_train:  16470.19316; grad/cos1_train:  0.72506; grad/true_mag2_train:  13.93944; grad/pseudo_mag2_train:  16079.87227; grad/true_std2_train:  0.00340; grad/pseudo_std2_train:  3.92540; grad/diff2_train:  16069.57783; grad/cos2_train:  0.73406; grad/true_mag3_train:  7.92502; grad/pseudo_mag3_train:  17367.01348; grad/true_std3_train:  0.00193; grad/pseudo_std3_train:  4.23997; grad/diff3_train:  17360.76865; grad/cos3_train:  0.78519; grad/true_mag4_train:  11.46195; grad/pseudo_mag4_train:  17810.84941; grad/true_std4_train:  0.00280; grad/pseudo_std4_train:  4.34832; grad/diff4_train:  17801.55264; grad/cos4_train:  0.80704; grad/true_mag5_train:  14.73349; grad/pseudo_mag5_train:  17985.67002; grad/true_std5_train:  0.00360; grad/pseudo_std5_train:  4.39086; grad/diff5_train:  17973.62842; grad/cos5_train:  0.80999; grad/true_mag6_train:  8.79260; grad/pseudo_mag6_train:  18632.40459; grad/true_std6_train:  0.00215; grad/pseudo_std6_train:  4.54892; grad/diff6_train:  18624.86816; grad/cos6_train:  0.85167; grad/true_mag7_train:  11.46164; grad/pseudo_mag7_train:  18875.31689; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  4.60822; grad/diff7_train:  18865.58789; grad/cos7_train:  0.84261; grad/true_mag8_train:  13.79511; grad/pseudo_mag8_train:  19386.50059; grad/true_std8_train:  0.00337; grad/pseudo_std8_train:  4.73295; grad/diff8_train:  19374.93193; grad/cos8_train:  0.82611; grad/true_mag9_train:  8.94687; grad/pseudo_mag9_train:  19251.76230; grad/true_std9_train:  0.00218; grad/pseudo_std9_train:  4.70013; grad/diff9_train:  19243.78467; grad/cos9_train:  0.88744; grad/true_mag10_train:  10.70239; grad/pseudo_mag10_train:  19393.25205; grad/true_std10_train:  0.00261; grad/pseudo_std10_train:  4.73467; grad/diff10_train:  19383.93301; grad/cos10_train:  0.86316; grad/true_mag11_train:  12.44297; grad/pseudo_mag11_train:  20528.78574; grad/true_std11_train:  0.00304; grad/pseudo_std11_train:  5.01189; grad/diff11_train:  20517.96807; grad/cos11_train:  0.85776; grad/true_mag12_train:  8.92456; grad/pseudo_mag12_train:  19761.35361; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  4.82455; grad/diff12_train:  19753.39199; grad/cos12_train:  0.88553; grad/true_mag13_train:  10.32364; grad/pseudo_mag13_train:  20004.41494; grad/true_std13_train:  0.00252; grad/pseudo_std13_train:  4.88389; grad/diff13_train:  19995.31035; grad/cos13_train:  0.87440; grad/true_mag14_train:  12.46134; grad/pseudo_mag14_train:  20525.00908; grad/true_std14_train:  0.00304; grad/pseudo_std14_train:  5.01097; grad/diff14_train:  20514.88477; grad/cos14_train:  0.79865; grad/true_mag15_train:  8.24398; grad/pseudo_mag15_train:  19894.92354; grad/true_std15_train:  0.00201; grad/pseudo_std15_train:  4.85716; grad/diff15_train:  19887.95010; grad/cos15_train:  0.83554; grad/true_mag16_train:  9.49831; grad/pseudo_mag16_train:  20150.54121; grad/true_std16_train:  0.00232; grad/pseudo_std16_train:  4.91956; grad/diff16_train:  20142.47891; grad/cos16_train:  0.83937; grad/true_mag17_train:  12.66378; grad/pseudo_mag17_train:  20419.04697; grad/true_std17_train:  0.00309; grad/pseudo_std17_train:  4.98507; grad/diff17_train:  20409.55527; grad/cos17_train:  0.73802; grad_train:  1709.62878; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:30,343][trainer][INFO] - Step 100:
[2025-04-24 22:33:30,344][trainer][INFO] - loss/edit_train:  8.99629; loss/loc_train:  0.20505; edit/acc_train:  0.06338; edit/log_prob_train: -8.99629; edit/prob_train:  0.30763; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.17212; perplexity/pre_train:  64.85285; nll/post_train:  4.70746; perplexity/post_train:  110.77032; n_tokens/pre_train:  4.40000; n_tokens/post_train:  4.40000; time/edit_train:  0.18581; loss/total_train:  1.10468; loss/total_edit_train:  1.10468; memory/alloc_max_train:  39979202457.60000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  6.40660; grad/pseudo_mag0_train:  18266.28848; grad/true_std0_train:  0.00156; grad/pseudo_std0_train:  4.45950; grad/diff0_train:  18261.97598; grad/cos0_train:  0.67329; grad/true_mag1_train:  11.24566; grad/pseudo_mag1_train:  17449.50801; grad/true_std1_train:  0.00275; grad/pseudo_std1_train:  4.26011; grad/diff1_train:  17441.19404; grad/cos1_train:  0.73872; grad/true_mag2_train:  13.80964; grad/pseudo_mag2_train:  17223.90215; grad/true_std2_train:  0.00337; grad/pseudo_std2_train:  4.20470; grad/diff2_train:  17213.45195; grad/cos2_train:  0.75577; grad/true_mag3_train:  8.19564; grad/pseudo_mag3_train:  19525.18203; grad/true_std3_train:  0.00200; grad/pseudo_std3_train:  4.76688; grad/diff3_train:  19518.58682; grad/cos3_train:  0.80184; grad/true_mag4_train:  11.72115; grad/pseudo_mag4_train:  19143.71553; grad/true_std4_train:  0.00286; grad/pseudo_std4_train:  4.67373; grad/diff4_train:  19134.07432; grad/cos4_train:  0.82026; grad/true_mag5_train:  15.30408; grad/pseudo_mag5_train:  19337.72080; grad/true_std5_train:  0.00374; grad/pseudo_std5_train:  4.72093; grad/diff5_train:  19325.21270; grad/cos5_train:  0.81578; grad/true_mag6_train:  9.28177; grad/pseudo_mag6_train:  20763.51582; grad/true_std6_train:  0.00227; grad/pseudo_std6_train:  5.06922; grad/diff6_train:  20755.44404; grad/cos6_train:  0.86663; grad/true_mag7_train:  11.51739; grad/pseudo_mag7_train:  20266.46621; grad/true_std7_train:  0.00281; grad/pseudo_std7_train:  4.94786; grad/diff7_train:  20256.44473; grad/cos7_train:  0.86741; grad/true_mag8_train:  13.83086; grad/pseudo_mag8_train:  20712.61406; grad/true_std8_train:  0.00338; grad/pseudo_std8_train:  5.05670; grad/diff8_train:  20700.59951; grad/cos8_train:  0.86378; grad/true_mag9_train:  9.21072; grad/pseudo_mag9_train:  20875.72187; grad/true_std9_train:  0.00225; grad/pseudo_std9_train:  5.09661; grad/diff9_train:  20867.40010; grad/cos9_train:  0.90170; grad/true_mag10_train:  10.72946; grad/pseudo_mag10_train:  20802.43398; grad/true_std10_train:  0.00262; grad/pseudo_std10_train:  5.07872; grad/diff10_train:  20792.85869; grad/cos10_train:  0.88950; grad/true_mag11_train:  12.40243; grad/pseudo_mag11_train:  21582.51504; grad/true_std11_train:  0.00303; grad/pseudo_std11_train:  5.26915; grad/diff11_train:  21571.43760; grad/cos11_train:  0.88908; grad/true_mag12_train:  8.89921; grad/pseudo_mag12_train:  20598.06123; grad/true_std12_train:  0.00217; grad/pseudo_std12_train:  5.02882; grad/diff12_train:  20590.03018; grad/cos12_train:  0.89900; grad/true_mag13_train:  10.15678; grad/pseudo_mag13_train:  20578.22939; grad/true_std13_train:  0.00248; grad/pseudo_std13_train:  5.02398; grad/diff13_train:  20569.13809; grad/cos13_train:  0.89137; grad/true_mag14_train:  12.11738; grad/pseudo_mag14_train:  21140.02275; grad/true_std14_train:  0.00296; grad/pseudo_std14_train:  5.16112; grad/diff14_train:  21129.80244; grad/cos14_train:  0.83696; grad/true_mag15_train:  8.12529; grad/pseudo_mag15_train:  20726.00156; grad/true_std15_train:  0.00198; grad/pseudo_std15_train:  5.06006; grad/diff15_train:  20718.97725; grad/cos15_train:  0.85757; grad/true_mag16_train:  9.38644; grad/pseudo_mag16_train:  20811.72256; grad/true_std16_train:  0.00229; grad/pseudo_std16_train:  5.08098; grad/diff16_train:  20803.60342; grad/cos16_train:  0.85911; grad/true_mag17_train:  11.76892; grad/pseudo_mag17_train:  20280.18037; grad/true_std17_train:  0.00287; grad/pseudo_std17_train:  4.95117; grad/diff17_train:  20270.95566; grad/cos17_train:  0.77726; grad_train:  2123.53174; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:33:49,235][trainer][INFO] - Step 100:
[2025-04-24 22:33:49,235][trainer][INFO] - loss/edit_val:  12.70822; loss/loc_val:  0.25195; edit/acc_val:  0.01103; edit/log_prob_val: -12.70822; edit/prob_val:  0.21998; acc/pre_val:  0.00000; acc/post_val:  0.00000; nll/pre_val:  4.32757; perplexity/pre_val:  75.75970; nll/post_val:  4.93080; perplexity/post_val:  138.49037; n_tokens/pre_val:  19.74000; n_tokens/post_val:  19.74000; time/edit_val:  0.11338; loss/total_val:  1.52277; loss/total_edit_val:  1.52277; memory/alloc_max_val:  41023668736.00000; memory/res_max_val:  43719327744.00000; eval_time/elapsed:  18.88682; eval_time/average:  0.18887
[2025-04-24 22:33:49,239][trainer][INFO] - Saving model to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-31-48_3849324322/models/Llama-3.2-1B-eos-sft.2025-04-24_22-31-48_3849324322
[2025-04-24 22:33:49,239][trainer][INFO] - Moving old archive to /work/09636/zyliu/vista/mend/outputs/2025-04-24_22-31-48_3849324322/models/Llama-3.2-1B-eos-sft.2025-04-24_22-31-48_3849324322.bk
[2025-04-24 22:34:43,397][trainer][INFO] - Write complete.
[2025-04-24 22:34:46,771][trainer][INFO] - Step 110:
[2025-04-24 22:34:46,772][trainer][INFO] - loss/edit_train:  15.62969; loss/loc_train:  0.10581; edit/acc_train:  0.02500; edit/log_prob_train: -15.62969; edit/prob_train:  0.21528; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  5.55557; perplexity/pre_train:  258.67560; nll/post_train:  5.82474; perplexity/post_train:  338.57251; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.19949; loss/total_train:  1.66878; loss/total_edit_train:  1.66878; memory/alloc_max_train:  41023668736.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  5.42225; grad/pseudo_mag0_train:  16036.51348; grad/true_std0_train:  0.00132; grad/pseudo_std0_train:  3.91511; grad/diff0_train:  16032.86436; grad/cos0_train:  0.67281; grad/true_mag1_train:  9.82161; grad/pseudo_mag1_train:  15731.68066; grad/true_std1_train:  0.00240; grad/pseudo_std1_train:  3.84071; grad/diff1_train:  15724.51826; grad/cos1_train:  0.72730; grad/true_mag2_train:  12.16555; grad/pseudo_mag2_train:  15069.89883; grad/true_std2_train:  0.00297; grad/pseudo_std2_train:  3.67864; grad/diff2_train:  15061.01426; grad/cos2_train:  0.72534; grad/true_mag3_train:  6.86231; grad/pseudo_mag3_train:  16278.77129; grad/true_std3_train:  0.00168; grad/pseudo_std3_train:  3.97429; grad/diff3_train:  16273.33350; grad/cos3_train:  0.78925; grad/true_mag4_train:  10.14312; grad/pseudo_mag4_train:  16847.63418; grad/true_std4_train:  0.00248; grad/pseudo_std4_train:  4.11316; grad/diff4_train:  16839.40703; grad/cos4_train:  0.80760; grad/true_mag5_train:  12.64728; grad/pseudo_mag5_train:  16483.00254; grad/true_std5_train:  0.00309; grad/pseudo_std5_train:  4.02386; grad/diff5_train:  16472.84404; grad/cos5_train:  0.79796; grad/true_mag6_train:  7.56835; grad/pseudo_mag6_train:  16908.52959; grad/true_std6_train:  0.00185; grad/pseudo_std6_train:  4.12805; grad/diff6_train:  16902.03447; grad/cos6_train:  0.85426; grad/true_mag7_train:  9.91042; grad/pseudo_mag7_train:  17113.19814; grad/true_std7_train:  0.00242; grad/pseudo_std7_train:  4.17802; grad/diff7_train:  17104.78086; grad/cos7_train:  0.84667; grad/true_mag8_train:  12.27957; grad/pseudo_mag8_train:  17410.68701; grad/true_std8_train:  0.00300; grad/pseudo_std8_train:  4.25052; grad/diff8_train:  17400.60908; grad/cos8_train:  0.81485; grad/true_mag9_train:  7.66842; grad/pseudo_mag9_train:  17478.45937; grad/true_std9_train:  0.00187; grad/pseudo_std9_train:  4.26720; grad/diff9_train:  17471.60664; grad/cos9_train:  0.89027; grad/true_mag10_train:  9.07072; grad/pseudo_mag10_train:  17508.67246; grad/true_std10_train:  0.00221; grad/pseudo_std10_train:  4.27457; grad/diff10_train:  17500.71455; grad/cos10_train:  0.87357; grad/true_mag11_train:  10.51039; grad/pseudo_mag11_train:  18292.45283; grad/true_std11_train:  0.00257; grad/pseudo_std11_train:  4.46589; grad/diff11_train:  18283.32617; grad/cos11_train:  0.86209; grad/true_mag12_train:  7.67656; grad/pseudo_mag12_train:  17947.97480; grad/true_std12_train:  0.00187; grad/pseudo_std12_train:  4.38182; grad/diff12_train:  17941.12568; grad/cos12_train:  0.88818; grad/true_mag13_train:  8.84727; grad/pseudo_mag13_train:  17977.19678; grad/true_std13_train:  0.00216; grad/pseudo_std13_train:  4.38896; grad/diff13_train:  17969.38105; grad/cos13_train:  0.87949; grad/true_mag14_train:  10.77061; grad/pseudo_mag14_train:  18649.32168; grad/true_std14_train:  0.00263; grad/pseudo_std14_train:  4.55302; grad/diff14_train:  18640.50010; grad/cos14_train:  0.81541; grad/true_mag15_train:  7.18052; grad/pseudo_mag15_train:  18612.14072; grad/true_std15_train:  0.00175; grad/pseudo_std15_train:  4.54397; grad/diff15_train:  18605.99170; grad/cos15_train:  0.85226; grad/true_mag16_train:  8.52644; grad/pseudo_mag16_train:  19082.97676; grad/true_std16_train:  0.00208; grad/pseudo_std16_train:  4.65892; grad/diff16_train:  19075.63232; grad/cos16_train:  0.85691; grad/true_mag17_train:  10.90326; grad/pseudo_mag17_train:  18683.68643; grad/true_std17_train:  0.00266; grad/pseudo_std17_train:  4.56137; grad/diff17_train:  18675.33428; grad/cos17_train:  0.76084; grad_train:  2048.11084; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:34:50,031][trainer][INFO] - Step 120:
[2025-04-24 22:34:50,032][trainer][INFO] - loss/edit_train:  13.32747; loss/loc_train:  0.15082; edit/acc_train:  0.03250; edit/log_prob_train: -13.32747; edit/prob_train:  0.27905; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.45123; perplexity/pre_train:  85.73236; nll/post_train:  5.30861; perplexity/post_train:  202.06902; n_tokens/pre_train:  6.80000; n_tokens/post_train:  6.80000; time/edit_train:  0.18432; loss/total_train:  1.48357; loss/total_edit_train:  1.48357; memory/alloc_max_train:  41023668736.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  5.74811; grad/pseudo_mag0_train:  16062.75576; grad/true_std0_train:  0.00140; grad/pseudo_std0_train:  3.92151; grad/diff0_train:  16058.88594; grad/cos0_train:  0.67405; grad/true_mag1_train:  10.33508; grad/pseudo_mag1_train:  15879.62158; grad/true_std1_train:  0.00252; grad/pseudo_std1_train:  3.87683; grad/diff1_train:  15872.06426; grad/cos1_train:  0.73017; grad/true_mag2_train:  12.88497; grad/pseudo_mag2_train:  15619.64014; grad/true_std2_train:  0.00315; grad/pseudo_std2_train:  3.81277; grad/diff2_train:  15610.13564; grad/cos2_train:  0.73299; grad/true_mag3_train:  7.35684; grad/pseudo_mag3_train:  17737.98223; grad/true_std3_train:  0.00180; grad/pseudo_std3_train:  4.33053; grad/diff3_train:  17732.09453; grad/cos3_train:  0.79504; grad/true_mag4_train:  10.49791; grad/pseudo_mag4_train:  17405.14297; grad/true_std4_train:  0.00256; grad/pseudo_std4_train:  4.24926; grad/diff4_train:  17396.56670; grad/cos4_train:  0.81058; grad/true_mag5_train:  13.27990; grad/pseudo_mag5_train:  17292.30820; grad/true_std5_train:  0.00324; grad/pseudo_std5_train:  4.22143; grad/diff5_train:  17281.51279; grad/cos5_train:  0.80513; grad/true_mag6_train:  8.16061; grad/pseudo_mag6_train:  18233.50430; grad/true_std6_train:  0.00199; grad/pseudo_std6_train:  4.45154; grad/diff6_train:  18226.51660; grad/cos6_train:  0.84832; grad/true_mag7_train:  10.31805; grad/pseudo_mag7_train:  18237.82100; grad/true_std7_train:  0.00252; grad/pseudo_std7_train:  4.45259; grad/diff7_train:  18228.91504; grad/cos7_train:  0.85485; grad/true_mag8_train:  12.27906; grad/pseudo_mag8_train:  18353.77949; grad/true_std8_train:  0.00300; grad/pseudo_std8_train:  4.48075; grad/diff8_train:  18343.41924; grad/cos8_train:  0.83079; grad/true_mag9_train:  7.98304; grad/pseudo_mag9_train:  18324.20146; grad/true_std9_train:  0.00195; grad/pseudo_std9_train:  4.47368; grad/diff9_train:  18317.07998; grad/cos9_train:  0.88423; grad/true_mag10_train:  9.56452; grad/pseudo_mag10_train:  18336.30186; grad/true_std10_train:  0.00234; grad/pseudo_std10_train:  4.47663; grad/diff10_train:  18327.95068; grad/cos10_train:  0.86219; grad/true_mag11_train:  10.89804; grad/pseudo_mag11_train:  19175.32676; grad/true_std11_train:  0.00266; grad/pseudo_std11_train:  4.68144; grad/diff11_train:  19165.78311; grad/cos11_train:  0.86238; grad/true_mag12_train:  7.84536; grad/pseudo_mag12_train:  18446.25347; grad/true_std12_train:  0.00192; grad/pseudo_std12_train:  4.50347; grad/diff12_train:  18439.25103; grad/cos12_train:  0.88212; grad/true_mag13_train:  9.15406; grad/pseudo_mag13_train:  18495.86821; grad/true_std13_train:  0.00223; grad/pseudo_std13_train:  4.51559; grad/diff13_train:  18487.80161; grad/cos13_train:  0.86991; grad/true_mag14_train:  11.02683; grad/pseudo_mag14_train:  19058.33945; grad/true_std14_train:  0.00269; grad/pseudo_std14_train:  4.65288; grad/diff14_train:  19049.32329; grad/cos14_train:  0.79983; grad/true_mag15_train:  7.59035; grad/pseudo_mag15_train:  19249.47217; grad/true_std15_train:  0.00185; grad/pseudo_std15_train:  4.69957; grad/diff15_train:  19243.04824; grad/cos15_train:  0.83109; grad/true_mag16_train:  8.84188; grad/pseudo_mag16_train:  19433.96289; grad/true_std16_train:  0.00216; grad/pseudo_std16_train:  4.74462; grad/diff16_train:  19426.43623; grad/cos16_train:  0.83924; grad/true_mag17_train:  11.43965; grad/pseudo_mag17_train:  19207.29531; grad/true_std17_train:  0.00279; grad/pseudo_std17_train:  4.68920; grad/diff17_train:  19198.71602; grad/cos17_train:  0.73231; grad_train:  1759.35803; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:34:53,788][trainer][INFO] - Step 130:
[2025-04-24 22:34:53,789][trainer][INFO] - loss/edit_train:  11.14415; loss/loc_train:  0.19092; edit/acc_train:  0.03693; edit/log_prob_train: -11.14415; edit/prob_train:  0.26018; acc/pre_train:  0.00000; acc/post_train:  0.10000; nll/pre_train:  4.42674; perplexity/pre_train:  83.65853; nll/post_train:  4.88115; perplexity/post_train:  131.78252; n_tokens/pre_train:  3.40000; n_tokens/post_train:  3.40000; time/edit_train:  0.22590; loss/total_train:  1.30533; loss/total_edit_train:  1.30533; memory/alloc_max_train:  41023668736.00000; memory/res_max_train:  43719327744.00000; grad/true_mag0_train:  6.19709; grad/pseudo_mag0_train:  17814.49297; grad/true_std0_train:  0.00151; grad/pseudo_std0_train:  4.34909; grad/diff0_train:  17810.34277; grad/cos0_train:  0.67059; grad/true_mag1_train:  11.31091; grad/pseudo_mag1_train:  17351.90566; grad/true_std1_train:  0.00276; grad/pseudo_std1_train:  4.23622; grad/diff1_train:  17343.70537; grad/cos1_train:  0.72502; grad/true_mag2_train:  14.30615; grad/pseudo_mag2_train:  17433.19170; grad/true_std2_train:  0.00349; grad/pseudo_std2_train:  4.25531; grad/diff2_train:  17422.73926; grad/cos2_train:  0.72856; grad/true_mag3_train:  8.23570; grad/pseudo_mag3_train:  19956.70205; grad/true_std3_train:  0.00201; grad/pseudo_std3_train:  4.87222; grad/diff3_train:  19950.11924; grad/cos3_train:  0.79454; grad/true_mag4_train:  12.01429; grad/pseudo_mag4_train:  19704.82734; grad/true_std4_train:  0.00293; grad/pseudo_std4_train:  4.81069; grad/diff4_train:  19695.01934; grad/cos4_train:  0.81103; grad/true_mag5_train:  15.26498; grad/pseudo_mag5_train:  19673.01328; grad/true_std5_train:  0.00373; grad/pseudo_std5_train:  4.80251; grad/diff5_train:  19660.65107; grad/cos5_train:  0.80223; grad/true_mag6_train:  9.28440; grad/pseudo_mag6_train:  20967.40996; grad/true_std6_train:  0.00227; grad/pseudo_std6_train:  5.11899; grad/diff6_train:  20959.44424; grad/cos6_train:  0.85344; grad/true_mag7_train:  11.47576; grad/pseudo_mag7_train:  20583.87969; grad/true_std7_train:  0.00280; grad/pseudo_std7_train:  5.02534; grad/diff7_train:  20573.92715; grad/cos7_train:  0.86104; grad/true_mag8_train:  13.72911; grad/pseudo_mag8_train:  21094.83965; grad/true_std8_train:  0.00335; grad/pseudo_std8_train:  5.14989; grad/diff8_train:  21083.06377; grad/cos8_train:  0.84719; grad/true_mag9_train:  9.12328; grad/pseudo_mag9_train:  21205.89541; grad/true_std9_train:  0.00223; grad/pseudo_std9_train:  5.17721; grad/diff9_train:  21197.70186; grad/cos9_train:  0.89410; grad/true_mag10_train:  10.63721; grad/pseudo_mag10_train:  20863.41299; grad/true_std10_train:  0.00260; grad/pseudo_std10_train:  5.09360; grad/diff10_train:  20854.04033; grad/cos10_train:  0.87520; grad/true_mag11_train:  12.35319; grad/pseudo_mag11_train:  21984.51465; grad/true_std11_train:  0.00302; grad/pseudo_std11_train:  5.36726; grad/diff11_train:  21973.66982; grad/cos11_train:  0.86809; grad/true_mag12_train:  8.92337; grad/pseudo_mag12_train:  21179.60967; grad/true_std12_train:  0.00218; grad/pseudo_std12_train:  5.17080; grad/diff12_train:  21171.59521; grad/cos12_train:  0.89203; grad/true_mag13_train:  10.24744; grad/pseudo_mag13_train:  21137.72520; grad/true_std13_train:  0.00250; grad/pseudo_std13_train:  5.16057; grad/diff13_train:  21128.61758; grad/cos13_train:  0.88116; grad/true_mag14_train:  12.31908; grad/pseudo_mag14_train:  21621.02344; grad/true_std14_train:  0.00301; grad/pseudo_std14_train:  5.27851; grad/diff14_train:  21610.84170; grad/cos14_train:  0.81605; grad/true_mag15_train:  8.35049; grad/pseudo_mag15_train:  21790.83066; grad/true_std15_train:  0.00204; grad/pseudo_std15_train:  5.32002; grad/diff15_train:  21783.59893; grad/cos15_train:  0.85779; grad/true_mag16_train:  9.56484; grad/pseudo_mag16_train:  21769.30303; grad/true_std16_train:  0.00234; grad/pseudo_std16_train:  5.31476; grad/diff16_train:  21761.02490; grad/cos16_train:  0.85608; grad/true_mag17_train:  12.21440; grad/pseudo_mag17_train:  21416.27949; grad/true_std17_train:  0.00298; grad/pseudo_std17_train:  5.22846; grad/diff17_train:  21406.82510; grad/cos17_train:  0.76086; grad_train:  2213.28662; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:34:57,192][trainer][INFO] - Step 140:
[2025-04-24 22:34:57,192][trainer][INFO] - loss/edit_train:  9.34307; loss/loc_train:  0.08077; edit/acc_train:  0.10762; edit/log_prob_train: -9.34307; edit/prob_train:  0.28183; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  3.45981; perplexity/pre_train:  31.81095; nll/post_train:  3.58717; perplexity/post_train:  36.13152; n_tokens/pre_train:  4.70000; n_tokens/post_train:  4.70000; time/edit_train:  0.19469; loss/total_train:  1.01508; loss/total_edit_train:  1.01508; memory/alloc_max_train:  41023668736.00000; memory/res_max_train:  43729394073.60000; grad/true_mag0_train:  5.97550; grad/pseudo_mag0_train:  17516.11367; grad/true_std0_train:  0.00146; grad/pseudo_std0_train:  4.27633; grad/diff0_train:  17512.13438; grad/cos0_train:  0.66624; grad/true_mag1_train:  10.74988; grad/pseudo_mag1_train:  17254.59951; grad/true_std1_train:  0.00262; grad/pseudo_std1_train:  4.21250; grad/diff1_train:  17246.69287; grad/cos1_train:  0.73352; grad/true_mag2_train:  13.18771; grad/pseudo_mag2_train:  17076.30527; grad/true_std2_train:  0.00322; grad/pseudo_std2_train:  4.16821; grad/diff2_train:  17066.41309; grad/cos2_train:  0.74544; grad/true_mag3_train:  7.71933; grad/pseudo_mag3_train:  19197.53135; grad/true_std3_train:  0.00188; grad/pseudo_std3_train:  4.68688; grad/diff3_train:  19191.31826; grad/cos3_train:  0.80247; grad/true_mag4_train:  11.28410; grad/pseudo_mag4_train:  19225.37324; grad/true_std4_train:  0.00275; grad/pseudo_std4_train:  4.69366; grad/diff4_train:  19216.06826; grad/cos4_train:  0.82161; grad/true_mag5_train:  14.86397; grad/pseudo_mag5_train:  19218.95078; grad/true_std5_train:  0.00363; grad/pseudo_std5_train:  4.69169; grad/diff5_train:  19206.95508; grad/cos5_train:  0.80556; grad/true_mag6_train:  9.21601; grad/pseudo_mag6_train:  21547.05508; grad/true_std6_train:  0.00225; grad/pseudo_std6_train:  5.26050; grad/diff6_train:  21539.03330; grad/cos6_train:  0.86666; grad/true_mag7_train:  11.42750; grad/pseudo_mag7_train:  21155.20869; grad/true_std7_train:  0.00279; grad/pseudo_std7_train:  5.16483; grad/diff7_train:  21145.19766; grad/cos7_train:  0.87149; grad/true_mag8_train:  13.72247; grad/pseudo_mag8_train:  21577.00098; grad/true_std8_train:  0.00335; grad/pseudo_std8_train:  5.26763; grad/diff8_train:  21565.07051; grad/cos8_train:  0.86261; grad/true_mag9_train:  9.41083; grad/pseudo_mag9_train:  22144.17344; grad/true_std9_train:  0.00230; grad/pseudo_std9_train:  5.40629; grad/diff9_train:  22135.67061; grad/cos9_train:  0.89995; grad/true_mag10_train:  10.95621; grad/pseudo_mag10_train:  22119.92422; grad/true_std10_train:  0.00267; grad/pseudo_std10_train:  5.40037; grad/diff10_train:  22110.11270; grad/cos10_train:  0.89069; grad/true_mag11_train:  12.39504; grad/pseudo_mag11_train:  22695.70781; grad/true_std11_train:  0.00303; grad/pseudo_std11_train:  5.54091; grad/diff11_train:  22684.59834; grad/cos11_train:  0.88857; grad/true_mag12_train:  9.13789; grad/pseudo_mag12_train:  21982.76152; grad/true_std12_train:  0.00223; grad/pseudo_std12_train:  5.36688; grad/diff12_train:  21974.50928; grad/cos12_train:  0.89873; grad/true_mag13_train:  10.49205; grad/pseudo_mag13_train:  22138.17402; grad/true_std13_train:  0.00256; grad/pseudo_std13_train:  5.40482; grad/diff13_train:  22128.74062; grad/cos13_train:  0.89295; grad/true_mag14_train:  12.19479; grad/pseudo_mag14_train:  22254.31631; grad/true_std14_train:  0.00298; grad/pseudo_std14_train:  5.43314; grad/diff14_train:  22244.02744; grad/cos14_train:  0.83554; grad/true_mag15_train:  8.45029; grad/pseudo_mag15_train:  22330.58447; grad/true_std15_train:  0.00206; grad/pseudo_std15_train:  5.45180; grad/diff15_train:  22323.24697; grad/cos15_train:  0.86174; grad/true_mag16_train:  9.63195; grad/pseudo_mag16_train:  22412.52715; grad/true_std16_train:  0.00235; grad/pseudo_std16_train:  5.47180; grad/diff16_train:  22404.09922; grad/cos16_train:  0.86784; grad/true_mag17_train:  12.12139; grad/pseudo_mag17_train:  21826.59004; grad/true_std17_train:  0.00296; grad/pseudo_std17_train:  5.32866; grad/diff17_train:  21817.08994; grad/cos17_train:  0.77484; grad_train:  1150.20630; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
[2025-04-24 22:35:00,444][trainer][INFO] - Step 150:
[2025-04-24 22:35:00,445][trainer][INFO] - loss/edit_train:  8.20551; loss/loc_train:  0.12166; edit/acc_train:  0.02436; edit/log_prob_train: -8.20551; edit/prob_train:  0.30569; acc/pre_train:  0.00000; acc/post_train:  0.00000; nll/pre_train:  4.70109; perplexity/pre_train:  110.06695; nll/post_train:  5.03912; perplexity/post_train:  154.33421; n_tokens/pre_train:  7.60000; n_tokens/post_train:  7.60000; time/edit_train:  0.18199; loss/total_train:  0.94221; loss/total_edit_train:  0.94221; memory/alloc_max_train:  41023668736.00000; memory/res_max_train:  43752882176.00000; grad/true_mag0_train:  6.02422; grad/pseudo_mag0_train:  17117.45957; grad/true_std0_train:  0.00147; grad/pseudo_std0_train:  4.17898; grad/diff0_train:  17113.40107; grad/cos0_train:  0.67438; grad/true_mag1_train:  11.16863; grad/pseudo_mag1_train:  17442.29521; grad/true_std1_train:  0.00273; grad/pseudo_std1_train:  4.25831; grad/diff1_train:  17434.05186; grad/cos1_train:  0.73726; grad/true_mag2_train:  14.77704; grad/pseudo_mag2_train:  17826.06064; grad/true_std2_train:  0.00361; grad/pseudo_std2_train:  4.35142; grad/diff2_train:  17814.95898; grad/cos2_train:  0.75017; grad/true_mag3_train:  8.38605; grad/pseudo_mag3_train:  20734.78428; grad/true_std3_train:  0.00205; grad/pseudo_std3_train:  5.06218; grad/diff3_train:  20727.97227; grad/cos3_train:  0.81216; grad/true_mag4_train:  11.96930; grad/pseudo_mag4_train:  20448.71201; grad/true_std4_train:  0.00292; grad/pseudo_std4_train:  4.99232; grad/diff4_train:  20438.74795; grad/cos4_train:  0.83134; grad/true_mag5_train:  15.55211; grad/pseudo_mag5_train:  20728.48193; grad/true_std5_train:  0.00380; grad/pseudo_std5_train:  5.06034; grad/diff5_train:  20715.50928; grad/cos5_train:  0.83330; grad/true_mag6_train:  9.64030; grad/pseudo_mag6_train:  22130.78975; grad/true_std6_train:  0.00235; grad/pseudo_std6_train:  5.40302; grad/diff6_train:  22122.36758; grad/cos6_train:  0.87319; grad/true_mag7_train:  11.81297; grad/pseudo_mag7_train:  21686.58174; grad/true_std7_train:  0.00288; grad/pseudo_std7_train:  5.29456; grad/diff7_train:  21676.18359; grad/cos7_train:  0.87830; grad/true_mag8_train:  14.50460; grad/pseudo_mag8_train:  22362.98975; grad/true_std8_train:  0.00354; grad/pseudo_std8_train:  5.45956; grad/diff8_train:  22350.37090; grad/cos8_train:  0.86686; grad/true_mag9_train:  9.87161; grad/pseudo_mag9_train:  22943.50000; grad/true_std9_train:  0.00241; grad/pseudo_std9_train:  5.60143; grad/diff9_train:  22934.54902; grad/cos9_train:  0.90546; grad/true_mag10_train:  11.37455; grad/pseudo_mag10_train:  22843.76465; grad/true_std10_train:  0.00278; grad/pseudo_std10_train:  5.57708; grad/diff10_train:  22833.56016; grad/cos10_train:  0.89558; grad/true_mag11_train:  13.09100; grad/pseudo_mag11_train:  23730.54688; grad/true_std11_train:  0.00320; grad/pseudo_std11_train:  5.79356; grad/diff11_train:  23718.81230; grad/cos11_train:  0.89358; grad/true_mag12_train:  9.71919; grad/pseudo_mag12_train:  22975.96699; grad/true_std12_train:  0.00237; grad/pseudo_std12_train:  5.60936; grad/diff12_train:  22967.15967; grad/cos12_train:  0.90418; grad/true_mag13_train:  10.93614; grad/pseudo_mag13_train:  22865.01094; grad/true_std13_train:  0.00267; grad/pseudo_std13_train:  5.58227; grad/diff13_train:  22855.16748; grad/cos13_train:  0.89838; grad/true_mag14_train:  12.82999; grad/pseudo_mag14_train:  23178.71650; grad/true_std14_train:  0.00313; grad/pseudo_std14_train:  5.65883; grad/diff14_train:  23167.83672; grad/cos14_train:  0.84469; grad/true_mag15_train:  9.02404; grad/pseudo_mag15_train:  23511.34512; grad/true_std15_train:  0.00220; grad/pseudo_std15_train:  5.74007; grad/diff15_train:  23503.44824; grad/cos15_train:  0.87110; grad/true_mag16_train:  10.52955; grad/pseudo_mag16_train:  23485.05566; grad/true_std16_train:  0.00257; grad/pseudo_std16_train:  5.73365; grad/diff16_train:  23475.91660; grad/cos16_train:  0.86323; grad/true_mag17_train:  12.77747; grad/pseudo_mag17_train:  22664.02852; grad/true_std17_train:  0.00312; grad/pseudo_std17_train:  5.53309; grad/diff17_train:  22654.01963; grad/cos17_train:  0.77435; grad_train:  1496.09949; lr/lr0_train:  0.00009; lr/lr1_train:  0.00009; lr/lr2_train:  0.00009; lr/lr3_train:  0.00009; lr/lr4_train:  0.00009; lr/lr5_train:  0.00009; lr/lr6_train:  0.00009; lr/lr7_train:  0.00009; lr/lr8_train:  0.00009; lr/lr9_train:  0.00009; lr/lr10_train:  0.00009; lr/lr11_train:  0.00009; lr/lr12_train:  0.00009; lr/lr13_train:  0.00009; lr/lr14_train:  0.00009; lr/lr15_train:  0.00009; lr/lr16_train:  0.00009; lr/lr17_train:  0.00009
